<div class="code-page">
  <div class="code-card">
    <div class="code-toolbar">
      <div class="toolbar-left">
        <button class="back-btn" (click)="goBack()">‚Üê</button>
        <h2>üìÖ Code Period</h2>
        <span class="record-count">{{ filtered.length }} records</span>
      </div>
      <div class="toolbar-right">
        <button class="btn-add" (click)="openAdd()">Ôºã Add New Period</button>
      </div>
    </div>
    <div class="code-table-wrap">
      <div class="table-search">
        <span class="search-icon">üîç</span>
        <input type="text" [(ngModel)]="searchTerm" placeholder="Search periods...">
      </div>
      <table class="code-table">
        <thead>
          <tr>
            <th>Period Name</th>
            <th>Status</th>
            <th>Recorded By</th>
            <th>Record Time</th>
            <th style="width:90px">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of filtered">
            <td><strong>{{ item.periodName }}</strong></td>
            <td>
              <span [class]="item.active ? 'status-active' : 'status-inactive'">
                {{ item.active ? 'Active' : 'Inactive' }}
              </span>
            </td>
            <td>{{ item.recordBy }}</td>
            <td>{{ item.recordTime | date:'yyyy-MM-dd HH:mm' }}</td>
            <td>
              <div class="actions-cell">
                <button class="action-btn edit-btn" (click)="openEdit(item)">‚úèÔ∏è</button>
                <button class="action-btn delete-btn" (click)="confirmDelete(item)">üóëÔ∏è</button>
              </div>
            </td>
          </tr>
          <tr *ngIf="filtered.length === 0">
            <td colspan="5" class="empty-row">No periods found</td>
          </tr>
        </tbody>
      </table>
      <div class="table-footer">
        <span class="records-info">Showing {{ filtered.length }} of {{ items.length }} records</span>
        <app-export-buttons [data]="filtered"></app-export-buttons>
      </div>
    </div>
  </div>

  <!-- Add/Edit Modal -->
  <app-modal [title]="isEdit ? 'Edit Period' : 'Add New Period'" [isOpen]="isModalOpen" (closed)="closeModal()" size="medium">
    <div class="modal-form">
      <div class="form-row">
        <div class="form-group">
          <label>Period Name *</label>
          <input type="text" [(ngModel)]="model.periodName" placeholder="e.g. 2026-12">
        </div>
        <div class="form-group">
          <label class="checkbox-label">
            <input type="checkbox" [(ngModel)]="model.active">
            Active
          </label>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-save" (click)="save()" [disabled]="saving">{{ isEdit ? 'üíæ Update Period' : 'Ôºã Add Period' }}</button>
      <button class="btn-cancel-modal" (click)="closeModal()">Cancel</button>
    </div>
  </app-modal>

  <!-- Delete Confirmation -->
  <app-confirm-dialog
    [isOpen]="showDeleteConfirm"
    [itemName]="deleteTarget?.periodName || ''"
    (confirmed)="onDeleteConfirmed()"
    (cancelled)="onDeleteCancelled()">
  </app-confirm-dialog>
</div>