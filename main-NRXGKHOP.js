var j2=Object.defineProperty,U2=Object.defineProperties;var W2=Object.getOwnPropertyDescriptors;var S1=Object.getOwnPropertySymbols;var z2=Object.prototype.hasOwnProperty,H2=Object.prototype.propertyIsEnumerable;var D1=(e,n,t)=>n in e?j2(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Y=(e,n)=>{for(var t in n||={})z2.call(n,t)&&D1(e,t,n[t]);if(S1)for(var t of S1(n))H2.call(n,t)&&D1(e,t,n[t]);return e},nt=(e,n)=>U2(e,W2(n));var zn=null,ql=!1,T0=1,$2=null,Qn=Symbol("SIGNAL");function Qe(e){let n=zn;return zn=e,n}function Yl(){return zn}var Js={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function ec(e){if(ql)throw new Error("");if(zn===null)return;zn.consumerOnSignalRead(e);let n=zn.producersTail;if(n!==void 0&&n.producer===e)return;let t,r=zn.recomputing;if(r&&(t=n!==void 0?n.nextProducer:zn.producers,t!==void 0&&t.producer===e)){zn.producersTail=t,t.lastReadVersion=e.version;return}let o=e.consumersTail;if(o!==void 0&&o.consumer===zn&&(!r||q2(o,zn)))return;let i=Ra(zn),a={producer:e,consumer:zn,nextProducer:t,prevConsumer:o,lastReadVersion:e.version,nextConsumer:void 0};zn.producersTail=a,n!==void 0?n.nextProducer=a:zn.producers=a,i&&N1(e,a)}function k1(){T0++}function P0(e){if(!(Ra(e)&&!e.dirty)&&!(!e.dirty&&e.lastCleanEpoch===T0)){if(!e.producerMustRecompute(e)&&!Zl(e)){O0(e);return}e.producerRecomputeValue(e),O0(e)}}function S0(e){if(e.consumers===void 0)return;let n=ql;ql=!0;try{for(let t=e.consumers;t!==void 0;t=t.nextConsumer){let r=t.consumer;r.dirty||G2(r)}}finally{ql=n}}function D0(){return zn?.consumerAllowSignalWrites!==!1}function G2(e){e.dirty=!0,S0(e),e.consumerMarkedDirty?.(e)}function O0(e){e.dirty=!1,e.lastCleanEpoch=T0}function tc(e){return e&&I1(e),Qe(e)}function I1(e){e.producersTail=void 0,e.recomputing=!0}function Kl(e,n){Qe(n),e&&A1(e)}function A1(e){e.recomputing=!1;let n=e.producersTail,t=n!==void 0?n.nextProducer:e.producers;if(t!==void 0){if(Ra(e))do t=k0(t);while(t!==void 0);n!==void 0?n.nextProducer=void 0:e.producers=void 0}}function Zl(e){for(let n=e.producers;n!==void 0;n=n.nextProducer){let t=n.producer,r=n.lastReadVersion;if(r!==t.version||(P0(t),r!==t.version))return!0}return!1}function nc(e){if(Ra(e)){let n=e.producers;for(;n!==void 0;)n=k0(n)}e.producers=void 0,e.producersTail=void 0,e.consumers=void 0,e.consumersTail=void 0}function N1(e,n){let t=e.consumersTail,r=Ra(e);if(t!==void 0?(n.nextConsumer=t.nextConsumer,t.nextConsumer=n):(n.nextConsumer=void 0,e.consumers=n),n.prevConsumer=t,e.consumersTail=n,!r)for(let o=e.producers;o!==void 0;o=o.nextProducer)N1(o.producer,o)}function k0(e){let n=e.producer,t=e.nextProducer,r=e.nextConsumer,o=e.prevConsumer;if(e.nextConsumer=void 0,e.prevConsumer=void 0,r!==void 0?r.prevConsumer=o:n.consumersTail=o,o!==void 0)o.nextConsumer=r;else if(n.consumers=r,!Ra(n)){let i=n.producers;for(;i!==void 0;)i=k0(i)}return t}function Ra(e){return e.consumerIsAlwaysLive||e.consumers!==void 0}function I0(e){$2?.(e)}function q2(e,n){let t=n.producersTail;if(t!==void 0){let r=n.producers;do{if(r===e)return!0;if(r===t)break;r=r.nextProducer}while(r!==void 0)}return!1}function A0(e,n){return Object.is(e,n)}function Ql(e,n){let t=Object.create(X2);t.computation=e,n!==void 0&&(t.equal=n);let r=()=>{if(P0(t),ec(t),t.value===Xl)throw t.error;return t.value};return r[Qn]=t,I0(t),r}var w0=Symbol("UNSET"),E0=Symbol("COMPUTING"),Xl=Symbol("ERRORED"),X2=nt(Y({},Js),{value:w0,dirty:!0,error:null,equal:A0,kind:"computed",producerMustRecompute(e){return e.value===w0||e.value===E0},producerRecomputeValue(e){if(e.value===E0)throw new Error("");let n=e.value;e.value=E0;let t=tc(e),r,o=!1;try{r=e.computation(),Qe(null),o=n!==w0&&n!==Xl&&r!==Xl&&e.equal(n,r)}catch(i){r=Xl,e.error=i}finally{Kl(e,t)}if(o){e.value=n;return}e.value=r,e.version++}});function Y2(){throw new Error}var F1=Y2;function R1(e){F1(e)}function N0(e){F1=e}var K2=null;function F0(e,n){let t=Object.create(Jl);t.value=e,n!==void 0&&(t.equal=n);let r=()=>L1(t);return r[Qn]=t,I0(t),[r,a=>rc(t,a),a=>B1(t,a)]}function L1(e){return ec(e),e.value}function rc(e,n){D0()||R1(e),e.equal(e.value,n)||(e.value=n,Z2(e))}function B1(e,n){D0()||R1(e),rc(e,n(e.value))}var Jl=nt(Y({},Js),{equal:A0,value:void 0,kind:"signal"});function Z2(e){e.version++,k1(),S0(e),K2?.(e)}function R0(e){let n=Qe(null);try{return e()}finally{Qe(n)}}function Je(e){return typeof e=="function"}function La(e){let t=e(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ed=La(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,o)=>`${o+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function oc(e,n){if(e){let t=e.indexOf(n);0<=t&&e.splice(t,1)}}var Tn=class e{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let i of t)i.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(Je(r))try{r()}catch(i){n=i instanceof ed?i.errors:[i]}let{_finalizers:o}=this;if(o){this._finalizers=null;for(let i of o)try{V1(i)}catch(a){n=n??[],a instanceof ed?n=[...n,...a.errors]:n.push(a)}}if(n)throw new ed(n)}}add(n){var t;if(n&&n!==this)if(this.closed)V1(n);else{if(n instanceof e){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(n)}}_hasParent(n){let{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){let{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&oc(t,n)}remove(n){let{_finalizers:t}=this;t&&oc(t,n),n instanceof e&&n._removeParent(this)}};Tn.EMPTY=(()=>{let e=new Tn;return e.closed=!0,e})();var L0=Tn.EMPTY;function td(e){return e instanceof Tn||e&&"closed"in e&&Je(e.remove)&&Je(e.add)&&Je(e.unsubscribe)}function V1(e){Je(e)?e():e.unsubscribe()}var qr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ba={setTimeout(e,n,...t){let{delegate:r}=Ba;return r?.setTimeout?r.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){let{delegate:n}=Ba;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function nd(e){Ba.setTimeout(()=>{let{onUnhandledError:n}=qr;if(n)n(e);else throw e})}function ic(){}var j1=B0("C",void 0,void 0);function U1(e){return B0("E",void 0,e)}function W1(e){return B0("N",e,void 0)}function B0(e,n,t){return{kind:e,value:n,error:t}}var zi=null;function Va(e){if(qr.useDeprecatedSynchronousErrorHandling){let n=!zi;if(n&&(zi={errorThrown:!1,error:null}),e(),n){let{errorThrown:t,error:r}=zi;if(zi=null,t)throw r}}else e()}function z1(e){qr.useDeprecatedSynchronousErrorHandling&&zi&&(zi.errorThrown=!0,zi.error=e)}var Hi=class extends Tn{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,td(n)&&n.add(this)):this.destination=eO}static create(n,t,r){return new ja(n,t,r)}next(n){this.isStopped?j0(W1(n),this):this._next(n)}error(n){this.isStopped?j0(U1(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?j0(j1,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Q2=Function.prototype.bind;function V0(e,n){return Q2.call(e,n)}var U0=class{constructor(n){this.partialObserver=n}next(n){let{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(r){rd(r)}}error(n){let{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(r){rd(r)}else rd(n)}complete(){let{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){rd(t)}}},ja=class extends Hi{constructor(n,t,r){super();let o;if(Je(n)||!n)o={next:n??void 0,error:t??void 0,complete:r??void 0};else{let i;this&&qr.useDeprecatedNextContext?(i=Object.create(n),i.unsubscribe=()=>this.unsubscribe(),o={next:n.next&&V0(n.next,i),error:n.error&&V0(n.error,i),complete:n.complete&&V0(n.complete,i)}):o=n}this.destination=new U0(o)}};function rd(e){qr.useDeprecatedSynchronousErrorHandling?z1(e):nd(e)}function J2(e){throw e}function j0(e,n){let{onStoppedNotification:t}=qr;t&&Ba.setTimeout(()=>t(e,n))}var eO={closed:!0,next:ic,error:J2,complete:ic};var Ua=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Xr(e){return e}function W0(...e){return z0(e)}function z0(e){return e.length===0?Xr:e.length===1?e[0]:function(t){return e.reduce((r,o)=>o(r),t)}}var lt=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new e;return r.source=this,r.operator=t,r}subscribe(t,r,o){let i=nO(t)?t:new ja(t,r,o);return Va(()=>{let{operator:a,source:l}=this;i.add(a?a.call(i,l):l?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=H1(r),new r((o,i)=>{let a=new ja({next:l=>{try{t(l)}catch(u){i(u),a.unsubscribe()}},error:i,complete:o});this.subscribe(a)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Ua](){return this}pipe(...t){return z0(t)(this)}toPromise(t){return t=H1(t),new t((r,o)=>{let i;this.subscribe(a=>i=a,a=>o(a),()=>r(i))})}}return e.create=n=>new e(n),e})();function H1(e){var n;return(n=e??qr.Promise)!==null&&n!==void 0?n:Promise}function tO(e){return e&&Je(e.next)&&Je(e.error)&&Je(e.complete)}function nO(e){return e&&e instanceof Hi||tO(e)&&td(e)}function rO(e){return Je(e?.lift)}function yt(e){return n=>{if(rO(n))return n.lift(function(t){try{return e(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Mt(e,n,t,r,o){return new H0(e,n,t,r,o)}var H0=class extends Hi{constructor(n,t,r,o,i,a){super(n),this.onFinalize=i,this.shouldUnsubscribe=a,this._next=t?function(l){try{t(l)}catch(u){n.error(u)}}:super._next,this._error=o?function(l){try{o(l)}catch(u){n.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(l){n.error(l)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((n=this.onFinalize)===null||n===void 0||n.call(this))}}};var $1=La(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var fn=(()=>{class e extends lt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new od(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new $1}next(t){Va(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Va(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Va(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:o,observers:i}=this;return r||o?L0:(this.currentObservers=null,i.push(t),new Tn(()=>{this.currentObservers=null,oc(i,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:o,isStopped:i}=this;r?t.error(o):i&&t.complete()}asObservable(){let t=new lt;return t.source=this,t}}return e.create=(n,t)=>new od(n,t),e})(),od=class extends fn{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,n)}error(n){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,n)}complete(){var n,t;(t=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||t===void 0||t.call(n)}_subscribe(n){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(n))!==null&&r!==void 0?r:L0}};var Pn=class extends fn{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){let t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){let{hasError:n,thrownError:t,_value:r}=this;if(n)throw t;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}};var Sn=new lt(e=>e.complete());function G1(e){return e&&Je(e.schedule)}function q1(e){return e[e.length-1]}function id(e){return Je(q1(e))?e.pop():void 0}function ui(e){return G1(q1(e))?e.pop():void 0}function Y1(e,n,t,r){function o(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(g){try{p(r.next(g))}catch(m){a(m)}}function u(g){try{p(r.throw(g))}catch(m){a(m)}}function p(g){g.done?i(g.value):o(g.value).then(l,u)}p((r=r.apply(e,n||[])).next())})}function X1(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function $i(e){return this instanceof $i?(this.v=e,this):new $i(e)}function K1(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),o[Symbol.asyncIterator]=function(){return this},o;function a(h){return function(b){return Promise.resolve(b).then(h,m)}}function l(h,b){r[h]&&(o[h]=function(x){return new Promise(function(y,A){i.push([h,x,y,A])>1||u(h,x)})},b&&(o[h]=b(o[h])))}function u(h,b){try{p(r[h](b))}catch(x){v(i[0][3],x)}}function p(h){h.value instanceof $i?Promise.resolve(h.value.v).then(g,m):v(i[0][2],h)}function g(h){u("next",h)}function m(h){u("throw",h)}function v(h,b){h(b),i.shift(),i.length&&u(i[0][0],i[0][1])}}function Z1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof X1=="function"?X1(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(a){return new Promise(function(l,u){a=e[i](a),o(l,u,a.done,a.value)})}}function o(i,a,l,u){Promise.resolve(u).then(function(p){i({value:p,done:l})},a)}}var ad=e=>e&&typeof e.length=="number"&&typeof e!="function";function sd(e){return Je(e?.then)}function cd(e){return Je(e[Ua])}function ld(e){return Symbol.asyncIterator&&Je(e?.[Symbol.asyncIterator])}function dd(e){return new TypeError(`You provided ${e!==null&&typeof e=="object"?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function oO(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ud=oO();function fd(e){return Je(e?.[ud])}function pd(e){return K1(this,arguments,function*(){let t=e.getReader();try{for(;;){let{value:r,done:o}=yield $i(t.read());if(o)return yield $i(void 0);yield yield $i(r)}}finally{t.releaseLock()}})}function gd(e){return Je(e?.getReader)}function an(e){if(e instanceof lt)return e;if(e!=null){if(cd(e))return iO(e);if(ad(e))return aO(e);if(sd(e))return sO(e);if(ld(e))return Q1(e);if(fd(e))return cO(e);if(gd(e))return lO(e)}throw dd(e)}function iO(e){return new lt(n=>{let t=e[Ua]();if(Je(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function aO(e){return new lt(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}function sO(e){return new lt(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,nd)})}function cO(e){return new lt(n=>{for(let t of e)if(n.next(t),n.closed)return;n.complete()})}function Q1(e){return new lt(n=>{dO(e,n).catch(t=>n.error(t))})}function lO(e){return Q1(pd(e))}function dO(e,n){var t,r,o,i;return Y1(this,void 0,void 0,function*(){try{for(t=Z1(e);r=yield t.next(),!r.done;){let a=r.value;if(n.next(a),n.closed)return}}catch(a){o={error:a}}finally{try{r&&!r.done&&(i=t.return)&&(yield i.call(t))}finally{if(o)throw o.error}}n.complete()})}function dr(e,n,t,r=0,o=!1){let i=n.schedule(function(){t(),o?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(i),!o)return i}function md(e,n=0){return yt((t,r)=>{t.subscribe(Mt(r,o=>dr(r,e,()=>r.next(o),n),()=>dr(r,e,()=>r.complete(),n),o=>dr(r,e,()=>r.error(o),n)))})}function hd(e,n=0){return yt((t,r)=>{r.add(e.schedule(()=>t.subscribe(r),n))})}function J1(e,n){return an(e).pipe(hd(n),md(n))}function ex(e,n){return an(e).pipe(hd(n),md(n))}function tx(e,n){return new lt(t=>{let r=0;return n.schedule(function(){r===e.length?t.complete():(t.next(e[r++]),t.closed||this.schedule())})})}function nx(e,n){return new lt(t=>{let r;return dr(t,n,()=>{r=e[ud](),dr(t,n,()=>{let o,i;try{({value:o,done:i}=r.next())}catch(a){t.error(a);return}i?t.complete():t.next(o)},0,!0)}),()=>Je(r?.return)&&r.return()})}function vd(e,n){if(!e)throw new Error("Iterable cannot be null");return new lt(t=>{dr(t,n,()=>{let r=e[Symbol.asyncIterator]();dr(t,n,()=>{r.next().then(o=>{o.done?t.complete():t.next(o.value)})},0,!0)})})}function rx(e,n){return vd(pd(e),n)}function ox(e,n){if(e!=null){if(cd(e))return J1(e,n);if(ad(e))return tx(e,n);if(sd(e))return ex(e,n);if(ld(e))return vd(e,n);if(fd(e))return nx(e,n);if(gd(e))return rx(e,n)}throw dd(e)}function Xt(e,n){return n?ox(e,n):an(e)}function et(...e){let n=ui(e);return Xt(e,n)}function $0(e,n){let t=Je(e)?e:()=>e,r=o=>o.error(t());return new lt(n?o=>n.schedule(r,0,o):r)}function xd(e){return!!e&&(e instanceof lt||Je(e.lift)&&Je(e.subscribe))}var Gi=La(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function Tt(e,n){return yt((t,r)=>{let o=0;t.subscribe(Mt(r,i=>{r.next(e.call(n,i,o++))}))})}var{isArray:uO}=Array;function fO(e,n){return uO(n)?e(...n):e(n)}function _d(e){return Tt(n=>fO(e,n))}var{isArray:pO}=Array,{getPrototypeOf:gO,prototype:mO,keys:hO}=Object;function Cd(e){if(e.length===1){let n=e[0];if(pO(n))return{args:n,keys:null};if(vO(n)){let t=hO(n);return{args:t.map(r=>n[r]),keys:t}}}return{args:e,keys:null}}function vO(e){return e&&typeof e=="object"&&gO(e)===mO}function bd(e,n){return e.reduce((t,r,o)=>(t[r]=n[o],t),{})}function yd(...e){let n=ui(e),t=id(e),{args:r,keys:o}=Cd(e);if(r.length===0)return Xt([],n);let i=new lt(xO(r,n,o?a=>bd(o,a):Xr));return t?i.pipe(_d(t)):i}function xO(e,n,t=Xr){return r=>{ix(n,()=>{let{length:o}=e,i=new Array(o),a=o,l=o;for(let u=0;u<o;u++)ix(n,()=>{let p=Xt(e[u],n),g=!1;p.subscribe(Mt(r,m=>{i[u]=m,g||(g=!0,l--),l||r.next(t(i.slice()))},()=>{--a||r.complete()}))},r)},r)}}function ix(e,n,t){e?dr(t,e,n):n()}function ax(e,n,t,r,o,i,a,l){let u=[],p=0,g=0,m=!1,v=()=>{m&&!u.length&&!p&&n.complete()},h=x=>p<r?b(x):u.push(x),b=x=>{i&&n.next(x),p++;let y=!1;an(t(x,g++)).subscribe(Mt(n,A=>{o?.(A),i?h(A):n.next(A)},()=>{y=!0},void 0,()=>{if(y)try{for(p--;u.length&&p<r;){let A=u.shift();a?dr(n,a,()=>b(A)):b(A)}v()}catch(A){n.error(A)}}))};return e.subscribe(Mt(n,h,()=>{m=!0,v()})),()=>{l?.()}}function Dn(e,n,t=1/0){return Je(n)?Dn((r,o)=>Tt((i,a)=>n(r,i,o,a))(an(e(r,o))),t):(typeof n=="number"&&(t=n),yt((r,o)=>ax(r,o,e,t)))}function Wa(e=1/0){return Dn(Xr,e)}function sx(){return Wa(1)}function za(...e){return sx()(Xt(e,ui(e)))}function ac(e){return new lt(n=>{an(e()).subscribe(n)})}function Lo(...e){let n=id(e),{args:t,keys:r}=Cd(e),o=new lt(i=>{let{length:a}=t;if(!a){i.complete();return}let l=new Array(a),u=a,p=a;for(let g=0;g<a;g++){let m=!1;an(t[g]).subscribe(Mt(i,v=>{m||(m=!0,p--),l[g]=v},()=>u--,void 0,()=>{(!u||!m)&&(p||i.next(r?bd(r,l):l),i.complete())}))}});return n?o.pipe(_d(n)):o}function _r(e,n){return yt((t,r)=>{let o=0;t.subscribe(Mt(r,i=>e.call(n,i,o++)&&r.next(i)))})}function Ha(e){return yt((n,t)=>{let r=null,o=!1,i;r=n.subscribe(Mt(t,void 0,void 0,a=>{i=an(e(a,Ha(e)(n))),r?(r.unsubscribe(),r=null,i.subscribe(t)):o=!0})),o&&(r.unsubscribe(),r=null,i.subscribe(t))})}function fi(e,n){return Je(n)?Dn(e,n,1):Dn(e,1)}function cx(e){return yt((n,t)=>{let r=!1;n.subscribe(Mt(t,o=>{r=!0,t.next(o)},()=>{r||t.next(e),t.complete()}))})}function Bo(e){return e<=0?()=>Sn:yt((n,t)=>{let r=0;n.subscribe(Mt(t,o=>{++r<=e&&(t.next(o),e<=r&&t.complete())}))})}function lx(e=_O){return yt((n,t)=>{let r=!1;n.subscribe(Mt(t,o=>{r=!0,t.next(o)},()=>r?t.complete():t.error(e())))})}function _O(){return new Gi}function $a(e){return yt((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}function Vo(e,n){let t=arguments.length>=2;return r=>r.pipe(e?_r((o,i)=>e(o,i,r)):Xr,Bo(1),t?cx(n):lx(()=>new Gi))}function Md(e){return e<=0?()=>Sn:yt((n,t)=>{let r=[];n.subscribe(Mt(t,o=>{r.push(o),e<r.length&&r.shift()},()=>{for(let o of r)t.next(o);t.complete()},void 0,()=>{r=null}))})}function G0(...e){let n=ui(e);return yt((t,r)=>{(n?za(e,t,n):za(e,t)).subscribe(r)})}function Dr(e,n){return yt((t,r)=>{let o=null,i=0,a=!1,l=()=>a&&!o&&r.complete();t.subscribe(Mt(r,u=>{o?.unsubscribe();let p=0,g=i++;an(e(u,g)).subscribe(o=Mt(r,m=>r.next(n?n(u,m,g,p++):m),()=>{o=null,l()}))},()=>{a=!0,l()}))})}function sc(e){return yt((n,t)=>{an(e).subscribe(Mt(t,()=>t.complete(),ic)),!t.closed&&n.subscribe(t)})}function ho(e,n,t){let r=Je(e)||n||t?{next:e,error:n,complete:t}:e;return r?yt((o,i)=>{var a;(a=r.subscribe)===null||a===void 0||a.call(r);let l=!0;o.subscribe(Mt(i,u=>{var p;(p=r.next)===null||p===void 0||p.call(r,u),i.next(u)},()=>{var u;l=!1,(u=r.complete)===null||u===void 0||u.call(r),i.complete()},u=>{var p;l=!1,(p=r.error)===null||p===void 0||p.call(r,u),i.error(u)},()=>{var u,p;l&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(p=r.finalize)===null||p===void 0||p.call(r)}))}):Xr}var q0;function wd(){return q0}function vo(e){let n=q0;return q0=e,n}var dx=Symbol("NotFound");function Ga(e){return e===dx||e?.name==="\u0275NotFound"}var Sd="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",ge=class extends Error{code;constructor(n,t){super(Wo(n,t)),this.code=n}};function yO(e){return`NG0${Math.abs(e)}`}function Wo(e,n){return`${yO(e)}${n?": "+n:""}`}var An=globalThis;function wt(e){for(let n in e)if(e[n]===wt)return n;throw Error("")}function mx(e,n){for(let t in n)n.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Uo(e){if(typeof e=="string")return e;if(Array.isArray(e))return`[${e.map(Uo).join(", ")}]`;if(e==null)return""+e;let n=e.overriddenName||e.name;if(n)return`${n}`;let t=e.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function Dd(e,n){return e?n?`${e} ${n}`:e:n||""}var MO=wt({__forward_ref__:wt});function kr(e){return e.__forward_ref__=kr,e.toString=function(){return Uo(this())},e}function kn(e){return cg(e)?e():e}function cg(e){return typeof e=="function"&&e.hasOwnProperty(MO)&&e.__forward_ref__===kr}function we(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function dt(e){return{providers:e.providers||[],imports:e.imports||[]}}function pc(e){return wO(e,kd)}function lg(e){return pc(e)!==null}function wO(e,n){return e.hasOwnProperty(n)&&e[n]||null}function EO(e){let n=e?.[kd]??null;return n||null}function Y0(e){return e&&e.hasOwnProperty(Od)?e[Od]:null}var kd=wt({\u0275prov:wt}),Od=wt({\u0275inj:wt}),Me=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(n,t){this._desc=n,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=we({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function dg(e){return e&&!!e.\u0275providers}var ug=wt({\u0275cmp:wt}),fg=wt({\u0275dir:wt}),pg=wt({\u0275pipe:wt}),gg=wt({\u0275mod:wt}),lc=wt({\u0275fac:wt}),Zi=wt({__NG_ELEMENT_ID__:wt}),ux=wt({__NG_ENV_ID__:wt});function mg(e){return Id(e,"@NgModule"),e[gg]||null}function zo(e){return Id(e,"@Component"),e[ug]||null}function hg(e){return Id(e,"@Directive"),e[fg]||null}function hx(e){return Id(e,"@Pipe"),e[pg]||null}function Id(e,n){if(e==null)throw new ge(-919,!1)}function Ho(e){return typeof e=="string"?e:e==null?"":String(e)}var vx=wt({ngErrorCode:wt}),OO=wt({ngErrorMessage:wt}),TO=wt({ngTokenPath:wt});function vg(e,n){return xx("",-200,n)}function Ad(e,n){throw new ge(-201,!1)}function xx(e,n,t){let r=new ge(n,e);return r[vx]=n,r[OO]=e,t&&(r[TO]=t),r}function PO(e){return e[vx]}var K0;function _x(){return K0}function Jn(e){let n=K0;return K0=e,n}function xg(e,n,t){let r=pc(e);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(n!==void 0)return n;Ad(e,"")}var SO={},qi=SO,DO="__NG_DI_FLAG__",Z0=class{injector;constructor(n){this.injector=n}retrieve(n,t){let r=Xi(t)||0;try{return this.injector.get(n,r&8?null:qi,r)}catch(o){if(Ga(o))return o;throw o}}};function kO(e,n=0){let t=wd();if(t===void 0)throw new ge(-203,!1);if(t===null)return xg(e,void 0,n);{let r=IO(n),o=t.retrieve(e,r);if(Ga(o)){if(r.optional)return null;throw o}return o}}function Le(e,n=0){return(_x()||kO)(kn(e),n)}function K(e,n){return Le(e,Xi(n))}function Xi(e){return typeof e>"u"||typeof e=="number"?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function IO(e){return{optional:!!(e&8),host:!!(e&1),self:!!(e&2),skipSelf:!!(e&4)}}function Q0(e){let n=[];for(let t=0;t<e.length;t++){let r=kn(e[t]);if(Array.isArray(r)){if(r.length===0)throw new ge(900,!1);let o,i=0;for(let a=0;a<r.length;a++){let l=r[a],u=AO(l);typeof u=="number"?u===-1?o=l.token:i|=u:o=l}n.push(Le(o,i))}else n.push(Le(r))}return n}function AO(e){return e[DO]}function pi(e,n){let t=e.hasOwnProperty(lc);return t?e[lc]:null}function Nd(e,n){e.forEach(t=>Array.isArray(t)?Nd(t,n):n(t))}function _g(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function gc(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function Cx(e,n){let t=[];for(let r=0;r<e;r++)t.push(n);return t}function bx(e,n,t,r){let o=e.length;if(o==n)e.push(t,r);else if(o===1)e.push(r,e[0]),e[0]=t;else{for(o--,e.push(e[o-1],e[o]);o>n;){let i=o-2;e[o]=e[i],o--}e[n]=t,e[n+1]=r}}function Fd(e,n,t){let r=Xa(e,n);return r>=0?e[r|1]=t:(r=~r,bx(e,r,n,t)),r}function Rd(e,n){let t=Xa(e,n);if(t>=0)return e[t|1]}function Xa(e,n){return NO(e,n,1)}function NO(e,n,t){let r=0,o=e.length>>t;for(;o!==r;){let i=r+(o-r>>1),a=e[i<<t];if(n===a)return i<<t;a>n?o=i:r=i+1}return~(o<<t)}var hi={},er=[],Ya=new Me(""),Cg=new Me("",-1),bg=new Me(""),dc=class{get(n,t=qi){if(t===qi){let o=xx("",-201);throw o.name="\u0275NotFound",o}return t}};function Ka(e){return{\u0275providers:e}}function yx(...e){return{\u0275providers:yg(!0,e),\u0275fromNgModule:!0}}function yg(e,...n){let t=[],r=new Set,o,i=a=>{t.push(a)};return Nd(n,a=>{let l=a;Td(l,i,[],r)&&(o||=[],o.push(l))}),o!==void 0&&Mx(o,i),t}function Mx(e,n){for(let t=0;t<e.length;t++){let{ngModule:r,providers:o}=e[t];Mg(o,i=>{n(i,r)})}}function Td(e,n,t,r){if(e=kn(e),!e)return!1;let o=null,i=Y0(e),a=!i&&zo(e);if(!i&&!a){let u=e.ngModule;if(i=Y0(u),i)o=u;else return!1}else{if(a&&!a.standalone)return!1;o=e}let l=r.has(o);if(a){if(l)return!1;if(r.add(o),a.dependencies){let u=typeof a.dependencies=="function"?a.dependencies():a.dependencies;for(let p of u)Td(p,n,t,r)}}else if(i){if(i.imports!=null&&!l){r.add(o);let p;Nd(i.imports,g=>{Td(g,n,t,r)&&(p||=[],p.push(g))}),p!==void 0&&Mx(p,n)}if(!l){let p=pi(o)||(()=>new o);n({provide:o,useFactory:p,deps:er},o),n({provide:bg,useValue:o,multi:!0},o),n({provide:Ya,useValue:()=>Le(o),multi:!0},o)}let u=i.providers;if(u!=null&&!l){let p=e;Mg(u,g=>{n(g,p)})}}else return!1;return o!==e&&e.providers!==void 0}function Mg(e,n){for(let t of e)dg(t)&&(t=t.\u0275providers),Array.isArray(t)?Mg(t,n):n(t)}var FO=wt({provide:String,useValue:wt});function wx(e){return e!==null&&typeof e=="object"&&FO in e}function RO(e){return!!(e&&e.useExisting)}function LO(e){return!!(e&&e.useFactory)}function Yi(e){return typeof e=="function"}function Ex(e){return!!e.useClass}var mc=new Me(""),Ed={},fx={},X0;function hc(){return X0===void 0&&(X0=new dc),X0}var Gt=class{},Ki=class extends Gt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(n,t,r,o){super(),this.parent=t,this.source=r,this.scopes=o,eg(n,a=>this.processProvider(a)),this.records.set(Cg,qa(void 0,this)),o.has("environment")&&this.records.set(Gt,qa(void 0,this));let i=this.records.get(mc);i!=null&&typeof i.value=="string"&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(bg,er,{self:!0}))}retrieve(n,t){let r=Xi(t)||0;try{return this.get(n,qi,r)}catch(o){if(Ga(o))return o;throw o}}destroy(){cc(this),this._destroyed=!0;let n=Qe(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Qe(n)}}onDestroy(n){return cc(this),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){cc(this);let t=vo(this),r=Jn(void 0),o;try{return n()}finally{vo(t),Jn(r)}}get(n,t=qi,r){if(cc(this),n.hasOwnProperty(ux))return n[ux](this);let o=Xi(r),i,a=vo(this),l=Jn(void 0);try{if(!(o&4)){let p=this.records.get(n);if(p===void 0){let g=WO(n)&&pc(n);g&&this.injectableDefInScope(g)?p=qa(J0(n),Ed):p=null,this.records.set(n,p)}if(p!=null)return this.hydrate(n,p,o)}let u=o&2?hc():this.parent;return t=o&8&&t===qi?null:t,u.get(n,t)}catch(u){let p=PO(u);throw p===-200||p===-201?new ge(p,null):u}finally{Jn(l),vo(a)}}resolveInjectorInitializers(){let n=Qe(null),t=vo(this),r=Jn(void 0),o;try{let i=this.get(Ya,er,{self:!0});for(let a of i)a()}finally{vo(t),Jn(r),Qe(n)}}toString(){let n=[],t=this.records;for(let r of t.keys())n.push(Uo(r));return`R3Injector[${n.join(", ")}]`}processProvider(n){n=kn(n);let t=Yi(n)?n:kn(n&&n.provide),r=VO(n);if(!Yi(n)&&n.multi===!0){let o=this.records.get(t);o||(o=qa(void 0,Ed,!0),o.factory=()=>Q0(o.multi),this.records.set(t,o)),t=n,o.multi.push(n)}this.records.set(t,r)}hydrate(n,t,r){let o=Qe(null);try{if(t.value===fx)throw vg(Uo(n));return t.value===Ed&&(t.value=fx,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&UO(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Qe(o)}}injectableDefInScope(n){if(!n.providedIn)return!1;let t=kn(n.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(n){let t=this._onDestroyHooks.indexOf(n);t!==-1&&this._onDestroyHooks.splice(t,1)}};function J0(e){let n=pc(e),t=n!==null?n.factory:pi(e);if(t!==null)return t;if(e instanceof Me)throw new ge(204,!1);if(e instanceof Function)return BO(e);throw new ge(204,!1)}function BO(e){if(e.length>0)throw new ge(204,!1);let t=EO(e);return t!==null?()=>t.factory(e):()=>new e}function VO(e){if(wx(e))return qa(void 0,e.useValue);{let n=wg(e);return qa(n,Ed)}}function wg(e,n,t){let r;if(Yi(e)){let o=kn(e);return pi(o)||J0(o)}else if(wx(e))r=()=>kn(e.useValue);else if(LO(e))r=()=>e.useFactory(...Q0(e.deps||[]));else if(RO(e))r=(o,i)=>Le(kn(e.useExisting),i!==void 0&&i&8?8:void 0);else{let o=kn(e&&(e.useClass||e.provide));if(jO(e))r=()=>new o(...Q0(e.deps));else return pi(o)||J0(o)}return r}function cc(e){if(e.destroyed)throw new ge(205,!1)}function qa(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function jO(e){return!!e.deps}function UO(e){return e!==null&&typeof e=="object"&&typeof e.ngOnDestroy=="function"}function WO(e){return typeof e=="function"||typeof e=="object"&&e.ngMetadataName==="InjectionToken"}function eg(e,n){for(let t of e)Array.isArray(t)?eg(t,n):t&&dg(t)?eg(t.\u0275providers,n):n(t)}function pn(e,n){let t;e instanceof Ki?(cc(e),t=e):t=new Z0(e);let r,o=vo(t),i=Jn(void 0);try{return n()}finally{vo(o),Jn(i)}}function Eg(){return _x()!==void 0||wd()!=null}var Yr=0,Ke=1,Ye=2,In=3,Ir=4,tr=5,Za=6,Qa=7,Nn=8,vi=9,_o=10,qt=11,Ja=12,Og=13,Qi=14,ur=15,Ji=16,ea=17,ta=18,xi=19,Tg=20,jo=21,Ld=22,vc=23,Cr=24,na=25,xc=26,tn=27,Ox=1;var _i=7,_c=8,Cc=9,nr=10;function Co(e){return Array.isArray(e)&&typeof e[Ox]=="object"}function Kr(e){return Array.isArray(e)&&e[Ox]===!0}function Pg(e){return(e.flags&4)!==0}function Ci(e){return e.componentOffset>-1}function bc(e){return(e.flags&1)===1}function bo(e){return!!e.template}function es(e){return(e[Ye]&512)!==0}function ra(e){return(e[Ye]&256)===256}var Sg="svg",Tx="math";function Ar(e){for(;Array.isArray(e);)e=e[Yr];return e}function Dg(e,n){return Ar(n[e])}function Zr(e,n){return Ar(n[e.index])}function yc(e,n){return e.data[n]}function kg(e,n){return e[n]}function Ig(e,n,t,r){t>=e.data.length&&(e.data[t]=null,e.blueprint[t]=null),n[t]=r}function Nr(e,n){let t=n[e];return Co(t)?t:t[Yr]}function Bd(e){return(e[Ye]&128)===128}function Px(e){return Kr(e[In])}function bi(e,n){return n==null?null:e[n]}function Ag(e){e[ea]=0}function Ng(e){e[Ye]&1024||(e[Ye]|=1024,Bd(e)&&ts(e))}function Sx(e,n){for(;e>0;)n=n[Qi],e--;return n}function Mc(e){return!!(e[Ye]&9216||e[Cr]?.dirty)}function Vd(e){e[_o].changeDetectionScheduler?.notify(8),e[Ye]&64&&(e[Ye]|=1024),Mc(e)&&ts(e)}function ts(e){e[_o].changeDetectionScheduler?.notify(0);let n=gi(e);for(;n!==null&&!(n[Ye]&8192||(n[Ye]|=8192,!Bd(n)));)n=gi(n)}function Fg(e,n){if(ra(e))throw new ge(911,!1);e[jo]===null&&(e[jo]=[]),e[jo].push(n)}function Dx(e,n){if(e[jo]===null)return;let t=e[jo].indexOf(n);t!==-1&&e[jo].splice(t,1)}function gi(e){let n=e[In];return Kr(n)?n[In]:n}function kx(e){return e[Qa]??=[]}function Ix(e){return e.cleanup??=[]}var rt={lFrame:$x(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var tg=!1;function Ax(){return rt.lFrame.elementDepthCount}function Nx(){rt.lFrame.elementDepthCount++}function Fx(){rt.lFrame.elementDepthCount--}function Rg(){return rt.bindingsEnabled}function Lg(){return rt.skipHydrationRootTNode!==null}function Rx(e){return rt.skipHydrationRootTNode===e}function Lx(){rt.skipHydrationRootTNode=null}function it(){return rt.lFrame.lView}function Cn(){return rt.lFrame.tView}function ne(e){return rt.lFrame.contextLView=e,e[Nn]}function re(e){return rt.lFrame.contextLView=null,e}function rr(){let e=Bg();for(;e!==null&&e.type===64;)e=e.parent;return e}function Bg(){return rt.lFrame.currentTNode}function Bx(){let e=rt.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}function ns(e,n){let t=rt.lFrame;t.currentTNode=e,t.isParent=n}function Vg(){return rt.lFrame.isParent}function jg(){rt.lFrame.isParent=!1}function Ug(){return tg}function Wg(e){let n=tg;return tg=e,n}function zg(){let e=rt.lFrame,n=e.bindingRootIndex;return n===-1&&(n=e.bindingRootIndex=e.tView.bindingStartIndex),n}function Hg(){return rt.lFrame.bindingIndex}function Vx(e){return rt.lFrame.bindingIndex=e}function rs(){return rt.lFrame.bindingIndex++}function wc(e){let n=rt.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}function jx(){return rt.lFrame.inI18n}function Ux(e,n){let t=rt.lFrame;t.bindingIndex=t.bindingRootIndex=e,jd(n)}function Wx(){return rt.lFrame.currentDirectiveIndex}function jd(e){rt.lFrame.currentDirectiveIndex=e}function zx(e){let n=rt.lFrame.currentDirectiveIndex;return n===-1?null:e[n]}function $g(e){rt.lFrame.currentQueryIndex=e}function zO(e){let n=e[Ke];return n.type===2?n.declTNode:n.type===1?e[tr]:null}function Gg(e,n,t){if(t&4){let o=n,i=e;for(;o=o.parent,o===null&&!(t&1);)if(o=zO(i),o===null||(i=i[Qi],o.type&10))break;if(o===null)return!1;n=o,e=i}let r=rt.lFrame=Hx();return r.currentTNode=n,r.lView=e,!0}function Ud(e){let n=Hx(),t=e[Ke];rt.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function Hx(){let e=rt.lFrame,n=e===null?null:e.child;return n===null?$x(e):n}function $x(e){let n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return e!==null&&(e.child=n),n}function Gx(){let e=rt.lFrame;return rt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var qg=Gx;function Wd(){let e=Gx();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function qx(e){return(rt.lFrame.contextLView=Sx(e,rt.lFrame.contextLView))[Nn]}function yo(){return rt.lFrame.selectedIndex}function yi(e){rt.lFrame.selectedIndex=e}function zd(){let e=rt.lFrame;return yc(e.tView,e.selectedIndex)}function Mi(){rt.lFrame.currentNamespace=Sg}function wi(){HO()}function HO(){rt.lFrame.currentNamespace=null}function Xx(){return rt.lFrame.currentNamespace}var Yx=!0;function Hd(){return Yx}function $d(e){Yx=e}function ng(e,n=null,t=null,r){let o=Xg(e,n,t,r);return o.resolveInjectorInitializers(),o}function Xg(e,n=null,t=null,r,o=new Set){let i=[t||er,yx(e)];return r=r||(typeof e=="object"?void 0:Uo(e)),new Ki(i,n||hc(),r||null,o)}var Hn=class e{static THROW_IF_NOT_FOUND=qi;static NULL=new dc;static create(n,t){if(Array.isArray(n))return ng({name:""},t,n,"");{let r=n.name??"";return ng({name:r},n.parent,n.providers,r)}}static \u0275prov=we({token:e,providedIn:"any",factory:()=>Le(Cg)});static __NG_ELEMENT_ID__=-1},Yt=new Me(""),br=(()=>{class e{static __NG_ELEMENT_ID__=$O;static __NG_ENV_ID__=t=>t}return e})(),rg=class extends br{_lView;constructor(n){super(),this._lView=n}get destroyed(){return ra(this._lView)}onDestroy(n){let t=this._lView;return Fg(t,n),()=>Dx(t,n)}};function $O(){return new rg(it())}var Kx=!1,Zx=new Me(""),$o=(()=>{class e{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Pn(!1);debugTaskTracker=K(Zx,{optional:!0});get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new lt(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),this.debugTaskTracker?.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.debugTaskTracker?.remove(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=we({token:e,providedIn:"root",factory:()=>new e})}return e})(),og=class extends fn{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(n=!1){super(),this.__isAsync=n,Eg()&&(this.destroyRef=K(br,{optional:!0})??void 0,this.pendingTasks=K($o,{optional:!0})??void 0)}emit(n){let t=Qe(null);try{super.next(n)}finally{Qe(t)}}subscribe(n,t,r){let o=n,i=t||(()=>null),a=r;if(n&&typeof n=="object"){let u=n;o=u.next?.bind(u),i=u.error?.bind(u),a=u.complete?.bind(u)}this.__isAsync&&(i=this.wrapInTimeout(i),o&&(o=this.wrapInTimeout(o)),a&&(a=this.wrapInTimeout(a)));let l=super.subscribe({next:o,error:i,complete:a});return n instanceof Tn&&n.add(l),l}wrapInTimeout(n){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{n(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},$t=og;function Pd(...e){}function Yg(e){let n,t;function r(){e=Pd;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),n!==void 0&&clearTimeout(n)}catch{}}return n=setTimeout(()=>{e(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{e(),r()})),()=>r()}function Qx(e){return queueMicrotask(()=>e()),()=>{e=Pd}}var Kg="isAngularZone",uc=Kg+"_ID",GO=0,_n=class e{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new $t(!1);onMicrotaskEmpty=new $t(!1);onStable=new $t(!1);onError=new $t(!1);constructor(n){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:o=!1,scheduleInRootZone:i=Kx}=n;if(typeof Zone>"u")throw new ge(908,!1);Zone.assertZonePatched();let a=this;a._nesting=0,a._outer=a._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(a._inner=a._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(a._inner=a._inner.fork(Zone.longStackTraceZoneSpec)),a.shouldCoalesceEventChangeDetection=!o&&r,a.shouldCoalesceRunChangeDetection=o,a.callbackScheduled=!1,a.scheduleInRootZone=i,YO(a)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Kg)===!0}static assertInAngularZone(){if(!e.isInAngularZone())throw new ge(909,!1)}static assertNotInAngularZone(){if(e.isInAngularZone())throw new ge(909,!1)}run(n,t,r){return this._inner.run(n,t,r)}runTask(n,t,r,o){let i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+o,n,qO,Pd,Pd);try{return i.runTask(a,t,r)}finally{i.cancelTask(a)}}runGuarded(n,t,r){return this._inner.runGuarded(n,t,r)}runOutsideAngular(n){return this._outer.run(n)}},qO={};function Zg(e){if(e._nesting==0&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function XO(e){if(e.isCheckStableRunning||e.callbackScheduled)return;e.callbackScheduled=!0;function n(){Yg(()=>{e.callbackScheduled=!1,ig(e),e.isCheckStableRunning=!0,Zg(e),e.isCheckStableRunning=!1})}e.scheduleInRootZone?Zone.root.run(()=>{n()}):e._outer.run(()=>{n()}),ig(e)}function YO(e){let n=()=>{XO(e)},t=GO++;e._inner=e._inner.fork({name:"angular",properties:{[Kg]:!0,[uc]:t,[uc+t]:!0},onInvokeTask:(r,o,i,a,l,u)=>{if(KO(u))return r.invokeTask(i,a,l,u);try{return px(e),r.invokeTask(i,a,l,u)}finally{(e.shouldCoalesceEventChangeDetection&&a.type==="eventTask"||e.shouldCoalesceRunChangeDetection)&&n(),gx(e)}},onInvoke:(r,o,i,a,l,u,p)=>{try{return px(e),r.invoke(i,a,l,u,p)}finally{e.shouldCoalesceRunChangeDetection&&!e.callbackScheduled&&!ZO(u)&&n(),gx(e)}},onHasTask:(r,o,i,a)=>{r.hasTask(i,a),o===i&&(a.change=="microTask"?(e._hasPendingMicrotasks=a.microTask,ig(e),Zg(e)):a.change=="macroTask"&&(e.hasPendingMacrotasks=a.macroTask))},onHandleError:(r,o,i,a)=>(r.handleError(i,a),e.runOutsideAngular(()=>e.onError.emit(a)),!1)})}function ig(e){e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&e.callbackScheduled===!0?e.hasPendingMicrotasks=!0:e.hasPendingMicrotasks=!1}function px(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function gx(e){e._nesting--,Zg(e)}var fc=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new $t;onMicrotaskEmpty=new $t;onStable=new $t;onError=new $t;run(n,t,r){return n.apply(t,r)}runGuarded(n,t,r){return n.apply(t,r)}runOutsideAngular(n){return n()}runTask(n,t,r,o){return n.apply(t,r)}};function KO(e){return Jx(e,"__ignore_ng_zone__")}function ZO(e){return Jx(e,"__scheduler_tick__")}function Jx(e,n){return!Array.isArray(e)||e.length!==1?!1:e[0]?.data?.[n]===!0}var xo=class{_console=console;handleError(n){this._console.error("ERROR",n)}},Fr=new Me("",{factory:()=>{let e=K(_n),n=K(Gt),t;return r=>{e.runOutsideAngular(()=>{n.destroyed&&!t?setTimeout(()=>{throw r}):(t??=n.get(xo),t.handleError(r))})}}}),e_={provide:Ya,useValue:()=>{let e=K(xo,{optional:!0})},multi:!0};function Rt(e,n){let[t,r,o]=F0(e,n?.equal),i=t,a=i[Qn];return i.set=r,i.update=o,i.asReadonly=t_.bind(i),i}function t_(){let e=this[Qn];if(e.readonlyFn===void 0){let n=()=>this();n[Qn]=e,e.readonlyFn=n}return e.readonlyFn}var Gd=(()=>{class e{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=QO}return e})();function QO(){return new Gd(it(),rr())}var mi=class{},Ec=new Me("",{factory:()=>!0});var Qg=new Me(""),Oc=(()=>{class e{internalPendingTasks=K($o);scheduler=K(mi);errorHandler=K(Fr);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let r=this.add();t().catch(this.errorHandler).finally(r)}static \u0275prov=we({token:e,providedIn:"root",factory:()=>new e})}return e})(),Jg=(()=>{class e{static \u0275prov=we({token:e,providedIn:"root",factory:()=>new ag})}return e})(),ag=class{dirtyEffectCount=0;queues=new Map;add(n){this.enqueue(n),this.schedule(n)}schedule(n){n.dirty&&this.dirtyEffectCount++}remove(n){let t=n.zone,r=this.queues.get(t);r.has(n)&&(r.delete(n),n.dirty&&this.dirtyEffectCount--)}enqueue(n){let t=n.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(n)||r.add(n)}flush(){for(;this.dirtyEffectCount>0;){let n=!1;for(let[t,r]of this.queues)t===null?n||=this.flushQueue(r):n||=t.run(()=>this.flushQueue(r));n||(this.dirtyEffectCount=0)}}flushQueue(n){let t=!1;for(let r of n)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}},sg=class{[Qn];constructor(n){this[Qn]=n}destroy(){this[Qn].destroy()}};function gn(e){return R0(e)}function Fc(e){return{toString:e}.toString()}function D_(e){let n=An.ng;if(n&&n.\u0275compilerFacade)return n.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function oT(e){return typeof e=="function"}function k_(e,n,t,r){n!==null?n.applyValueToInputSignal(n,r):e[t]=r}var Jd=class{previousValue;currentValue;firstChange;constructor(n,t,r){this.previousValue=n,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}},Go=(()=>{let e=()=>I_;return e.ngInherit=!0,e})();function I_(e){return e.type.prototype.ngOnChanges&&(e.setInput=aT),iT}function iT(){let e=N_(this),n=e?.current;if(n){let t=e.previous;if(t===hi)e.previous=n;else for(let r in n)t[r]=n[r];e.current=null,this.ngOnChanges(n)}}function aT(e,n,t,r,o){let i=this.declaredInputs[r],a=N_(e)||sT(e,{previous:hi,current:null}),l=a.current||(a.current={}),u=a.previous,p=u[i];l[i]=new Jd(p&&p.currentValue,t,u===hi),k_(e,n,o,t)}var A_="__ngSimpleChanges__";function N_(e){return e[A_]||null}function sT(e,n){return e[A_]=n}var n_=[];var At=function(e,n=null,t){for(let r=0;r<n_.length;r++){let o=n_[r];o(e,n,t)}},xt=(function(e){return e[e.TemplateCreateStart=0]="TemplateCreateStart",e[e.TemplateCreateEnd=1]="TemplateCreateEnd",e[e.TemplateUpdateStart=2]="TemplateUpdateStart",e[e.TemplateUpdateEnd=3]="TemplateUpdateEnd",e[e.LifecycleHookStart=4]="LifecycleHookStart",e[e.LifecycleHookEnd=5]="LifecycleHookEnd",e[e.OutputStart=6]="OutputStart",e[e.OutputEnd=7]="OutputEnd",e[e.BootstrapApplicationStart=8]="BootstrapApplicationStart",e[e.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",e[e.BootstrapComponentStart=10]="BootstrapComponentStart",e[e.BootstrapComponentEnd=11]="BootstrapComponentEnd",e[e.ChangeDetectionStart=12]="ChangeDetectionStart",e[e.ChangeDetectionEnd=13]="ChangeDetectionEnd",e[e.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",e[e.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",e[e.AfterRenderHooksStart=16]="AfterRenderHooksStart",e[e.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",e[e.ComponentStart=18]="ComponentStart",e[e.ComponentEnd=19]="ComponentEnd",e[e.DeferBlockStateStart=20]="DeferBlockStateStart",e[e.DeferBlockStateEnd=21]="DeferBlockStateEnd",e[e.DynamicComponentStart=22]="DynamicComponentStart",e[e.DynamicComponentEnd=23]="DynamicComponentEnd",e[e.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",e[e.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",e})(xt||{});function cT(e,n,t){let{ngOnChanges:r,ngOnInit:o,ngDoCheck:i}=n.type.prototype;if(r){let a=I_(n);(t.preOrderHooks??=[]).push(e,a),(t.preOrderCheckHooks??=[]).push(e,a)}o&&(t.preOrderHooks??=[]).push(0-e,o),i&&((t.preOrderHooks??=[]).push(e,i),(t.preOrderCheckHooks??=[]).push(e,i))}function F_(e,n){for(let t=n.directiveStart,r=n.directiveEnd;t<r;t++){let i=e.data[t].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:l,ngAfterViewInit:u,ngAfterViewChecked:p,ngOnDestroy:g}=i;a&&(e.contentHooks??=[]).push(-t,a),l&&((e.contentHooks??=[]).push(t,l),(e.contentCheckHooks??=[]).push(t,l)),u&&(e.viewHooks??=[]).push(-t,u),p&&((e.viewHooks??=[]).push(t,p),(e.viewCheckHooks??=[]).push(t,p)),g!=null&&(e.destroyHooks??=[]).push(t,g)}}function Kd(e,n,t){R_(e,n,3,t)}function Zd(e,n,t,r){(e[Ye]&3)===t&&R_(e,n,t,r)}function em(e,n){let t=e[Ye];(t&3)===n&&(t&=16383,t+=1,e[Ye]=t)}function R_(e,n,t,r){let o=r!==void 0?e[ea]&65535:0,i=r??-1,a=n.length-1,l=0;for(let u=o;u<a;u++)if(typeof n[u+1]=="number"){if(l=n[u],r!=null&&l>=r)break}else n[u]<0&&(e[ea]+=65536),(l<i||i==-1)&&(lT(e,t,n,u),e[ea]=(e[ea]&4294901760)+u+2),u++}function r_(e,n){At(xt.LifecycleHookStart,e,n);let t=Qe(null);try{n.call(e)}finally{Qe(t),At(xt.LifecycleHookEnd,e,n)}}function lT(e,n,t,r){let o=t[r]<0,i=t[r+1],a=o?-t[r]:t[r],l=e[a];o?e[Ye]>>14<e[ea]>>16&&(e[Ye]&3)===n&&(e[Ye]+=16384,r_(l,i)):r_(l,i)}var is=-1,ia=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(n,t,r,o){this.factory=n,this.name=o,this.canSeeViewProviders=t,this.injectImpl=r}};function dT(e){return(e.flags&8)!==0}function uT(e){return(e.flags&16)!==0}function fT(e,n,t){let r=0;for(;r<t.length;){let o=t[r];if(typeof o=="number"){if(o!==0)break;r++;let i=t[r++],a=t[r++],l=t[r++];e.setAttribute(n,a,l,i)}else{let i=o,a=t[++r];pT(i)?e.setProperty(n,i,a):e.setAttribute(n,i,a),r++}}return r}function L_(e){return e===3||e===4||e===6}function pT(e){return e.charCodeAt(0)===64}function Dc(e,n){if(!(n===null||n.length===0))if(e===null||e.length===0)e=n.slice();else{let t=-1;for(let r=0;r<n.length;r++){let o=n[r];typeof o=="number"?t=o:t===0||(t===-1||t===2?o_(e,t,o,null,n[++r]):o_(e,t,o,null,null))}}return e}function o_(e,n,t,r,o){let i=0,a=e.length;if(n===-1)a=-1;else for(;i<e.length;){let l=e[i++];if(typeof l=="number"){if(l===n){a=-1;break}else if(l>n){a=i-1;break}}}for(;i<e.length;){let l=e[i];if(typeof l=="number")break;if(l===t){o!==null&&(e[i+1]=o);return}i++,o!==null&&i++}a!==-1&&(e.splice(a,0,n),i=a+1),e.splice(i++,0,t),o!==null&&e.splice(i++,0,o)}function B_(e){return e!==is}function eu(e){return e&32767}function gT(e){return e>>16}function tu(e,n){let t=gT(e),r=n;for(;t>0;)r=r[Qi],t--;return r}var um=!0;function nu(e){let n=um;return um=e,n}var mT=256,V_=mT-1,j_=5,hT=0,Mo={};function vT(e,n,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Zi)&&(r=t[Zi]),r==null&&(r=t[Zi]=hT++);let o=r&V_,i=1<<o;n.data[e+(o>>j_)]|=i}function ru(e,n){let t=U_(e,n);if(t!==-1)return t;let r=n[Ke];r.firstCreatePass&&(e.injectorIndex=n.length,tm(r.data,e),tm(n,null),tm(r.blueprint,null));let o=Pm(e,n),i=e.injectorIndex;if(B_(o)){let a=eu(o),l=tu(o,n),u=l[Ke].data;for(let p=0;p<8;p++)n[i+p]=l[a+p]|u[a+p]}return n[i+8]=o,i}function tm(e,n){e.push(0,0,0,0,0,0,0,0,n)}function U_(e,n){return e.injectorIndex===-1||e.parent&&e.parent.injectorIndex===e.injectorIndex||n[e.injectorIndex+8]===null?-1:e.injectorIndex}function Pm(e,n){if(e.parent&&e.parent.injectorIndex!==-1)return e.parent.injectorIndex;let t=0,r=null,o=n;for(;o!==null;){if(r=G_(o),r===null)return is;if(t++,o=o[Qi],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return is}function fm(e,n,t){vT(e,n,t)}function xT(e,n){if(n==="class")return e.classes;if(n==="style")return e.styles;let t=e.attrs;if(t){let r=t.length,o=0;for(;o<r;){let i=t[o];if(L_(i))break;if(i===0)o=o+2;else if(typeof i=="number")for(o++;o<r&&typeof t[o]=="string";)o++;else{if(i===n)return t[o+1];o=o+2}}}return null}function W_(e,n,t){if(t&8||e!==void 0)return e;Ad(n,"NodeInjector")}function z_(e,n,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let o=e[vi],i=Jn(void 0);try{return o?o.get(n,r,t&8):xg(n,r,t&8)}finally{Jn(i)}}return W_(r,n,t)}function H_(e,n,t,r=0,o){if(e!==null){if(n[Ye]&2048&&!(r&2)){let a=MT(e,n,t,r,Mo);if(a!==Mo)return a}let i=$_(e,n,t,r,Mo);if(i!==Mo)return i}return z_(n,t,r,o)}function $_(e,n,t,r,o){let i=bT(t);if(typeof i=="function"){if(!Gg(n,e,r))return r&1?W_(o,t,r):z_(n,t,r,o);try{let a;if(a=i(r),a==null&&!(r&8))Ad(t);else return a}finally{qg()}}else if(typeof i=="number"){let a=null,l=U_(e,n),u=is,p=r&1?n[ur][tr]:null;for((l===-1||r&4)&&(u=l===-1?Pm(e,n):n[l+8],u===is||!a_(r,!1)?l=-1:(a=n[Ke],l=eu(u),n=tu(u,n)));l!==-1;){let g=n[Ke];if(i_(i,l,g.data)){let m=_T(l,n,t,a,r,p);if(m!==Mo)return m}u=n[l+8],u!==is&&a_(r,n[Ke].data[l+8]===p)&&i_(i,l,n)?(a=g,l=eu(u),n=tu(u,n)):l=-1}}return o}function _T(e,n,t,r,o,i){let a=n[Ke],l=a.data[e+8],u=r==null?Ci(l)&&um:r!=a&&(l.type&3)!==0,p=o&1&&i===l,g=CT(l,a,t,u,p);return g!==null?ou(n,a,g,l,o):Mo}function CT(e,n,t,r,o){let i=e.providerIndexes,a=n.data,l=i&1048575,u=e.directiveStart,p=e.directiveEnd,g=i>>20,m=r?l:l+g,v=o?l+g:p;for(let h=m;h<v;h++){let b=a[h];if(h<u&&t===b||h>=u&&b.type===t)return h}if(o){let h=a[u];if(h&&bo(h)&&h.type===t)return u}return null}function ou(e,n,t,r,o){let i=e[t],a=n.data;if(i instanceof ia){let l=i;if(l.resolving)throw vg("");let u=nu(l.canSeeViewProviders);l.resolving=!0;let p=a[t].type||a[t],g,m=l.injectImpl?Jn(l.injectImpl):null,v=Gg(e,r,0);try{i=e[t]=l.factory(void 0,o,a,e,r),n.firstCreatePass&&t>=r.directiveStart&&cT(t,a[t],n)}finally{m!==null&&Jn(m),nu(u),l.resolving=!1,qg()}}return i}function bT(e){if(typeof e=="string")return e.charCodeAt(0)||0;let n=e.hasOwnProperty(Zi)?e[Zi]:void 0;return typeof n=="number"?n>=0?n&V_:yT:n}function i_(e,n,t){let r=1<<e;return!!(t[n+(e>>j_)]&r)}function a_(e,n){return!(e&2)&&!(e&1&&n)}var oa=class{_tNode;_lView;constructor(n,t){this._tNode=n,this._lView=t}get(n,t,r){return H_(this._tNode,this._lView,n,Xi(r),t)}};function yT(){return new oa(rr(),it())}function no(e){return Fc(()=>{let n=e.prototype.constructor,t=n[lc]||pm(n),r=Object.prototype,o=Object.getPrototypeOf(e.prototype).constructor;for(;o&&o!==r;){let i=o[lc]||pm(o);if(i&&i!==t)return i;o=Object.getPrototypeOf(o)}return i=>new i})}function pm(e){return cg(e)?()=>{let n=pm(kn(e));return n&&n()}:pi(e)}function MT(e,n,t,r,o){let i=e,a=n;for(;i!==null&&a!==null&&a[Ye]&2048&&!es(a);){let l=$_(i,a,t,r|2,Mo);if(l!==Mo)return l;let u=i.parent;if(!u){let p=a[Tg];if(p){let g=p.get(t,Mo,r);if(g!==Mo)return g}u=G_(a),a=a[Qi]}i=u}return o}function G_(e){let n=e[Ke],t=n.type;return t===2?n.declTNode:t===1?e[tr]:null}function Rc(e){return xT(rr(),e)}function wT(){return mu(rr(),it())}function mu(e,n){return new Rr(Zr(e,n))}var Rr=(()=>{class e{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=wT}return e})();function q_(e){return(e.flags&128)===128}var Sm=(function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e})(Sm||{}),X_=new Map,ET=0;function OT(){return ET++}function TT(e){X_.set(e[xi],e)}function gm(e){X_.delete(e[xi])}var s_="__ngContext__";function as(e,n){Co(n)?(e[s_]=n[xi],TT(n)):e[s_]=n}function Y_(e){return Z_(e[Ja])}function K_(e){return Z_(e[Ir])}function Z_(e){for(;e!==null&&!Kr(e);)e=e[Ir];return e}var PT;function Dm(e){PT=e}var hu=new Me("",{factory:()=>ST}),ST="ng";var vu=new Me(""),Lc=new Me("",{providedIn:"platform",factory:()=>"unknown"});var xu=new Me("",{factory:()=>K(Yt).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Q_=!1,J_=new Me("",{factory:()=>Q_});var km=new Me("");var DT=(e,n,t,r)=>{};function kT(e,n,t,r){DT(e,n,t,r)}function _u(e){return(e.flags&32)===32}var IT=()=>null;function eC(e,n,t=!1){return IT(e,n,t)}function tC(e,n){let t=e.contentQueries;if(t!==null){let r=Qe(null);try{for(let o=0;o<t.length;o+=2){let i=t[o],a=t[o+1];if(a!==-1){let l=e.data[a];$g(i),l.contentQueries(2,n[a],a)}}}finally{Qe(r)}}}function mm(e,n,t){$g(0);let r=Qe(null);try{n(e,t)}finally{Qe(r)}}function nC(e,n,t){if(Pg(n)){let r=Qe(null);try{let o=n.directiveStart,i=n.directiveEnd;for(let a=o;a<i;a++){let l=e.data[a];if(l.contentQueries){let u=t[a];l.contentQueries(1,u,a)}}}finally{Qe(r)}}}var eo=(function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e[e.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",e})(eo||{});var qd;function AT(){if(qd===void 0&&(qd=null,An.trustedTypes))try{qd=An.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return qd}function c_(e){return AT()?.createScriptURL(e)||e}var iu=class{changingThisBreaksApplicationSecurity;constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Sd})`}};function ls(e){return e instanceof iu?e.changingThisBreaksApplicationSecurity:e}function Im(e,n){let t=rC(e);if(t!=null&&t!==n){if(t==="ResourceURL"&&n==="URL")return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${Sd})`)}return t===n}function rC(e){return e instanceof iu&&e.getTypeName()||null}var NT=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function oC(e){return e=String(e),e.match(NT)?e:"unsafe:"+e}function FT(e,n){return e.createText(n)}function RT(e,n,t){e.setValue(n,t)}function iC(e,n,t){return e.createElement(n,t)}function au(e,n,t,r,o){e.insertBefore(n,t,r,o)}function aC(e,n,t){e.appendChild(n,t)}function l_(e,n,t,r,o){r!==null?au(e,n,t,r,o):aC(e,n,t)}function LT(e,n,t,r){e.removeChild(null,n,t,r)}function BT(e,n,t){e.setAttribute(n,"style",t)}function VT(e,n,t){t===""?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function sC(e,n,t){let{mergedAttrs:r,classes:o,styles:i}=t;r!==null&&fT(e,n,r),o!==null&&VT(e,n,o),i!==null&&BT(e,n,i)}var Cu=(function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e})(Cu||{});function cC(e){let n=dC();return n?n.sanitize(Cu.URL,e)||"":Im(e,"URL")?ls(e):oC(Ho(e))}function lC(e){let n=dC();if(n)return c_(n.sanitize(Cu.RESOURCE_URL,e)||"");if(Im(e,"ResourceURL"))return c_(ls(e));throw new ge(904,!1)}var jT=new Set(["embed","frame","iframe","media","script"]),UT=new Set(["base","link","script"]);function WT(e,n){return n==="src"&&jT.has(e)||n==="href"&&UT.has(e)||n==="xlink:href"&&e==="script"?lC:cC}function Am(e,n,t){return WT(n,t)(e)}function dC(){let e=it();return e&&e[_o].sanitizer}function uC(e){return e instanceof Function?e():e}function zT(e,n,t){let r=e.length;for(;;){let o=e.indexOf(n,t);if(o===-1)return o;if(o===0||e.charCodeAt(o-1)<=32){let i=n.length;if(o+i===r||e.charCodeAt(o+i)<=32)return o}t=o+1}}var fC="ng-template";function HT(e,n,t,r){let o=0;if(r){for(;o<n.length&&typeof n[o]=="string";o+=2)if(n[o]==="class"&&zT(n[o+1].toLowerCase(),t,0)!==-1)return!0}else if(Nm(e))return!1;if(o=n.indexOf(1,o),o>-1){let i;for(;++o<n.length&&typeof(i=n[o])=="string";)if(i.toLowerCase()===t)return!0}return!1}function Nm(e){return e.type===4&&e.value!==fC}function $T(e,n,t){let r=e.type===4&&!t?fC:e.value;return n===r}function GT(e,n,t){let r=4,o=e.attrs,i=o!==null?YT(o):0,a=!1;for(let l=0;l<n.length;l++){let u=n[l];if(typeof u=="number"){if(!a&&!Qr(r)&&!Qr(u))return!1;if(a&&Qr(u))continue;a=!1,r=u|r&1;continue}if(!a)if(r&4){if(r=2|r&1,u!==""&&!$T(e,u,t)||u===""&&n.length===1){if(Qr(r))return!1;a=!0}}else if(r&8){if(o===null||!HT(e,o,u,t)){if(Qr(r))return!1;a=!0}}else{let p=n[++l],g=qT(u,o,Nm(e),t);if(g===-1){if(Qr(r))return!1;a=!0;continue}if(p!==""){let m;if(g>i?m="":m=o[g+1].toLowerCase(),r&2&&p!==m){if(Qr(r))return!1;a=!0}}}}return Qr(r)||a}function Qr(e){return(e&1)===0}function qT(e,n,t,r){if(n===null)return-1;let o=0;if(r||!t){let i=!1;for(;o<n.length;){let a=n[o];if(a===e)return o;if(a===3||a===6)i=!0;else if(a===1||a===2){let l=n[++o];for(;typeof l=="string";)l=n[++o];continue}else{if(a===4)break;if(a===0){o+=4;continue}}o+=i?1:2}return-1}else return KT(n,e)}function pC(e,n,t=!1){for(let r=0;r<n.length;r++)if(GT(e,n[r],t))return!0;return!1}function XT(e){let n=e.attrs;if(n!=null){let t=n.indexOf(5);if((t&1)===0)return n[t+1]}return null}function YT(e){for(let n=0;n<e.length;n++){let t=e[n];if(L_(t))return n}return e.length}function KT(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){let r=e[t];if(typeof r=="number")return-1;if(r===n)return t;t++}return-1}function ZT(e,n){e:for(let t=0;t<n.length;t++){let r=n[t];if(e.length===r.length){for(let o=0;o<e.length;o++)if(e[o]!==r[o])continue e;return!0}}return!1}function d_(e,n){return e?":not("+n.trim()+")":n}function QT(e){let n=e[0],t=1,r=2,o="",i=!1;for(;t<e.length;){let a=e[t];if(typeof a=="string")if(r&2){let l=e[++t];o+="["+a+(l.length>0?'="'+l+'"':"")+"]"}else r&8?o+="."+a:r&4&&(o+=" "+a);else o!==""&&!Qr(a)&&(n+=d_(i,o),o=""),r=a,i=i||!Qr(r);t++}return o!==""&&(n+=d_(i,o)),n}function JT(e){return e.map(QT).join(",")}function eP(e){let n=[],t=[],r=1,o=2;for(;r<e.length;){let i=e[r];if(typeof i=="string")o===2?i!==""&&n.push(i,e[++r]):o===8&&t.push(i);else{if(!Qr(o))break;o=i}r++}return t.length&&n.push(1,...t),n}var $n={};function Fm(e,n,t,r,o,i,a,l,u,p,g){let m=tn+r,v=m+o,h=tP(m,v),b=typeof p=="function"?p():p;return h[Ke]={type:e,blueprint:h,template:t,queries:null,viewQuery:l,declTNode:n,data:h.slice().fill(null,m),bindingStartIndex:m,expandoStartIndex:v,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof i=="function"?i():i,pipeRegistry:typeof a=="function"?a():a,firstChild:null,schemas:u,consts:b,incompleteFirstPass:!1,ssrId:g}}function tP(e,n){let t=[];for(let r=0;r<n;r++)t.push(r<e?null:$n);return t}function nP(e){let n=e.tView;return n===null||n.incompleteFirstPass?e.tView=Fm(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):n}function Rm(e,n,t,r,o,i,a,l,u,p,g){let m=n.blueprint.slice();return m[Yr]=o,m[Ye]=r|4|128|8|64|1024,(p!==null||e&&e[Ye]&2048)&&(m[Ye]|=2048),Ag(m),m[In]=m[Qi]=e,m[Nn]=t,m[_o]=a||e&&e[_o],m[qt]=l||e&&e[qt],m[vi]=u||e&&e[vi]||null,m[tr]=i,m[xi]=OT(),m[Za]=g,m[Tg]=p,m[ur]=n.type==2?e[ur]:m,m}function rP(e,n,t){let r=Zr(n,e),o=nP(t),i=e[_o].rendererFactory,a=Lm(e,Rm(e,o,null,gC(t),r,n,null,i.createRenderer(r,t),null,null,null));return e[n.index]=a}function gC(e){let n=16;return e.signals?n=4096:e.onPush&&(n=64),n}function mC(e,n,t,r){if(t===0)return-1;let o=n.length;for(let i=0;i<t;i++)n.push(r),e.blueprint.push(r),e.data.push(null);return o}function Lm(e,n){return e[Ja]?e[Og][Ir]=n:e[Ja]=n,e[Og]=n,n}function f(e=1){hC(Cn(),it(),yo()+e,!1)}function hC(e,n,t,r){if(!r)if((n[Ye]&3)===3){let i=e.preOrderCheckHooks;i!==null&&Kd(n,i,t)}else{let i=e.preOrderHooks;i!==null&&Zd(n,i,0,t)}yi(t)}var bu=(function(e){return e[e.None=0]="None",e[e.SignalBased=1]="SignalBased",e[e.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",e})(bu||{});function hm(e,n,t,r){let o=Qe(null);try{let[i,a,l]=e.inputs[t],u=null;(a&bu.SignalBased)!==0&&(u=n[i][Qn]),u!==null&&u.transformFn!==void 0?r=u.transformFn(r):l!==null&&(r=l.call(n,r)),e.setInput!==null?e.setInput(n,u,r,t,i):k_(n,u,i,r)}finally{Qe(o)}}var wo=(function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e})(wo||{}),oP;function Bm(e,n){return oP(e,n)}var ss=new Set,yu=(function(e){return e[e.CHANGE_DETECTION=0]="CHANGE_DETECTION",e[e.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",e})(yu||{}),qo=new Me(""),u_=new Set;function Xo(e){u_.has(e)||(u_.add(e),performance?.mark?.("mark_feature_usage",{detail:{feature:e}}))}var Vm=(()=>{class e{impl=null;execute(){this.impl?.execute()}static \u0275prov=we({token:e,providedIn:"root",factory:()=>new e})}return e})(),vC=[0,1,2,3],xC=(()=>{class e{ngZone=K(_n);scheduler=K(mi);errorHandler=K(xo,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){K(qo,{optional:!0})}execute(){let t=this.sequences.size>0;t&&At(xt.AfterRenderHooksStart),this.executing=!0;for(let r of vC)for(let o of this.sequences)if(!(o.erroredOrDestroyed||!o.hooks[r]))try{o.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let i=o.hooks[r];return i(o.pipelinedValue)},o.snapshot))}catch(i){o.erroredOrDestroyed=!0,this.errorHandler?.handleError(i)}this.executing=!1;for(let r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(let r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&At(xt.AfterRenderHooksEnd)}register(t){let{view:r}=t;r!==void 0?((r[na]??=[]).push(t),ts(r),r[Ye]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,r){return r?r.run(yu.AFTER_NEXT_RENDER,t):t()}static \u0275prov=we({token:e,providedIn:"root",factory:()=>new e})}return e})(),su=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(n,t,r,o,i,a=null){this.impl=n,this.hooks=t,this.view=r,this.once=o,this.snapshot=a,this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let n=this.view?.[na];n&&(this.view[na]=n.filter(t=>t!==this))}};function ds(e,n){let t=n?.injector??K(Hn);return Xo("NgAfterNextRender"),aP(e,t,n,!0)}function iP(e){return e instanceof Function?[void 0,void 0,e,void 0]:[e.earlyRead,e.write,e.mixedReadWrite,e.read]}function aP(e,n,t,r){let o=n.get(Vm);o.impl??=n.get(xC);let i=n.get(qo,null,{optional:!0}),a=t?.manualCleanup!==!0?n.get(br):null,l=n.get(Gd,null,{optional:!0}),u=new su(o.impl,iP(e),l?.view,r,a,i?.snapshot(null));return o.impl.register(u),u}var _C=new Me("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:K(Gt)})});function CC(e,n,t){let r=e.get(_C);if(Array.isArray(n))for(let o of n)r.queue.add(o),t?.detachedLeaveAnimationFns?.push(o);else r.queue.add(n),t?.detachedLeaveAnimationFns?.push(n);r.scheduler&&r.scheduler(e)}function sP(e,n){for(let[t,r]of n)CC(e,r.animateFns)}function cP(e,n){let t=e.get(_C);if(Array.isArray(n))for(let r of n)t.queue.delete(r);else t.queue.delete(n)}function f_(e,n,t,r){let o=e?.[xc]?.enter;n!==null&&o&&o.has(t.index)&&sP(r,o)}function os(e,n,t,r,o,i,a,l){if(o!=null){let u,p=!1;Kr(o)?u=o:Co(o)&&(p=!0,o=o[Yr]);let g=Ar(o);e===0&&r!==null?(f_(l,r,i,t),a==null?aC(n,r,g):au(n,r,g,a||null,!0)):e===1&&r!==null?(f_(l,r,i,t),au(n,r,g,a||null,!0)):e===2?p_(l,i,t,m=>{LT(n,g,p,m)}):e===3&&p_(l,i,t,()=>{n.destroyNode(g)}),u!=null&&_P(n,e,t,u,i,r,a)}}function lP(e,n){bC(e,n),n[Yr]=null,n[tr]=null}function dP(e,n,t,r,o,i){r[Yr]=o,r[tr]=n,Mu(e,r,t,1,o,i)}function bC(e,n){n[_o].changeDetectionScheduler?.notify(9),Mu(e,n,n[qt],2,null,null)}function uP(e){let n=e[Ja];if(!n)return nm(e[Ke],e);for(;n;){let t=null;if(Co(n))t=n[Ja];else{let r=n[nr];r&&(t=r)}if(!t){for(;n&&!n[Ir]&&n!==e;)Co(n)&&nm(n[Ke],n),n=n[In];n===null&&(n=e),Co(n)&&nm(n[Ke],n),t=n&&n[Ir]}n=t}}function jm(e,n){let t=e[Cc],r=t.indexOf(n);t.splice(r,1)}function Um(e,n){if(ra(n))return;let t=n[qt];t.destroyNode&&Mu(e,n,t,3,null,null),uP(n)}function nm(e,n){if(ra(n))return;let t=Qe(null);try{n[Ye]&=-129,n[Ye]|=256,n[Cr]&&nc(n[Cr]),gP(e,n),pP(e,n),n[Ke].type===1&&n[qt].destroy();let r=n[Ji];if(r!==null&&Kr(n[In])){r!==n[In]&&jm(r,n);let o=n[ta];o!==null&&o.detachView(e)}gm(n)}finally{Qe(t)}}function p_(e,n,t,r){let o=e?.[xc];if(o?.enter?.has(n.index)&&cP(t,o.enter.get(n.index).animateFns),o==null||o.leave==null||!o.leave.has(n.index))return r(!1);e&&ss.add(e[xi]),CC(t,()=>{if(o.leave&&o.leave.has(n.index)){let a=o.leave.get(n.index),l=[];if(a){for(let u=0;u<a.animateFns.length;u++){let p=a.animateFns[u],{promise:g}=p();l.push(g)}o.detachedLeaveAnimationFns=void 0}o.running=Promise.allSettled(l),fP(e,r)}else e&&ss.delete(e[xi]),r(!1)},o)}function fP(e,n){let t=e[xc]?.running;if(t){t.then(()=>{e[xc].running=void 0,ss.delete(e[xi]),n(!0)});return}n(!1)}function pP(e,n){let t=e.cleanup,r=n[Qa];if(t!==null)for(let a=0;a<t.length-1;a+=2)if(typeof t[a]=="string"){let l=t[a+3];l>=0?r[l]():r[-l].unsubscribe(),a+=2}else{let l=r[t[a+1]];t[a].call(l)}r!==null&&(n[Qa]=null);let o=n[jo];if(o!==null){n[jo]=null;for(let a=0;a<o.length;a++){let l=o[a];l()}}let i=n[vc];if(i!==null){n[vc]=null;for(let a of i)a.destroy()}}function gP(e,n){let t;if(e!=null&&(t=e.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let o=n[t[r]];if(!(o instanceof ia)){let i=t[r+1];if(Array.isArray(i))for(let a=0;a<i.length;a+=2){let l=o[i[a]],u=i[a+1];At(xt.LifecycleHookStart,l,u);try{u.call(l)}finally{At(xt.LifecycleHookEnd,l,u)}}else{At(xt.LifecycleHookStart,o,i);try{i.call(o)}finally{At(xt.LifecycleHookEnd,o,i)}}}}}function yC(e,n,t){return mP(e,n.parent,t)}function mP(e,n,t){let r=n;for(;r!==null&&r.type&168;)n=r,r=n.parent;if(r===null)return t[Yr];if(Ci(r)){let{encapsulation:o}=e.data[r.directiveStart+r.componentOffset];if(o===eo.None||o===eo.Emulated)return null}return Zr(r,t)}function MC(e,n,t){return vP(e,n,t)}function hP(e,n,t){return e.type&40?Zr(e,t):null}var vP=hP,g_;function Wm(e,n,t,r){let o=yC(e,r,n),i=n[qt],a=r.parent||n[tr],l=MC(a,r,n);if(o!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)l_(i,o,t[u],l,!1);else l_(i,o,t,l,!1);g_!==void 0&&g_(i,r,n,t,o)}function Pc(e,n){if(n!==null){let t=n.type;if(t&3)return Zr(n,e);if(t&4)return vm(-1,e[n.index]);if(t&8){let r=n.child;if(r!==null)return Pc(e,r);{let o=e[n.index];return Kr(o)?vm(-1,o):Ar(o)}}else{if(t&128)return Pc(e,n.next);if(t&32)return Bm(n,e)()||Ar(e[n.index]);{let r=wC(e,n);if(r!==null){if(Array.isArray(r))return r[0];let o=gi(e[ur]);return Pc(o,r)}else return Pc(e,n.next)}}}return null}function wC(e,n){if(n!==null){let r=e[ur][tr],o=n.projection;return r.projection[o]}return null}function vm(e,n){let t=nr+e+1;if(t<n.length){let r=n[t],o=r[Ke].firstChild;if(o!==null)return Pc(r,o)}return n[_i]}function zm(e,n,t,r,o,i,a){for(;t!=null;){let l=r[vi];if(t.type===128){t=t.next;continue}let u=r[t.index],p=t.type;if(a&&n===0&&(u&&as(Ar(u),r),t.flags|=2),!_u(t))if(p&8)zm(e,n,t.child,r,o,i,!1),os(n,e,l,o,u,t,i,r);else if(p&32){let g=Bm(t,r),m;for(;m=g();)os(n,e,l,o,m,t,i,r);os(n,e,l,o,u,t,i,r)}else p&16?EC(e,n,r,t,o,i):os(n,e,l,o,u,t,i,r);t=a?t.projectionNext:t.next}}function Mu(e,n,t,r,o,i){zm(t,r,e.firstChild,n,o,i,!1)}function xP(e,n,t){let r=n[qt],o=yC(e,t,n),i=t.parent||n[tr],a=MC(i,t,n);EC(r,0,n,t,o,a)}function EC(e,n,t,r,o,i){let a=t[ur],u=a[tr].projection[r.projection];if(Array.isArray(u))for(let p=0;p<u.length;p++){let g=u[p];os(n,e,t[vi],o,g,r,i,t)}else{let p=u,g=a[In];q_(r)&&(p.flags|=128),zm(e,n,p,g,o,i,!0)}}function _P(e,n,t,r,o,i,a){let l=r[_i],u=Ar(r);l!==u&&os(n,e,t,i,l,o,a);for(let p=nr;p<r.length;p++){let g=r[p];Mu(g[Ke],g,e,n,i,l)}}function CP(e,n,t,r,o){if(n)o?e.addClass(t,r):e.removeClass(t,r);else{let i=r.indexOf("-")===-1?void 0:wo.DashCase;o==null?e.removeStyle(t,r,i):(typeof o=="string"&&o.endsWith("!important")&&(o=o.slice(0,-10),i|=wo.Important),e.setStyle(t,r,o,i))}}function OC(e,n,t,r,o){let i=yo(),a=r&2;try{yi(-1),a&&n.length>tn&&hC(e,n,tn,!1);let l=a?xt.TemplateUpdateStart:xt.TemplateCreateStart;At(l,o,t),t(r,o)}finally{yi(i);let l=a?xt.TemplateUpdateEnd:xt.TemplateCreateEnd;At(l,o,t)}}function Hm(e,n,t){TP(e,n,t),(t.flags&64)===64&&PP(e,n,t)}function $m(e,n,t=Zr){let r=n.localNames;if(r!==null){let o=n.index+1;for(let i=0;i<r.length;i+=2){let a=r[i+1],l=a===-1?t(n,e):e[a];e[o++]=l}}}function bP(e,n,t,r){let i=r.get(J_,Q_)||t===eo.ShadowDom||t===eo.ExperimentalIsolatedShadowDom,a=e.selectRootElement(n,i);return yP(a),a}function yP(e){MP(e)}var MP=()=>null;function wP(e){return e==="class"?"className":e==="for"?"htmlFor":e==="formaction"?"formAction":e==="innerHtml"?"innerHTML":e==="readonly"?"readOnly":e==="tabindex"?"tabIndex":e}function TC(e,n,t,r,o,i){let a=n[Ke];if(Gm(e,a,n,t,r)){Ci(e)&&OP(n,e.index);return}e.type&3&&(t=wP(t)),EP(e,n,t,r,o,i)}function EP(e,n,t,r,o,i){if(e.type&3){let a=Zr(e,n);r=i!=null?i(r,e.value||"",t):r,o.setProperty(a,t,r)}else e.type&12}function OP(e,n){let t=Nr(n,e);t[Ye]&16||(t[Ye]|=64)}function TP(e,n,t){let r=t.directiveStart,o=t.directiveEnd;Ci(t)&&rP(n,t,e.data[r+t.componentOffset]),e.firstCreatePass||ru(t,n);let i=t.initialInputs;for(let a=r;a<o;a++){let l=e.data[a],u=ou(n,e,a,t);if(as(u,n),i!==null&&IP(n,a-r,u,l,t,i),bo(l)){let p=Nr(t.index,n);p[Nn]=ou(n,e,a,t)}}}function PP(e,n,t){let r=t.directiveStart,o=t.directiveEnd,i=t.index,a=Wx();try{yi(i);for(let l=r;l<o;l++){let u=e.data[l],p=n[l];jd(l),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&SP(u,p)}}finally{yi(-1),jd(a)}}function SP(e,n){e.hostBindings!==null&&e.hostBindings(1,n)}function PC(e,n){let t=e.directiveRegistry,r=null;if(t)for(let o=0;o<t.length;o++){let i=t[o];pC(n,i.selectors,!1)&&(r??=[],bo(i)?r.unshift(i):r.push(i))}return r}function DP(e,n,t,r,o,i){let a=Zr(e,n);kP(n[qt],a,i,e.value,t,r,o)}function kP(e,n,t,r,o,i,a){if(i==null)e.removeAttribute(n,o,t);else{let l=a==null?Ho(i):a(i,r||"",o);e.setAttribute(n,o,l,t)}}function IP(e,n,t,r,o,i){let a=i[n];if(a!==null)for(let l=0;l<a.length;l+=2){let u=a[l],p=a[l+1];hm(r,t,u,p)}}function AP(e,n,t,r,o){let i=tn+t,a=n[Ke],l=o(a,n,e,r,t);n[i]=l,ns(e,!0);let u=e.type===2;return u?(sC(n[qt],l,e),(Ax()===0||bc(e))&&as(l,n),Nx()):as(l,n),Hd()&&(!u||!_u(e))&&Wm(a,n,l,e),e}function NP(e){let n=e;return Vg()?jg():(n=n.parent,ns(n,!1)),n}function FP(e,n){let t=e[vi];if(!t)return;let r;try{r=t.get(Fr,null)}catch{r=null}r?.(n)}function Gm(e,n,t,r,o){let i=e.inputs?.[r],a=e.hostDirectiveInputs?.[r],l=!1;if(a)for(let u=0;u<a.length;u+=2){let p=a[u],g=a[u+1],m=n.data[p];hm(m,t[p],g,o),l=!0}if(i)for(let u of i){let p=t[u],g=n.data[u];hm(g,p,r,o),l=!0}return l}function RP(e,n){let t=Nr(n,e),r=t[Ke];LP(r,t);let o=t[Yr];o!==null&&t[Za]===null&&(t[Za]=eC(o,t[vi])),At(xt.ComponentStart);try{qm(r,t,t[Nn])}finally{At(xt.ComponentEnd,t[Nn])}}function LP(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])}function qm(e,n,t){Ud(n);try{let r=e.viewQuery;r!==null&&mm(1,r,t);let o=e.template;o!==null&&OC(e,n,o,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),n[ta]?.finishViewCreation(e),e.staticContentQueries&&tC(e,n),e.staticViewQueries&&mm(2,e.viewQuery,t);let i=e.components;i!==null&&BP(n,i)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{n[Ye]&=-5,Wd()}}function BP(e,n){for(let t=0;t<n.length;t++)RP(e,n[t])}function Xm(e,n,t,r){let o=Qe(null);try{let i=n.tView,l=e[Ye]&4096?4096:16,u=Rm(e,i,t,l,null,n,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),p=e[n.index];u[Ji]=p;let g=e[ta];return g!==null&&(u[ta]=g.createEmbeddedView(i)),qm(i,u,t),u}finally{Qe(o)}}function cu(e,n){return!n||n.firstChild===null||q_(e)}function kc(e,n,t,r,o=!1){for(;t!==null;){if(t.type===128){t=o?t.projectionNext:t.next;continue}let i=n[t.index];i!==null&&r.push(Ar(i)),Kr(i)&&SC(i,r);let a=t.type;if(a&8)kc(e,n,t.child,r);else if(a&32){let l=Bm(t,n),u;for(;u=l();)r.push(u)}else if(a&16){let l=wC(n,t);if(Array.isArray(l))r.push(...l);else{let u=gi(n[ur]);kc(u[Ke],u,l,r,!0)}}t=o?t.projectionNext:t.next}return r}function SC(e,n){for(let t=nr;t<e.length;t++){let r=e[t],o=r[Ke].firstChild;o!==null&&kc(r[Ke],r,o,n)}e[_i]!==e[Yr]&&n.push(e[_i])}function DC(e){if(e[na]!==null){for(let n of e[na])n.impl.addSequence(n);e[na].length=0}}var kC=[];function VP(e){return e[Cr]??jP(e)}function jP(e){let n=kC.pop()??Object.create(WP);return n.lView=e,n}function UP(e){e.lView[Cr]!==e&&(e.lView=null,kC.push(e))}var WP=nt(Y({},Js),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:e=>{ts(e.lView)},consumerOnSignalRead(){this.lView[Cr]=this}});function zP(e){let n=e[Cr]??Object.create(HP);return n.lView=e,n}var HP=nt(Y({},Js),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:e=>{let n=gi(e.lView);for(;n&&!IC(n[Ke]);)n=gi(n);n&&Ng(n)},consumerOnSignalRead(){this.lView[Cr]=this}});function IC(e){return e.type!==2}function AC(e){if(e[vc]===null)return;let n=!0;for(;n;){let t=!1;for(let r of e[vc])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));n=t&&!!(e[Ye]&8192)}}var $P=100;function NC(e,n=0){let r=e[_o].rendererFactory,o=!1;o||r.begin?.();try{GP(e,n)}finally{o||r.end?.()}}function GP(e,n){let t=Ug();try{Wg(!0),xm(e,n);let r=0;for(;Mc(e);){if(r===$P)throw new ge(103,!1);r++,xm(e,1)}}finally{Wg(t)}}function qP(e,n,t,r){if(ra(n))return;let o=n[Ye],i=!1,a=!1;Ud(n);let l=!0,u=null,p=null;i||(IC(e)?(p=VP(n),u=tc(p)):Yl()===null?(l=!1,p=zP(n),u=tc(p)):n[Cr]&&(nc(n[Cr]),n[Cr]=null));try{Ag(n),Vx(e.bindingStartIndex),t!==null&&OC(e,n,t,2,r);let g=(o&3)===3;if(!i)if(g){let h=e.preOrderCheckHooks;h!==null&&Kd(n,h,null)}else{let h=e.preOrderHooks;h!==null&&Zd(n,h,0,null),em(n,0)}if(a||XP(n),AC(n),FC(n,0),e.contentQueries!==null&&tC(e,n),!i)if(g){let h=e.contentCheckHooks;h!==null&&Kd(n,h)}else{let h=e.contentHooks;h!==null&&Zd(n,h,1),em(n,1)}KP(e,n);let m=e.components;m!==null&&LC(n,m,0);let v=e.viewQuery;if(v!==null&&mm(2,v,r),!i)if(g){let h=e.viewCheckHooks;h!==null&&Kd(n,h)}else{let h=e.viewHooks;h!==null&&Zd(n,h,2),em(n,2)}if(e.firstUpdatePass===!0&&(e.firstUpdatePass=!1),n[Ld]){for(let h of n[Ld])h();n[Ld]=null}i||(DC(n),n[Ye]&=-73)}catch(g){throw i||ts(n),g}finally{p!==null&&(Kl(p,u),l&&UP(p)),Wd()}}function FC(e,n){for(let t=Y_(e);t!==null;t=K_(t))for(let r=nr;r<t.length;r++){let o=t[r];RC(o,n)}}function XP(e){for(let n=Y_(e);n!==null;n=K_(n)){if(!(n[Ye]&2))continue;let t=n[Cc];for(let r=0;r<t.length;r++){let o=t[r];Ng(o)}}}function YP(e,n,t){At(xt.ComponentStart);let r=Nr(n,e);try{RC(r,t)}finally{At(xt.ComponentEnd,r[Nn])}}function RC(e,n){Bd(e)&&xm(e,n)}function xm(e,n){let r=e[Ke],o=e[Ye],i=e[Cr],a=!!(n===0&&o&16);if(a||=!!(o&64&&n===0),a||=!!(o&1024),a||=!!(i?.dirty&&Zl(i)),a||=!1,i&&(i.dirty=!1),e[Ye]&=-9217,a)qP(r,e,r.template,e[Nn]);else if(o&8192){let l=Qe(null);try{AC(e),FC(e,1);let u=r.components;u!==null&&LC(e,u,1),DC(e)}finally{Qe(l)}}}function LC(e,n,t){for(let r=0;r<n.length;r++)YP(e,n[r],t)}function KP(e,n){let t=e.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let o=t[r];if(o<0)yi(~o);else{let i=o,a=t[++r],l=t[++r];Ux(a,i);let u=n[i];At(xt.HostBindingsUpdateStart,u);try{l(2,u)}finally{At(xt.HostBindingsUpdateEnd,u)}}}}finally{yi(-1)}}function Ym(e,n){let t=Ug()?64:1088;for(e[_o].changeDetectionScheduler?.notify(n);e;){e[Ye]|=t;let r=gi(e);if(es(e)&&!r)return e;e=r}return null}function BC(e,n,t,r){return[e,!0,0,n,null,r,null,t,null,null]}function ZP(e,n){let t=nr+n;if(t<e.length)return e[t]}function Km(e,n,t,r=!0){let o=n[Ke];if(JP(o,n,e,t),r){let a=vm(t,e),l=n[qt],u=l.parentNode(e[_i]);u!==null&&dP(o,e[tr],l,n,u,a)}let i=n[Za];i!==null&&i.firstChild!==null&&(i.firstChild=null)}function QP(e,n){let t=lu(e,n);return t!==void 0&&Um(t[Ke],t),t}function lu(e,n){if(e.length<=nr)return;let t=nr+n,r=e[t];if(r){let o=r[Ji];o!==null&&o!==e&&jm(o,r),n>0&&(e[t-1][Ir]=r[Ir]);let i=gc(e,nr+n);lP(r[Ke],r);let a=i[ta];a!==null&&a.detachView(i[Ke]),r[In]=null,r[Ir]=null,r[Ye]&=-129}return r}function JP(e,n,t,r){let o=nr+r,i=t.length;r>0&&(t[o-1][Ir]=n),r<i-nr?(n[Ir]=t[o],_g(t,nr+r,n)):(t.push(n),n[Ir]=null),n[In]=t;let a=n[Ji];a!==null&&t!==a&&VC(a,n);let l=n[ta];l!==null&&l.insertView(e),Vd(n),n[Ye]|=128}function VC(e,n){let t=e[Cc],r=n[In];if(Co(r))e[Ye]|=2;else{let o=r[In][ur];n[ur]!==o&&(e[Ye]|=2)}t===null?e[Cc]=[n]:t.push(n)}var Ei=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let n=this._lView,t=n[Ke];return kc(t,n,t.firstChild,[])}constructor(n,t){this._lView=n,this._cdRefInjectingView=t}get context(){return this._lView[Nn]}set context(n){this._lView[Nn]=n}get destroyed(){return ra(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let n=this._lView[In];if(Kr(n)){let t=n[_c],r=t?t.indexOf(this):-1;r>-1&&(lu(n,r),gc(t,r))}this._attachedToViewContainer=!1}Um(this._lView[Ke],this._lView)}onDestroy(n){Fg(this._lView,n)}markForCheck(){Ym(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Ye]&=-129}reattach(){Vd(this._lView),this._lView[Ye]|=128}detectChanges(){this._lView[Ye]|=1024,NC(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ge(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let n=es(this._lView),t=this._lView[Ji];t!==null&&!n&&jm(t,this._lView),bC(this._lView[Ke],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new ge(902,!1);this._appRef=n;let t=es(this._lView),r=this._lView[Ji];r!==null&&!t&&VC(r,this._lView),Vd(this._lView)}};var Bc=(()=>{class e{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=eS;constructor(t,r,o){this._declarationLView=t,this._declarationTContainer=r,this.elementRef=o}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,r){return this.createEmbeddedViewImpl(t,r)}createEmbeddedViewImpl(t,r,o){let i=Xm(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:r,dehydratedView:o});return new Ei(i)}}return e})();function eS(){return tS(rr(),it())}function tS(e,n){return e.type&4?new Bc(n,e,mu(e,n)):null}function Vc(e,n,t,r,o){let i=e.data[n];if(i===null)i=nS(e,n,t,r,o),jx()&&(i.flags|=32);else if(i.type&64){i.type=t,i.value=r,i.attrs=o;let a=Bx();i.injectorIndex=a===null?-1:a.injectorIndex}return ns(i,!0),i}function nS(e,n,t,r,o){let i=Bg(),a=Vg(),l=a?i:i&&i.parent,u=e.data[n]=oS(e,l,t,n,r,o);return rS(e,u,i,a),u}function rS(e,n,t,r){e.firstChild===null&&(e.firstChild=n),t!==null&&(r?t.child==null&&n.parent!==null&&(t.child=n):t.next===null&&(t.next=n,n.prev=t))}function oS(e,n,t,r,o,i){let a=n?n.injectorIndex:-1,l=0;return Lg()&&(l|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:a,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:l,providerIndexes:0,value:o,attrs:i,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var iS=()=>null,aS=()=>null;function _m(e,n){return iS(e,n)}function sS(e,n,t){return aS(e,n,t)}var jC=class{},wu=class{},Cm=class{resolveComponentFactory(n){throw new ge(917,!1)}},jc=class{static NULL=new Cm},aa=class{},ro=(()=>{class e{destroyNode=null;static __NG_ELEMENT_ID__=()=>cS()}return e})();function cS(){let e=it(),n=rr(),t=Nr(n.index,e);return(Co(t)?t:e)[qt]}var UC=(()=>{class e{static \u0275prov=we({token:e,providedIn:"root",factory:()=>null})}return e})();var Qd={},bm=class{injector;parentInjector;constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,r){let o=this.injector.get(n,Qd,r);return o!==Qd||t===Qd?o:this.parentInjector.get(n,t,r)}};function m_(e,n,t){let r=t?e.styles:null,o=t?e.classes:null,i=0;if(n!==null)for(let a=0;a<n.length;a++){let l=n[a];if(typeof l=="number")i=l;else if(i==1)o=Dd(o,l);else if(i==2){let u=l,p=n[++a];r=Dd(r,u+": "+p+";")}}t?e.styles=r:e.stylesWithoutHost=r,t?e.classes=o:e.classesWithoutHost=o}function j(e,n=0){let t=it();if(t===null)return Le(e,n);let r=rr();return H_(r,t,kn(e),n)}function Zm(){let e="invalid";throw new Error(e)}function WC(e,n,t,r,o){let i=r===null?null:{"":-1},a=o(e,t);if(a!==null){let l=a,u=null,p=null;for(let g of a)if(g.resolveHostDirectives!==null){[l,u,p]=g.resolveHostDirectives(a);break}uS(e,n,t,l,i,u,p)}i!==null&&r!==null&&lS(t,r,i)}function lS(e,n,t){let r=e.localNames=[];for(let o=0;o<n.length;o+=2){let i=t[n[o+1]];if(i==null)throw new ge(-301,!1);r.push(n[o],i)}}function dS(e,n,t){n.componentOffset=t,(e.components??=[]).push(n.index)}function uS(e,n,t,r,o,i,a){let l=r.length,u=null;for(let v=0;v<l;v++){let h=r[v];u===null&&bo(h)&&(u=h,dS(e,t,v)),fm(ru(t,n),e,h.type)}vS(t,e.data.length,l),u?.viewProvidersResolver&&u.viewProvidersResolver(u);for(let v=0;v<l;v++){let h=r[v];h.providersResolver&&h.providersResolver(h)}let p=!1,g=!1,m=mC(e,n,l,null);l>0&&(t.directiveToIndex=new Map);for(let v=0;v<l;v++){let h=r[v];if(t.mergedAttrs=Dc(t.mergedAttrs,h.hostAttrs),pS(e,t,n,m,h),hS(m,h,o),a!==null&&a.has(h)){let[x,y]=a.get(h);t.directiveToIndex.set(h.type,[m,x+t.directiveStart,y+t.directiveStart])}else(i===null||!i.has(h))&&t.directiveToIndex.set(h.type,m);h.contentQueries!==null&&(t.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(t.flags|=64);let b=h.type.prototype;!p&&(b.ngOnChanges||b.ngOnInit||b.ngDoCheck)&&((e.preOrderHooks??=[]).push(t.index),p=!0),!g&&(b.ngOnChanges||b.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(t.index),g=!0),m++}fS(e,t,i)}function fS(e,n,t){for(let r=n.directiveStart;r<n.directiveEnd;r++){let o=e.data[r];if(t===null||!t.has(o))h_(0,n,o,r),h_(1,n,o,r),x_(n,r,!1);else{let i=t.get(o);v_(0,n,i,r),v_(1,n,i,r),x_(n,r,!0)}}}function h_(e,n,t,r){let o=e===0?t.inputs:t.outputs;for(let i in o)if(o.hasOwnProperty(i)){let a;e===0?a=n.inputs??={}:a=n.outputs??={},a[i]??=[],a[i].push(r),zC(n,i)}}function v_(e,n,t,r){let o=e===0?t.inputs:t.outputs;for(let i in o)if(o.hasOwnProperty(i)){let a=o[i],l;e===0?l=n.hostDirectiveInputs??={}:l=n.hostDirectiveOutputs??={},l[a]??=[],l[a].push(r,i),zC(n,a)}}function zC(e,n){n==="class"?e.flags|=8:n==="style"&&(e.flags|=16)}function x_(e,n,t){let{attrs:r,inputs:o,hostDirectiveInputs:i}=e;if(r===null||!t&&o===null||t&&i===null||Nm(e)){e.initialInputs??=[],e.initialInputs.push(null);return}let a=null,l=0;for(;l<r.length;){let u=r[l];if(u===0){l+=4;continue}else if(u===5){l+=2;continue}else if(typeof u=="number")break;if(!t&&o.hasOwnProperty(u)){let p=o[u];for(let g of p)if(g===n){a??=[],a.push(u,r[l+1]);break}}else if(t&&i.hasOwnProperty(u)){let p=i[u];for(let g=0;g<p.length;g+=2)if(p[g]===n){a??=[],a.push(p[g+1],r[l+1]);break}}l+=2}e.initialInputs??=[],e.initialInputs.push(a)}function pS(e,n,t,r,o){e.data[r]=o;let i=o.factory||(o.factory=pi(o.type,!0)),a=new ia(i,bo(o),j,null);e.blueprint[r]=a,t[r]=a,gS(e,n,r,mC(e,t,o.hostVars,$n),o)}function gS(e,n,t,r,o){let i=o.hostBindings;if(i){let a=e.hostBindingOpCodes;a===null&&(a=e.hostBindingOpCodes=[]);let l=~n.index;mS(a)!=l&&a.push(l),a.push(t,r,i)}}function mS(e){let n=e.length;for(;n>0;){let t=e[--n];if(typeof t=="number"&&t<0)return t}return 0}function hS(e,n,t){if(t){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)t[n.exportAs[r]]=e;bo(n)&&(t[""]=e)}}function vS(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}function HC(e,n,t,r,o,i,a,l){let u=n[Ke],p=u.consts,g=bi(p,a),m=Vc(u,e,t,r,g);return i&&WC(u,n,m,bi(p,l),o),m.mergedAttrs=Dc(m.mergedAttrs,m.attrs),m.attrs!==null&&m_(m,m.attrs,!1),m.mergedAttrs!==null&&m_(m,m.mergedAttrs,!0),u.queries!==null&&u.queries.elementStart(u,m),m}function $C(e,n){F_(e,n),Pg(n)&&e.queries.elementEnd(n)}function Qm(e){return qC(e)?Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e:!1}function GC(e,n){if(Array.isArray(e))for(let t=0;t<e.length;t++)n(e[t]);else{let t=e[Symbol.iterator](),r;for(;!(r=t.next()).done;)n(r.value)}}function qC(e){return e!==null&&(typeof e=="function"||typeof e=="object")}function XC(e,n,t){return e[n]=t}function to(e,n,t){if(t===$n)return!1;let r=e[n];return Object.is(r,t)?!1:(e[n]=t,!0)}function Jm(e,n,t,r){let o=to(e,n,t);return to(e,n+1,r)||o}function xS(e,n,t,r,o){let i=Jm(e,n,t,r);return to(e,n+2,o)||i}function rm(e,n,t){return function r(o){let i=Ci(e)?Nr(e.index,n):n;Ym(i,5);let a=n[Nn],l=__(n,a,t,o),u=r.__ngNextListenerFn__;for(;u;)l=__(n,a,u,o)&&l,u=u.__ngNextListenerFn__;return l}}function __(e,n,t,r){let o=Qe(null);try{return At(xt.OutputStart,n,t),t(r)!==!1}catch(i){return FP(e,i),!1}finally{At(xt.OutputEnd,n,t),Qe(o)}}function _S(e,n,t,r,o,i,a,l){let u=bc(e),p=!1,g=null;if(!r&&u&&(g=bS(n,t,i,e.index)),g!==null){let m=g.__ngLastListenerFn__||g;m.__ngNextListenerFn__=a,g.__ngLastListenerFn__=a,p=!0}else{let m=Zr(e,t),v=r?r(m):m;kT(t,v,i,l);let h=o.listen(v,i,l);if(!CS(i)){let b=r?x=>r(Ar(x[e.index])):e.index;YC(b,n,t,i,l,h,!1)}}return p}function CS(e){return e.startsWith("animation")||e.startsWith("transition")}function bS(e,n,t,r){let o=e.cleanup;if(o!=null)for(let i=0;i<o.length-1;i+=2){let a=o[i];if(a===t&&o[i+1]===r){let l=n[Qa],u=o[i+2];return l&&l.length>u?l[u]:null}typeof a=="string"&&(i+=2)}return null}function YC(e,n,t,r,o,i,a){let l=n.firstCreatePass?Ix(n):null,u=kx(t),p=u.length;u.push(o,i),l&&l.push(r,e,p,(p+1)*(a?-1:1))}function C_(e,n,t,r,o,i){let a=n[t],l=n[Ke],p=l.data[t].outputs[r],m=a[p].subscribe(i);YC(e.index,l,n,o,i,m,!0)}var ym=Symbol("BINDING");var du=class extends jc{ngModule;constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){let t=zo(n);return new sa(t,this.ngModule)}};function yS(e){return Object.keys(e).map(n=>{let[t,r,o]=e[n],i={propName:t,templateName:n,isSignal:(r&bu.SignalBased)!==0};return o&&(i.transform=o),i})}function MS(e){return Object.keys(e).map(n=>({propName:e[n],templateName:n}))}function wS(e,n,t){let r=n instanceof Gt?n:n?.injector;return r&&e.getStandaloneInjector!==null&&(r=e.getStandaloneInjector(r)||r),r?new bm(t,r):t}function ES(e){let n=e.get(aa,null);if(n===null)throw new ge(407,!1);let t=e.get(UC,null),r=e.get(mi,null);return{rendererFactory:n,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function OS(e,n){let t=KC(e);return iC(n,t,t==="svg"?Sg:t==="math"?Tx:null)}function KC(e){return(e.selectors[0][0]||"div").toLowerCase()}var sa=class extends wu{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=yS(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=MS(this.componentDef.outputs),this.cachedOutputs}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=JT(n.selectors),this.ngContentSelectors=n.ngContentSelectors??[],this.isBoundToModule=!!t}create(n,t,r,o,i,a){At(xt.DynamicComponentStart);let l=Qe(null);try{let u=this.componentDef,p=TS(r,u,a,i),g=wS(u,o||this.ngModule,n),m=ES(g),v=m.rendererFactory.createRenderer(null,u),h=r?bP(v,r,u.encapsulation,g):OS(u,v),b=a?.some(b_)||i?.some(A=>typeof A!="function"&&A.bindings.some(b_)),x=Rm(null,p,null,512|gC(u),null,null,m,v,g,null,eC(h,g,!0));x[tn]=h,Ud(x);let y=null;try{let A=HC(tn,x,2,"#host",()=>p.directiveRegistry,!0,0);sC(v,h,A),as(h,x),Hm(p,x,A),nC(p,A,x),$C(p,A),t!==void 0&&SS(A,this.ngContentSelectors,t),y=Nr(A.index,x),x[Nn]=y[Nn],qm(p,x,null)}catch(A){throw y!==null&&gm(y),gm(x),A}finally{At(xt.DynamicComponentEnd),Wd()}return new uu(this.componentType,x,!!b)}finally{Qe(l)}}};function TS(e,n,t,r){let o=e?["ng-version","21.1.4"]:eP(n.selectors[0]),i=null,a=null,l=0;if(t)for(let g of t)l+=g[ym].requiredVars,g.create&&(g.targetIdx=0,(i??=[]).push(g)),g.update&&(g.targetIdx=0,(a??=[]).push(g));if(r)for(let g=0;g<r.length;g++){let m=r[g];if(typeof m!="function")for(let v of m.bindings){l+=v[ym].requiredVars;let h=g+1;v.create&&(v.targetIdx=h,(i??=[]).push(v)),v.update&&(v.targetIdx=h,(a??=[]).push(v))}}let u=[n];if(r)for(let g of r){let m=typeof g=="function"?g:g.type,v=hg(m);u.push(v)}return Fm(0,null,PS(i,a),1,l,u,null,null,null,[o],null)}function PS(e,n){return!e&&!n?null:t=>{if(t&1&&e)for(let r of e)r.create();if(t&2&&n)for(let r of n)r.update()}}function b_(e){let n=e[ym].kind;return n==="input"||n==="twoWay"}var uu=class extends jC{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(n,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=yc(t[Ke],tn),this.location=mu(this._tNode,t),this.instance=Nr(this._tNode.index,t)[Nn],this.hostView=this.changeDetectorRef=new Ei(t,void 0),this.componentType=n}setInput(n,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),t))return;let o=this._rootLView,i=Gm(r,o[Ke],o,n,t);this.previousInputValues.set(n,t);let a=Nr(r.index,o);Ym(a,1)}get injector(){return new oa(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}};function SS(e,n,t){let r=e.projection=[];for(let o=0;o<n.length;o++){let i=t[o];r.push(i!=null&&i.length?Array.from(i):null)}}var da=(()=>{class e{static __NG_ELEMENT_ID__=DS}return e})();function DS(){let e=rr();return IS(e,it())}var kS=da,ZC=class extends kS{_lContainer;_hostTNode;_hostLView;constructor(n,t,r){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=r}get element(){return mu(this._hostTNode,this._hostLView)}get injector(){return new oa(this._hostTNode,this._hostLView)}get parentInjector(){let n=Pm(this._hostTNode,this._hostLView);if(B_(n)){let t=tu(n,this._hostLView),r=eu(n),o=t[Ke].data[r+8];return new oa(o,t)}else return new oa(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){let t=y_(this._lContainer);return t!==null&&t[n]||null}get length(){return this._lContainer.length-nr}createEmbeddedView(n,t,r){let o,i;typeof r=="number"?o=r:r!=null&&(o=r.index,i=r.injector);let a=_m(this._lContainer,n.ssrId),l=n.createEmbeddedViewImpl(t||{},i,a);return this.insertImpl(l,o,cu(this._hostTNode,a)),l}createComponent(n,t,r,o,i,a,l){let u=n&&!oT(n),p;if(u)p=t;else{let y=t||{};p=y.index,r=y.injector,o=y.projectableNodes,i=y.environmentInjector||y.ngModuleRef,a=y.directives,l=y.bindings}let g=u?n:new sa(zo(n)),m=r||this.parentInjector;if(!i&&g.ngModule==null){let A=(u?m:this.parentInjector).get(Gt,null);A&&(i=A)}let v=zo(g.componentType??{}),h=_m(this._lContainer,v?.id??null),b=h?.firstChild??null,x=g.create(m,o,b,i,a,l);return this.insertImpl(x.hostView,p,cu(this._hostTNode,h)),x}insert(n,t){return this.insertImpl(n,t,!0)}insertImpl(n,t,r){let o=n._lView;if(Px(o)){let l=this.indexOf(n);if(l!==-1)this.detach(l);else{let u=o[In],p=new ZC(u,u[tr],u[In]);p.detach(p.indexOf(n))}}let i=this._adjustIndex(t),a=this._lContainer;return Km(a,o,i,r),n.attachToViewContainerRef(),_g(om(a),i,n),n}move(n,t){return this.insert(n,t)}indexOf(n){let t=y_(this._lContainer);return t!==null?t.indexOf(n):-1}remove(n){let t=this._adjustIndex(n,-1),r=lu(this._lContainer,t);r&&(gc(om(this._lContainer),t),Um(r[Ke],r))}detach(n){let t=this._adjustIndex(n,-1),r=lu(this._lContainer,t);return r&&gc(om(this._lContainer),t)!=null?new Ei(r):null}_adjustIndex(n,t=0){return n??this.length+t}};function y_(e){return e[_c]}function om(e){return e[_c]||(e[_c]=[])}function IS(e,n){let t,r=n[e.index];return Kr(r)?t=r:(t=BC(r,n,null,e),n[e.index]=t,Lm(n,t)),NS(t,n,e,r),new ZC(t,e,n)}function AS(e,n){let t=e[qt],r=t.createComment(""),o=Zr(n,e),i=t.parentNode(o);return au(t,i,r,t.nextSibling(o),!1),r}var NS=LS,FS=()=>!1;function RS(e,n,t){return FS(e,n,t)}function LS(e,n,t,r){if(e[_i])return;let o;t.type&8?o=Ar(r):o=AS(n,t),e[_i]=o}var Mm=new Map,BS=new Set;async function eh(e){let n=Mm;Mm=new Map;let t=new Map;function r(i){let a=t.get(i);if(a)return a;let l=e(i).then(u=>VS(i,u));return t.set(i,l),l}let o=Array.from(n).map(async([i,a])=>{if(a.styleUrl&&a.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");let l=[];a.templateUrl&&l.push(r(a.templateUrl).then(m=>{a.template=m}));let u=typeof a.styles=="string"?[a.styles]:a.styles??[];a.styles=u;let{styleUrl:p,styleUrls:g}=a;if(p&&(g=[p],a.styleUrl=void 0),g?.length){let m=Promise.all(g.map(v=>r(v))).then(v=>{u.push(...v),a.styleUrls=void 0});l.push(m)}await Promise.all(l),BS.delete(i)});await Promise.all(o)}function QC(){return Mm.size===0}async function VS(e,n){if(typeof n=="string")return n;if(n.status!==void 0&&n.status!==200)throw new ge(918,!1);return n.text()}var ca=class{},Eu=class{};var Ic=class extends ca{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new du(this);constructor(n,t,r,o=!0){super(),this.ngModuleType=n,this._parent=t;let i=mg(n);this._bootstrapComponents=uC(i.bootstrap),this._r3Injector=Xg(n,t,[{provide:ca,useValue:this},{provide:jc,useValue:this.componentFactoryResolver},...r],Uo(n),new Set(["environment"])),o&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}},Ac=class extends Eu{moduleType;constructor(n){super(),this.moduleType=n}create(n){return new Ic(this.moduleType,n,[])}};function JC(e,n,t){return new Ic(e,n,t,!1)}var fu=class extends ca{injector;componentFactoryResolver=new du(this);instance=null;constructor(n){super();let t=new Ki([...n.providers,{provide:ca,useValue:this},{provide:jc,useValue:this.componentFactoryResolver}],n.parent||hc(),n.debugName,new Set(["environment"]));this.injector=t,n.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}};function us(e,n,t=null){return new fu({providers:e,parent:n,debugName:t,runEnvironmentInitializers:!0}).injector}var jS=(()=>{class e{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=yg(!1,t.type),o=r.length>0?us([r],this._injector,""):null;this.cachedInjectors.set(t,o)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=we({token:e,providedIn:"environment",factory:()=>new e(Le(Gt))})}return e})();function se(e){return Fc(()=>{let n=eb(e),t=nt(Y({},n),{decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Sm.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:n.standalone?o=>o.get(jS).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||eo.Emulated,styles:e.styles||er,_:null,schemas:e.schemas||null,tView:null,id:""});n.standalone&&Xo("NgStandalone"),tb(t);let r=e.dependencies;return t.directiveDefs=M_(r,US),t.pipeDefs=M_(r,hx),t.id=HS(t),t})}function US(e){return zo(e)||hg(e)}function ft(e){return Fc(()=>({type:e.type,bootstrap:e.bootstrap||er,declarations:e.declarations||er,imports:e.imports||er,exports:e.exports||er,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function WS(e,n){if(e==null)return hi;let t={};for(let r in e)if(e.hasOwnProperty(r)){let o=e[r],i,a,l,u;Array.isArray(o)?(l=o[0],i=o[1],a=o[2]??i,u=o[3]||null):(i=o,a=o,l=bu.None,u=null),t[i]=[r,l,u],n[i]=a}return t}function zS(e){if(e==null)return hi;let n={};for(let t in e)e.hasOwnProperty(t)&&(n[e[t]]=t);return n}function Kt(e){return Fc(()=>{let n=eb(e);return tb(n),n})}function Ou(e){return{type:e.type,name:e.name,factory:null,pure:e.pure!==!1,standalone:e.standalone??!0,onDestroy:e.type.prototype.ngOnDestroy||null}}function eb(e){let n={};return{type:e.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputConfig:e.inputs||hi,exportAs:e.exportAs||null,standalone:e.standalone??!0,signals:e.signals===!0,selectors:e.selectors||er,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:WS(e.inputs,n),outputs:zS(e.outputs),debugInfo:null}}function tb(e){e.features?.forEach(n=>n(e))}function M_(e,n){return e?()=>{let t=typeof e=="function"?e():e,r=[];for(let o of t){let i=n(o);i!==null&&r.push(i)}return r}:null}function HS(e){let n=0,t=typeof e.consts=="function"?"":e.consts,r=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,t,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery];for(let i of r.join("|"))n=Math.imul(31,n)+i.charCodeAt(0)<<0;return n+=2147483648,"c"+n}function $S(e){return Object.getPrototypeOf(e.prototype).constructor}function Lr(e){let n=$S(e.type),t=!0,r=[e];for(;n;){let o;if(bo(e))o=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new ge(903,!1);o=n.\u0275dir}if(o){if(t){r.push(o);let a=e;a.inputs=im(e.inputs),a.declaredInputs=im(e.declaredInputs),a.outputs=im(e.outputs);let l=o.hostBindings;l&&KS(e,l);let u=o.viewQuery,p=o.contentQueries;if(u&&XS(e,u),p&&YS(e,p),GS(e,o),mx(e.outputs,o.outputs),bo(o)&&o.data.animation){let g=e.data;g.animation=(g.animation||[]).concat(o.data.animation)}}let i=o.features;if(i)for(let a=0;a<i.length;a++){let l=i[a];l&&l.ngInherit&&l(e),l===Lr&&(t=!1)}}n=Object.getPrototypeOf(n)}qS(r)}function GS(e,n){for(let t in n.inputs){if(!n.inputs.hasOwnProperty(t)||e.inputs.hasOwnProperty(t))continue;let r=n.inputs[t];r!==void 0&&(e.inputs[t]=r,e.declaredInputs[t]=n.declaredInputs[t])}}function qS(e){let n=0,t=null;for(let r=e.length-1;r>=0;r--){let o=e[r];o.hostVars=n+=o.hostVars,o.hostAttrs=Dc(o.hostAttrs,t=Dc(t,o.hostAttrs))}}function im(e){return e===hi?{}:e===er?[]:e}function XS(e,n){let t=e.viewQuery;t?e.viewQuery=(r,o)=>{n(r,o),t(r,o)}:e.viewQuery=n}function YS(e,n){let t=e.contentQueries;t?e.contentQueries=(r,o,i)=>{n(r,o,i),t(r,o,i)}:e.contentQueries=n}function KS(e,n){let t=e.hostBindings;t?e.hostBindings=(r,o)=>{n(r,o),t(r,o)}:e.hostBindings=n}function nb(e,n,t,r,o,i,a,l){if(t.firstCreatePass){e.mergedAttrs=Dc(e.mergedAttrs,e.attrs);let g=e.tView=Fm(2,e,o,i,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,e),g.queries=t.queries.embeddedTView(e))}l&&(e.flags|=l),ns(e,!1);let u=QS(t,n,e,r);Hd()&&Wm(t,n,u,e),as(u,n);let p=BC(u,n,u,e);n[r+tn]=p,Lm(n,p),RS(p,e,n)}function ZS(e,n,t,r,o,i,a,l,u,p,g){let m=t+tn,v;return n.firstCreatePass?(v=Vc(n,m,4,a||null,l||null),Rg()&&WC(n,e,v,bi(n.consts,p),PC),F_(n,v)):v=n.data[m],nb(v,e,n,t,r,o,i,u),bc(v)&&Hm(n,e,v),p!=null&&$m(e,v,g),v}function th(e,n,t,r,o,i,a,l,u,p,g){let m=t+tn,v;if(n.firstCreatePass){if(v=Vc(n,m,4,a||null,l||null),p!=null){let h=bi(n.consts,p);v.localNames=[];for(let b=0;b<h.length;b+=2)v.localNames.push(h[b],-1)}}else v=n.data[m];return nb(v,e,n,t,r,o,i,u),p!=null&&$m(e,v,g),v}function H(e,n,t,r,o,i,a,l){let u=it(),p=Cn(),g=bi(p.consts,i);return ZS(u,p,e,n,t,r,o,g,void 0,a,l),H}var QS=JS;function JS(e,n,t,r){return $d(!0),n[qt].createComment("")}var nh=(()=>{class e{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function rb(e){return typeof e=="function"&&e[Qn]!==void 0}function rh(e){return rb(e)&&typeof e.set=="function"}var Tu=new Me(""),Pu=new Me(""),Uc=(()=>{class e{_ngZone;registry;_isZoneStable=!0;_callbacks=[];_taskTrackingZone=null;_destroyRef;constructor(t,r,o){this._ngZone=t,this.registry=r,Eg()&&(this._destroyRef=K(br,{optional:!0})??void 0),oh||(ib(o),o.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this._taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){let t=this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),r=this._ngZone.runOutsideAngular(()=>this._ngZone.onStable.subscribe({next:()=>{_n.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}}));this._destroyRef?.onDestroy(()=>{t.unsubscribe(),r.unsubscribe()})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>r.updateCb&&r.updateCb(t)?(clearTimeout(r.timeoutId),!1):!0)}}getPendingTasks(){return this._taskTrackingZone?this._taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,o){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==i),t()},r)),this._callbacks.push({doneCb:t,timeoutId:i,updateCb:o})}whenStable(t,r,o){if(o&&!this._taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,o),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,o){return[]}static \u0275fac=function(r){return new(r||e)(Le(_n),Le(ob),Le(Pu))};static \u0275prov=we({token:e,factory:e.\u0275fac})}return e})(),ob=(()=>{class e{_applications=new Map;registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return oh?.findTestabilityInTree(this,t,r)??null}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function ib(e){oh=e}var oh;function Oi(e){return!!e&&typeof e.then=="function"}function ih(e){return!!e&&typeof e.subscribe=="function"}var ah=new Me("");function Su(e){return Ka([{provide:ah,multi:!0,useValue:e}])}var sh=(()=>{class e{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=K(ah,{optional:!0})??[];injector=K(Hn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let o of this.appInits){let i=pn(this.injector,o);if(Oi(i))t.push(i);else if(ih(i)){let a=new Promise((l,u)=>{i.subscribe({complete:l,error:u})});t.push(a)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(o=>{this.reject(o)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Du=new Me("");function ab(){N0(()=>{let e="";throw new ge(600,e)})}function sb(e){return e.isBoundToModule}var eD=10;function ch(e,n){return Array.isArray(n)?n.reduce(ch,e):Y(Y({},e),n)}var Eo=(()=>{class e{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=K(Fr);afterRenderManager=K(Vm);zonelessEnabled=K(Ec);rootEffectScheduler=K(Jg);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new fn;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=K($o);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(Tt(t=>!t))}constructor(){K(qo,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:o=>{o&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=K(Gt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,o=Hn.NULL){return this._injector.get(_n).run(()=>{At(xt.BootstrapComponentStart);let a=t instanceof wu;if(!this._injector.get(sh).done){let b="";throw new ge(405,b)}let u;a?u=t:u=this._injector.get(jc).resolveComponentFactory(t),this.componentTypes.push(u.componentType);let p=sb(u)?void 0:this._injector.get(ca),g=r||u.selector,m=u.create(o,[],g,p),v=m.location.nativeElement,h=m.injector.get(Tu,null);return h?.registerApplication(v),m.onDestroy(()=>{this.detachView(m.hostView),Sc(this.components,m),h?.unregisterApplication(v)}),this._loadComponent(m),At(xt.BootstrapComponentEnd,m),m})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){At(xt.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(yu.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw At(xt.ChangeDetectionEnd),new ge(101,!1);let t=Qe(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Qe(t),this.afterTick.next(),At(xt.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(aa,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<eD;){At(xt.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{At(xt.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:o}of this.allViews){if(!r&&!Mc(o))continue;let i=r&&!this.zonelessEnabled?0:1;NC(o,i),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Mc(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Sc(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(o){this.internalErrorHandler(o)}this.components.push(t),this._injector.get(Du,[]).forEach(o=>o(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Sc(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ge(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Sc(e,n){let t=e.indexOf(n);t>-1&&e.splice(t,1)}function fs(e,n,t,r){let o=it(),i=rs();if(to(o,i,n)){let a=Cn(),l=zd();DP(l,o,e,n,t,r)}return fs}var R$=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";function Yo(e,n,t,r,o,i,a,l){Xo("NgControlFlow");let u=it(),p=Cn(),g=bi(p.consts,i);return th(u,p,e,n,t,r,o,g,256,a,l),lh}function lh(e,n,t,r,o,i,a,l){Xo("NgControlFlow");let u=it(),p=Cn(),g=bi(p.consts,i);return th(u,p,e,n,t,r,o,g,512,a,l),lh}function Ko(e,n){Xo("NgControlFlow");let t=it(),r=rs(),o=t[r]!==$n?t[r]:-1,i=o!==-1?w_(t,tn+o):void 0,a=0;if(to(t,r,e)){let l=Qe(null);try{if(i!==void 0&&QP(i,a),e!==-1){let u=tn+e,p=w_(t,u),g=tD(t[Ke],u),m=sS(p,g,t),v=Xm(t,g,n,{dehydratedView:m});Km(p,v,a,cu(g,m))}}finally{Qe(l)}}else if(i!==void 0){let l=ZP(i,a);l!==void 0&&(l[Nn]=n)}}function w_(e,n){return e[n]}function tD(e,n){return yc(e,n)}function _(e,n,t){let r=it(),o=rs();if(to(r,o,n)){let i=Cn(),a=zd();TC(a,r,e,n,r[qt],t)}return _}function wm(e,n,t,r,o){Gm(n,e,t,o?"class":"style",r)}function c(e,n,t,r){let o=it(),i=o[Ke],a=e+tn,l=i.firstCreatePass?HC(a,o,2,n,PC,Rg(),t,r):i.data[a];if(AP(l,o,e,n,nD),bc(l)){let u=o[Ke];Hm(u,o,l),nC(u,l,o)}return r!=null&&$m(o,l),c}function s(){let e=Cn(),n=rr(),t=NP(n);return e.firstCreatePass&&$C(e,t),Rx(t)&&Lx(),Fx(),t.classesWithoutHost!=null&&dT(t)&&wm(e,t,it(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&uT(t)&&wm(e,t,it(),t.stylesWithoutHost,!1),s}function le(e,n,t,r){return c(e,n,t,r),s(),le}var nD=(e,n,t,r,o)=>($d(!0),iC(n[qt],r,Xx()));function be(){return it()}var Tc=void 0;function rD(e){let n=Math.floor(Math.abs(e)),t=e.toString().replace(/^[^.]*\.?/,"").length;return n===1&&t===0?1:5}var oD=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Tc,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Tc,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",Tc,Tc,Tc],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",rD],am={};function fr(e){let n=iD(e),t=E_(n);if(t)return t;let r=n.split("-")[0];if(t=E_(r),t)return t;if(r==="en")return oD;throw new ge(701,!1)}function E_(e){return e in am||(am[e]=An.ng&&An.ng.common&&An.ng.common.locales&&An.ng.common.locales[e]),am[e]}var Qt=(function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e})(Qt||{});function iD(e){return e.toLowerCase().replace(/_/g,"-")}var Wc="en-US";var aD=Wc;function cb(e){typeof e=="string"&&(aD=e.toLowerCase().replace(/_/g,"-"))}function E(e,n,t){let r=it(),o=Cn(),i=rr();return lb(o,r,r[qt],i,e,n,t),E}function lb(e,n,t,r,o,i,a){let l=!0,u=null;if((r.type&3||a)&&(u??=rm(r,n,i),_S(r,e,n,a,t,o,i,u)&&(l=!1)),l){let p=r.outputs?.[o],g=r.hostDirectiveOutputs?.[o];if(g&&g.length)for(let m=0;m<g.length;m+=2){let v=g[m],h=g[m+1];u??=rm(r,n,i),C_(r,n,v,h,o,u)}if(p&&p.length)for(let m of p)u??=rm(r,n,i),C_(r,n,m,o,o,u)}}function q(e=1){return qx(e)}function sD(e,n){let t=null,r=XT(e);for(let o=0;o<n.length;o++){let i=n[o];if(i==="*"){t=o;continue}if(r===null?pC(e,i,!0):ZT(r,i))return o}return t}function dh(e){let n=it()[ur][tr];if(!n.projection){let t=e?e.length:1,r=n.projection=Cx(t,null),o=r.slice(),i=n.child;for(;i!==null;){if(i.type!==128){let a=e?sD(i,e):0;a!==null&&(o[a]?o[a].projectionNext=i:r[a]=i,o[a]=i)}i=i.next}}}function uh(e,n=0,t,r,o,i){let a=it(),l=Cn(),u=r?e+1:null;u!==null&&th(a,l,u,r,o,i,null,t);let p=Vc(l,tn+e,16,null,t||null);p.projection===null&&(p.projection=n),jg();let m=!a[Za]||Lg();a[ur][tr].projection[p.projection]===null&&u!==null?cD(a,l,u):m&&!_u(p)&&xP(l,a,p)}function cD(e,n,t){let r=tn+t,o=n.data[r],i=e[r],a=_m(i,o.tView.ssrId),l=Xm(e,o,void 0,{dehydratedView:a});Km(i,l,0,cu(o,a))}function Xd(e,n){return e<<17|n<<2}function la(e){return e>>17&32767}function lD(e){return(e&2)==2}function dD(e,n){return e&131071|n<<17}function Em(e){return e|2}function cs(e){return(e&131068)>>2}function sm(e,n){return e&-131069|n<<2}function uD(e){return(e&1)===1}function Om(e){return e|1}function fD(e,n,t,r,o,i){let a=i?n.classBindings:n.styleBindings,l=la(a),u=cs(a);e[r]=t;let p=!1,g;if(Array.isArray(t)){let m=t;g=m[1],(g===null||Xa(m,g)>0)&&(p=!0)}else g=t;if(o)if(u!==0){let v=la(e[l+1]);e[r+1]=Xd(v,l),v!==0&&(e[v+1]=sm(e[v+1],r)),e[l+1]=dD(e[l+1],r)}else e[r+1]=Xd(l,0),l!==0&&(e[l+1]=sm(e[l+1],r)),l=r;else e[r+1]=Xd(u,0),l===0?l=r:e[u+1]=sm(e[u+1],r),u=r;p&&(e[r+1]=Em(e[r+1])),O_(e,g,r,!0),O_(e,g,r,!1),pD(n,g,e,r,i),a=Xd(l,u),i?n.classBindings=a:n.styleBindings=a}function pD(e,n,t,r,o){let i=o?e.residualClasses:e.residualStyles;i!=null&&typeof n=="string"&&Xa(i,n)>=0&&(t[r+1]=Om(t[r+1]))}function O_(e,n,t,r){let o=e[t+1],i=n===null,a=r?la(o):cs(o),l=!1;for(;a!==0&&(l===!1||i);){let u=e[a],p=e[a+1];gD(u,n)&&(l=!0,e[a+1]=r?Om(p):Em(p)),a=r?la(p):cs(p)}l&&(e[t+1]=r?Em(o):Om(o))}function gD(e,n){return e===null||n==null||(Array.isArray(e)?e[1]:e)===n?!0:Array.isArray(e)&&typeof n=="string"?Xa(e,n)>=0:!1}var Jr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function mD(e){return e.substring(Jr.key,Jr.keyEnd)}function hD(e){return vD(e),db(e,ub(e,0,Jr.textEnd))}function db(e,n){let t=Jr.textEnd;return t===n?-1:(n=Jr.keyEnd=xD(e,Jr.key=n,t),ub(e,n,t))}function vD(e){Jr.key=0,Jr.keyEnd=0,Jr.value=0,Jr.valueEnd=0,Jr.textEnd=e.length}function ub(e,n,t){for(;n<t&&e.charCodeAt(n)<=32;)n++;return n}function xD(e,n,t){for(;n<t&&e.charCodeAt(n)>32;)n++;return n}function nn(e,n,t){return fb(e,n,t,!1),nn}function Fn(e,n){return fb(e,n,null,!0),Fn}function st(e){CD(OD,_D,e,!0)}function _D(e,n){for(let t=hD(n);t>=0;t=db(n,t))Fd(e,mD(n),!0)}function fb(e,n,t,r){let o=it(),i=Cn(),a=wc(2);if(i.firstUpdatePass&&gb(i,e,a,r),n!==$n&&to(o,a,n)){let l=i.data[yo()];mb(i,l,o,o[qt],e,o[a+1]=PD(n,t),r,a)}}function CD(e,n,t,r){let o=Cn(),i=wc(2);o.firstUpdatePass&&gb(o,null,i,r);let a=it();if(t!==$n&&to(a,i,t)){let l=o.data[yo()];if(hb(l,r)&&!pb(o,i)){let u=r?l.classesWithoutHost:l.stylesWithoutHost;u!==null&&(t=Dd(u,t||"")),wm(o,l,a,t,r)}else TD(o,l,a,a[qt],a[i+1],a[i+1]=ED(e,n,t),r,i)}}function pb(e,n){return n>=e.expandoStartIndex}function gb(e,n,t,r){let o=e.data;if(o[t+1]===null){let i=o[yo()],a=pb(e,t);hb(i,r)&&n===null&&!a&&(n=!1),n=bD(o,i,n,r),fD(o,i,n,t,a,r)}}function bD(e,n,t,r){let o=zx(e),i=r?n.residualClasses:n.residualStyles;if(o===null)(r?n.classBindings:n.styleBindings)===0&&(t=cm(null,e,n,t,r),t=Nc(t,n.attrs,r),i=null);else{let a=n.directiveStylingLast;if(a===-1||e[a]!==o)if(t=cm(o,e,n,t,r),i===null){let u=yD(e,n,r);u!==void 0&&Array.isArray(u)&&(u=cm(null,e,n,u[1],r),u=Nc(u,n.attrs,r),MD(e,n,r,u))}else i=wD(e,n,r)}return i!==void 0&&(r?n.residualClasses=i:n.residualStyles=i),t}function yD(e,n,t){let r=t?n.classBindings:n.styleBindings;if(cs(r)!==0)return e[la(r)]}function MD(e,n,t,r){let o=t?n.classBindings:n.styleBindings;e[la(o)]=r}function wD(e,n,t){let r,o=n.directiveEnd;for(let i=1+n.directiveStylingLast;i<o;i++){let a=e[i].hostAttrs;r=Nc(r,a,t)}return Nc(r,n.attrs,t)}function cm(e,n,t,r,o){let i=null,a=t.directiveEnd,l=t.directiveStylingLast;for(l===-1?l=t.directiveStart:l++;l<a&&(i=n[l],r=Nc(r,i.hostAttrs,o),i!==e);)l++;return e!==null&&(t.directiveStylingLast=l),r}function Nc(e,n,t){let r=t?1:2,o=-1;if(n!==null)for(let i=0;i<n.length;i++){let a=n[i];typeof a=="number"?o=a:o===r&&(Array.isArray(e)||(e=e===void 0?[]:["",e]),Fd(e,a,t?!0:n[++i]))}return e===void 0?null:e}function ED(e,n,t){if(t==null||t==="")return er;let r=[],o=ls(t);if(Array.isArray(o))for(let i=0;i<o.length;i++)e(r,o[i],!0);else if(o instanceof Set)for(let i of o)e(r,i,!0);else if(typeof o=="object")for(let i in o)o.hasOwnProperty(i)&&e(r,i,o[i]);else typeof o=="string"&&n(r,o);return r}function OD(e,n,t){let r=String(n);r!==""&&!r.includes(" ")&&Fd(e,r,t)}function TD(e,n,t,r,o,i,a,l){o===$n&&(o=er);let u=0,p=0,g=0<o.length?o[0]:null,m=0<i.length?i[0]:null;for(;g!==null||m!==null;){let v=u<o.length?o[u+1]:void 0,h=p<i.length?i[p+1]:void 0,b=null,x;g===m?(u+=2,p+=2,v!==h&&(b=m,x=h)):m===null||g!==null&&g<m?(u+=2,b=g):(p+=2,b=m,x=h),b!==null&&mb(e,n,t,r,b,x,a,l),g=u<o.length?o[u]:null,m=p<i.length?i[p]:null}}function mb(e,n,t,r,o,i,a,l){if(!(n.type&3))return;let u=e.data,p=u[l+1],g=uD(p)?T_(u,n,t,o,cs(p),a):void 0;if(!pu(g)){pu(i)||lD(p)&&(i=T_(u,null,t,o,l,a));let m=Dg(yo(),t);CP(r,a,m,o,i)}}function T_(e,n,t,r,o,i){let a=n===null,l;for(;o>0;){let u=e[o],p=Array.isArray(u),g=p?u[1]:u,m=g===null,v=t[o+1];v===$n&&(v=m?er:void 0);let h=m?Rd(v,r):g===r?v:void 0;if(p&&!pu(h)&&(h=Rd(u,r)),pu(h)&&(l=h,a))return l;let b=e[o+1];o=a?la(b):cs(b)}if(n!==null){let u=i?n.residualClasses:n.residualStyles;u!=null&&(l=Rd(u,r))}return l}function pu(e){return e!==void 0}function PD(e,n){return e==null||e===""||(typeof n=="string"?e=e+n:typeof e=="object"&&(e=Uo(ls(e)))),e}function hb(e,n){return(e.flags&(n?8:16))!==0}function d(e,n=""){let t=it(),r=Cn(),o=e+tn,i=r.firstCreatePass?Vc(r,o,1,n,null):r.data[o],a=SD(r,t,i,n);t[o]=a,Hd()&&Wm(r,t,a,i),ns(i,!1)}var SD=(e,n,t,r)=>($d(!0),FT(n[qt],r));function vb(e,n,t,r=""){return to(e,rs(),t)?n+Ho(t)+r:$n}function DD(e,n,t,r,o,i=""){let a=Hg(),l=Jm(e,a,t,o);return wc(2),l?n+Ho(t)+r+Ho(o)+i:$n}function kD(e,n,t,r,o,i,a,l=""){let u=Hg(),p=xS(e,u,t,o,a);return wc(3),p?n+Ho(t)+r+Ho(o)+i+Ho(a)+l:$n}function M(e){return ue("",e),M}function ue(e,n,t){let r=it(),o=vb(r,e,n,t);return o!==$n&&fh(r,yo(),o),ue}function Ue(e,n,t,r,o){let i=it(),a=DD(i,e,n,t,r,o);return a!==$n&&fh(i,yo(),a),Ue}function ku(e,n,t,r,o,i,a){let l=it(),u=kD(l,e,n,t,r,o,i,a);return u!==$n&&fh(l,yo(),u),ku}function fh(e,n,t){let r=Dg(n,e);RT(e[qt],r,t)}function T(e,n,t){rh(n)&&(n=n());let r=it(),o=rs();if(to(r,o,n)){let i=Cn(),a=zd();TC(a,r,e,n,r[qt],t)}return T}function S(e,n){let t=rh(e);return t&&e.set(n),t}function P(e,n){let t=it(),r=Cn(),o=rr();return lb(r,t,t[qt],o,e,n),P}function ph(e,n,t=""){return vb(it(),e,n,t)}function P_(e,n,t){let r=Cn();r.firstCreatePass&&xb(n,r.data,r.blueprint,bo(e),t)}function xb(e,n,t,r,o){if(e=kn(e),Array.isArray(e))for(let i=0;i<e.length;i++)xb(e[i],n,t,r,o);else{let i=Cn(),a=it(),l=rr(),u=Yi(e)?e:kn(e.provide),p=wg(e),g=l.providerIndexes&1048575,m=l.directiveStart,v=l.providerIndexes>>20;if(Yi(e)||!e.multi){let h=new ia(p,o,j,null),b=dm(u,n,o?g:g+v,m);b===-1?(fm(ru(l,a),i,u),lm(i,e,n.length),n.push(u),l.directiveStart++,l.directiveEnd++,o&&(l.providerIndexes+=1048576),t.push(h),a.push(h)):(t[b]=h,a[b]=h)}else{let h=dm(u,n,g+v,m),b=dm(u,n,g,g+v),x=h>=0&&t[h],y=b>=0&&t[b];if(o&&!y||!o&&!x){fm(ru(l,a),i,u);let A=ND(o?AD:ID,t.length,o,r,p,e);!o&&y&&(t[b].providerFactory=A),lm(i,e,n.length,0),n.push(u),l.directiveStart++,l.directiveEnd++,o&&(l.providerIndexes+=1048576),t.push(A),a.push(A)}else{let A=_b(t[o?b:h],p,!o&&r);lm(i,e,h>-1?h:b,A)}!o&&r&&y&&t[b].componentProviders++}}}function lm(e,n,t,r){let o=Yi(n),i=Ex(n);if(o||i){let u=(i?kn(n.useClass):n).prototype.ngOnDestroy;if(u){let p=e.destroyHooks||(e.destroyHooks=[]);if(!o&&n.multi){let g=p.indexOf(t);g===-1?p.push(t,[r,u]):p[g+1].push(r,u)}else p.push(t,u)}}}function _b(e,n,t){return t&&e.componentProviders++,e.multi.push(n)-1}function dm(e,n,t,r){for(let o=t;o<r;o++)if(n[o]===e)return o;return-1}function ID(e,n,t,r,o){return Tm(this.multi,[])}function AD(e,n,t,r,o){let i=this.multi,a;if(this.providerFactory){let l=this.providerFactory.componentProviders,u=ou(r,r[Ke],this.providerFactory.index,o);a=u.slice(0,l),Tm(i,a);for(let p=l;p<u.length;p++)a.push(u[p])}else a=[],Tm(i,a);return a}function Tm(e,n){for(let t=0;t<e.length;t++){let r=e[t];n.push(r())}return n}function ND(e,n,t,r,o,i){let a=new ia(e,t,j,null);return a.multi=[],a.index=n,a.componentProviders=0,_b(a,o,r&&!t),a}function Zo(e,n){return t=>{t.providersResolver=(r,o)=>P_(r,o?o(e):e,!1),n&&(t.viewProvidersResolver=(r,o)=>P_(r,o?o(n):n,!0))}}function Cb(e,n){let t=e[n];return t===$n?void 0:t}function FD(e,n,t,r,o,i){let a=n+t;return to(e,a,o)?XC(e,a+1,i?r.call(i,o):r(o)):Cb(e,a+1)}function RD(e,n,t,r,o,i,a){let l=n+t;return Jm(e,l,o,i)?XC(e,l+2,a?r.call(a,o,i):r(o,i)):Cb(e,l+2)}function He(e,n){let t=Cn(),r,o=e+tn;t.firstCreatePass?(r=LD(n,t.pipeRegistry),t.data[o]=r,r.onDestroy&&(t.destroyHooks??=[]).push(o,r.onDestroy)):r=t.data[o];let i=r.factory||(r.factory=pi(r.type,!0)),a,l=Jn(j);try{let u=nu(!1),p=i();return nu(u),Ig(t,it(),o,p),p}finally{Jn(l)}}function LD(e,n){if(n)for(let t=n.length-1;t>=0;t--){let r=n[t];if(e===r.name)return r}}function gh(e,n,t){let r=e+tn,o=it(),i=kg(o,r);return bb(o,r)?FD(o,zg(),n,i.transform,t,i):i.transform(t)}function $e(e,n,t,r){let o=e+tn,i=it(),a=kg(i,o);return bb(i,o)?RD(i,zg(),n,a.transform,t,r,a):a.transform(t,r)}function bb(e,n){return e[Ke].data[n].pure}var Yd=null;function yb(e){Yd!==null&&(e.defaultEncapsulation!==Yd.defaultEncapsulation||e.preserveWhitespaces!==Yd.preserveWhitespaces)||(Yd=e)}var gu=class{ngModuleFactory;componentFactories;constructor(n,t){this.ngModuleFactory=n,this.componentFactories=t}},mh=(()=>{class e{compileModuleSync(t){return new Ac(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),o=mg(t),i=uC(o.declarations).reduce((a,l)=>{let u=zo(l);return u&&a.push(new sa(u)),a},[]);return new gu(r,i)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Mb=new Me("");var wb=(()=>{class e{applicationErrorHandler=K(Fr);appRef=K(Eo);taskService=K($o);ngZone=K(_n);zonelessEnabled=K(Ec);tracing=K(qo,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Tn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(uc):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(K(Qg,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{let t=this.taskService.add();if(!this.runningTick&&(this.cleanup(),!this.zonelessEnabled||this.appRef.includeAllTestViews)){this.taskService.remove(t);return}this.switchToMicrotaskScheduler(),this.taskService.remove(t)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{let t=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})})}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?Qx:Yg;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(uc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.applicationErrorHandler(r)}finally{this.taskService.remove(t),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Eb(){return[{provide:mi,useExisting:wb},{provide:_n,useClass:fc},{provide:Ec,useValue:!0}]}function BD(){return typeof $localize<"u"&&$localize.locale||Wc}var ps=new Me("",{factory:()=>K(ps,{optional:!0,skipSelf:!0})||BD()});function Oo(e,n){return Ql(e,n?.equal)}var Ab=Symbol("InputSignalNode#UNSET"),ZD=nt(Y({},Jl),{transformFn:void 0,applyValueToInputSignal(e,n){rc(e,n)}});function Nb(e,n){let t=Object.create(ZD);t.value=e,t.transformFn=n?.transform;function r(){if(ec(t),t.value===Ab){let o=null;throw new ge(-950,o)}return t.value}return r[Qn]=t,r}var Iu=class{attributeName;constructor(n){this.attributeName=n}__NG_ELEMENT_ID__=()=>Rc(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}};function Ob(e,n){return Nb(e,n)}function QD(e){return Nb(Ab,e)}var Fb=(Ob.required=QD,Ob);function JD(e,n,t){let r=new Ac(t);return Promise.resolve(r)}function Tb(e){for(let n=e.length-1;n>=0;n--)if(e[n]!==void 0)return e[n]}var Au=new Me(""),ek=new Me("");function zc(e){return!e.moduleRef}function tk(e){let n=zc(e)?e.r3Injector:e.moduleRef.injector,t=n.get(_n);return t.run(()=>{zc(e)?e.r3Injector.resolveInjectorInitializers():e.moduleRef.resolveInjectorInitializers();let r=n.get(Fr),o;if(t.runOutsideAngular(()=>{o=t.onError.subscribe({next:r})}),zc(e)){let i=()=>n.destroy(),a=e.platformInjector.get(Au);a.add(i),n.onDestroy(()=>{o.unsubscribe(),a.delete(i)})}else{let i=()=>e.moduleRef.destroy(),a=e.platformInjector.get(Au);a.add(i),e.moduleRef.onDestroy(()=>{Sc(e.allPlatformModules,e.moduleRef),o.unsubscribe(),a.delete(i)})}return rk(r,t,()=>{let i=n.get($o),a=i.add(),l=n.get(sh);return l.runInitializers(),l.donePromise.then(()=>{let u=n.get(ps,Wc);if(cb(u||Wc),!n.get(ek,!0))return zc(e)?n.get(Eo):(e.allPlatformModules.push(e.moduleRef),e.moduleRef);if(zc(e)){let g=n.get(Eo);return e.rootComponent!==void 0&&g.bootstrap(e.rootComponent),g}else return Rb?.(e.moduleRef,e.allPlatformModules),e.moduleRef}).finally(()=>{i.remove(a)})})})}var Rb;function Pb(){Rb=nk}function nk(e,n){let t=e.injector.get(Eo);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(e.instance.ngDoBootstrap)e.instance.ngDoBootstrap(t);else throw new ge(-403,!1);n.push(e)}function rk(e,n,t){try{let r=t();return Oi(r)?r.catch(o=>{throw n.runOutsideAngular(()=>e(o)),o}):r}catch(r){throw n.runOutsideAngular(()=>e(r)),r}}var Lb=(()=>{class e{_injector;_modules=[];_destroyListeners=[];_destroyed=!1;constructor(t){this._injector=t}bootstrapModuleFactory(t,r){let o=[Eb(),...r?.applicationProviders??[],e_],i=JC(t.moduleType,this.injector,o);return Pb(),tk({moduleRef:i,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(t,r=[]){let o=ch({},r);return Pb(),JD(this.injector,o,t).then(i=>this.bootstrapModuleFactory(i,o))}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ge(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());let t=this._injector.get(Au,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static \u0275fac=function(r){return new(r||e)(Le(Hn))};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),Ch=null;function ok(e){if(yh())throw new ge(400,!1);ab(),Ch=e;let n=e.get(Lb);return sk(e),n}function bh(e,n,t=[]){let r=`Platform: ${n}`,o=new Me(r);return(i=[])=>{let a=yh();if(!a){let l=[...t,...i,{provide:o,useValue:!0}];a=e?.(l)??ok(ik(l,r))}return ak(o)}}function ik(e=[],n){return Hn.create({name:n,providers:[{provide:mc,useValue:"platform"},{provide:Au,useValue:new Set([()=>Ch=null])},...e]})}function ak(e){let n=yh();if(!n)throw new ge(-401,!1);return n}function yh(){return Ch?.get(Lb)??null}function sk(e){let n=e.get(vu,null);pn(e,()=>{n?.forEach(t=>t())})}var ck=1e4;var WZ=ck-1e3;var Se=(()=>{class e{static __NG_ELEMENT_ID__=lk}return e})();function lk(e){return dk(rr(),it(),(e&16)===16)}function dk(e,n,t){if(Ci(e)&&!t){let r=Nr(e.index,n);return new Ei(r,r)}else if(e.type&175){let r=n[ur];return new Ei(r,n)}return null}var hh=class{supports(n){return Qm(n)}create(n){return new vh(n)}},uk=(e,n)=>n,vh=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(n){this._trackByFn=n||uk}forEachItem(n){let t;for(t=this._itHead;t!==null;t=t._next)n(t)}forEachOperation(n){let t=this._itHead,r=this._removalsHead,o=0,i=null;for(;t||r;){let a=!r||t&&t.currentIndex<Sb(r,o,i)?t:r,l=Sb(a,o,i),u=a.currentIndex;if(a===r)o--,r=r._nextRemoved;else if(t=t._next,a.previousIndex==null)o++;else{i||(i=[]);let p=l-o,g=u-o;if(p!=g){for(let v=0;v<p;v++){let h=v<i.length?i[v]:i[v]=0,b=h+v;g<=b&&b<p&&(i[v]=h+1)}let m=a.previousIndex;i[m]=g-p}}l!==u&&n(a,l,u)}}forEachPreviousItem(n){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)n(t)}forEachMovedItem(n){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)n(t)}forEachIdentityChange(n){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)n(t)}diff(n){if(n==null&&(n=[]),!Qm(n))throw new ge(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let t=this._itHead,r=!1,o,i,a;if(Array.isArray(n)){this.length=n.length;for(let l=0;l<this.length;l++)i=n[l],a=this._trackByFn(l,i),t===null||!Object.is(t.trackById,a)?(t=this._mismatch(t,i,a,l),r=!0):(r&&(t=this._verifyReinsertion(t,i,a,l)),Object.is(t.item,i)||this._addIdentityChange(t,i)),t=t._next}else o=0,GC(n,l=>{a=this._trackByFn(o,l),t===null||!Object.is(t.trackById,a)?(t=this._mismatch(t,l,a,o),r=!0):(r&&(t=this._verifyReinsertion(t,l,a,o)),Object.is(t.item,l)||this._addIdentityChange(t,l)),t=t._next,o++}),this.length=o;return this._truncate(t),this.collection=n,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;n!==null;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;n!==null;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;n!==null;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,t,r,o){let i;return n===null?i=this._itTail:(i=n._prev,this._remove(n)),n=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),n!==null?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._reinsertAfter(n,i,o)):(n=this._linkedRecords===null?null:this._linkedRecords.get(r,o),n!==null?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._moveAfter(n,i,o)):n=this._addAfter(new xh(t,r),i,o)),n}_verifyReinsertion(n,t,r,o){let i=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return i!==null?n=this._reinsertAfter(i,n._prev,o):n.currentIndex!=o&&(n.currentIndex=o,this._addToMoves(n,o)),n}_truncate(n){for(;n!==null;){let t=n._next;this._addToRemovals(this._unlink(n)),n=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(n);let o=n._prevRemoved,i=n._nextRemoved;return o===null?this._removalsHead=i:o._nextRemoved=i,i===null?this._removalsTail=o:i._prevRemoved=o,this._insertAfter(n,t,r),this._addToMoves(n,r),n}_moveAfter(n,t,r){return this._unlink(n),this._insertAfter(n,t,r),this._addToMoves(n,r),n}_addAfter(n,t,r){return this._insertAfter(n,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=n:this._additionsTail=this._additionsTail._nextAdded=n,n}_insertAfter(n,t,r){let o=t===null?this._itHead:t._next;return n._next=o,n._prev=t,o===null?this._itTail=n:o._prev=n,t===null?this._itHead=n:t._next=n,this._linkedRecords===null&&(this._linkedRecords=new Nu),this._linkedRecords.put(n),n.currentIndex=r,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){this._linkedRecords!==null&&this._linkedRecords.remove(n);let t=n._prev,r=n._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,n}_addToMoves(n,t){return n.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=n:this._movesTail=this._movesTail._nextMoved=n),n}_addToRemovals(n){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Nu),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,t){return n.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=n:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=n,n}},xh=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(n,t){this.item=n,this.trackById=t}},_h=class{_head=null;_tail=null;add(n){this._head===null?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,n))return r;return null}remove(n){let t=n._prevDup,r=n._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Nu=class{map=new Map;put(n){let t=n.trackById,r=this.map.get(t);r||(r=new _h,this.map.set(t,r)),r.add(n)}get(n,t){let r=n,o=this.map.get(r);return o?o.get(n,t):null}remove(n){let t=n.trackById;return this.map.get(t).remove(n)&&this.map.delete(t),n}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function Sb(e,n,t){let r=e.previousIndex;if(r===null)return r;let o=0;return t&&r<t.length&&(o=t[r]),r+n+o}function Db(){return new Mh([new hh])}var Mh=(()=>{class e{factories;static \u0275prov=we({token:e,providedIn:"root",factory:Db});constructor(t){this.factories=t}static create(t,r){if(r!=null){let o=r.factories.slice();t=t.concat(o)}return new e(t)}static extend(t){return{provide:e,useFactory:()=>{let r=K(e,{optional:!0,skipSelf:!0});return e.create(t,r||Db())}}}find(t){let r=this.factories.find(o=>o.supports(t));if(r!=null)return r;throw new ge(901,!1)}}return e})();var Bb=bh(null,"core",[]),Vb=(()=>{class e{constructor(t){}static \u0275fac=function(r){return new(r||e)(Le(Eo))};static \u0275mod=ft({type:e});static \u0275inj=dt({})}return e})();function ua(e){return typeof e=="boolean"?e:e!=null&&e!=="false"}function jb(e){let n=zo(e);if(!n)return null;let t=new sa(n);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}var Ub=null;function yr(){return Ub}function wh(e){Ub??=e}var Hc=class{},Qo=(()=>{class e{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:()=>K(Wb),providedIn:"platform"})}return e})(),Eh=new Me(""),Wb=(()=>{class e extends Qo{_location;_history;_doc=K(Yt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return yr().getBaseHref(this._doc)}onPopState(t){let r=yr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=yr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,o){this._history.pushState(t,r,o)}replaceState(t,r,o){this._history.replaceState(t,r,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:()=>new e,providedIn:"platform"})}return e})();function Fu(e,n){return e?n?e.endsWith("/")?n.startsWith("/")?e+n.slice(1):e+n:n.startsWith("/")?e+n:`${e}/${n}`:e:n}function zb(e){let n=e.search(/#|\?|$/);return e[n-1]==="/"?e.slice(0,n-1)+e.slice(n):e}function oo(e){return e&&e[0]!=="?"?`?${e}`:e}var io=(()=>{class e{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:()=>K(Lu),providedIn:"root"})}return e})(),Ru=new Me(""),Lu=(()=>{class e extends io{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??K(Yt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Fu(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+oo(this._platformLocation.search),o=this._platformLocation.hash;return o&&t?`${r}${o}`:r}pushState(t,r,o,i){let a=this.prepareExternalUrl(o+oo(i));this._platformLocation.pushState(t,r,a)}replaceState(t,r,o,i){let a=this.prepareExternalUrl(o+oo(i));this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||e)(Le(Qo),Le(Ru,8))};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Ti=(()=>{class e{_subject=new fn;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=gk(zb(Hb(r))),this._locationStrategy.onPopState(o=>{this._subject.next({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+oo(r))}normalize(t){return e.stripTrailingSlash(pk(this._basePath,Hb(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",o=null){this._locationStrategy.pushState(o,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+oo(r)),o)}replaceState(t,r="",o=null){this._locationStrategy.replaceState(o,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+oo(r)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(o=>o(t,r))}subscribe(t,r,o){return this._subject.subscribe({next:t,error:r??void 0,complete:o??void 0})}static normalizeQueryParams=oo;static joinWithSlash=Fu;static stripTrailingSlash=zb;static \u0275fac=function(r){return new(r||e)(Le(io))};static \u0275prov=we({token:e,factory:()=>fk(),providedIn:"root"})}return e})();function fk(){return new Ti(Le(io))}function pk(e,n){if(!e||!n.startsWith(e))return n;let t=n.substring(e.length);return t===""||["/",";","?","#"].includes(t[0])?t:n}function Hb(e){return e.replace(/\/index.html$/,"")}function gk(e){if(new RegExp("^(https?:)?//").test(e)){let[,t]=e.split(/\/\/[^\/]+/);return t}return e}var Ih=(()=>{class e extends io{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=Fu(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,o,i){let a=this.prepareExternalUrl(o+oo(i))||this._platformLocation.pathname;this._platformLocation.pushState(t,r,a)}replaceState(t,r,o,i){let a=this.prepareExternalUrl(o+oo(i))||this._platformLocation.pathname;this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||e)(Le(Qo),Le(Ru,8))};static \u0275prov=we({token:e,factory:e.\u0275fac})}return e})();var Ah=(function(e){return e[e.Decimal=0]="Decimal",e[e.Percent=1]="Percent",e[e.Currency=2]="Currency",e[e.Scientific=3]="Scientific",e})(Ah||{});var Gn=(function(e){return e[e.Format=0]="Format",e[e.Standalone=1]="Standalone",e})(Gn||{}),Nt=(function(e){return e[e.Narrow=0]="Narrow",e[e.Abbreviated=1]="Abbreviated",e[e.Wide=2]="Wide",e[e.Short=3]="Short",e})(Nt||{}),pr=(function(e){return e[e.Short=0]="Short",e[e.Medium=1]="Medium",e[e.Long=2]="Long",e[e.Full=3]="Full",e})(pr||{}),gr={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function Kb(e){return fr(e)[Qt.LocaleId]}function Zb(e,n,t){let r=fr(e),o=[r[Qt.DayPeriodsFormat],r[Qt.DayPeriodsStandalone]],i=Br(o,n);return Br(i,t)}function Qb(e,n,t){let r=fr(e),o=[r[Qt.DaysFormat],r[Qt.DaysStandalone]],i=Br(o,n);return Br(i,t)}function Jb(e,n,t){let r=fr(e),o=[r[Qt.MonthsFormat],r[Qt.MonthsStandalone]],i=Br(o,n);return Br(i,t)}function ey(e,n){let r=fr(e)[Qt.Eras];return Br(r,n)}function $c(e,n){let t=fr(e);return Br(t[Qt.DateFormat],n)}function Gc(e,n){let t=fr(e);return Br(t[Qt.TimeFormat],n)}function qc(e,n){let r=fr(e)[Qt.DateTimeFormat];return Br(r,n)}function To(e,n){let t=fr(e),r=t[Qt.NumberSymbols][n];if(typeof r>"u"){if(n===gr.CurrencyDecimal)return t[Qt.NumberSymbols][gr.Decimal];if(n===gr.CurrencyGroup)return t[Qt.NumberSymbols][gr.Group]}return r}function ty(e,n){return fr(e)[Qt.NumberFormats][n]}function ny(e){if(!e[Qt.ExtraData])throw new ge(2303,!1)}function ry(e){let n=fr(e);return ny(n),(n[Qt.ExtraData][2]||[]).map(r=>typeof r=="string"?Oh(r):[Oh(r[0]),Oh(r[1])])}function oy(e,n,t){let r=fr(e);ny(r);let o=[r[Qt.ExtraData][0],r[Qt.ExtraData][1]],i=Br(o,n)||[];return Br(i,t)||[]}function Br(e,n){for(let t=n;t>-1;t--)if(typeof e[t]<"u")return e[t];throw new ge(2304,!1)}function Oh(e){let[n,t]=e.split(":");return{hours:+n,minutes:+t}}var mk=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Bu={},hk=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function iy(e,n,t,r){let o=Ek(e);n=Jo(t,n)||n;let a=[],l;for(;n;)if(l=hk.exec(n),l){a=a.concat(l.slice(1));let g=a.pop();if(!g)break;n=g}else{a.push(n);break}let u=o.getTimezoneOffset();r&&(u=sy(r,u),o=wk(o,r));let p="";return a.forEach(g=>{let m=yk(g);p+=m?m(o,t,u):g==="''"?"'":g.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),p}function zu(e,n,t){let r=new Date(0);return r.setFullYear(e,n,t),r.setHours(0,0,0),r}function Jo(e,n){let t=Kb(e);if(Bu[t]??={},Bu[t][n])return Bu[t][n];let r="";switch(n){case"shortDate":r=$c(e,pr.Short);break;case"mediumDate":r=$c(e,pr.Medium);break;case"longDate":r=$c(e,pr.Long);break;case"fullDate":r=$c(e,pr.Full);break;case"shortTime":r=Gc(e,pr.Short);break;case"mediumTime":r=Gc(e,pr.Medium);break;case"longTime":r=Gc(e,pr.Long);break;case"fullTime":r=Gc(e,pr.Full);break;case"short":let o=Jo(e,"shortTime"),i=Jo(e,"shortDate");r=Vu(qc(e,pr.Short),[o,i]);break;case"medium":let a=Jo(e,"mediumTime"),l=Jo(e,"mediumDate");r=Vu(qc(e,pr.Medium),[a,l]);break;case"long":let u=Jo(e,"longTime"),p=Jo(e,"longDate");r=Vu(qc(e,pr.Long),[u,p]);break;case"full":let g=Jo(e,"fullTime"),m=Jo(e,"fullDate");r=Vu(qc(e,pr.Full),[g,m]);break}return r&&(Bu[t][n]=r),r}function Vu(e,n){return n&&(e=e.replace(/\{([^}]+)}/g,function(t,r){return n!=null&&r in n?n[r]:t})),e}function ao(e,n,t="-",r,o){let i="";(e<0||o&&e<=0)&&(o?e=-e+1:(e=-e,i=t));let a=String(e);for(;a.length<n;)a="0"+a;return r&&(a=a.slice(a.length-n)),i+a}function vk(e,n){return ao(e,3).substring(0,n)}function sn(e,n,t=0,r=!1,o=!1){return function(i,a){let l=xk(e,i);if((t>0||l>-t)&&(l+=t),e===3)l===0&&t===-12&&(l=12);else if(e===6)return vk(l,n);let u=To(a,gr.MinusSign);return ao(l,n,u,r,o)}}function xk(e,n){switch(e){case 0:return n.getFullYear();case 1:return n.getMonth();case 2:return n.getDate();case 3:return n.getHours();case 4:return n.getMinutes();case 5:return n.getSeconds();case 6:return n.getMilliseconds();case 7:return n.getDay();default:throw new ge(2301,!1)}}function jt(e,n,t=Gn.Format,r=!1){return function(o,i){return _k(o,i,e,n,t,r)}}function _k(e,n,t,r,o,i){switch(t){case 2:return Jb(n,o,r)[e.getMonth()];case 1:return Qb(n,o,r)[e.getDay()];case 0:let a=e.getHours(),l=e.getMinutes();if(i){let p=ry(n),g=oy(n,o,r),m=p.findIndex(v=>{if(Array.isArray(v)){let[h,b]=v,x=a>=h.hours&&l>=h.minutes,y=a<b.hours||a===b.hours&&l<b.minutes;if(h.hours<b.hours){if(x&&y)return!0}else if(x||y)return!0}else if(v.hours===a&&v.minutes===l)return!0;return!1});if(m!==-1)return g[m]}return Zb(n,o,r)[a<12?0:1];case 3:return ey(n,r)[e.getFullYear()<=0?0:1];default:let u=t;throw new ge(2302,!1)}}function ju(e){return function(n,t,r){let o=-1*r,i=To(t,gr.MinusSign),a=o>0?Math.floor(o/60):Math.ceil(o/60);switch(e){case 0:return(o>=0?"+":"")+ao(a,2,i)+ao(Math.abs(o%60),2,i);case 1:return"GMT"+(o>=0?"+":"")+ao(a,1,i);case 2:return"GMT"+(o>=0?"+":"")+ao(a,2,i)+":"+ao(Math.abs(o%60),2,i);case 3:return r===0?"Z":(o>=0?"+":"")+ao(a,2,i)+":"+ao(Math.abs(o%60),2,i);default:throw new ge(2310,!1)}}}var Ck=0,Wu=4;function bk(e){let n=zu(e,Ck,1).getDay();return zu(e,0,1+(n<=Wu?Wu:Wu+7)-n)}function ay(e){let n=e.getDay(),t=n===0?-3:Wu-n;return zu(e.getFullYear(),e.getMonth(),e.getDate()+t)}function Th(e,n=!1){return function(t,r){let o;if(n){let i=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,a=t.getDate();o=1+Math.floor((a+i)/7)}else{let i=ay(t),a=bk(i.getFullYear()),l=i.getTime()-a.getTime();o=1+Math.round(l/6048e5)}return ao(o,e,To(r,gr.MinusSign))}}function Uu(e,n=!1){return function(t,r){let i=ay(t).getFullYear();return ao(i,e,To(r,gr.MinusSign),n)}}var Ph={};function yk(e){if(Ph[e])return Ph[e];let n;switch(e){case"G":case"GG":case"GGG":n=jt(3,Nt.Abbreviated);break;case"GGGG":n=jt(3,Nt.Wide);break;case"GGGGG":n=jt(3,Nt.Narrow);break;case"y":n=sn(0,1,0,!1,!0);break;case"yy":n=sn(0,2,0,!0,!0);break;case"yyy":n=sn(0,3,0,!1,!0);break;case"yyyy":n=sn(0,4,0,!1,!0);break;case"Y":n=Uu(1);break;case"YY":n=Uu(2,!0);break;case"YYY":n=Uu(3);break;case"YYYY":n=Uu(4);break;case"M":case"L":n=sn(1,1,1);break;case"MM":case"LL":n=sn(1,2,1);break;case"MMM":n=jt(2,Nt.Abbreviated);break;case"MMMM":n=jt(2,Nt.Wide);break;case"MMMMM":n=jt(2,Nt.Narrow);break;case"LLL":n=jt(2,Nt.Abbreviated,Gn.Standalone);break;case"LLLL":n=jt(2,Nt.Wide,Gn.Standalone);break;case"LLLLL":n=jt(2,Nt.Narrow,Gn.Standalone);break;case"w":n=Th(1);break;case"ww":n=Th(2);break;case"W":n=Th(1,!0);break;case"d":n=sn(2,1);break;case"dd":n=sn(2,2);break;case"c":case"cc":n=sn(7,1);break;case"ccc":n=jt(1,Nt.Abbreviated,Gn.Standalone);break;case"cccc":n=jt(1,Nt.Wide,Gn.Standalone);break;case"ccccc":n=jt(1,Nt.Narrow,Gn.Standalone);break;case"cccccc":n=jt(1,Nt.Short,Gn.Standalone);break;case"E":case"EE":case"EEE":n=jt(1,Nt.Abbreviated);break;case"EEEE":n=jt(1,Nt.Wide);break;case"EEEEE":n=jt(1,Nt.Narrow);break;case"EEEEEE":n=jt(1,Nt.Short);break;case"a":case"aa":case"aaa":n=jt(0,Nt.Abbreviated);break;case"aaaa":n=jt(0,Nt.Wide);break;case"aaaaa":n=jt(0,Nt.Narrow);break;case"b":case"bb":case"bbb":n=jt(0,Nt.Abbreviated,Gn.Standalone,!0);break;case"bbbb":n=jt(0,Nt.Wide,Gn.Standalone,!0);break;case"bbbbb":n=jt(0,Nt.Narrow,Gn.Standalone,!0);break;case"B":case"BB":case"BBB":n=jt(0,Nt.Abbreviated,Gn.Format,!0);break;case"BBBB":n=jt(0,Nt.Wide,Gn.Format,!0);break;case"BBBBB":n=jt(0,Nt.Narrow,Gn.Format,!0);break;case"h":n=sn(3,1,-12);break;case"hh":n=sn(3,2,-12);break;case"H":n=sn(3,1);break;case"HH":n=sn(3,2);break;case"m":n=sn(4,1);break;case"mm":n=sn(4,2);break;case"s":n=sn(5,1);break;case"ss":n=sn(5,2);break;case"S":n=sn(6,1);break;case"SS":n=sn(6,2);break;case"SSS":n=sn(6,3);break;case"Z":case"ZZ":case"ZZZ":n=ju(0);break;case"ZZZZZ":n=ju(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=ju(1);break;case"OOOO":case"ZZZZ":case"zzzz":n=ju(2);break;default:return null}return Ph[e]=n,n}function sy(e,n){e=e.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(t)?n:t}function Mk(e,n){return e=new Date(e.getTime()),e.setMinutes(e.getMinutes()+n),e}function wk(e,n,t){let o=e.getTimezoneOffset(),i=sy(n,o);return Mk(e,-1*(i-o))}function Ek(e){if($b(e))return e;if(typeof e=="number"&&!isNaN(e))return new Date(e);if(typeof e=="string"){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){let[o,i=1,a=1]=e.split("-").map(l=>+l);return zu(o,i-1,a)}let t=parseFloat(e);if(!isNaN(e-t))return new Date(t);let r;if(r=e.match(mk))return Ok(r)}let n=new Date(e);if(!$b(n))throw new ge(2311,!1);return n}function Ok(e){let n=new Date(0),t=0,r=0,o=e[8]?n.setUTCFullYear:n.setFullYear,i=e[8]?n.setUTCHours:n.setHours;e[9]&&(t=Number(e[9]+e[10]),r=Number(e[9]+e[11])),o.call(n,Number(e[1]),Number(e[2])-1,Number(e[3]));let a=Number(e[4]||0)-t,l=Number(e[5]||0)-r,u=Number(e[6]||0),p=Math.floor(parseFloat("0."+(e[7]||0))*1e3);return i.call(n,a,l,u,p),n}function $b(e){return e instanceof Date&&!isNaN(e.valueOf())}var Tk=/^(\d+)?\.((\d+)(-(\d+))?)?$/,Gb=22,Hu=".",Xc="0",Pk=";",Sk=",",Sh="#";function Dk(e,n,t,r,o,i,a=!1){let l="",u=!1;if(!isFinite(e))l=To(t,gr.Infinity);else{let p=Ak(e);a&&(p=Ik(p));let g=n.minInt,m=n.minFrac,v=n.maxFrac;if(i){let L=i.match(Tk);if(L===null)throw new ge(2306,!1);let V=L[1],X=L[3],ae=L[5];V!=null&&(g=Dh(V)),X!=null&&(m=Dh(X)),ae!=null?v=Dh(ae):X!=null&&m>v&&(v=m)}Nk(p,m,v);let h=p.digits,b=p.integerLen,x=p.exponent,y=[];for(u=h.every(L=>!L);b<g;b++)h.unshift(0);for(;b<0;b++)h.unshift(0);b>0?y=h.splice(b,h.length):(y=h,h=[0]);let A=[];for(h.length>=n.lgSize&&A.unshift(h.splice(-n.lgSize,h.length).join(""));h.length>n.gSize;)A.unshift(h.splice(-n.gSize,h.length).join(""));h.length&&A.unshift(h.join("")),l=A.join(To(t,r)),y.length&&(l+=To(t,o)+y.join("")),x&&(l+=To(t,gr.Exponential)+"+"+x)}return e<0&&!u?l=n.negPre+l+n.negSuf:l=n.posPre+l+n.posSuf,l}function cy(e,n,t){let r=ty(n,Ah.Decimal),o=kk(r,To(n,gr.MinusSign));return Dk(e,o,n,gr.Group,gr.Decimal,t)}function kk(e,n="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(Pk),o=r[0],i=r[1],a=o.indexOf(Hu)!==-1?o.split(Hu):[o.substring(0,o.lastIndexOf(Xc)+1),o.substring(o.lastIndexOf(Xc)+1)],l=a[0],u=a[1]||"";t.posPre=l.substring(0,l.indexOf(Sh));for(let g=0;g<u.length;g++){let m=u.charAt(g);m===Xc?t.minFrac=t.maxFrac=g+1:m===Sh?t.maxFrac=g+1:t.posSuf+=m}let p=l.split(Sk);if(t.gSize=p[1]?p[1].length:0,t.lgSize=p[2]||p[1]?(p[2]||p[1]).length:0,i){let g=o.length-t.posPre.length-t.posSuf.length,m=i.indexOf(Sh);t.negPre=i.substring(0,m).replace(/'/g,""),t.negSuf=i.slice(m+g).replace(/'/g,"")}else t.negPre=n+t.posPre,t.negSuf=t.posSuf;return t}function Ik(e){if(e.digits[0]===0)return e;let n=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(n===0?e.digits.push(0,0):n===1&&e.digits.push(0),e.integerLen+=2),e}function Ak(e){let n=Math.abs(e)+"",t=0,r,o,i,a,l;for((o=n.indexOf(Hu))>-1&&(n=n.replace(Hu,"")),(i=n.search(/e/i))>0?(o<0&&(o=i),o+=+n.slice(i+1),n=n.substring(0,i)):o<0&&(o=n.length),i=0;n.charAt(i)===Xc;i++);if(i===(l=n.length))r=[0],o=1;else{for(l--;n.charAt(l)===Xc;)l--;for(o-=i,r=[],a=0;i<=l;i++,a++)r[a]=Number(n.charAt(i))}return o>Gb&&(r=r.splice(0,Gb-1),t=o-1,o=1),{digits:r,exponent:t,integerLen:o}}function Nk(e,n,t){if(n>t)throw new ge(2307,!1);let r=e.digits,o=r.length-e.integerLen,i=Math.min(Math.max(n,o),t),a=i+e.integerLen,l=r[a];if(a>0){r.splice(Math.max(e.integerLen,a));for(let m=a;m<r.length;m++)r[m]=0}else{o=Math.max(0,o),e.integerLen=1,r.length=Math.max(1,a=i+1),r[0]=0;for(let m=1;m<a;m++)r[m]=0}if(l>=5)if(a-1<0){for(let m=0;m>a;m--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[a-1]++;for(;o<Math.max(0,i);o++)r.push(0);let u=i!==0,p=n+e.integerLen,g=r.reduceRight(function(m,v,h,b){return v=v+m,b[h]=v<10?v:v-10,u&&(b[h]===0&&h>=p?b.pop():u=!1),v>=10?1:0},0);g&&(r.unshift(g),e.integerLen++)}function Dh(e){let n=parseInt(e);if(isNaN(n))throw new ge(2305,!1);return n}var kh=/\s+/,qb=[],Nh=(()=>{class e{_ngEl;_renderer;initialClasses=qb;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(kh):qb}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(kh):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let o=this.stateMap.get(t);o!==void 0?(o.enabled!==r&&(o.changed=!0,o.enabled=r),o.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],o=t[1];o.changed?(this._toggleClass(r,o.enabled),o.changed=!1):o.touched||(o.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),o.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(kh).forEach(o=>{r?this._renderer.addClass(this._ngEl.nativeElement,o):this._renderer.removeClass(this._ngEl.nativeElement,o)})}static \u0275fac=function(r){return new(r||e)(j(Rr),j(ro))};static \u0275dir=Kt({type:e,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return e})();var $u=class{$implicit;ngForOf;index;count;constructor(n,t,r,o){this.$implicit=n,this.ngForOf=t,this.index=r,this.count=o}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Oe=(()=>{class e{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,o){this._viewContainer=t,this._template=r,this._differs=o}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((o,i,a)=>{if(o.previousIndex==null)r.createEmbeddedView(this._template,new $u(o.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)r.remove(i===null?void 0:i);else if(i!==null){let l=r.get(i);r.move(l,a),Xb(l,o)}});for(let o=0,i=r.length;o<i;o++){let l=r.get(o).context;l.index=o,l.count=i,l.ngForOf=this._ngForOf}t.forEachIdentityChange(o=>{let i=r.get(o.currentIndex);Xb(i,o)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||e)(j(da),j(Bc),j(Mh))};static \u0275dir=Kt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return e})();function Xb(e,n){e.context.$implicit=n.item}var Pe=(()=>{class e{_viewContainer;_context=new Gu;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Yb(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Yb(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||e)(j(da),j(Bc))};static \u0275dir=Kt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return e})(),Gu=class{$implicit=null;ngIf=null};function Yb(e,n){if(e&&!e.createEmbeddedView)throw new ge(2020,!1)}function ly(e,n){return new ge(2100,!1)}var Fk="mediumDate",dy=new Me(""),uy=new Me(""),rn=(()=>{class e{locale;defaultTimezone;defaultOptions;constructor(t,r,o){this.locale=t,this.defaultTimezone=r,this.defaultOptions=o}transform(t,r,o,i){if(t==null||t===""||t!==t)return null;try{let a=r??this.defaultOptions?.dateFormat??Fk,l=o??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return iy(t,a,i||this.locale,l)}catch(a){throw ly(e,a.message)}}static \u0275fac=function(r){return new(r||e)(j(ps,16),j(dy,24),j(uy,24))};static \u0275pipe=Ou({name:"date",type:e,pure:!0})}return e})();var fa=(()=>{class e{_locale;constructor(t){this._locale=t}transform(t,r,o){if(!Rk(t))return null;o||=this._locale;try{let i=Lk(t);return cy(i,o,r)}catch(i){throw ly(e,i.message)}}static \u0275fac=function(r){return new(r||e)(j(ps,16))};static \u0275pipe=Ou({name:"number",type:e,pure:!0})}return e})();function Rk(e){return!(e==null||e===""||e!==e)}function Lk(e){if(typeof e=="string"&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if(typeof e!="number")throw new ge(2309,!1);return e}var qn=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({})}return e})();function Yc(e,n){n=encodeURIComponent(n);for(let t of e.split(";")){let r=t.indexOf("="),[o,i]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(o.trim()===n)return decodeURIComponent(i)}return null}var pa=class{};var fy="browser";var Rh=(()=>{class e{static \u0275prov=we({token:e,providedIn:"root",factory:()=>new Fh(K(Yt),window)})}return e})(),Fh=class{document;window;offset=()=>[0,0];constructor(n,t){this.document=n,this.window=t}setOffset(n){Array.isArray(n)?this.offset=()=>n:this.offset=n}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(n,t){this.window.scrollTo(nt(Y({},t),{left:n[0],top:n[1]}))}scrollToAnchor(n,t){let r=Bk(this.document,n);r&&(this.scrollToElement(r,t),r.focus())}setHistoryScrollRestoration(n){try{this.window.history.scrollRestoration=n}catch{console.warn(Wo(2400,!1))}}scrollToElement(n,t){let r=n.getBoundingClientRect(),o=r.left+this.window.pageXOffset,i=r.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(nt(Y({},t),{left:o-a[0],top:i-a[1]}))}};function Bk(e,n){let t=e.getElementById(n)||e.getElementsByName(n)[0];if(t)return t;if(typeof e.createTreeWalker=="function"&&e.body&&typeof e.body.attachShadow=="function"){let r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),o=r.currentNode;for(;o;){let i=o.shadowRoot;if(i){let a=i.getElementById(n)||i.querySelector(`[name="${n}"]`);if(a)return a}o=r.nextNode()}}return null}var Kc=class{_doc;constructor(n){this._doc=n}manager},qu=(()=>{class e extends Kc{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,o,i){return t.addEventListener(r,o,i),()=>this.removeEventListener(t,r,o,i)}removeEventListener(t,r,o,i){return t.removeEventListener(r,o,i)}static \u0275fac=function(r){return new(r||e)(Le(Yt))};static \u0275prov=we({token:e,factory:e.\u0275fac})}return e})(),Ku=new Me(""),jh=(()=>{class e{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(a=>{a.manager=this});let o=t.filter(a=>!(a instanceof qu));this._plugins=o.slice().reverse();let i=t.find(a=>a instanceof qu);i&&this._plugins.push(i)}addEventListener(t,r,o,i){return this._findPluginFor(r).addEventListener(t,r,o,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(i=>i.supports(t)),!r)throw new ge(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||e)(Le(Ku),Le(_n))};static \u0275prov=we({token:e,factory:e.\u0275fac})}return e})(),Lh="ng-app-id";function py(e){for(let n of e)n.remove()}function gy(e,n){let t=n.createElement("style");return t.textContent=e,t}function Vk(e,n,t,r){let o=e.head?.querySelectorAll(`style[${Lh}="${n}"],link[${Lh}="${n}"]`);if(o)for(let i of o)i.removeAttribute(Lh),i instanceof HTMLLinkElement?r.set(i.href.slice(i.href.lastIndexOf("/")+1),{usage:0,elements:[i]}):i.textContent&&t.set(i.textContent,{usage:0,elements:[i]})}function Vh(e,n){let t=n.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),t}var Uh=(()=>{class e{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,o,i={}){this.doc=t,this.appId=r,this.nonce=o,Vk(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let o of t)this.addUsage(o,this.inline,gy);r?.forEach(o=>this.addUsage(o,this.external,Vh))}removeStyles(t,r){for(let o of t)this.removeUsage(o,this.inline);r?.forEach(o=>this.removeUsage(o,this.external))}addUsage(t,r,o){let i=r.get(t);i?i.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(a=>this.addElement(a,o(t,this.doc)))})}removeUsage(t,r){let o=r.get(t);o&&(o.usage--,o.usage<=0&&(py(o.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])py(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:o}]of this.inline)o.push(this.addElement(t,gy(r,this.doc)));for(let[r,{elements:o}]of this.external)o.push(this.addElement(t,Vh(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||e)(Le(Yt),Le(hu),Le(xu,8),Le(Lc))};static \u0275prov=we({token:e,factory:e.\u0275fac})}return e})(),Bh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Wh=/%COMP%/g;var hy="%COMP%",jk=`_nghost-${hy}`,Uk=`_ngcontent-${hy}`,Wk=!0,zk=new Me("",{factory:()=>Wk});function Hk(e){return Uk.replace(Wh,e)}function $k(e){return jk.replace(Wh,e)}function vy(e,n){return n.map(t=>t.replace(Wh,e))}var zh=(()=>{class e{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,r,o,i,a,l,u=null,p=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=i,this.doc=a,this.ngZone=l,this.nonce=u,this.tracingService=p,this.defaultRenderer=new Zc(t,a,l,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let o=this.getOrCreateRenderer(t,r);return o instanceof Yu?o.applyToHost(t):o instanceof Qc&&o.applyStyles(),o}getOrCreateRenderer(t,r){let o=this.rendererByCompId,i=o.get(r.id);if(!i){let a=this.doc,l=this.ngZone,u=this.eventManager,p=this.sharedStylesHost,g=this.removeStylesOnCompDestroy,m=this.tracingService;switch(r.encapsulation){case eo.Emulated:i=new Yu(u,p,r,this.appId,g,a,l,m);break;case eo.ShadowDom:return new Xu(u,t,r,a,l,this.nonce,m,p);case eo.ExperimentalIsolatedShadowDom:return new Xu(u,t,r,a,l,this.nonce,m);default:i=new Qc(u,p,r,g,a,l,m);break}o.set(r.id,i)}return i}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||e)(Le(jh),Le(Uh),Le(hu),Le(zk),Le(Yt),Le(_n),Le(xu),Le(qo,8))};static \u0275prov=we({token:e,factory:e.\u0275fac})}return e})(),Zc=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(n,t,r,o){this.eventManager=n,this.doc=t,this.ngZone=r,this.tracingService=o}destroy(){}destroyNode=null;createElement(n,t){return t?this.doc.createElementNS(Bh[t]||t,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,t){(my(n)?n.content:n).appendChild(t)}insertBefore(n,t,r){n&&(my(n)?n.content:n).insertBefore(t,r)}removeChild(n,t){t.remove()}selectRootElement(n,t){let r=typeof n=="string"?this.doc.querySelector(n):n;if(!r)throw new ge(-5104,!1);return t||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,r,o){if(o){t=o+":"+t;let i=Bh[o];i?n.setAttributeNS(i,t,r):n.setAttribute(t,r)}else n.setAttribute(t,r)}removeAttribute(n,t,r){if(r){let o=Bh[r];o?n.removeAttributeNS(o,t):n.removeAttribute(`${r}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,r,o){o&(wo.DashCase|wo.Important)?n.style.setProperty(t,r,o&wo.Important?"important":""):n.style[t]=r}removeStyle(n,t,r){r&wo.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,r){n!=null&&(n[t]=r)}setValue(n,t){n.nodeValue=t}listen(n,t,r,o){if(typeof n=="string"&&(n=yr().getGlobalEventTarget(this.doc,n),!n))throw new ge(5102,!1);let i=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(i=this.tracingService.wrapEventListener(n,t,i)),this.eventManager.addEventListener(n,t,i,o)}decoratePreventDefault(n){return t=>{if(t==="__ngUnwrap__")return n;n(t)===!1&&t.preventDefault()}}};function my(e){return e.tagName==="TEMPLATE"&&e.content!==void 0}var Xu=class extends Zc{hostEl;sharedStylesHost;shadowRoot;constructor(n,t,r,o,i,a,l,u){super(n,o,i,l),this.hostEl=t,this.sharedStylesHost=u,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let p=r.styles;p=vy(r.id,p);for(let m of p){let v=document.createElement("style");a&&v.setAttribute("nonce",a),v.textContent=m,this.shadowRoot.appendChild(v)}let g=r.getExternalStyles?.();if(g)for(let m of g){let v=Vh(m,o);a&&v.setAttribute("nonce",a),this.shadowRoot.appendChild(v)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,r){return super.insertBefore(this.nodeOrShadowRoot(n),t,r)}removeChild(n,t){return super.removeChild(null,t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},Qc=class extends Zc{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(n,t,r,o,i,a,l,u){super(n,i,a,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=o;let p=r.styles;this.styles=u?vy(u,p):p,this.styleUrls=r.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&ss.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Yu=class extends Qc{contentAttr;hostAttr;constructor(n,t,r,o,i,a,l,u){let p=o+"-"+r.id;super(n,t,r,i,a,l,u,p),this.contentAttr=Hk(p),this.hostAttr=$k(p)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){let r=super.createElement(n,t);return super.setAttribute(r,this.contentAttr,""),r}};var Zu=class e extends Hc{supportsDOMEvents=!0;static makeCurrent(){wh(new e)}onAndCancel(n,t,r,o){return n.addEventListener(t,r,o),()=>{n.removeEventListener(t,r,o)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.remove()}createElement(n,t){return t=t||this.getDefaultDocument(),t.createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return t==="window"?window:t==="document"?n:t==="body"?n.body:null}getBaseHref(n){let t=Gk();return t==null?null:qk(t)}resetBaseElement(){Jc=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return Yc(document.cookie,n)}},Jc=null;function Gk(){return Jc=Jc||document.head.querySelector("base"),Jc?Jc.getAttribute("href"):null}function qk(e){return new URL(e,document.baseURI).pathname}var Qu=class{addToWindow(n){An.getAngularTestability=(r,o=!0)=>{let i=n.findTestabilityInTree(r,o);if(i==null)throw new ge(5103,!1);return i},An.getAllAngularTestabilities=()=>n.getAllTestabilities(),An.getAllAngularRootElements=()=>n.getAllRootElements();let t=r=>{let o=An.getAllAngularTestabilities(),i=o.length,a=function(){i--,i==0&&r()};o.forEach(l=>{l.whenStable(a)})};An.frameworkStabilizers||(An.frameworkStabilizers=[]),An.frameworkStabilizers.push(t)}findTestabilityInTree(n,t,r){if(t==null)return null;let o=n.getTestability(t);return o??(r?yr().isShadowRoot(t)?this.findTestabilityInTree(n,t.host,!0):this.findTestabilityInTree(n,t.parentElement,!0):null)}},Xk=(()=>{class e{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac})}return e})(),xy=["alt","control","meta","shift"],Yk={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Kk={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey},_y=(()=>{class e extends Kc{constructor(t){super(t)}supports(t){return e.parseEventName(t)!=null}addEventListener(t,r,o,i){let a=e.parseEventName(r),l=e.eventCallback(a.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>yr().onAndCancel(t,a.domEventName,l,i))}static parseEventName(t){let r=t.toLowerCase().split("."),o=r.shift();if(r.length===0||!(o==="keydown"||o==="keyup"))return null;let i=e._normalizeKey(r.pop()),a="",l=r.indexOf("code");if(l>-1&&(r.splice(l,1),a="code."),xy.forEach(p=>{let g=r.indexOf(p);g>-1&&(r.splice(g,1),a+=p+".")}),a+=i,r.length!=0||i.length===0)return null;let u={};return u.domEventName=o,u.fullKey=a,u}static matchEventFullKeyCode(t,r){let o=Yk[t.key]||t.key,i="";return r.indexOf("code.")>-1&&(o=t.code,i="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),xy.forEach(a=>{if(a!==o){let l=Kk[a];l(t)&&(i+=a+".")}}),i+=o,i===r)}static eventCallback(t,r,o){return i=>{e.matchEventFullKeyCode(i,t)&&o.runGuarded(()=>r(i))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||e)(Le(Yt))};static \u0275prov=we({token:e,factory:e.\u0275fac})}return e})();function Zk(){Zu.makeCurrent()}function Qk(){return new xo}function Jk(){return Dm(document),document}var eI=[{provide:Lc,useValue:fy},{provide:vu,useValue:Zk,multi:!0},{provide:Yt,useFactory:Jk}],Hh=bh(Bb,"browser",eI);var tI=[{provide:Pu,useClass:Qu},{provide:Tu,useClass:Uc},{provide:Uc,useClass:Uc}],nI=[{provide:mc,useValue:"root"},{provide:xo,useFactory:Qk},{provide:Ku,useClass:qu,multi:!0},{provide:Ku,useClass:_y,multi:!0},zh,Uh,jh,{provide:aa,useExisting:zh},{provide:pa,useClass:Xk},[]],$h=(()=>{class e{constructor(){}static \u0275fac=function(r){return new(r||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({providers:[...nI,...tI],imports:[qn,Vb]})}return e})();var Pi=class e{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(n){n?typeof n=="string"?this.lazyInit=()=>{this.headers=new Map,n.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let o=t.slice(0,r),i=t.slice(r+1).trim();this.addHeaderEntry(o,i)}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();let t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){let t=new e;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){let t=n.name.toLowerCase();switch(n.op){case"a":case"s":let r=n.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(n.name,t);let o=(n.op==="a"?this.headers.get(t):void 0)||[];o.push(...r),this.headers.set(t,o);break;case"d":let i=n.value;if(!i)this.headers.delete(t),this.normalizedNames.delete(t);else{let a=this.headers.get(t);if(!a)return;a=a.filter(l=>i.indexOf(l)===-1),a.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}break}}addHeaderEntry(n,t){let r=n.toLowerCase();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(n,t){let r=(Array.isArray(t)?t:[t]).map(i=>i.toString()),o=n.toLowerCase();this.headers.set(o,r),this.maybeSetNormalizedName(n,o)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}};var ef=class{map=new Map;set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}},tf=class{encodeKey(n){return Cy(n)}encodeValue(n){return Cy(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}};function rI(e,n){let t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(o=>{let i=o.indexOf("="),[a,l]=i==-1?[n.decodeKey(o),""]:[n.decodeKey(o.slice(0,i)),n.decodeValue(o.slice(i+1))],u=t.get(a)||[];u.push(l),t.set(a,u)}),t}var oI=/%(\d[a-f0-9])/gi,iI={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Cy(e){return encodeURIComponent(e).replace(oI,(n,t)=>iI[t]??n)}function Ju(e){return`${e}`}var Vr=class e{map;encoder;updates=null;cloneFrom=null;constructor(n={}){if(this.encoder=n.encoder||new tf,n.fromString){if(n.fromObject)throw new ge(2805,!1);this.map=rI(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{let r=n.fromObject[t],o=Array.isArray(r)?r.map(Ju):[Ju(r)];this.map.set(t,o)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();let t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){let t=[];return Object.keys(n).forEach(r=>{let o=n[r];Array.isArray(o)?o.forEach(i=>{t.push({param:r,value:i,op:"a"})}):t.push({param:r,value:o,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{let t=this.encoder.encodeKey(n);return this.map.get(n).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(n=>n!=="").join("&")}clone(n){let t=new e({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":let t=(n.op==="a"?this.map.get(n.param):void 0)||[];t.push(Ju(n.value)),this.map.set(n.param,t);break;case"d":if(n.value!==void 0){let r=this.map.get(n.param)||[],o=r.indexOf(Ju(n.value));o!==-1&&r.splice(o,1),r.length>0?this.map.set(n.param,r):this.map.delete(n.param)}else{this.map.delete(n.param);break}}}),this.cloneFrom=this.updates=null)}};function aI(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function by(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function yy(e){return typeof Blob<"u"&&e instanceof Blob}function My(e){return typeof FormData<"u"&&e instanceof FormData}function sI(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}var wy="Content-Type",Ey="Accept",Ty="text/plain",Py="application/json",cI=`${Py}, ${Ty}, */*`,gs=class e{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;referrerPolicy;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(n,t,r,o){this.url=t,this.method=n.toUpperCase();let i;if(aI(this.method)||o?(this.body=r!==void 0?r:null,i=o):i=r,i){if(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,this.keepalive=!!i.keepalive,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params),i.priority&&(this.priority=i.priority),i.cache&&(this.cache=i.cache),i.credentials&&(this.credentials=i.credentials),typeof i.timeout=="number"){if(i.timeout<1||!Number.isInteger(i.timeout))throw new ge(2822,"");this.timeout=i.timeout}i.mode&&(this.mode=i.mode),i.redirect&&(this.redirect=i.redirect),i.integrity&&(this.integrity=i.integrity),i.referrer&&(this.referrer=i.referrer),i.referrerPolicy&&(this.referrerPolicy=i.referrerPolicy),this.transferCache=i.transferCache}if(this.headers??=new Pi,this.context??=new ef,!this.params)this.params=new Vr,this.urlWithParams=t;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=t;else{let l=t.indexOf("?"),u=l===-1?"?":l<t.length-1?"&":"";this.urlWithParams=t+u+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||by(this.body)||yy(this.body)||My(this.body)||sI(this.body)?this.body:this.body instanceof Vr?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||My(this.body)?null:yy(this.body)?this.body.type||null:by(this.body)?null:typeof this.body=="string"?Ty:this.body instanceof Vr?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?Py:null}clone(n={}){let t=n.method||this.method,r=n.url||this.url,o=n.responseType||this.responseType,i=n.keepalive??this.keepalive,a=n.priority||this.priority,l=n.cache||this.cache,u=n.mode||this.mode,p=n.redirect||this.redirect,g=n.credentials||this.credentials,m=n.referrer||this.referrer,v=n.integrity||this.integrity,h=n.referrerPolicy||this.referrerPolicy,b=n.transferCache??this.transferCache,x=n.timeout??this.timeout,y=n.body!==void 0?n.body:this.body,A=n.withCredentials??this.withCredentials,L=n.reportProgress??this.reportProgress,V=n.headers||this.headers,X=n.params||this.params,ae=n.context??this.context;return n.setHeaders!==void 0&&(V=Object.keys(n.setHeaders).reduce((Te,B)=>Te.set(B,n.setHeaders[B]),V)),n.setParams&&(X=Object.keys(n.setParams).reduce((Te,B)=>Te.set(B,n.setParams[B]),X)),new e(t,r,y,{params:X,headers:V,context:ae,reportProgress:L,responseType:o,withCredentials:A,transferCache:b,keepalive:i,cache:l,priority:a,timeout:x,mode:u,redirect:p,credentials:g,referrer:m,integrity:v,referrerPolicy:h})}},ga=(function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e})(ga||{}),hs=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(n,t=200,r="OK"){this.headers=n.headers||new Pi,this.status=n.status!==void 0?n.status:t,this.statusText=n.statusText||r,this.url=n.url||null,this.redirected=n.redirected,this.responseType=n.responseType,this.ok=this.status>=200&&this.status<300}},nf=class e extends hs{constructor(n={}){super(n)}type=ga.ResponseHeader;clone(n={}){return new e({headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}},el=class e extends hs{body;constructor(n={}){super(n),this.body=n.body!==void 0?n.body:null}type=ga.Response;clone(n={}){return new e({body:n.body!==void 0?n.body:this.body,headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0,redirected:n.redirected??this.redirected,responseType:n.responseType??this.responseType})}},ms=class extends hs{name="HttpErrorResponse";message;error;ok=!1;constructor(n){super(n,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${n.url||"(unknown url)"}`:this.message=`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}},lI=200,dI=204;var uI=new Me("");var fI=/^\)\]\}',?\n/;var qh=(()=>{class e{xhrFactory;tracingService=K(qo,{optional:!0});constructor(t){this.xhrFactory=t}maybePropagateTrace(t){return this.tracingService?.propagate?this.tracingService.propagate(t):t}handle(t){if(t.method==="JSONP")throw new ge(-2800,!1);let r=this.xhrFactory;return et(null).pipe(Dr(()=>new lt(i=>{let a=r.build();if(a.open(t.method,t.urlWithParams),t.withCredentials&&(a.withCredentials=!0),t.headers.forEach((y,A)=>a.setRequestHeader(y,A.join(","))),t.headers.has(Ey)||a.setRequestHeader(Ey,cI),!t.headers.has(wy)){let y=t.detectContentTypeHeader();y!==null&&a.setRequestHeader(wy,y)}if(t.timeout&&(a.timeout=t.timeout),t.responseType){let y=t.responseType.toLowerCase();a.responseType=y!=="json"?y:"text"}let l=t.serializeBody(),u=null,p=()=>{if(u!==null)return u;let y=a.statusText||"OK",A=new Pi(a.getAllResponseHeaders()),L=a.responseURL||t.url;return u=new nf({headers:A,status:a.status,statusText:y,url:L}),u},g=this.maybePropagateTrace(()=>{let{headers:y,status:A,statusText:L,url:V}=p(),X=null;A!==dI&&(X=typeof a.response>"u"?a.responseText:a.response),A===0&&(A=X?lI:0);let ae=A>=200&&A<300;if(t.responseType==="json"&&typeof X=="string"){let Te=X;X=X.replace(fI,"");try{X=X!==""?JSON.parse(X):null}catch(B){X=Te,ae&&(ae=!1,X={error:B,text:X})}}ae?(i.next(new el({body:X,headers:y,status:A,statusText:L,url:V||void 0})),i.complete()):i.error(new ms({error:X,headers:y,status:A,statusText:L,url:V||void 0}))}),m=this.maybePropagateTrace(y=>{let{url:A}=p(),L=new ms({error:y,status:a.status||0,statusText:a.statusText||"Unknown Error",url:A||void 0});i.error(L)}),v=m;t.timeout&&(v=this.maybePropagateTrace(y=>{let{url:A}=p(),L=new ms({error:new DOMException("Request timed out","TimeoutError"),status:a.status||0,statusText:a.statusText||"Request timeout",url:A||void 0});i.error(L)}));let h=!1,b=this.maybePropagateTrace(y=>{h||(i.next(p()),h=!0);let A={type:ga.DownloadProgress,loaded:y.loaded};y.lengthComputable&&(A.total=y.total),t.responseType==="text"&&a.responseText&&(A.partialText=a.responseText),i.next(A)}),x=this.maybePropagateTrace(y=>{let A={type:ga.UploadProgress,loaded:y.loaded};y.lengthComputable&&(A.total=y.total),i.next(A)});return a.addEventListener("load",g),a.addEventListener("error",m),a.addEventListener("timeout",v),a.addEventListener("abort",m),t.reportProgress&&(a.addEventListener("progress",b),l!==null&&a.upload&&a.upload.addEventListener("progress",x)),a.send(l),i.next({type:ga.Sent}),()=>{a.removeEventListener("error",m),a.removeEventListener("abort",m),a.removeEventListener("load",g),a.removeEventListener("timeout",v),t.reportProgress&&(a.removeEventListener("progress",b),l!==null&&a.upload&&a.upload.removeEventListener("progress",x)),a.readyState!==a.DONE&&a.abort()}})))}static \u0275fac=function(r){return new(r||e)(Le(pa))};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Sy(e,n){return n(e)}function pI(e,n){return(t,r)=>n.intercept(t,{handle:o=>e(o,r)})}function gI(e,n,t){return(r,o)=>pn(t,()=>n(r,i=>e(i,o)))}var Dy=new Me(""),Xh=new Me("",{factory:()=>[]}),ky=new Me(""),Yh=new Me("",{factory:()=>!0});function mI(){let e=null;return(n,t)=>{e===null&&(e=(K(Dy,{optional:!0})??[]).reduceRight(pI,Sy));let r=K(Oc);if(K(Yh)){let i=r.add();return e(n,t).pipe($a(i))}else return e(n,t)}}var Kh=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:function(r){let o=null;return r?o=new(r||e):o=Le(qh),o},providedIn:"root"})}return e})();var rf=(()=>{class e{backend;injector;chain=null;pendingTasks=K(Oc);contributeToStability=K(Yh);constructor(t,r){this.backend=t,this.injector=r}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(Xh),...this.injector.get(ky,[])]));this.chain=r.reduceRight((o,i)=>gI(o,i,this.injector),Sy)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,o=>this.backend.handle(o)).pipe($a(r))}else return this.chain(t,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||e)(Le(Kh),Le(Gt))};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Zh=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:function(r){let o=null;return r?o=new(r||e):o=Le(rf),o},providedIn:"root"})}return e})();function Gh(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials,credentials:e.credentials,transferCache:e.transferCache,timeout:e.timeout,keepalive:e.keepalive,priority:e.priority,cache:e.cache,mode:e.mode,redirect:e.redirect,integrity:e.integrity,referrer:e.referrer,referrerPolicy:e.referrerPolicy}}var vs=(()=>{class e{handler;constructor(t){this.handler=t}request(t,r,o={}){let i;if(t instanceof gs)i=t;else{let u;o.headers instanceof Pi?u=o.headers:u=new Pi(o.headers);let p;o.params&&(o.params instanceof Vr?p=o.params:p=new Vr({fromObject:o.params})),i=new gs(t,r,o.body!==void 0?o.body:null,{headers:u,context:o.context,params:p,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials,transferCache:o.transferCache,keepalive:o.keepalive,priority:o.priority,cache:o.cache,mode:o.mode,redirect:o.redirect,credentials:o.credentials,referrer:o.referrer,referrerPolicy:o.referrerPolicy,integrity:o.integrity,timeout:o.timeout})}let a=et(i).pipe(fi(u=>this.handler.handle(u)));if(t instanceof gs||o.observe==="events")return a;let l=a.pipe(_r(u=>u instanceof el));switch(o.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return l.pipe(Tt(u=>{if(u.body!==null&&!(u.body instanceof ArrayBuffer))throw new ge(2806,!1);return u.body}));case"blob":return l.pipe(Tt(u=>{if(u.body!==null&&!(u.body instanceof Blob))throw new ge(2807,!1);return u.body}));case"text":return l.pipe(Tt(u=>{if(u.body!==null&&typeof u.body!="string")throw new ge(2808,!1);return u.body}));default:return l.pipe(Tt(u=>u.body))}case"response":return l;default:throw new ge(2809,!1)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new Vr().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,o={}){return this.request("PATCH",t,Gh(o,r))}post(t,r,o={}){return this.request("POST",t,Gh(o,r))}put(t,r,o={}){return this.request("PUT",t,Gh(o,r))}static \u0275fac=function(r){return new(r||e)(Le(Zh))};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var hI=new Me("",{factory:()=>!0}),vI="XSRF-TOKEN",xI=new Me("",{factory:()=>vI}),_I="X-XSRF-TOKEN",CI=new Me("",{factory:()=>_I}),bI=(()=>{class e{cookieName=K(xI);doc=K(Yt);lastCookieString="";lastToken=null;parseCount=0;getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Yc(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Iy=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:function(r){let o=null;return r?o=new(r||e):o=Le(bI),o},providedIn:"root"})}return e})();function yI(e,n){if(!K(hI)||e.method==="GET"||e.method==="HEAD")return n(e);try{let o=K(Qo).href,{origin:i}=new URL(o),{origin:a}=new URL(e.url,i);if(i!==a)return n(e)}catch{return n(e)}let t=K(Iy).getToken(),r=K(CI);return t!=null&&!e.headers.has(r)&&(e=e.clone({headers:e.headers.set(r,t)})),n(e)}var Qh=(function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e})(Qh||{});function MI(e,n){return{\u0275kind:e,\u0275providers:n}}function Ay(...e){let n=[vs,rf,{provide:Zh,useExisting:rf},{provide:Kh,useFactory:()=>K(uI,{optional:!0})??K(qh)},{provide:Xh,useValue:yI,multi:!0}];for(let t of e)n.push(...t.\u0275providers);return Ka(n)}var Oy=new Me("");function Ny(){return MI(Qh.LegacyInterceptors,[{provide:Oy,useFactory:mI},{provide:Xh,useExisting:Oy,multi:!0}])}var Jh=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({providers:[Ay(Ny())]})}return e})();var Fy=(()=>{class e{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||e)(Le(Yt))};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Ze="primary",dl=Symbol("RouteTitle"),ov=class{params;constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){let t=this.params[n];return Array.isArray(t)?t[0]:t}return null}getAll(n){if(this.has(n)){let t=this.params[n];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function va(e){return new ov(e)}function ev(e,n,t){for(let r=0;r<e.length;r++){let o=e[r],i=n[r];if(o[0]===":")t[o.substring(1)]=i;else if(o!==i.path)return!1}return!0}function $y(e,n,t){let r=t.path.split("/"),o=r.indexOf("**");if(o===-1){if(r.length>e.length||t.pathMatch==="full"&&(n.hasChildren()||r.length<e.length))return null;let u={},p=e.slice(0,r.length);return ev(r,p,u)?{consumed:p,posParams:u}:null}if(o!==r.lastIndexOf("**"))return null;let i=r.slice(0,o),a=r.slice(o+1);if(i.length+a.length>e.length||t.pathMatch==="full"&&n.hasChildren()&&t.path!=="**")return null;let l={};return!ev(i,e.slice(0,i.length),l)||!ev(a,e.slice(e.length-a.length),l)?null:{consumed:e,posParams:l}}function df(e){return new Promise((n,t)=>{e.pipe(Vo()).subscribe({next:r=>n(r),error:r=>t(r)})})}function OI(e,n){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!Po(e[t],n[t]))return!1;return!0}function Po(e,n){let t=e?iv(e):void 0,r=n?iv(n):void 0;if(!t||!r||t.length!=r.length)return!1;let o;for(let i=0;i<t.length;i++)if(o=t[i],!Gy(e[o],n[o]))return!1;return!0}function iv(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function Gy(e,n){if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;let t=[...e].sort(),r=[...n].sort();return t.every((o,i)=>r[i]===o)}else return e===n}function TI(e){return e.length>0?e[e.length-1]:null}function _a(e){return xd(e)?e:Oi(e)?Xt(Promise.resolve(e)):et(e)}function qy(e){return xd(e)?df(e):Promise.resolve(e)}var PI={exact:Yy,subset:Ky},Xy={exact:SI,subset:DI,ignored:()=>!0};function Ry(e,n,t){return PI[t.paths](e.root,n.root,t.matrixParams)&&Xy[t.queryParams](e.queryParams,n.queryParams)&&!(t.fragment==="exact"&&e.fragment!==n.fragment)}function SI(e,n){return Po(e,n)}function Yy(e,n,t){if(!ma(e.segments,n.segments)||!sf(e.segments,n.segments,t)||e.numberOfChildren!==n.numberOfChildren)return!1;for(let r in n.children)if(!e.children[r]||!Yy(e.children[r],n.children[r],t))return!1;return!0}function DI(e,n){return Object.keys(n).length<=Object.keys(e).length&&Object.keys(n).every(t=>Gy(e[t],n[t]))}function Ky(e,n,t){return Zy(e,n,n.segments,t)}function Zy(e,n,t,r){if(e.segments.length>t.length){let o=e.segments.slice(0,t.length);return!(!ma(o,t)||n.hasChildren()||!sf(o,t,r))}else if(e.segments.length===t.length){if(!ma(e.segments,t)||!sf(e.segments,t,r))return!1;for(let o in n.children)if(!e.children[o]||!Ky(e.children[o],n.children[o],r))return!1;return!0}else{let o=t.slice(0,e.segments.length),i=t.slice(e.segments.length);return!ma(e.segments,o)||!sf(e.segments,o,r)||!e.children[Ze]?!1:Zy(e.children[Ze],n,i,r)}}function sf(e,n,t){return n.every((r,o)=>Xy[t](e[o].parameters,r.parameters))}var co=class{root;queryParams;fragment;_queryParamMap;constructor(n=new _t([],{}),t={},r=null){this.root=n,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=va(this.queryParams),this._queryParamMap}toString(){return AI.serialize(this)}},_t=class{segments;children;parent=null;constructor(n,t){this.segments=n,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return cf(this)}},Si=class{path;parameters;_parameterMap;constructor(n,t){this.path=n,this.parameters=t}get parameterMap(){return this._parameterMap??=va(this.parameters),this._parameterMap}toString(){return Jy(this)}};function kI(e,n){return ma(e,n)&&e.every((t,r)=>Po(t.parameters,n[r].parameters))}function ma(e,n){return e.length!==n.length?!1:e.every((t,r)=>t.path===n[r].path)}function II(e,n){let t=[];return Object.entries(e.children).forEach(([r,o])=>{r===Ze&&(t=t.concat(n(o,r)))}),Object.entries(e.children).forEach(([r,o])=>{r!==Ze&&(t=t.concat(n(o,r)))}),t}var Ca=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:()=>new ti,providedIn:"root"})}return e})(),ti=class{parse(n){let t=new sv(n);return new co(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(n){let t=`/${tl(n.root,!0)}`,r=RI(n.queryParams),o=typeof n.fragment=="string"?`#${NI(n.fragment)}`:"";return`${t}${r}${o}`}},AI=new ti;function cf(e){return e.segments.map(n=>Jy(n)).join("/")}function tl(e,n){if(!e.hasChildren())return cf(e);if(n){let t=e.children[Ze]?tl(e.children[Ze],!1):"",r=[];return Object.entries(e.children).forEach(([o,i])=>{o!==Ze&&r.push(`${o}:${tl(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=II(e,(r,o)=>o===Ze?[tl(e.children[Ze],!1)]:[`${o}:${tl(r,!1)}`]);return Object.keys(e.children).length===1&&e.children[Ze]!=null?`${cf(e)}/${t[0]}`:`${cf(e)}/(${t.join("//")})`}}function Qy(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function of(e){return Qy(e).replace(/%3B/gi,";")}function NI(e){return encodeURI(e)}function av(e){return Qy(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function lf(e){return decodeURIComponent(e)}function Ly(e){return lf(e.replace(/\+/g,"%20"))}function Jy(e){return`${av(e.path)}${FI(e.parameters)}`}function FI(e){return Object.entries(e).map(([n,t])=>`;${av(n)}=${av(t)}`).join("")}function RI(e){let n=Object.entries(e).map(([t,r])=>Array.isArray(r)?r.map(o=>`${of(t)}=${of(o)}`).join("&"):`${of(t)}=${of(r)}`).filter(t=>t);return n.length?`?${n.join("&")}`:""}var LI=/^[^\/()?;#]+/;function tv(e){let n=e.match(LI);return n?n[0]:""}var BI=/^[^\/()?;=#]+/;function VI(e){let n=e.match(BI);return n?n[0]:""}var jI=/^[^=?&#]+/;function UI(e){let n=e.match(jI);return n?n[0]:""}var WI=/^[^&#]+/;function zI(e){let n=e.match(WI);return n?n[0]:""}var sv=class{url;remaining;constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new _t([],{}):new _t([],this.parseChildren())}parseQueryParams(){let n={};if(this.consumeOptional("?"))do this.parseQueryParam(n);while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(n=0){if(n>50)throw new ge(4010,!1);if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let r={};this.peekStartsWith("/(")&&(this.capture("/"),r=this.parseParens(!0,n));let o={};return this.peekStartsWith("(")&&(o=this.parseParens(!1,n)),(t.length>0||Object.keys(r).length>0)&&(o[Ze]=new _t(t,r)),o}parseSegment(){let n=tv(this.remaining);if(n===""&&this.peekStartsWith(";"))throw new ge(4009,!1);return this.capture(n),new Si(lf(n),this.parseMatrixParams())}parseMatrixParams(){let n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){let t=VI(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=tv(this.remaining);o&&(r=o,this.capture(r))}n[lf(t)]=lf(r)}parseQueryParam(n){let t=UI(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let a=zI(this.remaining);a&&(r=a,this.capture(r))}let o=Ly(t),i=Ly(r);if(n.hasOwnProperty(o)){let a=n[o];Array.isArray(a)||(a=[a],n[o]=a),a.push(i)}else n[o]=i}parseParens(n,t){let r={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let o=tv(this.remaining),i=this.remaining[o.length];if(i!=="/"&&i!==")"&&i!==";")throw new ge(4010,!1);let a;o.indexOf(":")>-1?(a=o.slice(0,o.indexOf(":")),this.capture(a),this.capture(":")):n&&(a=Ze);let l=this.parseChildren(t+1);r[a??Ze]=Object.keys(l).length===1&&l[Ze]?l[Ze]:new _t([],l),this.consumeOptional("//")}return r}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return this.peekStartsWith(n)?(this.remaining=this.remaining.substring(n.length),!0):!1}capture(n){if(!this.consumeOptional(n))throw new ge(4011,!1)}};function eM(e){return e.segments.length>0?new _t([],{[Ze]:e}):e}function tM(e){let n={};for(let[r,o]of Object.entries(e.children)){let i=tM(o);if(r===Ze&&i.segments.length===0&&i.hasChildren())for(let[a,l]of Object.entries(i.children))n[a]=l;else(i.segments.length>0||i.hasChildren())&&(n[r]=i)}let t=new _t(e.segments,n);return HI(t)}function HI(e){if(e.numberOfChildren===1&&e.children[Ze]){let n=e.children[Ze];return new _t(e.segments.concat(n.segments),n.children)}return e}function Di(e){return e instanceof co}function nM(e,n,t=null,r=null,o=new ti){let i=rM(e);return oM(i,n,t,r,o)}function rM(e){let n;function t(i){let a={};for(let u of i.children){let p=t(u);a[u.outlet]=p}let l=new _t(i.url,a);return i===e&&(n=l),l}let r=t(e.root),o=eM(r);return n??o}function oM(e,n,t,r,o){let i=e;for(;i.parent;)i=i.parent;if(n.length===0)return nv(i,i,i,t,r,o);let a=$I(n);if(a.toRoot())return nv(i,i,new _t([],{}),t,r,o);let l=GI(a,i,e),u=l.processChildren?rl(l.segmentGroup,l.index,a.commands):aM(l.segmentGroup,l.index,a.commands);return nv(i,l.segmentGroup,u,t,r,o)}function uf(e){return typeof e=="object"&&e!=null&&!e.outlets&&!e.segmentPath}function il(e){return typeof e=="object"&&e!=null&&e.outlets}function By(e,n,t){e||="\u0275";let r=new co;return r.queryParams={[e]:n},t.parse(t.serialize(r)).queryParams[e]}function nv(e,n,t,r,o,i){let a={};for(let[p,g]of Object.entries(r??{}))a[p]=Array.isArray(g)?g.map(m=>By(p,m,i)):By(p,g,i);let l;e===n?l=t:l=iM(e,n,t);let u=eM(tM(l));return new co(u,a,o)}function iM(e,n,t){let r={};return Object.entries(e.children).forEach(([o,i])=>{i===n?r[o]=t:r[o]=iM(i,n,t)}),new _t(e.segments,r)}var ff=class{isAbsolute;numberOfDoubleDots;commands;constructor(n,t,r){if(this.isAbsolute=n,this.numberOfDoubleDots=t,this.commands=r,n&&r.length>0&&uf(r[0]))throw new ge(4003,!1);let o=r.find(il);if(o&&o!==TI(r))throw new ge(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function $I(e){if(typeof e[0]=="string"&&e.length===1&&e[0]==="/")return new ff(!0,0,e);let n=0,t=!1,r=e.reduce((o,i,a)=>{if(typeof i=="object"&&i!=null){if(i.outlets){let l={};return Object.entries(i.outlets).forEach(([u,p])=>{l[u]=typeof p=="string"?p.split("/"):p}),[...o,{outlets:l}]}if(i.segmentPath)return[...o,i.segmentPath]}return typeof i!="string"?[...o,i]:a===0?(i.split("/").forEach((l,u)=>{u==0&&l==="."||(u==0&&l===""?t=!0:l===".."?n++:l!=""&&o.push(l))}),o):[...o,i]},[]);return new ff(t,n,r)}var _s=class{segmentGroup;processChildren;index;constructor(n,t,r){this.segmentGroup=n,this.processChildren=t,this.index=r}};function GI(e,n,t){if(e.isAbsolute)return new _s(n,!0,0);if(!t)return new _s(n,!1,NaN);if(t.parent===null)return new _s(t,!0,0);let r=uf(e.commands[0])?0:1,o=t.segments.length-1+r;return qI(t,o,e.numberOfDoubleDots)}function qI(e,n,t){let r=e,o=n,i=t;for(;i>o;){if(i-=o,r=r.parent,!r)throw new ge(4005,!1);o=r.segments.length}return new _s(r,!1,o-i)}function XI(e){return il(e[0])?e[0].outlets:{[Ze]:e}}function aM(e,n,t){if(e??=new _t([],{}),e.segments.length===0&&e.hasChildren())return rl(e,n,t);let r=YI(e,n,t),o=t.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){let i=new _t(e.segments.slice(0,r.pathIndex),{});return i.children[Ze]=new _t(e.segments.slice(r.pathIndex),e.children),rl(i,0,o)}else return r.match&&o.length===0?new _t(e.segments,{}):r.match&&!e.hasChildren()?cv(e,n,t):r.match?rl(e,0,o):cv(e,n,t)}function rl(e,n,t){if(t.length===0)return new _t(e.segments,{});{let r=XI(t),o={};if(Object.keys(r).some(i=>i!==Ze)&&e.children[Ze]&&e.numberOfChildren===1&&e.children[Ze].segments.length===0){let i=rl(e.children[Ze],n,t);return new _t(e.segments,i.children)}return Object.entries(r).forEach(([i,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(o[i]=aM(e.children[i],n,a))}),Object.entries(e.children).forEach(([i,a])=>{r[i]===void 0&&(o[i]=a)}),new _t(e.segments,o)}}function YI(e,n,t){let r=0,o=n,i={match:!1,pathIndex:0,commandIndex:0};for(;o<e.segments.length;){if(r>=t.length)return i;let a=e.segments[o],l=t[r];if(il(l))break;let u=`${l}`,p=r<t.length-1?t[r+1]:null;if(o>0&&u===void 0)break;if(u&&p&&typeof p=="object"&&p.outlets===void 0){if(!jy(u,p,a))return i;r+=2}else{if(!jy(u,{},a))return i;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}function cv(e,n,t){let r=e.segments.slice(0,n),o=0;for(;o<t.length;){let i=t[o];if(il(i)){let u=KI(i.outlets);return new _t(r,u)}if(o===0&&uf(t[0])){let u=e.segments[n];r.push(new Si(u.path,Vy(t[0]))),o++;continue}let a=il(i)?i.outlets[Ze]:`${i}`,l=o<t.length-1?t[o+1]:null;a&&l&&uf(l)?(r.push(new Si(a,Vy(l))),o+=2):(r.push(new Si(a,{})),o++)}return new _t(r,{})}function KI(e){let n={};return Object.entries(e).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(n[t]=cv(new _t([],{}),0,r))}),n}function Vy(e){let n={};return Object.entries(e).forEach(([t,r])=>n[t]=`${r}`),n}function jy(e,n,t){return e==t.path&&Po(n,t.parameters)}var Cs="imperative",mn=(function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e})(mn||{}),wr=class{id;url;constructor(n,t){this.id=n,this.url=t}},ki=class extends wr{type=mn.NavigationStart;navigationTrigger;restoredState;constructor(n,t,r="imperative",o=null){super(n,t),this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ur=class extends wr{urlAfterRedirects;type=mn.NavigationEnd;constructor(n,t,r){super(n,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Xn=(function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e[e.Aborted=4]="Aborted",e})(Xn||{}),ys=(function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e})(ys||{}),jr=class extends wr{reason;code;type=mn.NavigationCancel;constructor(n,t,r,o){super(n,t),this.reason=r,this.code=o}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function sM(e){return e instanceof jr&&(e.code===Xn.Redirect||e.code===Xn.SupersededByNewNavigation)}var So=class extends wr{reason;code;type=mn.NavigationSkipped;constructor(n,t,r,o){super(n,t),this.reason=r,this.code=o}},xa=class extends wr{error;target;type=mn.NavigationError;constructor(n,t,r,o){super(n,t),this.error=r,this.target=o}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ms=class extends wr{urlAfterRedirects;state;type=mn.RoutesRecognized;constructor(n,t,r,o){super(n,t),this.urlAfterRedirects=r,this.state=o}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},pf=class extends wr{urlAfterRedirects;state;type=mn.GuardsCheckStart;constructor(n,t,r,o){super(n,t),this.urlAfterRedirects=r,this.state=o}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},gf=class extends wr{urlAfterRedirects;state;shouldActivate;type=mn.GuardsCheckEnd;constructor(n,t,r,o,i){super(n,t),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},mf=class extends wr{urlAfterRedirects;state;type=mn.ResolveStart;constructor(n,t,r,o){super(n,t),this.urlAfterRedirects=r,this.state=o}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},hf=class extends wr{urlAfterRedirects;state;type=mn.ResolveEnd;constructor(n,t,r,o){super(n,t),this.urlAfterRedirects=r,this.state=o}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},vf=class{route;type=mn.RouteConfigLoadStart;constructor(n){this.route=n}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},xf=class{route;type=mn.RouteConfigLoadEnd;constructor(n){this.route=n}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},_f=class{snapshot;type=mn.ChildActivationStart;constructor(n){this.snapshot=n}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Cf=class{snapshot;type=mn.ChildActivationEnd;constructor(n){this.snapshot=n}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},bf=class{snapshot;type=mn.ActivationStart;constructor(n){this.snapshot=n}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yf=class{snapshot;type=mn.ActivationEnd;constructor(n){this.snapshot=n}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ws=class{routerEvent;position;anchor;scrollBehavior;type=mn.Scroll;constructor(n,t,r,o){this.routerEvent=n,this.position=t,this.anchor=r,this.scrollBehavior=o}toString(){let n=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${n}')`}},Es=class{},Os=class{url;navigationBehaviorOptions;constructor(n,t){this.url=n,this.navigationBehaviorOptions=t}};function ZI(e){return!(e instanceof Es)&&!(e instanceof Os)}var Mf=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(n){this.rootInjector=n,this.children=new ba(this.rootInjector)}},ba=(()=>{class e{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let o=this.getOrCreateContext(t);o.outlet=r,this.contexts.set(t,o)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Mf(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||e)(Le(Gt))};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),wf=class{_root;constructor(n){this._root=n}get root(){return this._root.value}parent(n){let t=this.pathFromRoot(n);return t.length>1?t[t.length-2]:null}children(n){let t=lv(n,this._root);return t?t.children.map(r=>r.value):[]}firstChild(n){let t=lv(n,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(n){let t=dv(n,this._root);return t.length<2?[]:t[t.length-2].children.map(o=>o.value).filter(o=>o!==n)}pathFromRoot(n){return dv(n,this._root).map(t=>t.value)}};function lv(e,n){if(e===n.value)return n;for(let t of n.children){let r=lv(e,t);if(r)return r}return null}function dv(e,n){if(e===n.value)return[n];for(let t of n.children){let r=dv(e,t);if(r.length)return r.unshift(n),r}return[]}var Mr=class{value;children;constructor(n,t){this.value=n,this.children=t}toString(){return`TreeNode(${this.value})`}};function xs(e){let n={};return e&&e.children.forEach(t=>n[t.value.outlet]=t),n}var al=class extends wf{snapshot;constructor(n,t){super(n),this.snapshot=t,xv(this,n)}toString(){return this.snapshot.toString()}};function cM(e,n){let t=QI(e,n),r=new Pn([new Si("",{})]),o=new Pn({}),i=new Pn({}),a=new Pn({}),l=new Pn(""),u=new ni(r,o,a,l,i,Ze,e,t.root);return u.snapshot=t.root,new al(new Mr(u,[]),t)}function QI(e,n){let t={},r={},o={},a=new ha([],t,o,"",r,Ze,e,null,{},n);return new sl("",new Mr(a,[]))}var ni=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(n,t,r,o,i,a,l,u){this.urlSubject=n,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=o,this.dataSubject=i,this.outlet=a,this.component=l,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(Tt(p=>p[dl]))??et(void 0),this.url=n,this.params=t,this.queryParams=r,this.fragment=o,this.data=i}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Tt(n=>va(n))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Tt(n=>va(n))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Ef(e,n,t="emptyOnly"){let r,{routeConfig:o}=e;return n!==null&&(t==="always"||o?.path===""||!n.component&&!n.routeConfig?.loadComponent)?r={params:Y(Y({},n.params),e.params),data:Y(Y({},n.data),e.data),resolve:Y(Y(Y(Y({},e.data),n.data),o?.data),e._resolvedData)}:r={params:Y({},e.params),data:Y({},e.data),resolve:Y(Y({},e.data),e._resolvedData??{})},o&&dM(o)&&(r.resolve[dl]=o.title),r}var ha=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[dl]}constructor(n,t,r,o,i,a,l,u,p,g){this.url=n,this.params=t,this.queryParams=r,this.fragment=o,this.data=i,this.outlet=a,this.component=l,this.routeConfig=u,this._resolve=p,this._environmentInjector=g}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=va(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=va(this.queryParams),this._queryParamMap}toString(){let n=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${n}', path:'${t}')`}},sl=class extends wf{url;constructor(n,t){super(t),this.url=n,xv(this,t)}toString(){return lM(this._root)}};function xv(e,n){n.value._routerState=e,n.children.forEach(t=>xv(e,t))}function lM(e){let n=e.children.length>0?` { ${e.children.map(lM).join(", ")} } `:"";return`${e.value}${n}`}function rv(e){if(e.snapshot){let n=e.snapshot,t=e._futureSnapshot;e.snapshot=t,Po(n.queryParams,t.queryParams)||e.queryParamsSubject.next(t.queryParams),n.fragment!==t.fragment&&e.fragmentSubject.next(t.fragment),Po(n.params,t.params)||e.paramsSubject.next(t.params),OI(n.url,t.url)||e.urlSubject.next(t.url),Po(n.data,t.data)||e.dataSubject.next(t.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function uv(e,n){let t=Po(e.params,n.params)&&kI(e.url,n.url),r=!e.parent!=!n.parent;return t&&!r&&(!e.parent||uv(e.parent,n.parent))}function dM(e){return typeof e.title=="string"||e.title===null}var uM=new Me(""),ya=(()=>{class e{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Ze;activateEvents=new $t;deactivateEvents=new $t;attachEvents=new $t;detachEvents=new $t;routerOutletData=Fb();parentContexts=K(ba);location=K(da);changeDetector=K(Se);inputBinder=K(ul,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:o}=t.name;if(r)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ge(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ge(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ge(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new ge(4013,!1);this._activatedRoute=t;let o=this.location,a=t.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,u=new fv(t,l,o.injector,this.routerOutletData);this.activated=o.createComponent(a,{index:o.length,injector:u,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||e)};static \u0275dir=Kt({type:e,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Go]})}return e})(),fv=class{route;childContexts;parent;outletData;constructor(n,t,r,o){this.route=n,this.childContexts=t,this.parent=r,this.outletData=o}get(n,t){return n===ni?this.route:n===ba?this.childContexts:n===uM?this.outletData:this.parent.get(n,t)}},ul=new Me(""),_v=(()=>{class e{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,o=yd([r.queryParams,r.params,r.data]).pipe(Dr(([i,a,l],u)=>(l=Y(Y(Y({},i),a),l),u===0?et(l):Promise.resolve(l)))).subscribe(i=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let a=jb(r.component);if(!a){this.unsubscribeFromRouteData(t);return}for(let{templateName:l}of a.inputs)t.activatedComponentRef.setInput(l,i[l])});this.outletDataSubscriptions.set(t,o)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac})}return e})(),Cv=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=se({type:e,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,o){r&1&&le(0,"router-outlet")},dependencies:[ya],encapsulation:2})}return e})();function bv(e){let n=e.children&&e.children.map(bv),t=n?nt(Y({},e),{children:n}):Y({},e);return!t.component&&!t.loadComponent&&(n||t.loadChildren)&&t.outlet&&t.outlet!==Ze&&(t.component=Cv),t}function JI(e,n,t){let r=cl(e,n._root,t?t._root:void 0);return new al(r,n)}function cl(e,n,t){if(t&&e.shouldReuseRoute(n.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=n.value;let o=eA(e,n,t);return new Mr(r,o)}else{if(e.shouldAttach(n.value)){let i=e.retrieve(n.value);if(i!==null){let a=i.route;return a.value._futureSnapshot=n.value,a.children=n.children.map(l=>cl(e,l)),a}}let r=tA(n.value),o=n.children.map(i=>cl(e,i));return new Mr(r,o)}}function eA(e,n,t){return n.children.map(r=>{for(let o of t.children)if(e.shouldReuseRoute(r.value,o.value.snapshot))return cl(e,r,o);return cl(e,r)})}function tA(e){return new ni(new Pn(e.url),new Pn(e.params),new Pn(e.queryParams),new Pn(e.fragment),new Pn(e.data),e.outlet,e.component,e)}var Ts=class{redirectTo;navigationBehaviorOptions;constructor(n,t){this.redirectTo=n,this.navigationBehaviorOptions=t}},fM="ngNavigationCancelingError";function Of(e,n){let{redirectTo:t,navigationBehaviorOptions:r}=Di(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,o=pM(!1,Xn.Redirect);return o.url=t,o.navigationBehaviorOptions=r,o}function pM(e,n){let t=new Error(`NavigationCancelingError: ${e||""}`);return t[fM]=!0,t.cancellationCode=n,t}function nA(e){return gM(e)&&Di(e.url)}function gM(e){return!!e&&e[fM]}var pv=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(n,t,r,o,i){this.routeReuseStrategy=n,this.futureState=t,this.currState=r,this.forwardEvent=o,this.inputBindingEnabled=i}activate(n){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,n),rv(this.futureState.root),this.activateChildRoutes(t,r,n)}deactivateChildRoutes(n,t,r){let o=xs(t);n.children.forEach(i=>{let a=i.value.outlet;this.deactivateRoutes(i,o[a],r),delete o[a]}),Object.values(o).forEach(i=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(n,t,r){let o=n.value,i=t?t.value:null;if(o===i)if(o.component){let a=r.getContext(o.outlet);a&&this.deactivateChildRoutes(n,t,a.children)}else this.deactivateChildRoutes(n,t,r);else i&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(n,t){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,t):this.deactivateRouteAndOutlet(n,t)}detachAndStoreRouteSubtree(n,t){let r=t.getContext(n.value.outlet),o=r&&n.value.component?r.children:t,i=xs(n);for(let a of Object.values(i))this.deactivateRouteAndItsChildren(a,o);if(r&&r.outlet){let a=r.outlet.detach(),l=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:a,route:n,contexts:l})}}deactivateRouteAndOutlet(n,t){let r=t.getContext(n.value.outlet),o=r&&n.value.component?r.children:t,i=xs(n);for(let a of Object.values(i))this.deactivateRouteAndItsChildren(a,o);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(n,t,r){let o=xs(t);n.children.forEach(i=>{this.activateRoutes(i,o[i.value.outlet],r),this.forwardEvent(new yf(i.value.snapshot))}),n.children.length&&this.forwardEvent(new Cf(n.value.snapshot))}activateRoutes(n,t,r){let o=n.value,i=t?t.value:null;if(rv(o),o===i)if(o.component){let a=r.getOrCreateContext(o.outlet);this.activateChildRoutes(n,t,a.children)}else this.activateChildRoutes(n,t,r);else if(o.component){let a=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let l=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),a.children.onOutletReAttached(l.contexts),a.attachRef=l.componentRef,a.route=l.route.value,a.outlet&&a.outlet.attach(l.componentRef,l.route.value),rv(l.route.value),this.activateChildRoutes(n,null,a.children)}else a.attachRef=null,a.route=o,a.outlet&&a.outlet.activateWith(o,a.injector),this.activateChildRoutes(n,null,a.children)}else this.activateChildRoutes(n,null,r)}},Tf=class{path;route;constructor(n){this.path=n,this.route=this.path[this.path.length-1]}},bs=class{component;route;constructor(n,t){this.component=n,this.route=t}};function rA(e,n,t){let r=e._root,o=n?n._root:null;return nl(r,o,t,[r.value])}function oA(e){let n=e.routeConfig?e.routeConfig.canActivateChild:null;return!n||n.length===0?null:{node:e,guards:n}}function Ss(e,n){let t=Symbol(),r=n.get(e,t);return r===t?typeof e=="function"&&!lg(e)?e:n.get(e):r}function nl(e,n,t,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let i=xs(n);return e.children.forEach(a=>{iA(a,i[a.value.outlet],t,r.concat([a.value]),o),delete i[a.value.outlet]}),Object.entries(i).forEach(([a,l])=>ol(l,t.getContext(a),o)),o}function iA(e,n,t,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let i=e.value,a=n?n.value:null,l=t?t.getContext(e.value.outlet):null;if(a&&i.routeConfig===a.routeConfig){let u=aA(a,i,i.routeConfig.runGuardsAndResolvers);u?o.canActivateChecks.push(new Tf(r)):(i.data=a.data,i._resolvedData=a._resolvedData),i.component?nl(e,n,l?l.children:null,r,o):nl(e,n,t,r,o),u&&l&&l.outlet&&l.outlet.isActivated&&o.canDeactivateChecks.push(new bs(l.outlet.component,a))}else a&&ol(n,l,o),o.canActivateChecks.push(new Tf(r)),i.component?nl(e,null,l?l.children:null,r,o):nl(e,null,t,r,o);return o}function aA(e,n,t){if(typeof t=="function")return pn(n._environmentInjector,()=>t(e,n));switch(t){case"pathParamsChange":return!ma(e.url,n.url);case"pathParamsOrQueryParamsChange":return!ma(e.url,n.url)||!Po(e.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!uv(e,n)||!Po(e.queryParams,n.queryParams);default:return!uv(e,n)}}function ol(e,n,t){let r=xs(e),o=e.value;Object.entries(r).forEach(([i,a])=>{o.component?n?ol(a,n.children.getContext(i),t):ol(a,null,t):ol(a,n,t)}),o.component?n&&n.outlet&&n.outlet.isActivated?t.canDeactivateChecks.push(new bs(n.outlet.component,o)):t.canDeactivateChecks.push(new bs(null,o)):t.canDeactivateChecks.push(new bs(null,o))}function fl(e){return typeof e=="function"}function sA(e){return typeof e=="boolean"}function cA(e){return e&&fl(e.canLoad)}function lA(e){return e&&fl(e.canActivate)}function dA(e){return e&&fl(e.canActivateChild)}function uA(e){return e&&fl(e.canDeactivate)}function fA(e){return e&&fl(e.canMatch)}function mM(e){return e instanceof Gi||e?.name==="EmptyError"}var af=Symbol("INITIAL_VALUE");function Ps(){return Dr(e=>yd(e.map(n=>n.pipe(Bo(1),G0(af)))).pipe(Tt(n=>{for(let t of n)if(t!==!0){if(t===af)return af;if(t===!1||pA(t))return t}return!0}),_r(n=>n!==af),Bo(1)))}function pA(e){return Di(e)||e instanceof Ts}function hM(e){return e.aborted?et(void 0).pipe(Bo(1)):new lt(n=>{let t=()=>{n.next(),n.complete()};return e.addEventListener("abort",t),()=>e.removeEventListener("abort",t)})}function vM(e){return sc(hM(e))}function gA(e){return Dn(n=>{let{targetSnapshot:t,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:i}}=n;return i.length===0&&o.length===0?et(nt(Y({},n),{guardsResult:!0})):mA(i,t,r).pipe(Dn(a=>a&&sA(a)?hA(t,o,e):et(a)),Tt(a=>nt(Y({},n),{guardsResult:a})))})}function mA(e,n,t){return Xt(e).pipe(Dn(r=>bA(r.component,r.route,t,n)),Vo(r=>r!==!0,!0))}function hA(e,n,t){return Xt(n).pipe(fi(r=>za(xA(r.route.parent,t),vA(r.route,t),CA(e,r.path),_A(e,r.route))),Vo(r=>r!==!0,!0))}function vA(e,n){return e!==null&&n&&n(new bf(e)),et(!0)}function xA(e,n){return e!==null&&n&&n(new _f(e)),et(!0)}function _A(e,n){let t=n.routeConfig?n.routeConfig.canActivate:null;if(!t||t.length===0)return et(!0);let r=t.map(o=>ac(()=>{let i=n._environmentInjector,a=Ss(o,i),l=lA(a)?a.canActivate(n,e):pn(i,()=>a(n,e));return _a(l).pipe(Vo())}));return et(r).pipe(Ps())}function CA(e,n){let t=n[n.length-1],o=n.slice(0,n.length-1).reverse().map(i=>oA(i)).filter(i=>i!==null).map(i=>ac(()=>{let a=i.guards.map(l=>{let u=i.node._environmentInjector,p=Ss(l,u),g=dA(p)?p.canActivateChild(t,e):pn(u,()=>p(t,e));return _a(g).pipe(Vo())});return et(a).pipe(Ps())}));return et(o).pipe(Ps())}function bA(e,n,t,r){let o=n&&n.routeConfig?n.routeConfig.canDeactivate:null;if(!o||o.length===0)return et(!0);let i=o.map(a=>{let l=n._environmentInjector,u=Ss(a,l),p=uA(u)?u.canDeactivate(e,n,t,r):pn(l,()=>u(e,n,t,r));return _a(p).pipe(Vo())});return et(i).pipe(Ps())}function yA(e,n,t,r,o){let i=n.canLoad;if(i===void 0||i.length===0)return et(!0);let a=i.map(l=>{let u=Ss(l,e),p=cA(u)?u.canLoad(n,t):pn(e,()=>u(n,t)),g=_a(p);return o?g.pipe(vM(o)):g});return et(a).pipe(Ps(),xM(r))}function xM(e){return W0(ho(n=>{if(typeof n!="boolean")throw Of(e,n)}),Tt(n=>n===!0))}function MA(e,n,t,r,o){let i=n.canMatch;if(!i||i.length===0)return et(!0);let a=i.map(l=>{let u=Ss(l,e),p=fA(u)?u.canMatch(n,t):pn(e,()=>u(n,t));return _a(p).pipe(vM(o))});return et(a).pipe(Ps(),xM(r))}var ei=class e extends Error{segmentGroup;constructor(n){super(),this.segmentGroup=n||null,Object.setPrototypeOf(this,e.prototype)}},ll=class e extends Error{urlTree;constructor(n){super(),this.urlTree=n,Object.setPrototypeOf(this,e.prototype)}};function wA(e){throw new ge(4e3,!1)}function EA(e){throw pM(!1,Xn.GuardRejected)}var gv=class{urlSerializer;urlTree;constructor(n,t){this.urlSerializer=n,this.urlTree=t}async lineralizeSegments(n,t){let r=[],o=t.root;for(;;){if(r=r.concat(o.segments),o.numberOfChildren===0)return r;if(o.numberOfChildren>1||!o.children[Ze])throw wA(`${n.redirectTo}`);o=o.children[Ze]}}async applyRedirectCommands(n,t,r,o,i){let a=await OA(t,o,i);if(a instanceof co)throw new ll(a);let l=this.applyRedirectCreateUrlTree(a,this.urlSerializer.parse(a),n,r);if(a[0]==="/")throw new ll(l);return l}applyRedirectCreateUrlTree(n,t,r,o){let i=this.createSegmentGroup(n,t.root,r,o);return new co(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(n,t){let r={};return Object.entries(n).forEach(([o,i])=>{if(typeof i=="string"&&i[0]===":"){let l=i.substring(1);r[o]=t[l]}else r[o]=i}),r}createSegmentGroup(n,t,r,o){let i=this.createSegments(n,t.segments,r,o),a={};return Object.entries(t.children).forEach(([l,u])=>{a[l]=this.createSegmentGroup(n,u,r,o)}),new _t(i,a)}createSegments(n,t,r,o){return t.map(i=>i.path[0]===":"?this.findPosParam(n,i,o):this.findOrReturn(i,r))}findPosParam(n,t,r){let o=r[t.path.substring(1)];if(!o)throw new ge(4001,!1);return o}findOrReturn(n,t){let r=0;for(let o of t){if(o.path===n.path)return t.splice(r),o;r++}return n}};function OA(e,n,t){if(typeof e=="string")return Promise.resolve(e);let r=e,{queryParams:o,fragment:i,routeConfig:a,url:l,outlet:u,params:p,data:g,title:m,paramMap:v,queryParamMap:h}=n;return df(_a(pn(t,()=>r({params:p,data:g,queryParams:o,fragment:i,routeConfig:a,url:l,outlet:u,title:m,paramMap:v,queryParamMap:h}))))}function TA(e,n){return e.providers&&!e._injector&&(e._injector=us(e.providers,n,`Route: ${e.path}`)),e._injector??n}function so(e){return e.outlet||Ze}function PA(e,n){let t=e.filter(r=>so(r)===n);return t.push(...e.filter(r=>so(r)!==n)),t}var mv={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function SA(e,n,t,r,o,i){let a=_M(e,n,t);return a.matched?(r=TA(n,r),MA(r,n,t,o,i).pipe(Tt(l=>l===!0?a:Y({},mv)))):et(a)}function _M(e,n,t){if(n.path==="")return n.pathMatch==="full"&&(e.hasChildren()||t.length>0)?Y({},mv):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let o=(n.matcher||$y)(t,e,n);if(!o)return Y({},mv);let i={};Object.entries(o.posParams??{}).forEach(([l,u])=>{i[l]=u.path});let a=o.consumed.length>0?Y(Y({},i),o.consumed[o.consumed.length-1].parameters):i;return{matched:!0,consumedSegments:o.consumed,remainingSegments:t.slice(o.consumed.length),parameters:a,positionalParamSegments:o.posParams??{}}}function Uy(e,n,t,r){return t.length>0&&IA(e,t,r)?{segmentGroup:new _t(n,kA(r,new _t(t,e.children))),slicedSegments:[]}:t.length===0&&AA(e,t,r)?{segmentGroup:new _t(e.segments,DA(e,t,r,e.children)),slicedSegments:t}:{segmentGroup:new _t(e.segments,e.children),slicedSegments:t}}function DA(e,n,t,r){let o={};for(let i of t)if(Sf(e,n,i)&&!r[so(i)]){let a=new _t([],{});o[so(i)]=a}return Y(Y({},r),o)}function kA(e,n){let t={};t[Ze]=n;for(let r of e)if(r.path===""&&so(r)!==Ze){let o=new _t([],{});t[so(r)]=o}return t}function IA(e,n,t){return t.some(r=>Sf(e,n,r)&&so(r)!==Ze)}function AA(e,n,t){return t.some(r=>Sf(e,n,r))}function Sf(e,n,t){return(e.hasChildren()||n.length>0)&&t.pathMatch==="full"?!1:t.path===""}function NA(e,n,t){return n.length===0&&!e.children[t]}var hv=class{};async function FA(e,n,t,r,o,i,a="emptyOnly",l){return new vv(e,n,t,r,o,a,i,l).recognize()}var RA=31,vv=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(n,t,r,o,i,a,l,u){this.injector=n,this.configLoader=t,this.rootComponentType=r,this.config=o,this.urlTree=i,this.paramsInheritanceStrategy=a,this.urlSerializer=l,this.abortSignal=u,this.applyRedirects=new gv(this.urlSerializer,this.urlTree)}noMatchError(n){return new ge(4002,`'${n.segmentGroup}'`)}async recognize(){let n=Uy(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:r}=await this.match(n),o=new Mr(r,t),i=new sl("",o),a=nM(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,i.url=this.urlSerializer.serialize(a),{state:i,tree:a}}async match(n){let t=new ha([],Object.freeze({}),Object.freeze(Y({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Ze,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,n,Ze,t),rootSnapshot:t}}catch(r){if(r instanceof ll)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ei?this.noMatchError(r):r}}async processSegmentGroup(n,t,r,o,i){if(r.segments.length===0&&r.hasChildren())return this.processChildren(n,t,r,i);let a=await this.processSegment(n,t,r,r.segments,o,!0,i);return a instanceof Mr?[a]:[]}async processChildren(n,t,r,o){let i=[];for(let u of Object.keys(r.children))u==="primary"?i.unshift(u):i.push(u);let a=[];for(let u of i){let p=r.children[u],g=PA(t,u),m=await this.processSegmentGroup(n,g,p,u,o);a.push(...m)}let l=CM(a);return LA(l),l}async processSegment(n,t,r,o,i,a,l){for(let u of t)try{return await this.processSegmentAgainstRoute(u._injector??n,t,u,r,o,i,a,l)}catch(p){if(p instanceof ei||mM(p))continue;throw p}if(NA(r,o,i))return new hv;throw new ei(r)}async processSegmentAgainstRoute(n,t,r,o,i,a,l,u){if(so(r)!==a&&(a===Ze||!Sf(o,i,r)))throw new ei(o);if(r.redirectTo===void 0)return this.matchSegmentAgainstRoute(n,o,r,i,a,u);if(this.allowRedirects&&l)return this.expandSegmentAgainstRouteUsingRedirect(n,o,t,r,i,a,u);throw new ei(o)}async expandSegmentAgainstRouteUsingRedirect(n,t,r,o,i,a,l){let{matched:u,parameters:p,consumedSegments:g,positionalParamSegments:m,remainingSegments:v}=_M(t,o,i);if(!u)throw new ei(t);typeof o.redirectTo=="string"&&o.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>RA&&(this.allowRedirects=!1));let h=new ha(i,p,Object.freeze(Y({},this.urlTree.queryParams)),this.urlTree.fragment,Wy(o),so(o),o.component??o._loadedComponent??null,o,zy(o),n),b=Ef(h,l,this.paramsInheritanceStrategy);if(h.params=Object.freeze(b.params),h.data=Object.freeze(b.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let x=await this.applyRedirects.applyRedirectCommands(g,o.redirectTo,m,h,n),y=await this.applyRedirects.lineralizeSegments(o,x);return this.processSegment(n,r,t,y.concat(v),a,!1,l)}async matchSegmentAgainstRoute(n,t,r,o,i,a){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let l=await df(SA(t,r,o,n,this.urlSerializer,this.abortSignal));if(r.path==="**"&&(t.children={}),!l?.matched)throw new ei(t);n=r._injector??n;let{routes:u}=await this.getChildConfig(n,r,o),p=r._loadedInjector??n,{parameters:g,consumedSegments:m,remainingSegments:v}=l,h=new ha(m,g,Object.freeze(Y({},this.urlTree.queryParams)),this.urlTree.fragment,Wy(r),so(r),r.component??r._loadedComponent??null,r,zy(r),n),b=Ef(h,a,this.paramsInheritanceStrategy);h.params=Object.freeze(b.params),h.data=Object.freeze(b.data);let{segmentGroup:x,slicedSegments:y}=Uy(t,m,v,u);if(y.length===0&&x.hasChildren()){let V=await this.processChildren(p,u,x,h);return new Mr(h,V)}if(u.length===0&&y.length===0)return new Mr(h,[]);let A=so(r)===i,L=await this.processSegment(p,u,x,y,A?Ze:i,!0,h);return new Mr(h,L instanceof Mr?[L]:[])}async getChildConfig(n,t,r){if(t.children)return{routes:t.children,injector:n};if(t.loadChildren){if(t._loadedRoutes!==void 0){let i=t._loadedNgModuleFactory;return i&&!t._loadedInjector&&(t._loadedInjector=i.create(n).injector),{routes:t._loadedRoutes,injector:t._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await df(yA(n,t,r,this.urlSerializer,this.abortSignal))){let i=await this.configLoader.loadChildren(n,t);return t._loadedRoutes=i.routes,t._loadedInjector=i.injector,t._loadedNgModuleFactory=i.factory,i}throw EA(t)}return{routes:[],injector:n}}};function LA(e){e.sort((n,t)=>n.value.outlet===Ze?-1:t.value.outlet===Ze?1:n.value.outlet.localeCompare(t.value.outlet))}function BA(e){let n=e.value.routeConfig;return n&&n.path===""}function CM(e){let n=[],t=new Set;for(let r of e){if(!BA(r)){n.push(r);continue}let o=n.find(i=>r.value.routeConfig===i.value.routeConfig);o!==void 0?(o.children.push(...r.children),t.add(o)):n.push(r)}for(let r of t){let o=CM(r.children);n.push(new Mr(r.value,o))}return n.filter(r=>!t.has(r))}function Wy(e){return e.data||{}}function zy(e){return e.resolve||{}}function VA(e,n,t,r,o,i,a){return Dn(async l=>{let{state:u,tree:p}=await FA(e,n,t,r,l.extractedUrl,o,i,a);return nt(Y({},l),{targetSnapshot:u,urlAfterRedirects:p})})}function jA(e){return Dn(n=>{let{targetSnapshot:t,guards:{canActivateChecks:r}}=n;if(!r.length)return et(n);let o=new Set(r.map(l=>l.route)),i=new Set;for(let l of o)if(!i.has(l))for(let u of bM(l))i.add(u);let a=0;return Xt(i).pipe(fi(l=>o.has(l)?UA(l,t,e):(l.data=Ef(l,l.parent,e).resolve,et(void 0))),ho(()=>a++),Md(1),Dn(l=>a===i.size?et(n):Sn))})}function bM(e){let n=e.children.map(t=>bM(t)).flat();return[e,...n]}function UA(e,n,t){let r=e.routeConfig,o=e._resolve;return r?.title!==void 0&&!dM(r)&&(o[dl]=r.title),ac(()=>(e.data=Ef(e,e.parent,t).resolve,WA(o,e,n).pipe(Tt(i=>(e._resolvedData=i,e.data=Y(Y({},e.data),i),null)))))}function WA(e,n,t){let r=iv(e);if(r.length===0)return et({});let o={};return Xt(r).pipe(Dn(i=>zA(e[i],n,t).pipe(Vo(),ho(a=>{if(a instanceof Ts)throw Of(new ti,a);o[i]=a}))),Md(1),Tt(()=>o),Ha(i=>mM(i)?Sn:$0(i)))}function zA(e,n,t){let r=n._environmentInjector,o=Ss(e,r),i=o.resolve?o.resolve(n,t):pn(r,()=>o(n,t));return _a(i)}function Hy(e){return Dr(n=>{let t=e(n);return t?Xt(t).pipe(Tt(()=>n)):et(n)})}var yv=(()=>{class e{buildTitle(t){let r,o=t.root;for(;o!==void 0;)r=this.getResolvedTitleForRoute(o)??r,o=o.children.find(i=>i.outlet===Ze);return r}getResolvedTitleForRoute(t){return t.data[dl]}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:()=>K(yM),providedIn:"root"})}return e})(),yM=(()=>{class e extends yv{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||e)(Le(Fy))};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Ii=new Me("",{factory:()=>({})}),Ds=new Me(""),Df=(()=>{class e{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=K(mh);async loadComponent(t,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let o=(async()=>{try{let i=await qy(pn(t,()=>r.loadComponent())),a=await EM(wM(i));return this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=a,a}finally{this.componentLoaders.delete(r)}})();return this.componentLoaders.set(r,o),o}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=(async()=>{try{let i=await MM(r,this.compiler,t,this.onLoadEndListener);return r._loadedRoutes=i.routes,r._loadedInjector=i.injector,r._loadedNgModuleFactory=i.factory,i}finally{this.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();async function MM(e,n,t,r){let o=await qy(pn(t,()=>e.loadChildren())),i=await EM(wM(o)),a;i instanceof Eu||Array.isArray(i)?a=i:a=await n.compileModuleAsync(i),r&&r(e);let l,u,p=!1,g;return Array.isArray(a)?(u=a,p=!0):(l=a.create(t).injector,g=a,u=l.get(Ds,[],{optional:!0,self:!0}).flat()),{routes:u.map(bv),injector:l,factory:g}}function HA(e){return e&&typeof e=="object"&&"default"in e}function wM(e){return HA(e)?e.default:e}async function EM(e){return e}var kf=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:()=>K($A),providedIn:"root"})}return e})(),$A=(()=>{class e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Mv=new Me(""),wv=new Me("");function OM(e,n,t){let r=e.get(wv),o=e.get(Yt);if(!o.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(p=>setTimeout(p));let i,a=new Promise(p=>{i=p}),l=o.startViewTransition(()=>(i(),GA(e)));l.updateCallbackDone.catch(p=>{}),l.ready.catch(p=>{}),l.finished.catch(p=>{});let{onViewTransitionCreated:u}=r;return u&&pn(e,()=>u({transition:l,from:n,to:t})),a}function GA(e){return new Promise(n=>{ds({read:()=>setTimeout(n)},{injector:e})})}var qA=()=>{},Ev=new Me(""),If=(()=>{class e{currentNavigation=Rt(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=Rt(null);events=new fn;transitionAbortWithErrorSubject=new fn;configLoader=K(Df);environmentInjector=K(Gt);destroyRef=K(br);urlSerializer=K(Ca);rootContexts=K(ba);location=K(Ti);inputBindingEnabled=K(ul,{optional:!0})!==null;titleStrategy=K(yv);options=K(Ii,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=K(kf);createViewTransition=K(Mv,{optional:!0});navigationErrorHandler=K(Ev,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>et(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=o=>this.events.next(new vf(o)),r=o=>this.events.next(new xf(o));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;gn(()=>{this.transitions?.next(nt(Y({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))})}setupNavigations(t){return this.transitions=new Pn(null),this.transitions.pipe(_r(r=>r!==null),Dr(r=>{let o=!1,i=new AbortController,a=()=>!o&&this.currentTransition?.id===r.id;return et(r).pipe(Dr(l=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",Xn.SupersededByNewNavigation),Sn;this.currentTransition=r;let u=this.lastSuccessfulNavigation();this.currentNavigation.set({id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:u?nt(Y({},u),{previousNavigation:null}):null,abort:()=>i.abort()});let p=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),g=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!p&&g!=="reload")return this.events.next(new So(l.id,this.urlSerializer.serialize(l.rawUrl),"",ys.IgnoredSameUrlNavigation)),l.resolve(!1),Sn;if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return et(l).pipe(Dr(m=>(this.events.next(new ki(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),m.id!==this.navigationId?Sn:Promise.resolve(m))),VA(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,i.signal),ho(m=>{r.targetSnapshot=m.targetSnapshot,r.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation.update(h=>(h.finalUrl=m.urlAfterRedirects,h));let v=new Ms(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(v)}));if(p&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:m,extractedUrl:v,source:h,restoredState:b,extras:x}=l,y=new ki(m,this.urlSerializer.serialize(v),h,b);this.events.next(y);let A=cM(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=r=nt(Y({},l),{targetSnapshot:A,urlAfterRedirects:v,extras:nt(Y({},x),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(L=>(L.finalUrl=v,L)),et(r)}else return this.events.next(new So(l.id,this.urlSerializer.serialize(l.extractedUrl),"",ys.IgnoredByUrlHandlingStrategy)),l.resolve(!1),Sn}),Tt(l=>{let u=new pf(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);return this.events.next(u),this.currentTransition=r=nt(Y({},l),{guards:rA(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),r}),gA(l=>this.events.next(l)),Dr(l=>{if(r.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw Of(this.urlSerializer,l.guardsResult);let u=new gf(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);if(this.events.next(u),!a())return Sn;if(!l.guardsResult)return this.cancelNavigationTransition(l,"",Xn.GuardRejected),Sn;if(l.guards.canActivateChecks.length===0)return et(l);let p=new mf(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);if(this.events.next(p),!a())return Sn;let g=!1;return et(l).pipe(jA(this.paramsInheritanceStrategy),ho({next:()=>{g=!0;let m=new hf(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(m)},complete:()=>{g||this.cancelNavigationTransition(l,"",Xn.NoDataFromResolver)}}))}),Hy(l=>{let u=g=>{let m=[];if(g.routeConfig?._loadedComponent)g.component=g.routeConfig?._loadedComponent;else if(g.routeConfig?.loadComponent){let v=g._environmentInjector;m.push(this.configLoader.loadComponent(v,g.routeConfig).then(h=>{g.component=h}))}for(let v of g.children)m.push(...u(v));return m},p=u(l.targetSnapshot.root);return p.length===0?et(l):Xt(Promise.all(p).then(()=>l))}),Hy(()=>this.afterPreactivation()),Dr(()=>{let{currentSnapshot:l,targetSnapshot:u}=r,p=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return p?Xt(p).pipe(Tt(()=>r)):et(r)}),Bo(1),Tt(l=>{let u=JI(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);this.currentTransition=r=l=nt(Y({},l),{targetRouterState:u}),this.currentNavigation.update(p=>(p.targetRouterState=u,p)),this.events.next(new Es),a()&&(new pv(t.routeReuseStrategy,r.targetRouterState,r.currentRouterState,p=>this.events.next(p),this.inputBindingEnabled).activate(this.rootContexts),a()&&(o=!0,this.currentNavigation.update(p=>(p.abort=qA,p)),this.lastSuccessfulNavigation.set(gn(this.currentNavigation)),this.events.next(new Ur(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)))}),sc(hM(i.signal).pipe(_r(()=>!o&&!r.targetRouterState),ho(()=>{this.cancelNavigationTransition(r,i.signal.reason+"",Xn.Aborted)}))),ho({complete:()=>{o=!0}}),sc(this.transitionAbortWithErrorSubject.pipe(ho(l=>{throw l}))),$a(()=>{i.abort(),o||this.cancelNavigationTransition(r,"",Xn.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Ha(l=>{if(o=!0,this.destroyed)return r.resolve(!1),Sn;if(gM(l))this.events.next(new jr(r.id,this.urlSerializer.serialize(r.extractedUrl),l.message,l.cancellationCode)),nA(l)?this.events.next(new Os(l.url,l.navigationBehaviorOptions)):r.resolve(!1);else{let u=new xa(r.id,this.urlSerializer.serialize(r.extractedUrl),l,r.targetSnapshot??void 0);try{let p=pn(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(p instanceof Ts){let{message:g,cancellationCode:m}=Of(this.urlSerializer,p);this.events.next(new jr(r.id,this.urlSerializer.serialize(r.extractedUrl),g,m)),this.events.next(new Os(p.redirectTo,p.navigationBehaviorOptions))}else throw this.events.next(u),l}catch(p){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(p)}}return Sn}))}))}cancelNavigationTransition(t,r,o){let i=new jr(t.id,this.urlSerializer.serialize(t.extractedUrl),r,o);this.events.next(i),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=gn(this.currentNavigation),o=r?.targetBrowserUrl??r?.extractedUrl;return t.toString()!==o?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function XA(e){return e!==Cs}var TM=new Me("");var PM=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:()=>K(YA),providedIn:"root"})}return e})(),Pf=class{shouldDetach(n){return!1}store(n,t){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,t){return n.routeConfig===t.routeConfig}shouldDestroyInjector(n){return!0}},YA=(()=>{class e extends Pf{static \u0275fac=(()=>{let t;return function(o){return(t||(t=no(e)))(o||e)}})();static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Ov=(()=>{class e{urlSerializer=K(Ca);options=K(Ii,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=K(Ti);urlHandlingStrategy=K(kf);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new co;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:o}){let i=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,a=o??i;return a instanceof co?this.urlSerializer.serialize(a):a}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:o}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,o),this.routerState=t):this.rawUrlTree=o}routerState=cM(null,K(Gt));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:()=>K(KA),providedIn:"root"})}return e})(),KA=(()=>{class e extends Ov{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof ki?this.updateStateMemento():t instanceof So?this.commitTransition(r):t instanceof Ms?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof Es?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof jr&&!sM(t)?this.restoreHistory(r):t instanceof xa?this.restoreHistory(r,!0):t instanceof Ur&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:o}){let{replaceUrl:i,state:a}=r;if(this.location.isCurrentPathEqualTo(t)||i){let l=this.browserPageId,u=Y(Y({},a),this.generateNgRouterState(o,l));this.location.replaceState(t,"",u)}else{let l=Y(Y({},a),this.generateNgRouterState(o,this.browserPageId+1));this.location.go(t,"",l)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,i=this.currentPageId-o;i!==0?this.location.historyGo(i):this.getCurrentUrlTree()===t.finalUrl&&i===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(o){return(t||(t=no(e)))(o||e)}})();static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Af(e,n){e.events.pipe(_r(t=>t instanceof Ur||t instanceof jr||t instanceof xa||t instanceof So),Tt(t=>t instanceof Ur||t instanceof So?0:(t instanceof jr?t.code===Xn.Redirect||t.code===Xn.SupersededByNewNavigation:!1)?2:1),_r(t=>t!==2),Bo(1)).subscribe(()=>{n()})}var SM={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},DM={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ye=(()=>{class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=K(nh);stateManager=K(Ov);options=K(Ii,{optional:!0})||{};pendingTasks=K($o);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=K(If);urlSerializer=K(Ca);location=K(Ti);urlHandlingStrategy=K(kf);injector=K(Gt);_events=new fn;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=K(PM);injectorCleanup=K(TM,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=K(Ds,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!K(ul,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new Tn;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let o=this.navigationTransitions.currentTransition,i=gn(this.navigationTransitions.currentNavigation);if(o!==null&&i!==null){if(this.stateManager.handleRouterEvent(r,i),r instanceof jr&&r.code!==Xn.Redirect&&r.code!==Xn.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Ur)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(r instanceof Os){let a=r.navigationBehaviorOptions,l=this.urlHandlingStrategy.merge(r.url,o.currentRawUrl),u=Y({scroll:o.extras.scroll,browserUrl:o.extras.browserUrl,info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||XA(o.source)},a);this.scheduleNavigation(l,Cs,null,u,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}ZI(r)&&this._events.next(r)}catch(o){this.navigationTransitions.transitionAbortWithErrorSubject.next(o)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Cs,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,o)=>{this.navigateToSyncWithBrowser(t,o,r)})}navigateToSyncWithBrowser(t,r,o){let i={replaceUrl:!0},a=o?.navigationId?o:null;if(o){let u=Y({},o);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(i.state=u)}let l=this.parseUrl(t);this.scheduleNavigation(l,r,a,i).catch(u=>{this.disposed||this.injector.get(Fr)(u)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return gn(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(bv),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:o,queryParams:i,fragment:a,queryParamsHandling:l,preserveFragment:u}=r,p=u?this.currentUrlTree.fragment:a,g=null;switch(l??this.options.defaultQueryParamsHandling){case"merge":g=Y(Y({},this.currentUrlTree.queryParams),i);break;case"preserve":g=this.currentUrlTree.queryParams;break;default:g=i||null}g!==null&&(g=this.removeEmptyProps(g));let m;try{let v=o?o.snapshot:this.routerState.snapshot.root;m=rM(v)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),m=this.currentUrlTree.root}return oM(m,t,g,p??null,this.urlSerializer)}navigateByUrl(t,r={skipLocationChange:!1}){let o=Di(t)?t:this.parseUrl(t),i=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(i,Cs,null,r)}navigate(t,r={skipLocationChange:!1}){return ZA(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(Wo(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,r){let o;if(r===!0?o=Y({},SM):r===!1?o=Y({},DM):o=r,Di(t))return Ry(this.currentUrlTree,t,o);let i=this.parseUrl(t);return Ry(this.currentUrlTree,i,o)}removeEmptyProps(t){return Object.entries(t).reduce((r,[o,i])=>(i!=null&&(r[o]=i),r),{})}scheduleNavigation(t,r,o,i,a){if(this.disposed)return Promise.resolve(!1);let l,u,p;a?(l=a.resolve,u=a.reject,p=a.promise):p=new Promise((m,v)=>{l=m,u=v});let g=this.pendingTasks.add();return Af(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(g))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:i,resolve:l,reject:u,promise:p,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),p.catch(Promise.reject.bind(Promise))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function ZA(e){for(let n=0;n<e.length;n++)if(e[n]==null)throw new ge(4008,!1)}var Nf=(()=>{class e{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=Rt(null);get href(){return gn(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new fn;applicationErrorHandler=K(Fr);options=K(Ii,{optional:!0});constructor(t,r,o,i,a,l){this.router=t,this.route=r,this.tabIndexAttribute=o,this.renderer=i,this.el=a,this.locationStrategy=l,this.reactiveHref.set(K(new Iu("href"),{optional:!0}));let u=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area"||!!(typeof customElements=="object"&&customElements.get(u)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){this.subscription===void 0&&(this.subscription=this.router.events.subscribe(t=>{t instanceof Ur&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Di(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,o,i,a){let l=this.urlTree;if(l===null||this.isAnchorElement&&(t!==0||r||o||i||a||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(l,u)?.catch(p=>{this.applicationErrorHandler(p)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,r){let o=this.renderer,i=this.el.nativeElement;r!==null?o.setAttribute(i,t,r):o.removeAttribute(i,t)}get urlTree(){return this.routerLinkInput===null?null:Di(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||e)(j(ye),j(ni),Rc("tabindex"),j(ro),j(Rr),j(io))};static \u0275dir=Kt({type:e,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(r,o){r&1&&E("click",function(a){return o.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),r&2&&fs("href",o.reactiveHref(),Am)("target",o.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",ua],skipLocationChange:[2,"skipLocationChange","skipLocationChange",ua],replaceUrl:[2,"replaceUrl","replaceUrl",ua],routerLink:"routerLink"},features:[Go]})}return e})();var pl=class{};var kM=(()=>{class e{router;injector;preloadingStrategy;loader;subscription;constructor(t,r,o,i){this.router=t,this.injector=r,this.preloadingStrategy=o,this.loader=i}setUpPreloading(){this.subscription=this.router.events.pipe(_r(t=>t instanceof Ur),fi(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription?.unsubscribe()}processRoutes(t,r){let o=[];for(let i of r){i.providers&&!i._injector&&(i._injector=us(i.providers,t,""));let a=i._injector??t;i._loadedNgModuleFactory&&!i._loadedInjector&&(i._loadedInjector=i._loadedNgModuleFactory.create(a).injector);let l=i._loadedInjector??a;(i.loadChildren&&!i._loadedRoutes&&i.canLoad===void 0||i.loadComponent&&!i._loadedComponent)&&o.push(this.preloadConfig(a,i)),(i.children||i._loadedRoutes)&&o.push(this.processRoutes(l,i.children??i._loadedRoutes))}return Xt(o).pipe(Wa())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{if(t.destroyed)return et(null);let o;r.loadChildren&&r.canLoad===void 0?o=Xt(this.loader.loadChildren(t,r)):o=et(null);let i=o.pipe(Dn(a=>a===null?et(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,r._loadedNgModuleFactory=a.factory,this.processRoutes(a.injector??t,a.routes))));if(r.loadComponent&&!r._loadedComponent){let a=this.loader.loadComponent(t,r);return Xt([i,a]).pipe(Wa())}else return i})}static \u0275fac=function(r){return new(r||e)(Le(ye),Le(Gt),Le(pl),Le(Df))};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),IM=new Me(""),JA=(()=>{class e{options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource=Cs;restoredId=0;store={};urlSerializer=K(Ca);zone=K(_n);viewportScroller=K(Rh);transitions=K(If);constructor(t){this.options=t,this.options.scrollPositionRestoration||="disabled",this.options.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof ki?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ur?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof So&&t.code===ys.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{if(!(t instanceof ws)||t.scrollBehavior==="manual")return;let r={behavior:"instant"};t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0],r):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position,r):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0])})}scheduleScrollEvent(t,r){let o=gn(this.transitions.currentNavigation)?.extras.scroll;this.zone.runOutsideAngular(async()=>{await new Promise(i=>{setTimeout(i),typeof requestAnimationFrame<"u"&&requestAnimationFrame(i)}),this.zone.run(()=>{this.transitions.events.next(new ws(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r,o))})})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){Zm()};static \u0275prov=we({token:e,factory:e.\u0275fac})}return e})();function e4(){return K(ye).routerState.root}function gl(e,n){return{\u0275kind:e,\u0275providers:n}}function t4(){let e=K(Hn);return n=>{let t=e.get(Eo);if(n!==t.components[0])return;let r=e.get(ye),o=e.get(AM);e.get(Pv)===1&&r.initialNavigation(),e.get(RM,null,{optional:!0})?.setUpPreloading(),e.get(IM,null,{optional:!0})?.init(),r.resetRootComponentType(t.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var AM=new Me("",{factory:()=>new fn}),Pv=new Me("",{factory:()=>1});function NM(){let e=[{provide:km,useValue:!0},{provide:Pv,useValue:0},Su(()=>{let n=K(Hn);return n.get(Eh,Promise.resolve()).then(()=>new Promise(r=>{let o=n.get(ye),i=n.get(AM);Af(o,()=>{r(!0)}),n.get(If).afterPreactivation=()=>(r(!0),i.closed?et(void 0):i),o.initialNavigation()}))})];return gl(2,e)}function FM(){let e=[Su(()=>{K(ye).setUpLocationChangeListener()}),{provide:Pv,useValue:2}];return gl(3,e)}var RM=new Me("");function LM(e){return gl(0,[{provide:RM,useExisting:kM},{provide:pl,useExisting:e}])}function BM(){return gl(8,[_v,{provide:ul,useExisting:_v}])}function VM(e){Xo("NgRouterViewTransitions");let n=[{provide:Mv,useValue:OM},{provide:wv,useValue:Y({skipNextTransition:!!e?.skipInitialTransition},e)}];return gl(9,n)}var jM=[Ti,{provide:Ca,useClass:ti},ye,ba,{provide:ni,useFactory:e4},Df,[]],Wr=(()=>{class e{constructor(){}static forRoot(t,r){return{ngModule:e,providers:[jM,[],{provide:Ds,multi:!0,useValue:t},[],r?.errorHandler?{provide:Ev,useValue:r.errorHandler}:[],{provide:Ii,useValue:r||{}},r?.useHash?r4():o4(),n4(),r?.preloadingStrategy?LM(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?i4(r):[],r?.bindToComponentInputs?BM().\u0275providers:[],r?.enableViewTransitions?VM().\u0275providers:[],a4()]}}static forChild(t){return{ngModule:e,providers:[{provide:Ds,multi:!0,useValue:t}]}}static \u0275fac=function(r){return new(r||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({})}return e})();function n4(){return{provide:IM,useFactory:()=>{let e=K(Rh),n=K(Ii);return n.scrollOffset&&e.setOffset(n.scrollOffset),new JA(n)}}}function r4(){return{provide:io,useClass:Ih}}function o4(){return{provide:io,useClass:Lu}}function i4(e){return[e.initialNavigation==="disabled"?FM().\u0275providers:[],e.initialNavigation==="enabledBlocking"?NM().\u0275providers:[]]}var Tv=new Me("");function a4(){return[{provide:Tv,useFactory:t4},{provide:Du,multi:!0,useExisting:Tv}]}var Ff=class e{constructor(n){this.router=n}currentYear=new Date().getFullYear();navigateToOperation(){this.router.navigate(["/operation"])}navigateToAccounting(){this.router.navigate(["/accounting"])}static \u0275fac=function(t){return new(t||e)(j(ye))};static \u0275cmp=se({type:e,selectors:[["app-landing"]],standalone:!1,decls:76,vars:1,consts:[[1,"landing-container"],[1,"hero"],[1,"logo-wrapper"],[1,"logo-circle"],["width","40","height","40","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"],["cx","12","cy","12","r","3"],[1,"title"],[1,"title-main"],[1,"title-accent"],[1,"subtitle"],[1,"title-divider"],[1,"cards-section"],["tabindex","0",1,"module-card","operation-card",3,"click","keydown.enter"],[1,"card-content"],[1,"card-icon-wrapper","operation-icon"],["width","32","height","32","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M12 2L2 7l10 5 10-5-10-5z"],["d","M2 17l10 5 10-5"],["d","M2 12l10 5 10-5"],[1,"card-text"],[1,"card-description"],[1,"card-features"],[1,"feature-dot","operation-dot"],[1,"card-action"],["width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M5 12h14"],["d","m12 5 7 7-7 7"],["tabindex","0",1,"module-card","accounting-card",3,"click","keydown.enter"],[1,"card-icon-wrapper","accounting-icon"],["x","3","y","3","width","18","height","18","rx","2"],["d","M9 17V10"],["d","M12 17V7"],["d","M15 17v-4"],[1,"feature-dot","accounting-dot"],[1,"landing-footer"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3),Mi(),c(4,"svg",4),le(5,"path",5)(6,"circle",6),s()()(),wi(),c(7,"h1",7)(8,"span",8),d(9,"Diving"),s(),c(10,"span",9),d(11,"System"),s()(),c(12,"p",10),d(13,"Select your workspace to get started"),s(),le(14,"div",11),s(),c(15,"main",12)(16,"div",13),E("click",function(){return r.navigateToOperation()})("keydown.enter",function(){return r.navigateToOperation()}),c(17,"div",14)(18,"div",15),Mi(),c(19,"svg",16),le(20,"path",17)(21,"path",18)(22,"path",19),s()(),wi(),c(23,"div",20)(24,"h2"),d(25,"Operation"),s(),c(26,"p",21),d(27,"Access the operational system including dashboard, entries, codes, and reports"),s()(),c(28,"ul",22)(29,"li"),le(30,"span",23),d(31," Dashboard & Analytics "),s(),c(32,"li"),le(33,"span",23),d(34," Entries Management "),s(),c(35,"li"),le(36,"span",23),d(37," Codes & Reports "),s()(),c(38,"div",24)(39,"span"),d(40,"Enter Module"),s(),Mi(),c(41,"svg",25),le(42,"path",26)(43,"path",27),s()()()(),wi(),c(44,"div",28),E("click",function(){return r.navigateToAccounting()})("keydown.enter",function(){return r.navigateToAccounting()}),c(45,"div",14)(46,"div",29),Mi(),c(47,"svg",16),le(48,"rect",30)(49,"path",31)(50,"path",32)(51,"path",33),s()(),wi(),c(52,"div",20)(53,"h2"),d(54,"Accounting"),s(),c(55,"p",21),d(56,"Business accounting module with codes and entries management"),s()(),c(57,"ul",22)(58,"li"),le(59,"span",34),d(60," Financial Codes "),s(),c(61,"li"),le(62,"span",34),d(63," Journal Entries "),s(),c(64,"li"),le(65,"span",34),d(66," Ledger & Balances "),s()(),c(67,"div",24)(68,"span"),d(69,"Enter Module"),s(),Mi(),c(70,"svg",25),le(71,"path",26)(72,"path",27),s()()()()(),wi(),c(73,"footer",35)(74,"p"),d(75),s()()()),t&2&&(f(75),ue("\xA9 ",r.currentYear," Diving System \u2014 All Rights Reserved"))},styles:['@charset "UTF-8";.landing-container[_ngcontent-%COMP%]{position:relative;min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem 1.5rem 1rem;background:var(--dm-primary);font-family:Inter,sans-serif}.hero[_ngcontent-%COMP%]{position:relative;z-index:1;text-align:center;margin-bottom:3rem}.logo-wrapper[_ngcontent-%COMP%]{margin-bottom:1.25rem}.logo-circle[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:76px;height:76px;border-radius:50%;background:var(--dm-highlight);color:#fff;box-shadow:0 0 0 6px #e9456026,0 8px 24px #0000004d;transition:transform .3s ease}.logo-circle[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.title[_ngcontent-%COMP%]{font-size:2.8rem;font-weight:700;line-height:1.15;color:#fff;letter-spacing:-.5px}.title-main[_ngcontent-%COMP%]{display:block}.title-accent[_ngcontent-%COMP%]{display:block;color:var(--dm-highlight);font-weight:800}.subtitle[_ngcontent-%COMP%]{margin-top:.6rem;font-size:1.05rem;color:#ffffff8c;font-weight:400}.title-divider[_ngcontent-%COMP%]{margin:1.25rem auto 0;width:48px;height:3px;border-radius:3px;background:var(--dm-highlight)}.cards-section[_ngcontent-%COMP%]{position:relative;z-index:1;display:grid;grid-template-columns:repeat(2,1fr);gap:1.5rem;max-width:800px;width:100%}.module-card[_ngcontent-%COMP%]{position:relative;border-radius:var(--dm-radius);padding:2rem 1.8rem 1.6rem;cursor:pointer;background:var(--dm-secondary);border:1px solid rgba(255,255,255,.06);transition:transform .25s ease,box-shadow .25s ease,border-color .25s ease;overflow:hidden;outline:none}.module-card[_ngcontent-%COMP%]:hover, .module-card[_ngcontent-%COMP%]:focus-visible{transform:translateY(-4px);box-shadow:0 16px 40px #0000004d}.module-card[_ngcontent-%COMP%]:focus-visible{border-color:var(--dm-highlight)}.card-content[_ngcontent-%COMP%]{position:relative;z-index:1}.card-icon-wrapper[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:56px;height:56px;border-radius:var(--dm-radius);margin-bottom:1.1rem}.operation-icon[_ngcontent-%COMP%]{background:#10b9811f;color:#10b981}.accounting-icon[_ngcontent-%COMP%]{background:#e945601f;color:var(--dm-highlight)}.card-text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;color:#fff;margin-bottom:.35rem}.card-description[_ngcontent-%COMP%]{font-size:.85rem;color:#ffffff80;line-height:1.55;margin:0 0 1rem}.card-features[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0 0 1.2rem;display:flex;flex-direction:column;gap:.45rem}.card-features[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.8rem;color:#ffffff73;font-weight:400}.feature-dot[_ngcontent-%COMP%]{width:5px;height:5px;border-radius:50%;flex-shrink:0}.operation-dot[_ngcontent-%COMP%]{background:#10b981}.accounting-dot[_ngcontent-%COMP%]{background:var(--dm-highlight)}.card-action[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;font-size:.82rem;font-weight:600;color:#ffffff80;transition:color .2s ease}.card-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transition:transform .2s ease}.operation-card[_ngcontent-%COMP%]:hover   .card-action[_ngcontent-%COMP%], .operation-card[_ngcontent-%COMP%]:focus-visible   .card-action[_ngcontent-%COMP%]{color:#10b981}.accounting-card[_ngcontent-%COMP%]:hover   .card-action[_ngcontent-%COMP%], .accounting-card[_ngcontent-%COMP%]:focus-visible   .card-action[_ngcontent-%COMP%]{color:var(--dm-highlight)}.module-card[_ngcontent-%COMP%]:hover   .card-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .module-card[_ngcontent-%COMP%]:focus-visible   .card-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:translate(4px)}.operation-card[_ngcontent-%COMP%]{border-left:3px solid #10b981}.accounting-card[_ngcontent-%COMP%]{border-left:3px solid var(--dm-highlight)}.landing-footer[_ngcontent-%COMP%]{position:relative;z-index:1;margin-top:3rem;text-align:center}.landing-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem;color:#ffffff40;font-weight:400}@media(max-width:768px){.landing-container[_ngcontent-%COMP%]{padding:1.5rem 1rem 1rem}.title[_ngcontent-%COMP%]{font-size:2rem}.logo-circle[_ngcontent-%COMP%]{width:64px;height:64px}.logo-circle[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:32px;height:32px}.cards-section[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1.25rem}.module-card[_ngcontent-%COMP%]{padding:1.6rem 1.4rem 1.4rem}}@media(max-width:420px){.title[_ngcontent-%COMP%]{font-size:1.7rem}.subtitle[_ngcontent-%COMP%]{font-size:.92rem}.card-text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem}}'],changeDetection:0})};var Rf=class e{router=K(ye);userName="Ibram";userInitials="IW";notificationCount=3;navigateToLanding(){this.router.navigate([""])}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-navbar"]],standalone:!1,decls:19,vars:2,consts:[[1,"header"],[1,"logo-section",3,"click"],[1,"logo"],[1,"logo-icon"],[1,"logo-text"],[1,"header-center"],[1,"system-title"],[1,"header-right"],[1,"user-section"],[1,"user-name"],[1,"user-avatar"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1),E("click",function(){return r.navigateToLanding()}),c(2,"div",2)(3,"span",3),d(4,"\u{1F93F}"),s()(),c(5,"div",4)(6,"h1"),d(7,"Dive UP"),s(),c(8,"p"),d(9,"Diving Center"),s()()(),c(10,"div",5)(11,"div",6),d(12,"Diving Center Management System"),s()(),c(13,"div",7)(14,"div",8)(15,"span",9),d(16),s(),c(17,"div",10),d(18),s()()()()),t&2&&(f(16),M(r.userName),f(2),M(r.userInitials))},styles:[".header[_ngcontent-%COMP%]{background:var(--dm-surface);padding:0 28px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 1px 3px #0000000f;z-index:100;position:relative;height:64px}.logo-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;cursor:pointer;padding:6px 10px;border-radius:var(--dm-radius-sm);transition:background .2s ease}.logo-section[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.logo-section[_ngcontent-%COMP%]:hover   .logo[_ngcontent-%COMP%]{box-shadow:0 4px 14px #0f34604d}.logo[_ngcontent-%COMP%]{width:42px;height:42px;background:linear-gradient(135deg,var(--dm-accent),var(--dm-primary));border-radius:10px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px #0f346033;transition:box-shadow .2s ease}.logo-icon[_ngcontent-%COMP%]{font-size:22px}.logo-text[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:16px;color:var(--dm-primary);font-weight:700;letter-spacing:-.3px}.logo-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px;color:var(--dm-text-muted);font-weight:400}.header-center[_ngcontent-%COMP%]{flex:1;max-width:500px;margin:0 32px}.system-title[_ngcontent-%COMP%]{text-align:center;color:var(--dm-primary);font-size:16px;font-weight:600;letter-spacing:-.2px}.header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.user-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;cursor:pointer;padding:5px 10px;border-radius:var(--dm-radius-sm);transition:background .2s ease}.user-section[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.user-avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,var(--dm-accent),var(--dm-highlight));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:12px;box-shadow:0 2px 8px #e9456040}.user-name[_ngcontent-%COMP%]{color:var(--dm-text);font-weight:500;font-size:13px}@media(max-width:768px){.header[_ngcontent-%COMP%]{padding:0 16px}.header-center[_ngcontent-%COMP%]{margin:0 12px}.system-title[_ngcontent-%COMP%]{font-size:13px}.user-name[_ngcontent-%COMP%]{display:none}}@media(max-width:576px){.header[_ngcontent-%COMP%]{height:56px;padding:0 12px}.header-center[_ngcontent-%COMP%]{display:none}.logo[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:8px}.logo-icon[_ngcontent-%COMP%]{font-size:18px}.logo-text[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:14px}.logo-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:none}}"]})};function c4(e,n){if(e&1&&(c(0,"a",2)(1,"span",3),d(2),s(),c(3,"span",4),d(4),s()()),e&2){let t=n.$implicit,r=q();Fn("active",r.isActive(t.route)),_("routerLink",t.route),f(2),M(t.icon),f(2),M(t.label)}}var Lf=class e{constructor(n){this.router=n}get menuItems(){return this.router.url.startsWith("/accounting")?[{label:"Dashboard",icon:"\u{1F3E0}",route:"/accounting/dashboard"},{label:"Entries",icon:"\u{1F4CB}",route:"/accounting/entries"},{label:"Codes",icon:"\u{1F3F7}\uFE0F",route:"/accounting/codes"},{label:"Reports",icon:"\u{1F4CA}",route:"/accounting/reports"}]:[{label:"Dashboard",icon:"\u{1F3E0}",route:"/operation/dashboard"},{label:"Entries",icon:"\u{1F4CB}",route:"/operation/entries"},{label:"Codes",icon:"\u{1F3F7}\uFE0F",route:"/operation/codes"},{label:"Reports",icon:"\u{1F4CA}",route:"/operation/reports"}]}isActive(n){return this.router.url===n||this.router.url.startsWith(n+"/")}static \u0275fac=function(t){return new(t||e)(j(ye))};static \u0275cmp=se({type:e,selectors:[["app-sidebar"]],standalone:!1,decls:2,vars:1,consts:[[1,"sidebar"],["class","menu-item",3,"active","routerLink",4,"ngFor","ngForOf"],[1,"menu-item",3,"routerLink"],[1,"menu-icon"],[1,"menu-label"]],template:function(t,r){t&1&&(c(0,"nav",0),H(1,c4,5,5,"a",1),s()),t&2&&(f(),_("ngForOf",r.menuItems))},dependencies:[Oe,Nf],styles:[".sidebar[_ngcontent-%COMP%]{width:240px;min-width:240px;height:100%;background:var(--dm-primary);padding:16px 10px;display:flex;flex-direction:column;gap:2px;overflow-y:auto}.menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:14px;padding:12px 18px;color:#ffffffa6;text-decoration:none;border-radius:var(--dm-radius-sm);transition:all .2s ease;cursor:pointer;font-size:14px;font-weight:400}.menu-item[_ngcontent-%COMP%]:hover{background:#ffffff14;color:#fff}.menu-item.active[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;font-weight:500;box-shadow:0 2px 10px #e945604d}.menu-icon[_ngcontent-%COMP%]{font-size:18px;width:24px;text-align:center;flex-shrink:0}.menu-label[_ngcontent-%COMP%]{white-space:nowrap}@media(max-width:768px){.sidebar[_ngcontent-%COMP%]{width:64px;min-width:64px;padding:16px 6px}.menu-label[_ngcontent-%COMP%]{display:none}.menu-item[_ngcontent-%COMP%]{justify-content:center;padding:12px;gap:0}}@media(max-width:576px){.sidebar[_ngcontent-%COMP%]{width:52px;min-width:52px;padding:12px 4px}.menu-item[_ngcontent-%COMP%]{padding:10px}.menu-icon[_ngcontent-%COMP%]{font-size:16px}}"]})};var ml=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-layout"]],standalone:!1,decls:5,vars:0,consts:[[1,"container"],[1,"main-content"]],template:function(t,r){t&1&&(le(0,"app-navbar"),c(1,"div",0),le(2,"app-sidebar"),c(3,"div",1),le(4,"router-outlet"),s()())},dependencies:[ya,Rf,Lf],styles:[".container[_ngcontent-%COMP%]{display:flex;height:calc(100vh - 64px);overflow:hidden}.main-content[_ngcontent-%COMP%]{flex:1;padding:28px 32px;overflow-y:auto;position:relative;background:var(--dm-bg)}@media(max-width:768px){.main-content[_ngcontent-%COMP%]{padding:20px 16px}}@media(max-width:576px){.main-content[_ngcontent-%COMP%]{padding:16px 12px}}"]})};function d4(e,n){if(e&1&&(c(0,"div",3)(1,"div",4),d(2),s(),c(3,"div",5),d(4),s()()),e&2){let t=n.$implicit;nn("background",t.gradient),f(2),M(t.value),f(2),M(t.label)}}var hl=class e{stats=[{label:"Today's Bookings",value:"24",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},{label:"Completed Dives",value:"12",gradient:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"},{label:"Occupancy Rate",value:"85%",gradient:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"},{label:"Monthly Revenue",value:"$12,450",gradient:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)"}];static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-dashboard"]],standalone:!1,decls:7,vars:1,consts:[[1,"welcome-section"],[1,"stats-container"],["class","stat-card",3,"background",4,"ngFor","ngForOf"],[1,"stat-card"],[1,"stat-number"],[1,"stat-label"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"h2"),d(2,"\u{1F30A} Welcome to Dive UP"),s(),c(3,"p"),d(4,"Professional diving center management system for all your operations"),s(),c(5,"div",1),H(6,d4,5,4,"div",2),s()()),t&2&&(f(6),_("ngForOf",r.stats))},dependencies:[Oe],styles:[".welcome-section[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);padding:48px 36px;text-align:center;box-shadow:var(--dm-shadow);max-width:900px;margin:40px auto;position:relative;z-index:1}.welcome-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--dm-primary);font-size:28px;margin-bottom:10px;font-weight:700}.welcome-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-size:15px;line-height:1.6}.stats-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:16px;margin-top:32px}.stat-card[_ngcontent-%COMP%]{padding:24px 18px;border-radius:var(--dm-radius);color:#fff;text-align:center;transition:transform .2s ease;box-shadow:var(--dm-shadow-md)}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}.stat-number[_ngcontent-%COMP%]{font-size:32px;font-weight:700;margin-bottom:6px;letter-spacing:-.5px}.stat-label[_ngcontent-%COMP%]{font-size:13px;opacity:.9;font-weight:500}@media(max-width:768px){.welcome-section[_ngcontent-%COMP%]{padding:32px 24px;margin:20px auto}.welcome-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px}.welcome-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.stats-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:12px}.stat-card[_ngcontent-%COMP%]{padding:20px 14px}.stat-number[_ngcontent-%COMP%]{font-size:26px}}"]})};var Bf={production:!1,apiUrl:"https://diveup-api-production.up.railway.app"};var Ut=class e{http=K(vs);baseUrl=`${Bf.apiUrl}/api`;getAccountingCodes(){return this.http.get(`${this.baseUrl}/AccountingCodes`)}getAccountingEntries(){return this.http.get(`${this.baseUrl}/AccountingEntry`)}getOperationEntries(){return this.http.get(`${this.baseUrl}/OperationEntries`)}getRootAccounts(){return this.http.get(`${this.baseUrl}/OperationAccounts/roots`)}getChildAccounts(n){return this.http.get(`${this.baseUrl}/OperationAccounts/${n}/children`)}getAccount(n){return this.http.get(`${this.baseUrl}/OperationAccounts/${n}`)}getAccountByNumber(n){return this.http.get(`${this.baseUrl}/OperationAccounts/by-number/${n}`)}searchAccounts(n){return this.http.get(`${this.baseUrl}/OperationAccounts/search?q=${encodeURIComponent(n)}`)}createAccount(n){return this.http.post(`${this.baseUrl}/OperationAccounts`,n)}updateAccount(n,t){return this.http.put(`${this.baseUrl}/OperationAccounts/${n}`,t)}deleteAccount(n){return this.http.delete(`${this.baseUrl}/OperationAccounts/${n}`)}getCodePeriods(){return this.http.get(`${this.baseUrl}/CodePeriods`)}getCodePeriod(n){return this.http.get(`${this.baseUrl}/CodePeriods/${n}`)}createCodePeriod(n){return this.http.post(`${this.baseUrl}/CodePeriods`,n)}updateCodePeriod(n,t){return this.http.put(`${this.baseUrl}/CodePeriods/${n}`,t)}deleteCodePeriod(n){return this.http.delete(`${this.baseUrl}/CodePeriods/${n}`)}getCodeBeneficiaryNames(){return this.http.get(`${this.baseUrl}/CodeBeneficiaryNames`)}getCodeBeneficiaryName(n){return this.http.get(`${this.baseUrl}/CodeBeneficiaryNames/${n}`)}createCodeBeneficiaryName(n){return this.http.post(`${this.baseUrl}/CodeBeneficiaryNames`,n)}updateCodeBeneficiaryName(n,t){return this.http.put(`${this.baseUrl}/CodeBeneficiaryNames/${n}`,t)}deleteCodeBeneficiaryName(n){return this.http.delete(`${this.baseUrl}/CodeBeneficiaryNames/${n}`)}getCodeBeneficiaryTypes(){return this.http.get(`${this.baseUrl}/CodeBeneficiaryTypes`)}getCodeBeneficiaryType(n){return this.http.get(`${this.baseUrl}/CodeBeneficiaryTypes/${n}`)}createCodeBeneficiaryType(n){return this.http.post(`${this.baseUrl}/CodeBeneficiaryTypes`,n)}updateCodeBeneficiaryType(n,t){return this.http.put(`${this.baseUrl}/CodeBeneficiaryTypes/${n}`,t)}deleteCodeBeneficiaryType(n){return this.http.delete(`${this.baseUrl}/CodeBeneficiaryTypes/${n}`)}getCodeCostCenters(){return this.http.get(`${this.baseUrl}/CodeCostCenters`)}getCodeCostCenter(n){return this.http.get(`${this.baseUrl}/CodeCostCenters/${n}`)}createCodeCostCenter(n){return this.http.post(`${this.baseUrl}/CodeCostCenters`,n)}updateCodeCostCenter(n,t){return this.http.put(`${this.baseUrl}/CodeCostCenters/${n}`,t)}deleteCodeCostCenter(n){return this.http.delete(`${this.baseUrl}/CodeCostCenters/${n}`)}getCodeFileNumbers(){return this.http.get(`${this.baseUrl}/CodeFileNumbers`)}getCodeFileNumber(n){return this.http.get(`${this.baseUrl}/CodeFileNumbers/${n}`)}createCodeFileNumber(n){return this.http.post(`${this.baseUrl}/CodeFileNumbers`,n)}updateCodeFileNumber(n,t){return this.http.put(`${this.baseUrl}/CodeFileNumbers/${n}`,t)}deleteCodeFileNumber(n){return this.http.delete(`${this.baseUrl}/CodeFileNumbers/${n}`)}getCodeAgents(){return this.http.get(`${this.baseUrl}/CodeAgents`)}getCodeAgent(n){return this.http.get(`${this.baseUrl}/CodeAgents/${n}`)}createCodeAgent(n){return this.http.post(`${this.baseUrl}/CodeAgents`,n)}updateCodeAgent(n,t){return this.http.put(`${this.baseUrl}/CodeAgents/${n}`,t)}deleteCodeAgent(n){return this.http.delete(`${this.baseUrl}/CodeAgents/${n}`)}searchTreasuryTransactions(n,t,r,o){let i=new Vr;return n&&(i=i.set("search",n)),t&&(i=i.set("fromDate",t)),r&&(i=i.set("toDate",r)),o&&(i=i.set("type",o.toString())),this.http.get(`${this.baseUrl}/TreasuryTransactions`,{params:i})}getTreasuryTransaction(n){return this.http.get(`${this.baseUrl}/TreasuryTransactions/${n}`)}createTreasuryTransaction(n){return this.http.post(`${this.baseUrl}/TreasuryTransactions`,n)}updateTreasuryTransaction(n,t){return this.http.put(`${this.baseUrl}/TreasuryTransactions/${n}`,t)}deleteTreasuryTransaction(n){return this.http.delete(`${this.baseUrl}/TreasuryTransactions/${n}`)}searchTreasuryCounters(n,t,r,o){let i=new Vr;return n&&(i=i.set("currency",n)),t&&(i=i.set("branch",t)),r&&(i=i.set("fromDate",r)),o&&(i=i.set("toDate",o)),this.http.get(`${this.baseUrl}/TreasuryCounters`,{params:i})}getTreasuryCounter(n){return this.http.get(`${this.baseUrl}/TreasuryCounters/${n}`)}createTreasuryCounter(n){return this.http.post(`${this.baseUrl}/TreasuryCounters`,n)}deleteTreasuryCounter(n){return this.http.delete(`${this.baseUrl}/TreasuryCounters/${n}`)}static \u0275fac=function(t){return new(t||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})};var KM=(()=>{class e{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||e)(j(ro),j(Rr))};static \u0275dir=Kt({type:e})}return e})(),yl=(()=>{class e extends KM{static \u0275fac=(()=>{let t;return function(o){return(t||(t=no(e)))(o||e)}})();static \u0275dir=Kt({type:e,features:[Lr]})}return e})(),As=new Me(""),u4={provide:As,useExisting:kr(()=>at),multi:!0},at=(()=>{class e extends yl{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(o){return(t||(t=no(e)))(o||e)}})();static \u0275dir=Kt({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,o){r&1&&E("change",function(a){return o.onChange(a.target.checked)})("blur",function(){return o.onTouched()})},standalone:!1,features:[Zo([u4]),Lr]})}return e})(),f4={provide:As,useExisting:kr(()=>De),multi:!0};function p4(){let e=yr()?yr().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}var g4=new Me(""),De=(()=>{class e extends KM{_compositionMode;_composing=!1;constructor(t,r,o){super(t,r),this._compositionMode=o,this._compositionMode==null&&(this._compositionMode=!p4())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||e)(j(ro),j(Rr),j(g4,8))};static \u0275dir=Kt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,o){r&1&&E("input",function(a){return o._handleInput(a.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(a){return o._compositionEnd(a.target.value)})},standalone:!1,features:[Zo([f4]),Lr]})}return e})();var ZM=new Me(""),m4=new Me("");function h4(e){return n=>{if(n.value==null||e==null)return null;let t=parseFloat(n.value);return!isNaN(t)&&t<e?{min:{min:e,actual:n.value}}:null}}function UM(e){return null}function QM(e){return e!=null}function JM(e){return Oi(e)?Xt(e):e}function ew(e){let n={};return e.forEach(t=>{n=t!=null?Y(Y({},n),t):n}),Object.keys(n).length===0?null:n}function tw(e,n){return n.map(t=>t(e))}function v4(e){return!e.validate}function nw(e){return e.map(n=>v4(n)?n:t=>n.validate(t))}function x4(e){if(!e)return null;let n=e.filter(QM);return n.length==0?null:function(t){return ew(tw(t,n))}}function rw(e){return e!=null?x4(nw(e)):null}function _4(e){if(!e)return null;let n=e.filter(QM);return n.length==0?null:function(t){let r=tw(t,n).map(JM);return Lo(r).pipe(Tt(ew))}}function ow(e){return e!=null?_4(nw(e)):null}function WM(e,n){return e===null?[n]:Array.isArray(e)?[...e,n]:[e,n]}function C4(e){return e._rawValidators}function b4(e){return e._rawAsyncValidators}function Sv(e){return e?Array.isArray(e)?e:[e]:[]}function jf(e,n){return Array.isArray(e)?e.includes(n):e===n}function zM(e,n){let t=Sv(n);return Sv(e).forEach(o=>{jf(t,o)||t.push(o)}),t}function HM(e,n){return Sv(n).filter(t=>!jf(e,t))}var Uf=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=rw(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=ow(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control?.reset(n)}hasError(n,t){return this.control?this.control.hasError(n,t):!1}getError(n,t){return this.control?this.control.getError(n,t):null}},Dv=class extends Uf{name;get formDirective(){return null}get path(){return null}},bl=class extends Uf{_parent=null;name=null;valueAccessor=null},kv=class{_cd;constructor(n){this._cd=n}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var Ne=(()=>{class e extends kv{constructor(t){super(t)}static \u0275fac=function(r){return new(r||e)(j(bl,2))};static \u0275dir=Kt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,o){r&2&&Fn("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},standalone:!1,features:[Lr]})}return e})();var vl="VALID",Vf="INVALID",ks="PENDING",xl="DISABLED",Ma=class{},Wf=class extends Ma{value;source;constructor(n,t){super(),this.value=n,this.source=t}},_l=class extends Ma{pristine;source;constructor(n,t){super(),this.pristine=n,this.source=t}},Cl=class extends Ma{touched;source;constructor(n,t){super(),this.touched=n,this.source=t}},Is=class extends Ma{status;source;constructor(n,t){super(),this.status=n,this.source=t}};var Iv=class extends Ma{source;constructor(n){super(),this.source=n}};function y4(e){return(zf(e)?e.validators:e)||null}function M4(e){return Array.isArray(e)?rw(e):e||null}function w4(e,n){return(zf(n)?n.asyncValidators:e)||null}function E4(e){return Array.isArray(e)?ow(e):e||null}function zf(e){return e!=null&&!Array.isArray(e)&&typeof e=="object"}var Av=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(n,t){this._assignValidators(n),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get status(){return gn(this.statusReactive)}set status(n){gn(()=>this.statusReactive.set(n))}_status=Oo(()=>this.statusReactive());statusReactive=Rt(void 0);get valid(){return this.status===vl}get invalid(){return this.status===Vf}get pending(){return this.status==ks}get disabled(){return this.status===xl}get enabled(){return this.status!==xl}errors;get pristine(){return gn(this.pristineReactive)}set pristine(n){gn(()=>this.pristineReactive.set(n))}_pristine=Oo(()=>this.pristineReactive());pristineReactive=Rt(!0);get dirty(){return!this.pristine}get touched(){return gn(this.touchedReactive)}set touched(n){gn(()=>this.touchedReactive.set(n))}_touched=Oo(()=>this.touchedReactive());touchedReactive=Rt(!1);get untouched(){return!this.touched}_events=new fn;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(zM(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(zM(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(HM(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(HM(n,this._rawAsyncValidators))}hasValidator(n){return jf(this._rawValidators,n)}hasAsyncValidator(n){return jf(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){let t=this.touched===!1;this.touched=!0;let r=n.sourceControl??this;n.onlySelf||this._parent?.markAsTouched(nt(Y({},n),{sourceControl:r})),t&&n.emitEvent!==!1&&this._events.next(new Cl(!0,r))}markAllAsDirty(n={}){this.markAsDirty({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(n))}markAllAsTouched(n={}){this.markAsTouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(n))}markAsUntouched(n={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=n.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:r})}),n.onlySelf||this._parent?._updateTouched(n,r),t&&n.emitEvent!==!1&&this._events.next(new Cl(!1,r))}markAsDirty(n={}){let t=this.pristine===!0;this.pristine=!1;let r=n.sourceControl??this;n.onlySelf||this._parent?.markAsDirty(nt(Y({},n),{sourceControl:r})),t&&n.emitEvent!==!1&&this._events.next(new _l(!1,r))}markAsPristine(n={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=n.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:n.emitEvent})}),n.onlySelf||this._parent?._updatePristine(n,r),t&&n.emitEvent!==!1&&this._events.next(new _l(!0,r))}markAsPending(n={}){this.status=ks;let t=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new Is(this.status,t)),this.statusChanges.emit(this.status)),n.onlySelf||this._parent?.markAsPending(nt(Y({},n),{sourceControl:t}))}disable(n={}){let t=this._parentMarkedDirty(n.onlySelf);this.status=xl,this.errors=null,this._forEachChild(o=>{o.disable(nt(Y({},n),{onlySelf:!0}))}),this._updateValue();let r=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new Wf(this.value,r)),this._events.next(new Is(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(nt(Y({},n),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(n={}){let t=this._parentMarkedDirty(n.onlySelf);this.status=vl,this._forEachChild(r=>{r.enable(nt(Y({},n),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors(nt(Y({},n),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(n,t){n.onlySelf||(this._parent?.updateValueAndValidity(n),n.skipPristineCheck||this._parent?._updatePristine({},t),this._parent?._updateTouched({},t))}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===vl||this.status===ks)&&this._runAsyncValidator(r,n.emitEvent)}let t=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new Wf(this.value,t)),this._events.next(new Is(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),n.onlySelf||this._parent?.updateValueAndValidity(nt(Y({},n),{sourceControl:t}))}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?xl:vl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n,t){if(this.asyncValidator){this.status=ks,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:n!==!1};let r=JM(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:t,shouldHaveEmitted:n})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let n=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,n}return!1}setErrors(n,t={}){this.errors=n,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(n){let t=n;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,o)=>r&&r._find(o),this)}getError(n,t){let r=t?this.get(t):this;return r?.errors?r.errors[n]:null}hasError(n,t){return!!this.getError(n,t)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n,t,r){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),(n||r)&&this._events.next(new Is(this.status,t)),this._parent&&this._parent._updateControlsErrors(n,t,r)}_initObservables(){this.valueChanges=new $t,this.statusChanges=new $t}_calculateStatus(){return this._allControlsDisabled()?xl:this.errors?Vf:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ks)?ks:this._anyControlsHaveStatus(Vf)?Vf:vl}_anyControlsHaveStatus(n){return this._anyControls(t=>t.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n,t){let r=!this._anyControlsDirty(),o=this.pristine!==r;this.pristine=r,n.onlySelf||this._parent?._updatePristine(n,t),o&&this._events.next(new _l(this.pristine,t))}_updateTouched(n={},t){this.touched=this._anyControlsTouched(),this._events.next(new Cl(this.touched,t)),n.onlySelf||this._parent?._updateTouched(n,t)}_onDisabledChange=[];_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){zf(n)&&n.updateOn!=null&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!!this._parent?.dirty&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=M4(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=E4(this._rawAsyncValidators)}};var iw=new Me("",{factory:()=>Nv}),Nv="always";function O4(e,n){return[...n.path,e]}function T4(e,n,t=Nv){S4(e,n),n.valueAccessor.writeValue(e.value),(e.disabled||t==="always")&&n.valueAccessor.setDisabledState?.(e.disabled),D4(e,n),I4(e,n),k4(e,n),P4(e,n)}function $M(e,n){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(n)})}function P4(e,n){if(n.valueAccessor.setDisabledState){let t=r=>{n.valueAccessor.setDisabledState(r)};e.registerOnDisabledChange(t),n._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}function S4(e,n){let t=C4(e);n.validator!==null?e.setValidators(WM(t,n.validator)):typeof t=="function"&&e.setValidators([t]);let r=b4(e);n.asyncValidator!==null?e.setAsyncValidators(WM(r,n.asyncValidator)):typeof r=="function"&&e.setAsyncValidators([r]);let o=()=>e.updateValueAndValidity();$M(n._rawValidators,o),$M(n._rawAsyncValidators,o)}function D4(e,n){n.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,e.updateOn==="change"&&aw(e,n)})}function k4(e,n){n.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,e.updateOn==="blur"&&e._pendingChange&&aw(e,n),e.updateOn!=="submit"&&e.markAsTouched()})}function aw(e,n){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function I4(e,n){let t=(r,o)=>{n.valueAccessor.writeValue(r),o&&n.viewToModelUpdate(r)};e.registerOnChange(t),n._registerOnDestroy(()=>{e._unregisterOnChange(t)})}function A4(e,n){if(!e.hasOwnProperty("model"))return!1;let t=e.model;return t.isFirstChange()?!0:!Object.is(n,t.currentValue)}function N4(e){return Object.getPrototypeOf(e.constructor)===yl}function F4(e,n){if(!n)return null;Array.isArray(n);let t,r,o;return n.forEach(i=>{i.constructor===De?t=i:N4(i)?r=i:o=i}),o||r||t||null}function GM(e,n){let t=e.indexOf(n);t>-1&&e.splice(t,1)}function qM(e){return typeof e=="object"&&e!==null&&Object.keys(e).length===2&&"value"in e&&"disabled"in e}var R4=class extends Av{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(n=null,t,r){super(y4(t),w4(r,t)),this._applyFormState(n),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),zf(t)&&(t.nonNullable||t.initialValueIsDefault)&&(qM(n)?this.defaultValue=n.value:this.defaultValue=n)}setValue(n,t={}){this.value=this._pendingValue=n,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(n,t={}){this.setValue(n,t)}reset(n=this.defaultValue,t={}){this._applyFormState(n),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new Iv(this))}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){GM(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){GM(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(n){qM(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}};var L4={provide:bl,useExisting:kr(()=>ke)},XM=Promise.resolve(),ke=(()=>{class e extends bl{_changeDetectorRef;callSetDisabledState;control=new R4;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new $t;constructor(t,r,o,i,a,l){super(),this._changeDetectorRef=a,this.callSetDisabledState=l,this._parent=t,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=F4(this,i)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),A4(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective?.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){T4(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){XM.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,o=r!==0&&ua(r);XM.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?O4(t,this._parent):[t]}static \u0275fac=function(r){return new(r||e)(j(Dv,9),j(ZM,10),j(m4,10),j(As,10),j(Se,8),j(iw,8))};static \u0275dir=Kt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Zo([L4]),Lr,Go]})}return e})();var B4={provide:As,useExisting:kr(()=>Rn),multi:!0},Rn=(()=>{class e extends yl{writeValue(t){let r=t??"";this.setProperty("value",r)}registerOnChange(t){this.onChange=r=>{t(r==""?null:parseFloat(r))}}static \u0275fac=(()=>{let t;return function(o){return(t||(t=no(e)))(o||e)}})();static \u0275dir=Kt({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,o){r&1&&E("input",function(a){return o.onChange(a.target.value)})("blur",function(){return o.onTouched()})},standalone:!1,features:[Zo([B4]),Lr]})}return e})();var V4={provide:As,useExisting:kr(()=>mt),multi:!0};function sw(e,n){return e==null?`${n}`:(n&&typeof n=="object"&&(n="Object"),`${e}: ${n}`.slice(0,50))}function j4(e){return e.split(":")[0]}var mt=(()=>{class e extends yl{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=K(Eo).injector;destroyRef=K(br);cdr=K(Se);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,ds({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let r=this._getOptionId(t),o=sw(r,t);this.setProperty("value",o)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=j4(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(o){return(t||(t=no(e)))(o||e)}})();static \u0275dir=Kt({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,o){r&1&&E("change",function(a){return o.onChange(a.target.value)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Zo([V4]),Lr]})}return e})(),Et=(()=>{class e{_element;_renderer;_select;id;constructor(t,r,o){this._element=t,this._renderer=r,this._select=o,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(sw(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select?._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select?._optionMap.delete(this.id),this._select?._writeValueAfterRender()}static \u0275fac=function(r){return new(r||e)(j(Rr),j(ro),j(mt,9))};static \u0275dir=Kt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return e})(),U4={provide:As,useExisting:kr(()=>cw),multi:!0};function YM(e,n){return e==null?`${n}`:(typeof n=="string"&&(n=`'${n}'`),n&&typeof n=="object"&&(n="Object"),`${e}: ${n}`.slice(0,50))}function W4(e){return e.split(":")[0]}var cw=(()=>{class e extends yl{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let o=t.map(i=>this._getOptionId(i));r=(i,a)=>{i._setSelected(o.indexOf(a.toString())>-1)}}else r=(o,i)=>{o._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let o=[],i=r.selectedOptions;if(i!==void 0){let a=i;for(let l=0;l<a.length;l++){let u=a[l],p=this._getOptionValue(u.value);o.push(p)}}else{let a=r.options;for(let l=0;l<a.length;l++){let u=a[l];if(u.selected){let p=this._getOptionValue(u.value);o.push(p)}}}this.value=o,t(o)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=W4(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(o){return(t||(t=no(e)))(o||e)}})();static \u0275dir=Kt({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,o){r&1&&E("change",function(a){return o.onChange(a.target)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Zo([U4]),Lr]})}return e})(),Ot=(()=>{class e{_element;_renderer;_select;id;_value;constructor(t,r,o){this._element=t,this._renderer=r,this._select=o,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(YM(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(YM(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||e)(j(Rr),j(ro),j(cw,9))};static \u0275dir=Kt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return e})();function z4(e){return typeof e=="number"?e:parseFloat(e)}var H4=(()=>{class e{_validator=UM;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):UM,this._onChange?.()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(r){return new(r||e)};static \u0275dir=Kt({type:e,features:[Go]})}return e})();var $4={provide:ZM,useExisting:kr(()=>Ml),multi:!0},Ml=(()=>{class e extends H4{min;inputName="min";normalizeInput=t=>z4(t);createValidator=t=>h4(t);static \u0275fac=(()=>{let t;return function(o){return(t||(t=no(e)))(o||e)}})();static \u0275dir=Kt({type:e,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(r,o){r&2&&fs("min",o._enabled?o.min:null)},inputs:{min:"min"},standalone:!1,features:[Zo([$4]),Lr]})}return e})();var G4=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({})}return e})();var Fv=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:iw,useValue:t.callSetDisabledState??Nv}]}}static \u0275fac=function(r){return new(r||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({imports:[G4]})}return e})();function q4(e,n){if(e&1){let t=be();c(0,"div",6)(1,"span",7),d(2,"\u{1F50D}"),s(),c(3,"input",8),P("ngModelChange",function(o){ne(t);let i=q();return S(i.searchTerm,o)||(i.searchTerm=o),re(o)}),s()()}if(e&2){let t=q();f(3),T("ngModel",t.searchTerm)}}function X4(e,n){e&1&&(c(0,"div",4),le(1,"div",9),c(2,"p"),d(3,"Loading operation entries..."),s()())}function Y4(e,n){if(e&1){let t=be();c(0,"div",5)(1,"span",10),d(2,"\u26A0\uFE0F"),s(),c(3,"h3"),d(4,"Failed to Load Entries"),s(),c(5,"p",11),d(6),s(),c(7,"button",12),E("click",function(){ne(t);let o=q();return re(o.retryLoading())}),d(8,"Try Again"),s()()}if(e&2){let t=q();f(6),M(t.error())}}function K4(e,n){if(e&1){let t=be();c(0,"div",20),E("click",function(){let o=ne(t).$implicit,i=q(2);return re(i.openEntry(o))}),le(1,"div",21),c(2,"div",22)(3,"div",23)(4,"span",24),d(5),s()(),c(6,"div",25)(7,"h3"),d(8),s(),c(9,"p"),d(10),s()(),c(11,"div",26)(12,"span",27),d(13,"\u2192"),s()()()()}if(e&2){let t=n.$implicit;f(),nn("background",t.gradient),f(2),nn("background",t.gradient),f(2),M(t.icon),f(3),M(t.label),f(2),M(t.desc)}}function Z4(e,n){e&1&&(c(0,"div",28)(1,"span",29),d(2,"\u{1F50D}"),s(),c(3,"h3"),d(4,"No entries found"),s(),c(5,"p"),d(6,"Try adjusting your search term"),s()())}function Q4(e,n){if(e&1&&(c(0,"div",13)(1,"div",14)(2,"span",15),d(3),s(),c(4,"span",16),d(5,"Total Entry Types"),s()(),c(6,"div",14)(7,"span",15),d(8),s(),c(9,"span",16),d(10,"Showing"),s()()(),c(11,"div",17),H(12,K4,14,7,"div",18),s(),H(13,Z4,7,0,"div",19)),e&2){let t=q();f(3),M(t.entries().length),f(5),M(t.filteredEntries.length),f(4),_("ngForOf",t.filteredEntries),f(),_("ngIf",t.filteredEntries.length===0)}}var Hf=class e{router=K(ye);accountingService=K(Ut);searchTerm="";entries=Rt([]);loading=Rt(!0);error=Rt(null);entryVisuals={entryexcursions:{icon:"\u{1F3DD}\uFE0F",desc:"Manage excursion entries",gradient:"linear-gradient(135deg, #667eea, #764ba2)",route:"/operation/entries/transaction"},entrytraffic:{icon:"\u{1F697}",desc:"Track traffic & movement data",gradient:"linear-gradient(135deg, #43e97b, #38f9d7)",route:"/operation/entries/traffic"},entryrevenue:{icon:"\u{1F4B0}",desc:"Revenue records & reporting",gradient:"linear-gradient(135deg, #f6d365, #fda085)",route:"/operation/entries/revenue"},entryguideallowance:{icon:"\u{1F464}",desc:"Guide allowance & compensation",gradient:"linear-gradient(135deg, #a18cd1, #fbc2eb)",route:"/operation/entries/guide-allowance"},entryrepcommission:{icon:"\u{1F4DD}",desc:"Representative commission entries",gradient:"linear-gradient(135deg, #f093fb, #f5576c)",route:"/operation/entries/rep-commission"},invoiceagent:{icon:"\u{1F468}\u200D\u{1F4BC}",desc:"Agent invoice management",gradient:"linear-gradient(135deg, #4facfe, #00f2fe)",route:"/operation/entries/transaction"},invoicesupplierboat:{icon:"\u{1F6A2}",desc:"Boat supplier invoice entries",gradient:"linear-gradient(135deg, #4facfe, #00f2fe)",route:"/operation/entries/boat-coast"},invoicesupplierexcursion:{icon:"\u{1F3D6}\uFE0F",desc:"Excursion supplier invoices",gradient:"linear-gradient(135deg, #fa709a, #fee140)",route:"/operation/entries/transaction"},invoicesuppliertransportation:{icon:"\u{1F68C}",desc:"Transportation supplier invoices",gradient:"linear-gradient(135deg, #a8edea, #fed6e3)",route:"/operation/entries/transaction"}};ngOnInit(){this.loadOperationEntries()}loadOperationEntries(){this.loading.set(!0),this.error.set(null),this.accountingService.getOperationEntries().subscribe({next:n=>{let t=this.mapApiDataToEntryCards(n);this.entries.set(t),this.loading.set(!1)},error:n=>{console.error("Error loading operation entries:",n),this.error.set("Failed to load operation entries"),this.loading.set(!1)}})}mapApiDataToEntryCards(n){return n.map(t=>{let r=this.entryVisuals[t.key]||{icon:"\u{1F4CB}",desc:t.displayName,gradient:"linear-gradient(135deg, #667eea, #764ba2)",route:`/operation/entries/${t.key}`};return{key:t.key,label:t.displayName,route:r.route,icon:r.icon,desc:r.desc,gradient:r.gradient}})}get filteredEntries(){let n=this.entries();if(!this.searchTerm)return n;let t=this.searchTerm.toLowerCase();return n.filter(r=>r.label.toLowerCase().includes(t)||r.desc.toLowerCase().includes(t))}openEntry(n){this.router.navigate([n.route])}retryLoading(){this.loadOperationEntries()}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-entries"]],standalone:!1,decls:11,vars:2,consts:[[1,"entries-page"],[1,"page-header"],[1,"header-content"],["class","header-search",4,"ngIf"],[1,"loading-container"],[1,"error-container"],[1,"header-search"],[1,"search-icon"],["type","text","placeholder","Search entries...",3,"ngModelChange","ngModel"],[1,"spinner"],[1,"error-icon"],[1,"error-message"],[1,"retry-btn",3,"click"],[1,"summary-bar"],[1,"summary-stat"],[1,"stat-val"],[1,"stat-lbl"],[1,"cards-grid"],["class","card-item",3,"click",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"card-item",3,"click"],[1,"card-accent"],[1,"card-body"],[1,"card-icon-wrap"],[1,"card-icon"],[1,"card-info"],[1,"card-meta"],[1,"arrow-circle"],[1,"empty-state"],[1,"empty-icon"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),d(4,"\u{1F4CB} Entries"),s(),c(5,"p"),d(6,"Manage all entry types and transactions"),s()(),H(7,q4,4,1,"div",3),s(),Yo(8,X4,4,0,"div",4)(9,Y4,9,1,"div",5)(10,Q4,14,4),s()),t&2&&(f(7),_("ngIf",!r.loading()),f(),Ko(r.loading()?8:r.error()?9:10))},dependencies:[Oe,Pe,De,Ne,ke],styles:[".page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:20px;flex-wrap:wrap;gap:14px}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:var(--dm-primary);margin:0 0 4px;letter-spacing:-.3px}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-size:14px;margin:0}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]{position:relative}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:10px 16px 10px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;width:260px;outline:none;background:var(--dm-surface);box-shadow:var(--dm-shadow);font-family:inherit;color:var(--dm-text);transition:border-color .2s,box-shadow .2s,width .2s}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014;width:300px}.summary-bar[_ngcontent-%COMP%]{display:flex;gap:14px;margin-bottom:20px;flex-wrap:wrap}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]{background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);padding:10px 18px;display:flex;align-items:center;gap:10px;box-shadow:var(--dm-shadow)}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-val[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:var(--dm-primary)}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-lbl[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.cards-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px}.card-item[_ngcontent-%COMP%]{display:block;position:relative;background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius);text-decoration:none;color:inherit;overflow:hidden;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease,border-color .2s ease;box-shadow:var(--dm-shadow)}.card-item[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:var(--dm-shadow-md);border-color:var(--dm-accent)}.card-item[_ngcontent-%COMP%]:hover   .arrow-circle[_ngcontent-%COMP%]{background:var(--dm-primary);color:#fff}.card-item[_ngcontent-%COMP%]:hover   .card-accent[_ngcontent-%COMP%]{height:4px}.card-item[_ngcontent-%COMP%]:hover   .card-icon-wrap[_ngcontent-%COMP%]{transform:scale(1.05)}.card-item[_ngcontent-%COMP%]   .card-accent[_ngcontent-%COMP%]{height:3px;transition:height .2s}.card-item[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;align-items:center;gap:14px;padding:16px 18px}.card-item[_ngcontent-%COMP%]   .card-icon-wrap[_ngcontent-%COMP%]{width:46px;height:46px;border-radius:var(--dm-radius-sm);display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:var(--dm-shadow);transition:transform .2s ease}.card-item[_ngcontent-%COMP%]   .card-icon-wrap[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{font-size:22px}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]{flex:1;min-width:0}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--dm-text);margin:0 0 2px;letter-spacing:-.2px}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;color:var(--dm-text-muted);margin:0;line-height:1.3;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.card-item[_ngcontent-%COMP%]   .card-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:6px;flex-shrink:0}.card-item[_ngcontent-%COMP%]   .record-badge[_ngcontent-%COMP%]{background:#10b98114;color:#059669;padding:2px 10px;border-radius:20px;font-size:11px;font-weight:600;white-space:nowrap}.card-item[_ngcontent-%COMP%]   .arrow-circle[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:50%;background:var(--dm-hover);display:flex;align-items:center;justify-content:center;font-size:13px;color:var(--dm-text-muted);transition:all .2s}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:56px 20px;background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius);margin-top:16px;box-shadow:var(--dm-shadow)}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:44px;display:block;margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--dm-primary);font-size:17px;margin:0 0 4px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-size:14px;margin:0}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:3.5rem 2rem;color:var(--dm-text-muted);text-align:center}.loading-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:38px;height:38px;border:3px solid rgba(15,52,96,.1);border-top:3px solid var(--dm-accent);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;font-weight:500}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:3.5rem 2rem;text-align:center}.error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:44px;margin-bottom:.75rem;opacity:.7}.error-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--dm-highlight);font-size:18px;font-weight:600;margin-bottom:.5rem}.error-container[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:var(--dm-text-muted);margin-bottom:1.5rem;font-size:14px}.error-container[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border:none;padding:.65rem 1.25rem;border-radius:var(--dm-radius-sm);cursor:pointer;font-weight:600;font-size:14px;transition:box-shadow .2s}.error-container[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]:hover{box-shadow:var(--dm-shadow-md)}@media(max-width:768px){.cards-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{width:100%}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]{flex:1;min-width:100px}}.entries-page[_ngcontent-%COMP%]{position:relative;z-index:1}"]})};var tt=class e{constructor(n){this.http=n}api=Bf.apiUrl;getAgents(){return this.http.get(`${this.api}/api/Agents`)}getAgent(n){return this.http.get(`${this.api}/api/Agents/${n}`)}createAgent(n){return this.http.post(`${this.api}/api/Agents`,n)}updateAgent(n,t){return this.http.put(`${this.api}/api/Agents/${n}`,t)}deleteAgent(n){return this.http.delete(`${this.api}/api/Agents/${n}`)}getBoats(){return this.http.get(`${this.api}/api/Boats`)}getBoat(n){return this.http.get(`${this.api}/api/Boats/${n}`)}createBoat(n){return this.http.post(`${this.api}/api/Boats`,n)}updateBoat(n,t){return this.http.put(`${this.api}/api/Boats/${n}`,t)}deleteBoat(n){return this.http.delete(`${this.api}/api/Boats/${n}`)}getExcursions(){return this.http.get(`${this.api}/api/Excursions`)}getExcursion(n){return this.http.get(`${this.api}/api/Excursions/${n}`)}createExcursion(n){return this.http.post(`${this.api}/api/Excursions`,n)}updateExcursion(n,t){return this.http.put(`${this.api}/api/Excursions/${n}`,t)}deleteExcursion(n){return this.http.delete(`${this.api}/api/Excursions/${n}`)}getExcursionSuppliers(){return this.http.get(`${this.api}/api/ExcursionSuppliers`)}getExcursionSupplier(n){return this.http.get(`${this.api}/api/ExcursionSuppliers/${n}`)}createExcursionSupplier(n){return this.http.post(`${this.api}/api/ExcursionSuppliers`,n)}updateExcursionSupplier(n,t){return this.http.put(`${this.api}/api/ExcursionSuppliers/${n}`,t)}deleteExcursionSupplier(n){return this.http.delete(`${this.api}/api/ExcursionSuppliers/${n}`)}getGuides(){return this.http.get(`${this.api}/api/Guides`)}getGuide(n){return this.http.get(`${this.api}/api/Guides/${n}`)}createGuide(n){return this.http.post(`${this.api}/api/Guides`,n)}updateGuide(n,t){return this.http.put(`${this.api}/api/Guides/${n}`,t)}deleteGuide(n){return this.http.delete(`${this.api}/api/Guides/${n}`)}getHotelDestinations(){return this.http.get(`${this.api}/api/HotelDestinations`)}getHotelDestination(n){return this.http.get(`${this.api}/api/HotelDestinations/${n}`)}createHotelDestination(n){return this.http.post(`${this.api}/api/HotelDestinations`,n)}updateHotelDestination(n,t){return this.http.put(`${this.api}/api/HotelDestinations/${n}`,t)}deleteHotelDestination(n){return this.http.delete(`${this.api}/api/HotelDestinations/${n}`)}getHotels(){return this.http.get(`${this.api}/api/Hotels`)}getHotel(n){return this.http.get(`${this.api}/api/Hotels/${n}`)}createHotel(n){return this.http.post(`${this.api}/api/Hotels`,n)}updateHotel(n,t){return this.http.put(`${this.api}/api/Hotels/${n}`,t)}deleteHotel(n){return this.http.delete(`${this.api}/api/Hotels/${n}`)}getNationalities(){return this.http.get(`${this.api}/api/Nationalities`)}getNationality(n){return this.http.get(`${this.api}/api/Nationalities/${n}`)}createNationality(n){return this.http.post(`${this.api}/api/Nationalities`,n)}updateNationality(n,t){return this.http.put(`${this.api}/api/Nationalities/${n}`,t)}deleteNationality(n){return this.http.delete(`${this.api}/api/Nationalities/${n}`)}getPriceLists(){return this.http.get(`${this.api}/api/PriceLists`)}getPriceList(n){return this.http.get(`${this.api}/api/PriceLists/${n}`)}createPriceList(n){return this.http.post(`${this.api}/api/PriceLists`,n)}updatePriceList(n,t){return this.http.put(`${this.api}/api/PriceLists/${n}`,t)}deletePriceList(n){return this.http.delete(`${this.api}/api/PriceLists/${n}`)}getRates(){return this.http.get(`${this.api}/api/Rates`)}getRate(n){return this.http.get(`${this.api}/api/Rates/${n}`)}createRate(n){return this.http.post(`${this.api}/api/Rates`,n)}updateRate(n,t){return this.http.put(`${this.api}/api/Rates/${n}`,t)}deleteRate(n){return this.http.delete(`${this.api}/api/Rates/${n}`)}getReps(){return this.http.get(`${this.api}/api/Reps`)}getRep(n){return this.http.get(`${this.api}/api/Reps/${n}`)}createRep(n){return this.http.post(`${this.api}/api/Reps`,n)}updateRep(n,t){return this.http.put(`${this.api}/api/Reps/${n}`,t)}deleteRep(n){return this.http.delete(`${this.api}/api/Reps/${n}`)}getTransportationTypes(){return this.http.get(`${this.api}/api/TransportationTypes`)}getTransportationType(n){return this.http.get(`${this.api}/api/TransportationTypes/${n}`)}createTransportationType(n){return this.http.post(`${this.api}/api/TransportationTypes`,n)}updateTransportationType(n,t){return this.http.put(`${this.api}/api/TransportationTypes/${n}`,t)}deleteTransportationType(n){return this.http.delete(`${this.api}/api/TransportationTypes/${n}`)}getTransportationSuppliers(){return this.http.get(`${this.api}/api/TransportationSuppliers`)}getTransportationSupplier(n){return this.http.get(`${this.api}/api/TransportationSuppliers/${n}`)}createTransportationSupplier(n){return this.http.post(`${this.api}/api/TransportationSuppliers`,n)}updateTransportationSupplier(n,t){return this.http.put(`${this.api}/api/TransportationSuppliers/${n}`,t)}deleteTransportationSupplier(n){return this.http.delete(`${this.api}/api/TransportationSuppliers/${n}`)}getTransportationCosts(){return this.http.get(`${this.api}/api/TransportationCosts`)}getTransportationCost(n){return this.http.get(`${this.api}/api/TransportationCosts/${n}`)}createTransportationCost(n){return this.http.post(`${this.api}/api/TransportationCosts`,n)}updateTransportationCost(n,t){return this.http.put(`${this.api}/api/TransportationCosts/${n}`,t)}deleteTransportationCost(n){return this.http.delete(`${this.api}/api/TransportationCosts/${n}`)}getVouchers(){return this.http.get(`${this.api}/api/RepVouchers`)}getVoucher(n){return this.http.get(`${this.api}/api/RepVouchers/${n}`)}createVoucher(n){return this.http.post(`${this.api}/api/RepVouchers`,n)}updateVoucher(n,t){return this.http.put(`${this.api}/api/RepVouchers/${n}`,t)}deleteVoucher(n){return this.http.delete(`${this.api}/api/RepVouchers/${n}`)}getExcursionCostSellings(){return this.http.get(`${this.api}/api/ExcursionCostSellings`)}getExcursionCostSelling(n){return this.http.get(`${this.api}/api/ExcursionCostSellings/${n}`)}createExcursionCostSelling(n){return this.http.post(`${this.api}/api/ExcursionCostSellings`,n)}updateExcursionCostSelling(n,t){return this.http.put(`${this.api}/api/ExcursionCostSellings/${n}`,t)}deleteExcursionCostSelling(n){return this.http.delete(`${this.api}/api/ExcursionCostSellings/${n}`)}getEntryTransactions(n){return n?this.http.get(`${this.api}/api/EntryTransactions?search=${encodeURIComponent(n)}`):this.http.get(`${this.api}/api/EntryTransactions`)}getEntryTransaction(n){return this.http.get(`${this.api}/api/EntryTransactions/${n}`)}createEntryTransaction(n){return this.http.post(`${this.api}/api/EntryTransactions`,n)}updateEntryTransaction(n,t){return this.http.put(`${this.api}/api/EntryTransactions/${n}`,t)}deleteEntryTransaction(n){return this.http.delete(`${this.api}/api/EntryTransactions/${n}`)}getEntryTraffic(n){let t=[];Object.keys(n).forEach(o=>{n[o]!==null&&n[o]!==void 0&&n[o]!==""&&t.push(`${o}=${encodeURIComponent(n[o])}`)});let r=t.length>0?`?${t.join("&")}`:"";return this.http.get(`${this.api}/api/EntryTraffic${r}`)}getCodes(){return this.http.get(`${this.api}/api/Codes`)}getCurrentDateTime(){return new Date().toISOString()}static \u0275fac=function(t){return new(t||e)(Le(vs))};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})};var J4=["*"],Ve=class e{title="";isOpen=!1;size="large";closed=new $t;close(){this.closed.emit()}onOverlayClick(n){n.target.classList.contains("modal-overlay")&&this.close()}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-modal"]],inputs:{title:"title",isOpen:"isOpen",size:"size"},outputs:{closed:"closed"},standalone:!1,ngContentSelectors:J4,decls:9,vars:4,consts:[[1,"modal-overlay",3,"click"],[1,"modal-container",3,"ngClass"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"]],template:function(t,r){t&1&&(dh(),c(0,"div",0),E("click",function(i){return r.onOverlayClick(i)}),c(1,"div",1)(2,"div",2)(3,"h2"),d(4),s(),c(5,"button",3),E("click",function(){return r.close()}),d(6,"\u2715"),s()(),c(7,"div",4),uh(8),s()()()),t&2&&(Fn("show",r.isOpen),f(),_("ngClass","modal-"+r.size),f(3),M(r.title))},dependencies:[Nh],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000073;display:flex;align-items:flex-start;justify-content:center;z-index:1000;opacity:0;visibility:hidden;transition:opacity .2s ease,visibility .2s ease;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);overflow-y:auto;padding:40px 0}.modal-overlay.show[_ngcontent-%COMP%]{opacity:1;visibility:visible}.modal-container[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);overflow:hidden;box-shadow:var(--dm-shadow-lg);transform:scale(.95) translateY(8px);transition:transform .2s ease;margin:auto;display:flex;flex-direction:column}.modal-overlay.show[_ngcontent-%COMP%]   .modal-container[_ngcontent-%COMP%]{transform:scale(1) translateY(0)}.modal-small[_ngcontent-%COMP%]{width:90%;max-width:500px}.modal-medium[_ngcontent-%COMP%]{width:90%;max-width:800px}.modal-large[_ngcontent-%COMP%]{width:95%;max-width:1200px}.modal-full[_ngcontent-%COMP%]{width:95%;max-width:1400px}.modal-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-shrink:0}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:600;letter-spacing:-.2px}.close-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:32px;height:32px;border-radius:50%;color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.close-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.modal-body[_ngcontent-%COMP%]{overflow-y:auto;flex:1}@media(max-width:576px){.modal-small[_ngcontent-%COMP%], .modal-medium[_ngcontent-%COMP%], .modal-large[_ngcontent-%COMP%], .modal-full[_ngcontent-%COMP%]{width:96%;max-width:100%}.modal-header[_ngcontent-%COMP%]{padding:14px 18px}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px}}"]})};function e3(e,n){if(e&1&&(c(0,"p",13)(1,"span",14),d(2),s()()),e&2){let t=q(2);f(2),M(t.itemName)}}function t3(e,n){if(e&1){let t=be();c(0,"div",1),E("click",function(){ne(t);let o=q();return re(o.onCancel())}),c(1,"div",2),E("click",function(o){return ne(t),re(o.stopPropagation())}),c(2,"div",3)(3,"div",4)(4,"span",5),d(5,"!"),s()()(),c(6,"h3",6),d(7),s(),c(8,"p",7),d(9),s(),H(10,e3,3,1,"p",8),c(11,"p",9),d(12,"This action cannot be undone."),s(),c(13,"div",10)(14,"button",11),E("click",function(){ne(t);let o=q();return re(o.onCancel())}),d(15),s(),c(16,"button",12),E("click",function(){ne(t);let o=q();return re(o.onConfirm())}),d(17),s()()()()}if(e&2){let t=q();f(7),M(t.title),f(2),M(t.message),f(),_("ngIf",t.itemName),f(5),M(t.cancelText),f(2),ue("\u{1F5D1}\uFE0F ",t.confirmText)}}var We=class e{isOpen=!1;title="Confirm Delete";message="Are you sure you want to delete this record?";itemName="";confirmText="Delete";cancelText="Cancel";confirmed=new $t;cancelled=new $t;onConfirm(){this.confirmed.emit()}onCancel(){this.cancelled.emit()}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-confirm-dialog"]],inputs:{isOpen:"isOpen",title:"title",message:"message",itemName:"itemName",confirmText:"confirmText",cancelText:"cancelText"},outputs:{confirmed:"confirmed",cancelled:"cancelled"},standalone:!1,decls:1,vars:1,consts:[["class","confirm-overlay",3,"click",4,"ngIf"],[1,"confirm-overlay",3,"click"],[1,"confirm-card",3,"click"],[1,"danger-icon-wrap"],[1,"danger-icon"],[1,"icon-exclaim"],[1,"confirm-title"],[1,"confirm-message"],["class","confirm-item",4,"ngIf"],[1,"confirm-warning"],[1,"confirm-actions"],[1,"btn-cancel",3,"click"],[1,"btn-confirm",3,"click"],[1,"confirm-item"],[1,"item-label"]],template:function(t,r){t&1&&H(0,t3,18,5,"div",0),t&2&&_("ngIf",r.isOpen)},dependencies:[Pe],styles:[".confirm-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000073;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);display:flex;align-items:center;justify-content:center;z-index:10000}.confirm-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);padding:32px 28px 24px;width:400px;max-width:90vw;text-align:center;box-shadow:var(--dm-shadow-lg)}.danger-icon-wrap[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;margin-bottom:16px}.danger-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,var(--dm-highlight),#d63851);display:flex;align-items:center;justify-content:center}.danger-icon[_ngcontent-%COMP%]   .icon-exclaim[_ngcontent-%COMP%]{color:#fff;font-size:30px;font-weight:800;line-height:1}.confirm-title[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:var(--dm-text);margin-bottom:6px;letter-spacing:-.2px}.confirm-message[_ngcontent-%COMP%]{font-size:14px;color:var(--dm-text-muted);margin-bottom:6px;line-height:1.5}.confirm-item[_ngcontent-%COMP%]{margin-bottom:6px}.confirm-item[_ngcontent-%COMP%]   .item-label[_ngcontent-%COMP%]{display:inline-block;background:#fef2f2;color:#c53030;padding:3px 12px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;border:1px solid #fed7d7}.confirm-warning[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af;margin-bottom:20px;font-style:italic}.confirm-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.btn-cancel[_ngcontent-%COMP%], .btn-confirm[_ngcontent-%COMP%]{flex:1;padding:11px 18px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-cancel[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text)}.btn-cancel[_ngcontent-%COMP%]:hover{background:var(--dm-border)}.btn-confirm[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;box-shadow:0 2px 10px #e9456040}.btn-confirm[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #e9456059}@media(max-width:420px){.confirm-card[_ngcontent-%COMP%]{padding:28px 20px 20px}.confirm-actions[_ngcontent-%COMP%]{flex-direction:column}}"]})};var Il={};Il.version="0.18.5";var Ea=1200,Hs=1252,n3=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],r3={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Yw=function(e){n3.indexOf(e)!=-1&&(Hs=r3[0]=e)};function o3(){Yw(1252)}var Al=function(e){Ea=e,Yw(e)};function i3(){Al(1200),o3()}function a3(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var $f=function(n){return String.fromCharCode(n)},lw=function(n){return String.fromCharCode(n)},Bt;var Io=null,wl=!0,Ni="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Nl(e){for(var n="",t=0,r=0,o=0,i=0,a=0,l=0,u=0,p=0;p<e.length;)t=e.charCodeAt(p++),i=t>>2,r=e.charCodeAt(p++),a=(t&3)<<4|r>>4,o=e.charCodeAt(p++),l=(r&15)<<2|o>>6,u=o&63,isNaN(r)?l=u=64:isNaN(o)&&(u=64),n+=Ni.charAt(i)+Ni.charAt(a)+Ni.charAt(l)+Ni.charAt(u);return n}function ci(e){var n="",t=0,r=0,o=0,i=0,a=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var p=0;p<e.length;)i=Ni.indexOf(e.charAt(p++)),a=Ni.indexOf(e.charAt(p++)),t=i<<2|a>>4,n+=String.fromCharCode(t),l=Ni.indexOf(e.charAt(p++)),r=(a&15)<<4|l>>2,l!==64&&(n+=String.fromCharCode(r)),u=Ni.indexOf(e.charAt(p++)),o=(l&3)<<6|u,u!==64&&(n+=String.fromCharCode(o));return n}var Ct=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),di=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function Ta(e){return Ct?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function dw(e){return Ct?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var fo=function(n){return Ct?di(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function pp(e){if(typeof ArrayBuffer>"u")return fo(e);for(var n=new ArrayBuffer(e.length),t=new Uint8Array(n),r=0;r!=e.length;++r)t[r]=e.charCodeAt(r)&255;return n}function Vl(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function s3(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Vn=Ct?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:di(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var r=new Uint8Array(t),o=0;for(n=0,t=0;n<e.length;t+=o,++n)if(o=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),t)}return r}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function c3(e){for(var n=[],t=0,r=e.length+250,o=Ta(e.length+255),i=0;i<e.length;++i){var a=e.charCodeAt(i);if(a<128)o[t++]=a;else if(a<2048)o[t++]=192|a>>6&31,o[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var l=e.charCodeAt(++i)&1023;o[t++]=240|a>>8&7,o[t++]=128|a>>2&63,o[t++]=128|l>>6&15|(a&3)<<4,o[t++]=128|l&63}else o[t++]=224|a>>12&15,o[t++]=128|a>>6&63,o[t++]=128|a&63;t>r&&(n.push(o.slice(0,t)),t=0,o=Ta(65535),r=65530)}return n.push(o.slice(0,t)),Vn(n)}var Vs=/\u0000/g,Gf=/[\u0001-\u0006]/g;function js(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function po(e,n){var t=""+e;return t.length>=n?t:Jt("0",n-t.length)+t}function Xv(e,n){var t=""+e;return t.length>=n?t:Jt(" ",n-t.length)+t}function ep(e,n){var t=""+e;return t.length>=n?t:t+Jt(" ",n-t.length)}function l3(e,n){var t=""+Math.round(e);return t.length>=n?t:Jt("0",n-t.length)+t}function d3(e,n){var t=""+e;return t.length>=n?t:Jt("0",n-t.length)+t}var uw=Math.pow(2,32);function Ns(e,n){if(e>uw||e<-uw)return l3(e,n);var t=Math.round(e);return d3(t,n)}function tp(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var fw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function u3(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var en={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},pw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},f3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function np(e,n,t){for(var r=e<0?-1:1,o=e*r,i=0,a=1,l=0,u=1,p=0,g=0,m=Math.floor(o);p<n&&(m=Math.floor(o),l=m*a+i,g=m*p+u,!(o-m<5e-8));)o=1/(o-m),i=a,a=l,u=p,p=g;if(g>n&&(p>n?(g=u,l=i):(g=p,l=a)),!t)return[0,r*l,g];var v=Math.floor(r*l/g);return[v,r*l-v*g,g]}function qf(e,n,t){if(e>2958465||e<0)return null;var r=e|0,o=Math.floor(86400*(e-r)),i=0,a=[],l={D:r,T:o,u:86400*(e-r)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),n&&n.date1904&&(r+=1462),l.u>.9999&&(l.u=0,++o==86400&&(l.T=o=0,++r,++l.D)),r===60)a=t?[1317,10,29]:[1900,2,29],i=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var u=new Date(1900,0,1);u.setDate(u.getDate()+r-1),a=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),r<60&&(i=(i+6)%7),t&&(i=_3(u,a))}return l.y=a[0],l.m=a[1],l.d=a[2],l.S=o%60,o=Math.floor(o/60),l.M=o%60,o=Math.floor(o/60),l.H=o,l.q=i,l}var Kw=new Date(1899,11,31,0,0,0),p3=Kw.getTime(),g3=new Date(1900,2,1,0,0,0);function Zw(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=g3&&(t+=1440*60*1e3),(t-(p3+(e.getTimezoneOffset()-Kw.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Yv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function m3(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function h3(e){var n=e<0?12:11,t=Yv(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function v3(e){var n=Yv(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function x3(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=h3(e):n===10?t=e.toFixed(10).substr(0,12):t=v3(e),Yv(m3(t.toUpperCase()))}function Hv(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):x3(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ri(14,Zw(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function _3(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function C3(e,n,t,r){var o="",i=0,a=0,l=t.y,u,p=0;switch(e){case 98:l=t.y+543;case 121:switch(n.length){case 1:case 2:u=l%100,p=2;break;default:u=l%1e4,p=4;break}break;case 109:switch(n.length){case 1:case 2:u=t.m,p=n.length;break;case 3:return Rv[t.m-1][1];case 5:return Rv[t.m-1][0];default:return Rv[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:u=t.d,p=n.length;break;case 3:return fw[t.q][0];default:return fw[t.q][1]}break;case 104:switch(n.length){case 1:case 2:u=1+(t.H+11)%12,p=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:u=t.H,p=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:u=t.M,p=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?po(t.S,n.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,i=Math.round(a*(t.S+t.u)),i>=60*a&&(i=0),n==="s"?i===0?"0":""+i/a:(o=po(i,2+r),n==="ss"?o.substr(0,2):"."+o.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":u=t.D*24+t.H;break;case"[m]":case"[mm]":u=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":u=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}p=n.length===3?1:2;break;case 101:u=l,p=1;break}var g=p>0?po(u,p):"";return g}function Fi(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,r=e.substr(0,t);t!=e.length;t+=n)r+=(r.length>0?",":"")+e.substr(t,n);return r}var Qw=/%/g;function b3(e,n,t){var r=n.replace(Qw,""),o=n.length-r.length;return ii(e,r,t*Math.pow(10,2*o))+Jt("%",o)}function y3(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ii(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function Jw(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Jw(e,-n);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var i=Math.floor(Math.log(n)*Math.LOG10E)%o;if(i<0&&(i+=o),t=(n/Math.pow(10,i)).toPrecision(r+1+(o+i)%o),t.indexOf("e")===-1){var a=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+i):t+="E+"+(a-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,o)+"."+t.substr(2+o),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,p,g){return u+p+g.substr(0,(o+i)%o)+"."+g.substr(i)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var eE=/# (\?+)( ?)\/( ?)(\d+)/;function M3(e,n,t){var r=parseInt(e[4],10),o=Math.round(n*r),i=Math.floor(o/r),a=o-i*r,l=r;return t+(i===0?"":""+i)+" "+(a===0?Jt(" ",e[1].length+1+e[4].length):Xv(a,e[1].length)+e[2]+"/"+e[3]+po(l,e[4].length))}function w3(e,n,t){return t+(n===0?"":""+n)+Jt(" ",e[1].length+2+e[4].length)}var tE=/^#*0*\.([0#]+)/,nE=/\).*[0#]/,rE=/\(###\) ###\\?-####/;function or(e){for(var n="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function gw(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function mw(e,n){var t=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(t*r)).length?0:Math.round(t*r)}function E3(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function O3(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function zr(e,n,t){if(e.charCodeAt(0)===40&&!n.match(nE)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?zr("n",r,t):"("+zr("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return y3(e,n,t);if(n.indexOf("%")!==-1)return b3(e,n,t);if(n.indexOf("E")!==-1)return Jw(n,t);if(n.charCodeAt(0)===36)return"$"+zr(e,n.substr(n.charAt(1)==" "?2:1),t);var o,i,a,l,u=Math.abs(t),p=t<0?"-":"";if(n.match(/^00+$/))return p+Ns(u,n.length);if(n.match(/^[#?]+$/))return o=Ns(t,0),o==="0"&&(o=""),o.length>n.length?o:or(n.substr(0,n.length-o.length))+o;if(i=n.match(eE))return M3(i,u,p);if(n.match(/^#+0+$/))return p+Ns(u,n.length-n.indexOf("0"));if(i=n.match(tE))return o=gw(t,i[1].length).replace(/^([^\.]+)$/,"$1."+or(i[1])).replace(/\.$/,"."+or(i[1])).replace(/\.(\d*)$/,function(b,x){return"."+x+Jt("0",or(i[1]).length-x.length)}),n.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),i=n.match(/^(0*)\.(#*)$/))return p+gw(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=n.match(/^#{1,3},##0(\.?)$/))return p+Fi(Ns(u,0));if(i=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+zr(e,n,-t):Fi(""+(Math.floor(t)+E3(t,i[1].length)))+"."+po(mw(t,i[1].length),i[1].length);if(i=n.match(/^#,#*,#0/))return zr(e,n.replace(/^#,#*,/,""),t);if(i=n.match(/^([0#]+)(\\?-([0#]+))+$/))return o=js(zr(e,n.replace(/[\\-]/g,""),t)),a=0,js(js(n.replace(/\\/g,"")).replace(/[0#]/g,function(b){return a<o.length?o.charAt(a++):b==="0"?"0":""}));if(n.match(rE))return o=zr(e,"##########",t),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var g="";if(i=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),l=np(u,Math.pow(10,a)-1,!1),o=""+p,g=ii("n",i[1],l[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),o+=g+i[2]+"/"+i[3],g=ep(l[2],a),g.length<i[4].length&&(g=or(i[4].substr(i[4].length-g.length))+g),o+=g,o;if(i=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),l=np(u,Math.pow(10,a)-1,!0),p+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Xv(l[1],a)+i[2]+"/"+i[3]+ep(l[2],a):Jt(" ",2*a+1+i[2].length+i[3].length));if(i=n.match(/^[#0?]+$/))return o=Ns(t,0),n.length<=o.length?o:or(n.substr(0,n.length-o.length))+o;if(i=n.match(/^([#0?]+)\.([#0]+)$/)){o=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=o.indexOf(".");var m=n.indexOf(".")-a,v=n.length-o.length-m;return or(n.substr(0,m)+o+n.substr(n.length-v))}if(i=n.match(/^00,000\.([#0]*0)$/))return a=mw(t,i[1].length),t<0?"-"+zr(e,n,-t):Fi(O3(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?po(0,3-b.length):"")+b})+"."+po(a,i[1].length);switch(n){case"###,##0.00":return zr(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var h=Fi(Ns(u,0));return h!=="0"?p+h:"";case"###,###.00":return zr(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return zr(e,"#,##0.00",t).replace(/^0\./,".");default:}throw new Error("unsupported format |"+n+"|")}function T3(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ii(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function P3(e,n,t){var r=n.replace(Qw,""),o=n.length-r.length;return ii(e,r,t*Math.pow(10,2*o))+Jt("%",o)}function oE(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+oE(e,-n);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var i=Math.floor(Math.log(n)*Math.LOG10E)%o;if(i<0&&(i+=o),t=(n/Math.pow(10,i)).toPrecision(r+1+(o+i)%o),!t.match(/[Ee]/)){var a=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+i):t+="E+"+(a-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,p,g){return u+p+g.substr(0,(o+i)%o)+"."+g.substr(i)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Do(e,n,t){if(e.charCodeAt(0)===40&&!n.match(nE)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Do("n",r,t):"("+Do("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return T3(e,n,t);if(n.indexOf("%")!==-1)return P3(e,n,t);if(n.indexOf("E")!==-1)return oE(n,t);if(n.charCodeAt(0)===36)return"$"+Do(e,n.substr(n.charAt(1)==" "?2:1),t);var o,i,a,l,u=Math.abs(t),p=t<0?"-":"";if(n.match(/^00+$/))return p+po(u,n.length);if(n.match(/^[#?]+$/))return o=""+t,t===0&&(o=""),o.length>n.length?o:or(n.substr(0,n.length-o.length))+o;if(i=n.match(eE))return w3(i,u,p);if(n.match(/^#+0+$/))return p+po(u,n.length-n.indexOf("0"));if(i=n.match(tE))return o=(""+t).replace(/^([^\.]+)$/,"$1."+or(i[1])).replace(/\.$/,"."+or(i[1])),o=o.replace(/\.(\d*)$/,function(b,x){return"."+x+Jt("0",or(i[1]).length-x.length)}),n.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),i=n.match(/^(0*)\.(#*)$/))return p+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=n.match(/^#{1,3},##0(\.?)$/))return p+Fi(""+u);if(i=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Do(e,n,-t):Fi(""+t)+"."+Jt("0",i[1].length);if(i=n.match(/^#,#*,#0/))return Do(e,n.replace(/^#,#*,/,""),t);if(i=n.match(/^([0#]+)(\\?-([0#]+))+$/))return o=js(Do(e,n.replace(/[\\-]/g,""),t)),a=0,js(js(n.replace(/\\/g,"")).replace(/[0#]/g,function(b){return a<o.length?o.charAt(a++):b==="0"?"0":""}));if(n.match(rE))return o=Do(e,"##########",t),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var g="";if(i=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),l=np(u,Math.pow(10,a)-1,!1),o=""+p,g=ii("n",i[1],l[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),o+=g+i[2]+"/"+i[3],g=ep(l[2],a),g.length<i[4].length&&(g=or(i[4].substr(i[4].length-g.length))+g),o+=g,o;if(i=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),l=np(u,Math.pow(10,a)-1,!0),p+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Xv(l[1],a)+i[2]+"/"+i[3]+ep(l[2],a):Jt(" ",2*a+1+i[2].length+i[3].length));if(i=n.match(/^[#0?]+$/))return o=""+t,n.length<=o.length?o:or(n.substr(0,n.length-o.length))+o;if(i=n.match(/^([#0]+)\.([#0]+)$/)){o=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=o.indexOf(".");var m=n.indexOf(".")-a,v=n.length-o.length-m;return or(n.substr(0,m)+o+n.substr(n.length-v))}if(i=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Do(e,n,-t):Fi(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?po(0,3-b.length):"")+b})+"."+po(0,i[1].length);switch(n){case"###,###":case"##,###":case"#,###":var h=Fi(""+u);return h!=="0"?p+h:"";default:if(n.match(/\.[0#?]*$/))return Do(e,n.slice(0,n.lastIndexOf(".")),t)+or(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function ii(e,n,t){return(t|0)===t?Do(e,n,t):zr(e,n,t)}function S3(e){for(var n=[],t=!1,r=0,o=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(o,r-o),o=r+1}if(n[n.length]=e.substr(o),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var iE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function aE(e){for(var n=0,t="",r="";n<e.length;)switch(t=e.charAt(n)){case"G":tp(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++n;break;case"[":for(r=t;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(iE))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function D3(e,n,t,r){for(var o=[],i="",a=0,l="",u="t",p,g,m,v="H";a<e.length;)switch(l=e.charAt(a)){case"G":if(!tp(e,a))throw new Error("unrecognized character "+l+" in "+e);o[o.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(m=e.charCodeAt(++a))!==34&&a<e.length;)i+=String.fromCharCode(m);o[o.length]={t:"t",v:i},++a;break;case"\\":var h=e.charAt(++a),b=h==="("||h===")"?h:"t";o[o.length]={t:b,v:h},++a;break;case"_":o[o.length]={t:"t",v:" "},a+=2;break;case"@":o[o.length]={t:"T",v:n},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(p==null&&(p=qf(n,t,e.charAt(a+1)==="2"),p==null))return"";o[o.length]={t:"X",v:e.substr(a,2)},u=l,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||p==null&&(p=qf(n,t),p==null))return"";for(i=l;++a<e.length&&e.charAt(a).toLowerCase()===l;)i+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=v),o[o.length]={t:l,v:i},u=l;break;case"A":case"a":case"\u4E0A":var x={t:l,v:l};if(p==null&&(p=qf(n,t)),e.substr(a,3).toUpperCase()==="A/P"?(p!=null&&(x.v=p.H>=12?"P":"A"),x.t="T",v="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(p!=null&&(x.v=p.H>=12?"PM":"AM"),x.t="T",a+=5,v="h"):e.substr(a,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(p!=null&&(x.v=p.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),x.t="T",a+=5,v="h"):(x.t="t",++a),p==null&&x.t==="T")return"";o[o.length]=x,u=l;break;case"[":for(i=l;e.charAt(a++)!=="]"&&a<e.length;)i+=e.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(iE)){if(p==null&&(p=qf(n,t),p==null))return"";o[o.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",aE(e)||(o[o.length]={t:"t",v:i}));break;case".":if(p!=null){for(i=l;++a<e.length&&(l=e.charAt(a))==="0";)i+=l;o[o.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++a<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(a))>-1;)i+=l;o[o.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++a)===l;)i+=l;o[o.length]={t:l,v:i},u=l;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":o[o.length]={t:r===1?"t":l,v:l},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)i+=e.charAt(a);o[o.length]={t:"D",v:i};break;case" ":o[o.length]={t:l,v:l},++a;break;case"$":o[o.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);o[o.length]={t:"t",v:l},++a;break}var y=0,A=0,L;for(a=o.length-1,u="t";a>=0;--a)switch(o[a].t){case"h":case"H":o[a].t=v,u="h",y<1&&(y=1);break;case"s":(L=o[a].v.match(/\.0+$/))&&(A=Math.max(A,L[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":u=o[a].t;break;case"m":u==="s"&&(o[a].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&o[a].v.match(/[Hh]/)&&(y=1),y<2&&o[a].v.match(/[Mm]/)&&(y=2),y<3&&o[a].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M);break}var V="",X;for(a=0;a<o.length;++a)switch(o[a].t){case"t":case"T":case" ":case"D":break;case"X":o[a].v="",o[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[a].v=C3(o[a].t.charCodeAt(0),o[a].v,p,A),o[a].t="t";break;case"n":case"?":for(X=a+1;o[X]!=null&&((l=o[X].t)==="?"||l==="D"||(l===" "||l==="t")&&o[X+1]!=null&&(o[X+1].t==="?"||o[X+1].t==="t"&&o[X+1].v==="/")||o[a].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(o[X].v==="/"||o[X].v===" "&&o[X+1]!=null&&o[X+1].t=="?"));)o[a].v+=o[X].v,o[X]={v:"",t:";"},++X;V+=o[a].v,a=X-1;break;case"G":o[a].t="t",o[a].v=Hv(n,t);break}var ae="",Te,B;if(V.length>0){V.charCodeAt(0)==40?(Te=n<0&&V.charCodeAt(0)===45?-n:n,B=ii("n",V,Te)):(Te=n<0&&r>1?-n:n,B=ii("n",V,Te),Te<0&&o[0]&&o[0].t=="t"&&(B=B.substr(1),o[0].v="-"+o[0].v)),X=B.length-1;var oe=o.length;for(a=0;a<o.length;++a)if(o[a]!=null&&o[a].t!="t"&&o[a].v.indexOf(".")>-1){oe=a;break}var J=o.length;if(oe===o.length&&B.indexOf("E")===-1){for(a=o.length-1;a>=0;--a)o[a]==null||"n?".indexOf(o[a].t)===-1||(X>=o[a].v.length-1?(X-=o[a].v.length,o[a].v=B.substr(X+1,o[a].v.length)):X<0?o[a].v="":(o[a].v=B.substr(0,X+1),X=-1),o[a].t="t",J=a);X>=0&&J<o.length&&(o[J].v=B.substr(0,X+1)+o[J].v)}else if(oe!==o.length&&B.indexOf("E")===-1){for(X=B.indexOf(".")-1,a=oe;a>=0;--a)if(!(o[a]==null||"n?".indexOf(o[a].t)===-1)){for(g=o[a].v.indexOf(".")>-1&&a===oe?o[a].v.indexOf(".")-1:o[a].v.length-1,ae=o[a].v.substr(g+1);g>=0;--g)X>=0&&(o[a].v.charAt(g)==="0"||o[a].v.charAt(g)==="#")&&(ae=B.charAt(X--)+ae);o[a].v=ae,o[a].t="t",J=a}for(X>=0&&J<o.length&&(o[J].v=B.substr(0,X+1)+o[J].v),X=B.indexOf(".")+1,a=oe;a<o.length;++a)if(!(o[a]==null||"n?(".indexOf(o[a].t)===-1&&a!==oe)){for(g=o[a].v.indexOf(".")>-1&&a===oe?o[a].v.indexOf(".")+1:0,ae=o[a].v.substr(0,g);g<o[a].v.length;++g)X<B.length&&(ae+=B.charAt(X++));o[a].v=ae,o[a].t="t",J=a}}}for(a=0;a<o.length;++a)o[a]!=null&&"n?".indexOf(o[a].t)>-1&&(Te=r>1&&n<0&&a>0&&o[a-1].v==="-"?-n:n,o[a].v=ii(o[a].t,o[a].v,Te),o[a].t="t");var te="";for(a=0;a!==o.length;++a)o[a]!=null&&(te+=o[a].v);return te}var hw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vw(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function k3(e,n){var t=S3(e),r=t.length,o=t[r-1].indexOf("@");if(r<4&&o>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||o>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=o>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=o>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=o>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break;case 4:break}var i=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(hw),l=t[1].match(hw);return vw(n,a)?[r,t[0]]:vw(n,l)?[r,t[1]]:[r,t[a!=null&&l!=null?2:1]]}return[r,i]}function Ri(e,n,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:en)[e],r==null&&(r=t.table&&t.table[pw[e]]||en[pw[e]]),r==null&&(r=f3[e]||"General");break}if(tp(r,0))return Hv(n,t);n instanceof Date&&(n=Zw(n,t.date1904));var o=k3(r,n);if(tp(o[1]))return Hv(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return D3(o[1],n,t,o[0])}function sE(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(en[t]==null){n<0&&(n=t);continue}if(en[t]==e){n=t;break}}n<0&&(n=391)}return en[n]=e,n}function gp(e){for(var n=0;n!=392;++n)e[n]!==void 0&&sE(e[n],n)}function mp(){en=u3()}var cE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function I3(e){var n=typeof e=="number"?en[e]:e;return n=n.replace(cE,"(\\d+)"),new RegExp("^"+n+"$")}function A3(e,n,t){var r=-1,o=-1,i=-1,a=-1,l=-1,u=-1;(n.match(cE)||[]).forEach(function(m,v){var h=parseInt(t[v+1],10);switch(m.toLowerCase().charAt(0)){case"y":r=h;break;case"d":i=h;break;case"h":a=h;break;case"s":u=h;break;case"m":a>=0?l=h:o=h;break}}),u>=0&&l==-1&&o>=0&&(l=o,o=-1);var p=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(o>=1?o:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);p.length==7&&(p="0"+p),p.length==8&&(p="20"+p);var g=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return a==-1&&l==-1&&u==-1?p:r==-1&&o==-1&&i==-1?g:p+"T"+g}var N3=(function(){var e={};e.version="1.2.0";function n(){for(var B=0,oe=new Array(256),J=0;J!=256;++J)B=J,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,oe[J]=B;return typeof Int32Array<"u"?new Int32Array(oe):oe}var t=n();function r(B){var oe=0,J=0,te=0,de=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)de[te]=B[te];for(te=0;te!=256;++te)for(J=B[te],oe=256+te;oe<4096;oe+=256)J=de[oe]=J>>>8^B[J&255];var fe=[];for(te=1;te!=16;++te)fe[te-1]=typeof Int32Array<"u"?de.subarray(te*256,te*256+256):de.slice(te*256,te*256+256);return fe}var o=r(t),i=o[0],a=o[1],l=o[2],u=o[3],p=o[4],g=o[5],m=o[6],v=o[7],h=o[8],b=o[9],x=o[10],y=o[11],A=o[12],L=o[13],V=o[14];function X(B,oe){for(var J=oe^-1,te=0,de=B.length;te<de;)J=J>>>8^t[(J^B.charCodeAt(te++))&255];return~J}function ae(B,oe){for(var J=oe^-1,te=B.length-15,de=0;de<te;)J=V[B[de++]^J&255]^L[B[de++]^J>>8&255]^A[B[de++]^J>>16&255]^y[B[de++]^J>>>24]^x[B[de++]]^b[B[de++]]^h[B[de++]]^v[B[de++]]^m[B[de++]]^g[B[de++]]^p[B[de++]]^u[B[de++]]^l[B[de++]]^a[B[de++]]^i[B[de++]]^t[B[de++]];for(te+=15;de<te;)J=J>>>8^t[(J^B[de++])&255];return~J}function Te(B,oe){for(var J=oe^-1,te=0,de=B.length,fe=0,Be=0;te<de;)fe=B.charCodeAt(te++),fe<128?J=J>>>8^t[(J^fe)&255]:fe<2048?(J=J>>>8^t[(J^(192|fe>>6&31))&255],J=J>>>8^t[(J^(128|fe&63))&255]):fe>=55296&&fe<57344?(fe=(fe&1023)+64,Be=B.charCodeAt(te++)&1023,J=J>>>8^t[(J^(240|fe>>8&7))&255],J=J>>>8^t[(J^(128|fe>>2&63))&255],J=J>>>8^t[(J^(128|Be>>6&15|(fe&3)<<4))&255],J=J>>>8^t[(J^(128|Be&63))&255]):(J=J>>>8^t[(J^(224|fe>>12&15))&255],J=J>>>8^t[(J^(128|fe>>6&63))&255],J=J>>>8^t[(J^(128|fe&63))&255]);return~J}return e.table=t,e.bstr=X,e.buf=ae,e.str=Te,e})(),Ft=(function(){var n={};n.version="1.2.1";function t(C,D){for(var w=C.split("/"),O=D.split("/"),k=0,I=0,U=Math.min(w.length,O.length);k<U;++k){if(I=w[k].length-O[k].length)return I;if(w[k]!=O[k])return w[k]<O[k]?-1:1}return w.length-O.length}function r(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:r(C.slice(0,-1));var D=C.lastIndexOf("/");return D===-1?C:C.slice(0,D+1)}function o(C){if(C.charAt(C.length-1)=="/")return o(C.slice(0,-1));var D=C.lastIndexOf("/");return D===-1?C:C.slice(D+1)}function i(C,D){typeof D=="string"&&(D=new Date(D));var w=D.getHours();w=w<<6|D.getMinutes(),w=w<<5|D.getSeconds()>>>1,C.write_shift(2,w);var O=D.getFullYear()-1980;O=O<<4|D.getMonth()+1,O=O<<5|D.getDate(),C.write_shift(2,O)}function a(C){var D=C.read_shift(2)&65535,w=C.read_shift(2)&65535,O=new Date,k=w&31;w>>>=5;var I=w&15;w>>>=4,O.setMilliseconds(0),O.setFullYear(w+1980),O.setMonth(I-1),O.setDate(k);var U=D&31;D>>>=5;var Q=D&63;return D>>>=6,O.setHours(D),O.setMinutes(Q),O.setSeconds(U<<1),O}function l(C){Or(C,0);for(var D={},w=0;C.l<=C.length-4;){var O=C.read_shift(2),k=C.read_shift(2),I=C.l+k,U={};O===21589&&(w=C.read_shift(1),w&1&&(U.mtime=C.read_shift(4)),k>5&&(w&2&&(U.atime=C.read_shift(4)),w&4&&(U.ctime=C.read_shift(4))),U.mtime&&(U.mt=new Date(U.mtime*1e3))),C.l=I,D[O]=U}return D}var u;function p(){return u||(u={})}function g(C,D){if(C[0]==80&&C[1]==75)return P1(C,D);if((C[0]|32)==109&&(C[1]|32)==105)return N2(C,D);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var w=3,O=512,k=0,I=0,U=0,Q=0,z=0,W=[],G=C.slice(0,512);Or(G,0);var pe=m(G);switch(w=pe[0],w){case 3:O=512;break;case 4:O=4096;break;case 0:if(pe[1]==0)return P1(C,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+w)}O!==512&&(G=C.slice(0,O),Or(G,28));var ve=C.slice(0,O);v(G,w);var Ae=G.read_shift(4,"i");if(w===3&&Ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ae);G.l+=4,U=G.read_shift(4,"i"),G.l+=4,G.chk("00100000","Mini Stream Cutoff Size: "),Q=G.read_shift(4,"i"),k=G.read_shift(4,"i"),z=G.read_shift(4,"i"),I=G.read_shift(4,"i");for(var xe=-1,Ce=0;Ce<109&&(xe=G.read_shift(4,"i"),!(xe<0));++Ce)W[Ce]=xe;var Xe=h(C,O);y(z,I,Xe,O,W);var zt=L(Xe,U,W,O);zt[U].name="!Directory",k>0&&Q!==Be&&(zt[Q].name="!MiniFAT"),zt[W[0]].name="!FAT",zt.fat_addrs=W,zt.ssz=O;var lr={},on=[],xr=[],Zs=[];V(U,zt,Xe,on,k,lr,xr,Q),b(xr,Zs,on),on.shift();var Qs={FileIndex:xr,FullPaths:Zs};return D&&D.raw&&(Qs.raw={header:ve,sectors:Xe}),Qs}function m(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(bt,"Header Signature: "),C.l+=16;var D=C.read_shift(2,"u");return[C.read_shift(2,"u"),D]}function v(C,D){var w=9;switch(C.l+=2,w=C.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+w);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+w)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function h(C,D){for(var w=Math.ceil(C.length/D)-1,O=[],k=1;k<w;++k)O[k-1]=C.slice(k*D,(k+1)*D);return O[w-1]=C.slice(w*D),O}function b(C,D,w){for(var O=0,k=0,I=0,U=0,Q=0,z=w.length,W=[],G=[];O<z;++O)W[O]=G[O]=O,D[O]=w[O];for(;Q<G.length;++Q)O=G[Q],k=C[O].L,I=C[O].R,U=C[O].C,W[O]===O&&(k!==-1&&W[k]!==k&&(W[O]=W[k]),I!==-1&&W[I]!==I&&(W[O]=W[I])),U!==-1&&(W[U]=O),k!==-1&&O!=W[O]&&(W[k]=W[O],G.lastIndexOf(k)<Q&&G.push(k)),I!==-1&&O!=W[O]&&(W[I]=W[O],G.lastIndexOf(I)<Q&&G.push(I));for(O=1;O<z;++O)W[O]===O&&(I!==-1&&W[I]!==I?W[O]=W[I]:k!==-1&&W[k]!==k&&(W[O]=W[k]));for(O=1;O<z;++O)if(C[O].type!==0){if(Q=O,Q!=W[Q])do Q=W[Q],D[O]=D[Q]+"/"+D[O];while(Q!==0&&W[Q]!==-1&&Q!=W[Q]);W[O]=-1}for(D[0]+="/",O=1;O<z;++O)C[O].type!==2&&(D[O]+="/")}function x(C,D,w){for(var O=C.start,k=C.size,I=[],U=O;w&&k>0&&U>=0;)I.push(D.slice(U*fe,U*fe+fe)),k-=fe,U=wa(w,U*4);return I.length===0?Z(0):Vn(I).slice(0,C.size)}function y(C,D,w,O,k){var I=Be;if(C===Be){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var U=w[C],Q=(O>>>2)-1;if(!U)return;for(var z=0;z<Q&&(I=wa(U,z*4))!==Be;++z)k.push(I);y(wa(U,O-4),D-1,w,O,k)}}function A(C,D,w,O,k){var I=[],U=[];k||(k=[]);var Q=O-1,z=0,W=0;for(z=D;z>=0;){k[z]=!0,I[I.length]=z,U.push(C[z]);var G=w[Math.floor(z*4/O)];if(W=z*4&Q,O<4+W)throw new Error("FAT boundary crossed: "+z+" 4 "+O);if(!C[G])break;z=wa(C[G],W)}return{nodes:I,data:Ew([U])}}function L(C,D,w,O){var k=C.length,I=[],U=[],Q=[],z=[],W=O-1,G=0,pe=0,ve=0,Ae=0;for(G=0;G<k;++G)if(Q=[],ve=G+D,ve>=k&&(ve-=k),!U[ve]){z=[];var xe=[];for(pe=ve;pe>=0;){xe[pe]=!0,U[pe]=!0,Q[Q.length]=pe,z.push(C[pe]);var Ce=w[Math.floor(pe*4/O)];if(Ae=pe*4&W,O<4+Ae)throw new Error("FAT boundary crossed: "+pe+" 4 "+O);if(!C[Ce]||(pe=wa(C[Ce],Ae),xe[pe]))break}I[ve]={nodes:Q,data:Ew([z])}}return I}function V(C,D,w,O,k,I,U,Q){for(var z=0,W=O.length?2:0,G=D[C].data,pe=0,ve=0,Ae;pe<G.length;pe+=128){var xe=G.slice(pe,pe+128);Or(xe,64),ve=xe.read_shift(2),Ae=xp(xe,0,ve-W),O.push(Ae);var Ce={name:Ae,type:xe.read_shift(1),color:xe.read_shift(1),L:xe.read_shift(4,"i"),R:xe.read_shift(4,"i"),C:xe.read_shift(4,"i"),clsid:xe.read_shift(16),state:xe.read_shift(4,"i"),start:0,size:0},Xe=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Xe!==0&&(Ce.ct=X(xe,xe.l-8));var zt=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);zt!==0&&(Ce.mt=X(xe,xe.l-8)),Ce.start=xe.read_shift(4,"i"),Ce.size=xe.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=Be,Ce.name=""),Ce.type===5?(z=Ce.start,k>0&&z!==Be&&(D[z].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",D[Ce.start]===void 0&&(D[Ce.start]=A(w,Ce.start,D.fat_addrs,D.ssz)),D[Ce.start].name=Ce.name,Ce.content=D[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:z!==Be&&Ce.start!==Be&&D[z]&&(Ce.content=x(Ce,D[z].data,(D[Q]||{}).data))),Ce.content&&Or(Ce.content,0),I[Ae]=Ce,U.push(Ce)}}function X(C,D){return new Date((bn(C,D+4)/1e7*Math.pow(2,32)+bn(C,D)/1e7-11644473600)*1e3)}function ae(C,D){return p(),g(u.readFileSync(C),D)}function Te(C,D){var w=D&&D.type;switch(w||Ct&&Buffer.isBuffer(C)&&(w="buffer"),w||"base64"){case"file":return ae(C,D);case"base64":return g(fo(ci(C)),D);case"binary":return g(fo(C),D)}return g(C,D)}function B(C,D){var w=D||{},O=w.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=O+"/",C.FileIndex[0]={name:O,type:5}),w.CLSID&&(C.FileIndex[0].clsid=w.CLSID),oe(C)}function oe(C){var D="Sh33tJ5";if(!Ft.find(C,"/"+D)){var w=Z(4);w[0]=55,w[1]=w[3]=50,w[2]=54,C.FileIndex.push({name:D,type:2,content:w,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+D),J(C)}}function J(C,D){B(C);for(var w=!1,O=!1,k=C.FullPaths.length-1;k>=0;--k){var I=C.FileIndex[k];switch(I.type){case 0:O?w=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(I.R*I.L*I.C)&&(w=!0),I.R>-1&&I.L>-1&&I.R==I.L&&(w=!0);break;default:w=!0;break}}if(!(!w&&!D)){var U=new Date(1987,1,19),Q=0,z=Object.create?Object.create(null):{},W=[];for(k=0;k<C.FullPaths.length;++k)z[C.FullPaths[k]]=!0,C.FileIndex[k].type!==0&&W.push([C.FullPaths[k],C.FileIndex[k]]);for(k=0;k<W.length;++k){var G=r(W[k][0]);O=z[G],O||(W.push([G,{name:o(G).replace("/",""),type:1,clsid:vn,ct:U,mt:U,content:null}]),z[G]=!0)}for(W.sort(function(Ae,xe){return t(Ae[0],xe[0])}),C.FullPaths=[],C.FileIndex=[],k=0;k<W.length;++k)C.FullPaths[k]=W[k][0],C.FileIndex[k]=W[k][1];for(k=0;k<W.length;++k){var pe=C.FileIndex[k],ve=C.FullPaths[k];if(pe.name=o(ve).replace("/",""),pe.L=pe.R=pe.C=-(pe.color=1),pe.size=pe.content?pe.content.length:0,pe.start=0,pe.clsid=pe.clsid||vn,k===0)pe.C=W.length>1?1:-1,pe.size=0,pe.type=5;else if(ve.slice(-1)=="/"){for(Q=k+1;Q<W.length&&r(C.FullPaths[Q])!=ve;++Q);for(pe.C=Q>=W.length?-1:Q,Q=k+1;Q<W.length&&r(C.FullPaths[Q])!=r(ve);++Q);pe.R=Q>=W.length?-1:Q,pe.type=1}else r(C.FullPaths[k+1]||"")==r(ve)&&(pe.R=k+1),pe.type=2}}}function te(C,D){var w=D||{};if(w.fileType=="mad")return F2(C,w);if(J(C),w.fileType==="zip")return P2(C,w);var O=(function(Ae){for(var xe=0,Ce=0,Xe=0;Xe<Ae.FileIndex.length;++Xe){var zt=Ae.FileIndex[Xe];if(zt.content){var lr=zt.content.length;lr>0&&(lr<4096?xe+=lr+63>>6:Ce+=lr+511>>9)}}for(var on=Ae.FullPaths.length+3>>2,xr=xe+7>>3,Zs=xe+127>>7,Qs=xr+Ce+on+Zs,Wi=Qs+127>>7,M0=Wi<=109?0:Math.ceil((Wi-109)/127);Qs+Wi+M0+127>>7>Wi;)M0=++Wi<=109?0:Math.ceil((Wi-109)/127);var Ro=[1,M0,Wi,Zs,on,Ce,xe,0];return Ae.FileIndex[0].size=xe<<6,Ro[7]=(Ae.FileIndex[0].start=Ro[0]+Ro[1]+Ro[2]+Ro[3]+Ro[4]+Ro[5])+(Ro[6]+7>>3),Ro})(C),k=Z(O[7]<<9),I=0,U=0;{for(I=0;I<8;++I)k.write_shift(1,ze[I]);for(I=0;I<8;++I)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),I=0;I<3;++I)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,O[2]),k.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:Be),k.write_shift(4,O[3]),k.write_shift(-4,O[1]?O[0]-1:Be),k.write_shift(4,O[1]),I=0;I<109;++I)k.write_shift(-4,I<O[2]?O[1]+I:-1)}if(O[1])for(U=0;U<O[1];++U){for(;I<236+U*127;++I)k.write_shift(-4,I<O[2]?O[1]+I:-1);k.write_shift(-4,U===O[1]-1?Be:U+1)}var Q=function(Ae){for(U+=Ae;I<U-1;++I)k.write_shift(-4,I+1);Ae&&(++I,k.write_shift(-4,Be))};for(U=I=0,U+=O[1];I<U;++I)k.write_shift(-4,xn.DIFSECT);for(U+=O[2];I<U;++I)k.write_shift(-4,xn.FATSECT);Q(O[3]),Q(O[4]);for(var z=0,W=0,G=C.FileIndex[0];z<C.FileIndex.length;++z)G=C.FileIndex[z],G.content&&(W=G.content.length,!(W<4096)&&(G.start=U,Q(W+511>>9)));for(Q(O[6]+7>>3);k.l&511;)k.write_shift(-4,xn.ENDOFCHAIN);for(U=I=0,z=0;z<C.FileIndex.length;++z)G=C.FileIndex[z],G.content&&(W=G.content.length,!(!W||W>=4096)&&(G.start=U,Q(W+63>>6)));for(;k.l&511;)k.write_shift(-4,xn.ENDOFCHAIN);for(I=0;I<O[4]<<2;++I){var pe=C.FullPaths[I];if(!pe||pe.length===0){for(z=0;z<17;++z)k.write_shift(4,0);for(z=0;z<3;++z)k.write_shift(4,-1);for(z=0;z<12;++z)k.write_shift(4,0);continue}G=C.FileIndex[I],I===0&&(G.start=G.size?G.start-1:Be);var ve=I===0&&w.root||G.name;if(W=2*(ve.length+1),k.write_shift(64,ve,"utf16le"),k.write_shift(2,W),k.write_shift(1,G.type),k.write_shift(1,G.color),k.write_shift(-4,G.L),k.write_shift(-4,G.R),k.write_shift(-4,G.C),G.clsid)k.write_shift(16,G.clsid,"hex");else for(z=0;z<4;++z)k.write_shift(4,0);k.write_shift(4,G.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,G.start),k.write_shift(4,G.size),k.write_shift(4,0)}for(I=1;I<C.FileIndex.length;++I)if(G=C.FileIndex[I],G.size>=4096)if(k.l=G.start+1<<9,Ct&&Buffer.isBuffer(G.content))G.content.copy(k,k.l,0,G.size),k.l+=G.size+511&-512;else{for(z=0;z<G.size;++z)k.write_shift(1,G.content[z]);for(;z&511;++z)k.write_shift(1,0)}for(I=1;I<C.FileIndex.length;++I)if(G=C.FileIndex[I],G.size>0&&G.size<4096)if(Ct&&Buffer.isBuffer(G.content))G.content.copy(k,k.l,0,G.size),k.l+=G.size+63&-64;else{for(z=0;z<G.size;++z)k.write_shift(1,G.content[z]);for(;z&63;++z)k.write_shift(1,0)}if(Ct)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function de(C,D){var w=C.FullPaths.map(function(z){return z.toUpperCase()}),O=w.map(function(z){var W=z.split("/");return W[W.length-(z.slice(-1)=="/"?2:1)]}),k=!1;D.charCodeAt(0)===47?(k=!0,D=w[0].slice(0,-1)+D):k=D.indexOf("/")!==-1;var I=D.toUpperCase(),U=k===!0?w.indexOf(I):O.indexOf(I);if(U!==-1)return C.FileIndex[U];var Q=!I.match(Gf);for(I=I.replace(Vs,""),Q&&(I=I.replace(Gf,"!")),U=0;U<w.length;++U)if((Q?w[U].replace(Gf,"!"):w[U]).replace(Vs,"")==I||(Q?O[U].replace(Gf,"!"):O[U]).replace(Vs,"")==I)return C.FileIndex[U];return null}var fe=64,Be=-2,bt="d0cf11e0a1b11ae1",ze=[208,207,17,224,161,177,26,225],vn="00000000000000000000000000000000",xn={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Be,FREESECT:-1,HEADER_SIGNATURE:bt,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:vn,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function sr(C,D,w){p();var O=te(C,w);u.writeFileSync(D,O)}function Zn(C){for(var D=new Array(C.length),w=0;w<C.length;++w)D[w]=String.fromCharCode(C[w]);return D.join("")}function En(C,D){var w=te(C,D);switch(D&&D.type||"buffer"){case"file":return p(),u.writeFileSync(D.filename,w),w;case"binary":return typeof w=="string"?w:Zn(w);case"base64":return Nl(typeof w=="string"?w:Zn(w));case"buffer":if(Ct)return Buffer.isBuffer(w)?w:di(w);case"array":return typeof w=="string"?fo(w):w}return w}var cr;function N(C){try{var D=C.InflateRaw,w=new D;if(w._processChunk(new Uint8Array([3,0]),w._finishFlushFlag),w.bytesRead)cr=C;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function ee(C,D){if(!cr)return O1(C,D);var w=cr.InflateRaw,O=new w,k=O._processChunk(C.slice(C.l),O._finishFlushFlag);return C.l+=O.bytesRead,k}function R(C){return cr?cr.deflateRawSync(C):C1(C)}var F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function qe(C){var D=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(D>>16|D>>8|D)&255}for(var Ie=typeof Uint8Array<"u",_e=Ie?new Uint8Array(256):[],It=0;It<256;++It)_e[It]=qe(It);function ut(C,D){var w=_e[C&255];return D<=8?w>>>8-D:(w=w<<8|_e[C>>8&255],D<=16?w>>>16-D:(w=w<<8|_e[C>>16&255],w>>>24-D))}function On(C,D){var w=D&7,O=D>>>3;return(C[O]|(w<=6?0:C[O+1]<<8))>>>w&3}function pt(C,D){var w=D&7,O=D>>>3;return(C[O]|(w<=5?0:C[O+1]<<8))>>>w&7}function Gr(C,D){var w=D&7,O=D>>>3;return(C[O]|(w<=4?0:C[O+1]<<8))>>>w&15}function Zt(C,D){var w=D&7,O=D>>>3;return(C[O]|(w<=3?0:C[O+1]<<8))>>>w&31}function Fe(C,D){var w=D&7,O=D>>>3;return(C[O]|(w<=1?0:C[O+1]<<8))>>>w&127}function Sr(C,D,w){var O=D&7,k=D>>>3,I=(1<<w)-1,U=C[k]>>>O;return w<8-O||(U|=C[k+1]<<8-O,w<16-O)||(U|=C[k+2]<<16-O,w<24-O)||(U|=C[k+3]<<24-O),U&I}function Fo(C,D,w){var O=D&7,k=D>>>3;return O<=5?C[k]|=(w&7)<<O:(C[k]|=w<<O&255,C[k+1]=(w&7)>>8-O),D+3}function ji(C,D,w){var O=D&7,k=D>>>3;return w=(w&1)<<O,C[k]|=w,D+1}function Fa(C,D,w){var O=D&7,k=D>>>3;return w<<=O,C[k]|=w&255,w>>>=8,C[k+1]=w,D+8}function _1(C,D,w){var O=D&7,k=D>>>3;return w<<=O,C[k]|=w&255,w>>>=8,C[k+1]=w&255,C[k+2]=w>>>8,D+16}function _0(C,D){var w=C.length,O=2*w>D?2*w:D+5,k=0;if(w>=D)return C;if(Ct){var I=dw(O);if(C.copy)C.copy(I);else for(;k<C.length;++k)I[k]=C[k];return I}else if(Ie){var U=new Uint8Array(O);if(U.set)U.set(C);else for(;k<w;++k)U[k]=C[k];return U}return C.length=O,C}function mo(C){for(var D=new Array(C),w=0;w<C;++w)D[w]=0;return D}function $l(C,D,w){var O=1,k=0,I=0,U=0,Q=0,z=C.length,W=Ie?new Uint16Array(32):mo(32);for(I=0;I<32;++I)W[I]=0;for(I=z;I<w;++I)C[I]=0;z=C.length;var G=Ie?new Uint16Array(z):mo(z);for(I=0;I<z;++I)W[k=C[I]]++,O<k&&(O=k),G[I]=0;for(W[0]=0,I=1;I<=O;++I)W[I+16]=Q=Q+W[I-1]<<1;for(I=0;I<z;++I)Q=C[I],Q!=0&&(G[I]=W[Q+16]++);var pe=0;for(I=0;I<z;++I)if(pe=C[I],pe!=0)for(Q=ut(G[I],O)>>O-pe,U=(1<<O+4-pe)-1;U>=0;--U)D[Q|U<<pe]=pe&15|I<<4;return O}var C0=Ie?new Uint16Array(512):mo(512),b0=Ie?new Uint16Array(32):mo(32);if(!Ie){for(var Ui=0;Ui<512;++Ui)C0[Ui]=0;for(Ui=0;Ui<32;++Ui)b0[Ui]=0}(function(){for(var C=[],D=0;D<32;D++)C.push(5);$l(C,b0,32);var w=[];for(D=0;D<=143;D++)w.push(8);for(;D<=255;D++)w.push(9);for(;D<=279;D++)w.push(7);for(;D<=287;D++)w.push(8);$l(w,C0,288)})();var w2=(function(){for(var D=Ie?new Uint8Array(32768):[],w=0,O=0;w<Re.length-1;++w)for(;O<Re[w+1];++O)D[O]=w;for(;O<32768;++O)D[O]=29;var k=Ie?new Uint8Array(259):[];for(w=0,O=0;w<ce.length-1;++w)for(;O<ce[w+1];++O)k[O]=w;function I(Q,z){for(var W=0;W<Q.length;){var G=Math.min(65535,Q.length-W),pe=W+G==Q.length;for(z.write_shift(1,+pe),z.write_shift(2,G),z.write_shift(2,~G&65535);G-- >0;)z[z.l++]=Q[W++]}return z.l}function U(Q,z){for(var W=0,G=0,pe=Ie?new Uint16Array(32768):[];G<Q.length;){var ve=Math.min(65535,Q.length-G);if(ve<10){for(W=Fo(z,W,+(G+ve==Q.length)),W&7&&(W+=8-(W&7)),z.l=W/8|0,z.write_shift(2,ve),z.write_shift(2,~ve&65535);ve-- >0;)z[z.l++]=Q[G++];W=z.l*8;continue}W=Fo(z,W,+(G+ve==Q.length)+2);for(var Ae=0;ve-- >0;){var xe=Q[G];Ae=(Ae<<5^xe)&32767;var Ce=-1,Xe=0;if((Ce=pe[Ae])&&(Ce|=G&-32768,Ce>G&&(Ce-=32768),Ce<G))for(;Q[Ce+Xe]==Q[G+Xe]&&Xe<250;)++Xe;if(Xe>2){xe=k[Xe],xe<=22?W=Fa(z,W,_e[xe+1]>>1)-1:(Fa(z,W,3),W+=5,Fa(z,W,_e[xe-23]>>5),W+=3);var zt=xe<8?0:xe-4>>2;zt>0&&(_1(z,W,Xe-ce[xe]),W+=zt),xe=D[G-Ce],W=Fa(z,W,_e[xe]>>3),W-=3;var lr=xe<4?0:xe-2>>1;lr>0&&(_1(z,W,G-Ce-Re[xe]),W+=lr);for(var on=0;on<Xe;++on)pe[Ae]=G&32767,Ae=(Ae<<5^Q[G])&32767,++G;ve-=Xe-1}else xe<=143?xe=xe+48:W=ji(z,W,1),W=Fa(z,W,_e[xe]),pe[Ae]=G&32767,++G}W=Fa(z,W,0)-1}return z.l=(W+7)/8|0,z.l}return function(z,W){return z.length<8?I(z,W):U(z,W)}})();function C1(C){var D=Z(50+Math.floor(C.length*1.1)),w=w2(C,D);return D.slice(0,w)}var b1=Ie?new Uint16Array(32768):mo(32768),y1=Ie?new Uint16Array(32768):mo(32768),M1=Ie?new Uint16Array(128):mo(128),w1=1,E1=1;function E2(C,D){var w=Zt(C,D)+257;D+=5;var O=Zt(C,D)+1;D+=5;var k=Gr(C,D)+4;D+=4;for(var I=0,U=Ie?new Uint8Array(19):mo(19),Q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=1,W=Ie?new Uint8Array(8):mo(8),G=Ie?new Uint8Array(8):mo(8),pe=U.length,ve=0;ve<k;++ve)U[F[ve]]=I=pt(C,D),z<I&&(z=I),W[I]++,D+=3;var Ae=0;for(W[0]=0,ve=1;ve<=z;++ve)G[ve]=Ae=Ae+W[ve-1]<<1;for(ve=0;ve<pe;++ve)(Ae=U[ve])!=0&&(Q[ve]=G[Ae]++);var xe=0;for(ve=0;ve<pe;++ve)if(xe=U[ve],xe!=0){Ae=_e[Q[ve]]>>8-xe;for(var Ce=(1<<7-xe)-1;Ce>=0;--Ce)M1[Ae|Ce<<xe]=xe&7|ve<<3}var Xe=[];for(z=1;Xe.length<w+O;)switch(Ae=M1[Fe(C,D)],D+=Ae&7,Ae>>>=3){case 16:for(I=3+On(C,D),D+=2,Ae=Xe[Xe.length-1];I-- >0;)Xe.push(Ae);break;case 17:for(I=3+pt(C,D),D+=3;I-- >0;)Xe.push(0);break;case 18:for(I=11+Fe(C,D),D+=7;I-- >0;)Xe.push(0);break;default:Xe.push(Ae),z<Ae&&(z=Ae);break}var zt=Xe.slice(0,w),lr=Xe.slice(w);for(ve=w;ve<286;++ve)zt[ve]=0;for(ve=O;ve<30;++ve)lr[ve]=0;return w1=$l(zt,b1,286),E1=$l(lr,y1,30),D}function O2(C,D){if(C[0]==3&&!(C[1]&3))return[Ta(D),2];for(var w=0,O=0,k=dw(D||1<<18),I=0,U=k.length>>>0,Q=0,z=0;(O&1)==0;){if(O=pt(C,w),w+=3,O>>>1)O>>1==1?(Q=9,z=5):(w=E2(C,w),Q=w1,z=E1);else{w&7&&(w+=8-(w&7));var W=C[w>>>3]|C[(w>>>3)+1]<<8;if(w+=32,W>0)for(!D&&U<I+W&&(k=_0(k,I+W),U=k.length);W-- >0;)k[I++]=C[w>>>3],w+=8;continue}for(;;){!D&&U<I+32767&&(k=_0(k,I+32767),U=k.length);var G=Sr(C,w,Q),pe=O>>>1==1?C0[G]:b1[G];if(w+=pe&15,pe>>>=4,(pe>>>8&255)===0)k[I++]=pe;else{if(pe==256)break;pe-=257;var ve=pe<8?0:pe-4>>2;ve>5&&(ve=0);var Ae=I+ce[pe];ve>0&&(Ae+=Sr(C,w,ve),w+=ve),G=Sr(C,w,z),pe=O>>>1==1?b0[G]:y1[G],w+=pe&15,pe>>>=4;var xe=pe<4?0:pe-2>>1,Ce=Re[pe];for(xe>0&&(Ce+=Sr(C,w,xe),w+=xe),!D&&U<Ae&&(k=_0(k,Ae+100),U=k.length);I<Ae;)k[I]=k[I-Ce],++I}}}return D?[k,w+7>>>3]:[k.slice(0,I),w+7>>>3]}function O1(C,D){var w=C.slice(C.l||0),O=O2(w,D);return C.l+=O[1],O[0]}function T1(C,D){if(C)typeof console<"u"&&console.error(D);else throw new Error(D)}function P1(C,D){var w=C;Or(w,0);var O=[],k=[],I={FileIndex:O,FullPaths:k};B(I,{root:D.root});for(var U=w.length-4;(w[U]!=80||w[U+1]!=75||w[U+2]!=5||w[U+3]!=6)&&U>=0;)--U;w.l=U+4,w.l+=4;var Q=w.read_shift(2);w.l+=6;var z=w.read_shift(4);for(w.l=z,U=0;U<Q;++U){w.l+=20;var W=w.read_shift(4),G=w.read_shift(4),pe=w.read_shift(2),ve=w.read_shift(2),Ae=w.read_shift(2);w.l+=8;var xe=w.read_shift(4),Ce=l(w.slice(w.l+pe,w.l+pe+ve));w.l+=pe+ve+Ae;var Xe=w.l;w.l=xe+4,T2(w,W,G,I,Ce),w.l=Xe}return I}function T2(C,D,w,O,k){C.l+=2;var I=C.read_shift(2),U=C.read_shift(2),Q=a(C);if(I&8257)throw new Error("Unsupported ZIP encryption");for(var z=C.read_shift(4),W=C.read_shift(4),G=C.read_shift(4),pe=C.read_shift(2),ve=C.read_shift(2),Ae="",xe=0;xe<pe;++xe)Ae+=String.fromCharCode(C[C.l++]);if(ve){var Ce=l(C.slice(C.l,C.l+ve));(Ce[21589]||{}).mt&&(Q=Ce[21589].mt),((k||{})[21589]||{}).mt&&(Q=k[21589].mt)}C.l+=ve;var Xe=C.slice(C.l,C.l+W);switch(U){case 8:Xe=ee(C,G);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+U)}var zt=!1;I&8&&(z=C.read_shift(4),z==134695760&&(z=C.read_shift(4),zt=!0),W=C.read_shift(4),G=C.read_shift(4)),W!=D&&T1(zt,"Bad compressed size: "+D+" != "+W),G!=w&&T1(zt,"Bad uncompressed size: "+w+" != "+G),y0(O,Ae,Xe,{unsafe:!0,mt:Q})}function P2(C,D){var w=D||{},O=[],k=[],I=Z(1),U=w.compression?8:0,Q=0,z=!1;z&&(Q|=8);var W=0,G=0,pe=0,ve=0,Ae=C.FullPaths[0],xe=Ae,Ce=C.FileIndex[0],Xe=[],zt=0;for(W=1;W<C.FullPaths.length;++W)if(xe=C.FullPaths[W].slice(Ae.length),Ce=C.FileIndex[W],!(!Ce.size||!Ce.content||xe=="Sh33tJ5")){var lr=pe,on=Z(xe.length);for(G=0;G<xe.length;++G)on.write_shift(1,xe.charCodeAt(G)&127);on=on.slice(0,on.l),Xe[ve]=N3.buf(Ce.content,0);var xr=Ce.content;U==8&&(xr=R(xr)),I=Z(30),I.write_shift(4,67324752),I.write_shift(2,20),I.write_shift(2,Q),I.write_shift(2,U),Ce.mt?i(I,Ce.mt):I.write_shift(4,0),I.write_shift(-4,Q&8?0:Xe[ve]),I.write_shift(4,Q&8?0:xr.length),I.write_shift(4,Q&8?0:Ce.content.length),I.write_shift(2,on.length),I.write_shift(2,0),pe+=I.length,O.push(I),pe+=on.length,O.push(on),pe+=xr.length,O.push(xr),Q&8&&(I=Z(12),I.write_shift(-4,Xe[ve]),I.write_shift(4,xr.length),I.write_shift(4,Ce.content.length),pe+=I.l,O.push(I)),I=Z(46),I.write_shift(4,33639248),I.write_shift(2,0),I.write_shift(2,20),I.write_shift(2,Q),I.write_shift(2,U),I.write_shift(4,0),I.write_shift(-4,Xe[ve]),I.write_shift(4,xr.length),I.write_shift(4,Ce.content.length),I.write_shift(2,on.length),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(4,0),I.write_shift(4,lr),zt+=I.l,k.push(I),zt+=on.length,k.push(on),++ve}return I=Z(22),I.write_shift(4,101010256),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,ve),I.write_shift(2,ve),I.write_shift(4,zt),I.write_shift(4,pe),I.write_shift(2,0),Vn([Vn(O),Vn(k),I])}var Gl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function S2(C,D){if(C.ctype)return C.ctype;var w=C.name||"",O=w.match(/\.([^\.]+)$/);return O&&Gl[O[1]]||D&&(O=(w=D).match(/[\.\\]([^\.\\])+$/),O&&Gl[O[1]])?Gl[O[1]]:"application/octet-stream"}function D2(C){for(var D=Nl(C),w=[],O=0;O<D.length;O+=76)w.push(D.slice(O,O+76));return w.join(`\r
`)+`\r
`}function k2(C){var D=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(W){var G=W.charCodeAt(0).toString(16).toUpperCase();return"="+(G.length==1?"0"+G:G)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var w=[],O=D.split(`\r
`),k=0;k<O.length;++k){var I=O[k];if(I.length==0){w.push("");continue}for(var U=0;U<I.length;){var Q=76,z=I.slice(U,U+Q);z.charAt(Q-1)=="="?Q--:z.charAt(Q-2)=="="?Q-=2:z.charAt(Q-3)=="="&&(Q-=3),z=I.slice(U,U+Q),U+=Q,U<I.length&&(z+="="),w.push(z)}}return w.join(`\r
`)}function I2(C){for(var D=[],w=0;w<C.length;++w){for(var O=C[w];w<=C.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+C[++w];D.push(O)}for(var k=0;k<D.length;++k)D[k]=D[k].replace(/[=][0-9A-Fa-f]{2}/g,function(I){return String.fromCharCode(parseInt(I.slice(1),16))});return fo(D.join(`\r
`))}function A2(C,D,w){for(var O="",k="",I="",U,Q=0;Q<10;++Q){var z=D[Q];if(!z||z.match(/^\s*$/))break;var W=z.match(/^(.*?):\s*([^\s].*)$/);if(W)switch(W[1].toLowerCase()){case"content-location":O=W[2].trim();break;case"content-type":I=W[2].trim();break;case"content-transfer-encoding":k=W[2].trim();break}}switch(++Q,k.toLowerCase()){case"base64":U=fo(ci(D.slice(Q).join("")));break;case"quoted-printable":U=I2(D.slice(Q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var G=y0(C,O.slice(w.length),U,{unsafe:!0});I&&(G.ctype=I)}function N2(C,D){if(Zn(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var w=D&&D.root||"",O=(Ct&&Buffer.isBuffer(C)?C.toString("binary"):Zn(C)).split(`\r
`),k=0,I="";for(k=0;k<O.length;++k)if(I=O[k],!!/^Content-Location:/i.test(I)&&(I=I.slice(I.indexOf("file")),w||(w=I.slice(0,I.lastIndexOf("/")+1)),I.slice(0,w.length)!=w))for(;w.length>0&&(w=w.slice(0,w.length-1),w=w.slice(0,w.lastIndexOf("/")+1),I.slice(0,w.length)!=w););var U=(O[1]||"").match(/boundary="(.*?)"/);if(!U)throw new Error("MAD cannot find boundary");var Q="--"+(U[1]||""),z=[],W=[],G={FileIndex:z,FullPaths:W};B(G);var pe,ve=0;for(k=0;k<O.length;++k){var Ae=O[k];Ae!==Q&&Ae!==Q+"--"||(ve++&&A2(G,O.slice(pe,k),w),pe=k)}return G}function F2(C,D){var w=D||{},O=w.boundary||"SheetJS";O="------="+O;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],I=C.FullPaths[0],U=I,Q=C.FileIndex[0],z=1;z<C.FullPaths.length;++z)if(U=C.FullPaths[z].slice(I.length),Q=C.FileIndex[z],!(!Q.size||!Q.content||U=="Sh33tJ5")){U=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xe){return"_x"+Xe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xe){return"_u"+Xe.charCodeAt(0).toString(16)+"_"});for(var W=Q.content,G=Ct&&Buffer.isBuffer(W)?W.toString("binary"):Zn(W),pe=0,ve=Math.min(1024,G.length),Ae=0,xe=0;xe<=ve;++xe)(Ae=G.charCodeAt(xe))>=32&&Ae<128&&++pe;var Ce=pe>=ve*4/5;k.push(O),k.push("Content-Location: "+(w.root||"file:///C:/SheetJS/")+U),k.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),k.push("Content-Type: "+S2(Q,U)),k.push(""),k.push(Ce?k2(G):D2(G))}return k.push(O+`--\r
`),k.join(`\r
`)}function R2(C){var D={};return B(D,C),D}function y0(C,D,w,O){var k=O&&O.unsafe;k||B(C);var I=!k&&Ft.find(C,D);if(!I){var U=C.FullPaths[0];D.slice(0,U.length)==U?U=D:(U.slice(-1)!="/"&&(U+="/"),U=(U+D).replace("//","/")),I={name:o(D),type:2},C.FileIndex.push(I),C.FullPaths.push(U),k||Ft.utils.cfb_gc(C)}return I.content=w,I.size=w?w.length:0,O&&(O.CLSID&&(I.clsid=O.CLSID),O.mt&&(I.mt=O.mt),O.ct&&(I.ct=O.ct)),I}function L2(C,D){B(C);var w=Ft.find(C,D);if(w){for(var O=0;O<C.FileIndex.length;++O)if(C.FileIndex[O]==w)return C.FileIndex.splice(O,1),C.FullPaths.splice(O,1),!0}return!1}function B2(C,D,w){B(C);var O=Ft.find(C,D);if(O){for(var k=0;k<C.FileIndex.length;++k)if(C.FileIndex[k]==O)return C.FileIndex[k].name=o(w),C.FullPaths[k]=w,!0}return!1}function V2(C){J(C,!0)}return n.find=de,n.read=Te,n.parse=g,n.write=En,n.writeFile=sr,n.utils={cfb_new:R2,cfb_add:y0,cfb_del:L2,cfb_mov:B2,cfb_gc:V2,ReadShift:Pl,CheckField:bE,prep_blob:Or,bconcat:Vn,use_zlib:N,_deflateRaw:C1,_inflateRaw:O1,consts:xn},n})(),Xf;function F3(e){return typeof e=="string"?pp(e):Array.isArray(e)?s3(e):e}function jl(e,n,t){if(typeof Xf<"u"&&Xf.writeFileSync)return t?Xf.writeFileSync(e,n,t):Xf.writeFileSync(e,n);if(typeof Deno<"u"){if(t&&typeof n=="string")switch(t){case"utf8":n=new TextEncoder(t).encode(n);break;case"binary":n=pp(n);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,n)}var r=t=="utf8"?oi(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var o=new Blob([F3(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(o,e);if(typeof saveAs<"u")return saveAs(o,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(o);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(n)&&(n=Vl(n)),l.write(n),l.close(),n}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function Wn(e){for(var n=Object.keys(e),t=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&t.push(n[r]);return t}function xw(e,n){for(var t=[],r=Wn(e),o=0;o!==r.length;++o)t[e[r[o]][n]]==null&&(t[e[r[o]][n]]=r[o]);return t}function Kv(e){for(var n=[],t=Wn(e),r=0;r!==t.length;++r)n[e[t[r]]]=t[r];return n}function hp(e){for(var n=[],t=Wn(e),r=0;r!==t.length;++r)n[e[t[r]]]=parseInt(t[r],10);return n}function R3(e){for(var n=[],t=Wn(e),r=0;r!==t.length;++r)n[e[t[r]]]==null&&(n[e[t[r]]]=[]),n[e[t[r]]].push(t[r]);return n}var rp=new Date(1899,11,30,0,0,0);function hr(e,n){var t=e.getTime();n&&(t-=1462*24*60*60*1e3);var r=rp.getTime()+(e.getTimezoneOffset()-rp.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var lE=new Date,L3=rp.getTime()+(lE.getTimezoneOffset()-rp.getTimezoneOffset())*6e4,_w=lE.getTimezoneOffset();function dE(e){var n=new Date;return n.setTime(e*24*60*60*1e3+L3),n.getTimezoneOffset()!==_w&&n.setTime(n.getTime()+(n.getTimezoneOffset()-_w)*6e4),n}var Cw=new Date("2017-02-19T19:06:09.000Z"),uE=isNaN(Cw.getFullYear())?new Date("2/19/17"):Cw,B3=uE.getFullYear()==2017;function ar(e,n){var t=new Date(e);if(B3)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(uE.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function vp(e,n){if(Ct&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return oi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return oi(a3(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return oi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return oi(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return t[i]||i})}catch{}for(var r=[],o=0;o!=e.length;++o)r.push(String.fromCharCode(e[o]));return r.join("")}function vr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=vr(e[t]));return n}function Jt(e,n){for(var t="";t.length<n;)t+=e;return t}function ai(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(o,i){return t=-t,i}),!isNaN(n=Number(r)))?n/t:n}var V3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Fl(e){var n=new Date(e),t=new Date(NaN),r=n.getYear(),o=n.getMonth(),i=n.getDate();if(isNaN(i))return t;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&V3.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(o>0||i>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}function ot(e,n,t){if(e.FullPaths){if(typeof t=="string"){var r;return Ct?r=di(t):r=c3(t),Ft.utils.cfb_add(e,n,r)}Ft.utils.cfb_add(e,n,t)}else e.file(n,t)}function Zv(){return Ft.utils.cfb_new()}var un=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var j3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Qv=Kv(j3);var Jv=/[&<>'"]/g,U3=/[\u0000-\u0008\u000b-\u001f]/g;function Dt(e){var n=e+"";return n.replace(Jv,function(t){return Qv[t]}).replace(U3,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function bw(e){return Dt(e).replace(/ /g,"_x0020_")}var fE=/[\u0000-\u001f]/g;function W3(e){var n=e+"";return n.replace(Jv,function(t){return Qv[t]}).replace(/\n/g,"<br/>").replace(fE,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function z3(e){var n=e+"";return n.replace(Jv,function(t){return Qv[t]}).replace(fE,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function H3(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function $3(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Lv(e){for(var n="",t=0,r=0,o=0,i=0,a=0,l=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){n+=String.fromCharCode(r);continue}if(o=e.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=o&63,n+=String.fromCharCode(a);continue}if(i=e.charCodeAt(t++),r<240){n+=String.fromCharCode((r&15)<<12|(o&63)<<6|i&63);continue}a=e.charCodeAt(t++),l=((r&7)<<18|(o&63)<<12|(i&63)<<6|a&63)-65536,n+=String.fromCharCode(55296+(l>>>10&1023)),n+=String.fromCharCode(56320+(l&1023))}return n}function yw(e){var n=Ta(2*e.length),t,r,o=1,i=0,a=0,l;for(r=0;r<e.length;r+=o)o=1,(l=e.charCodeAt(r))<128?t=l:l<224?(t=(l&31)*64+(e.charCodeAt(r+1)&63),o=2):l<240?(t=(l&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),o=3):(o=4,t=(l&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(n[i++]=a&255,n[i++]=a>>>8,a=0),n[i++]=t%256,n[i++]=t>>>8;return n.slice(0,i).toString("ucs2")}function Mw(e){return di(e,"binary").toString("utf8")}var Yf="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",Tl=Ct&&(Mw(Yf)==Lv(Yf)&&Mw||yw(Yf)==Lv(Yf)&&yw)||Lv,oi=Ct?function(e){return di(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,r=0,o=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,o=e.charCodeAt(t++)-56320+(r<<10),n.push(String.fromCharCode(240+(o>>18&7))),n.push(String.fromCharCode(144+(o>>12&63))),n.push(String.fromCharCode(128+(o>>6&63))),n.push(String.fromCharCode(128+(o&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")};var G3=(function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),o=0;o<e.length;++o)r=r.replace(e[o][0],e[o][1]);return r}})();var pE=/(^\s|\s$|\n)/;function jn(e,n){return"<"+e+(n.match(pE)?' xml:space="preserve"':"")+">"+n+"</"+e+">"}function Rl(e){return Wn(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function me(e,n,t){return"<"+e+(t!=null?Rl(t):"")+(n!=null?(n.match(pE)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function $v(e,n){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(n)throw t}return""}function q3(e,n){switch(typeof e){case"string":var t=me("vt:lpwstr",Dt(e));return n&&(t=t.replace(/&quot;/g,"_x0022_")),t;case"number":return me((e|0)==e?"vt:i4":"vt:r8",Dt(String(e)));case"boolean":return me("vt:bool",e?"true":"false")}if(e instanceof Date)return me("vt:filetime",$v(e));throw new Error("Unable to serialize "+e)}var yn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Gs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Tr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function X3(e,n){for(var t=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),o=e[n+6]&15,i=5;i>=0;--i)o=o*256+e[n+i];return r==2047?o==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,o+=Math.pow(2,52)),t*Math.pow(2,r-52)*o)}function Y3(e,n,t){var r=(n<0||1/n==-1/0?1:0)<<7,o=0,i=0,a=r?-n:n;isFinite(a)?a==0?o=i=0:(o=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-o),o<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?o=-1022:(i-=Math.pow(2,52),o+=1023)):(o=2047,i=isNaN(n)?26985:0);for(var l=0;l<=5;++l,i/=256)e[t+l]=i&255;e[t+6]=(o&15)<<4|i&15,e[t+7]=o>>4|r}var ww=function(e){for(var n=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var o=0,i=e[0][r].length;o<i;o+=t)n.push.apply(n,e[0][r].slice(o,o+t));return n},Ew=Ct?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:di(n)})):ww(e)}:ww,Ow=function(e,n,t){for(var r=[],o=n;o<t;o+=2)r.push(String.fromCharCode(Ol(e,o)));return r.join("").replace(Vs,"")},xp=Ct?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(Vs,""):Ow(e,n,t)}:Ow,Tw=function(e,n,t){for(var r=[],o=n;o<n+t;++o)r.push(("0"+e[o].toString(16)).slice(-2));return r.join("")},gE=Ct?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):Tw(e,n,t)}:Tw,Pw=function(e,n,t){for(var r=[],o=n;o<t;o++)r.push(String.fromCharCode(Ls(e,o)));return r.join("")},qs=Ct?function(n,t,r){return Buffer.isBuffer(n)?n.toString("utf8",t,r):Pw(n,t,r)}:Pw,mE=function(e,n){var t=bn(e,n);return t>0?qs(e,n+4,n+4+t-1):""},e1=mE,hE=function(e,n){var t=bn(e,n);return t>0?qs(e,n+4,n+4+t-1):""},t1=hE,vE=function(e,n){var t=2*bn(e,n);return t>0?qs(e,n+4,n+4+t-1):""},n1=vE,xE=function(n,t){var r=bn(n,t);return r>0?xp(n,t+4,t+4+r):""},r1=xE,_E=function(e,n){var t=bn(e,n);return t>0?qs(e,n+4,n+4+t):""},o1=_E,CE=function(e,n){return X3(e,n)},op=CE,i1=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};Ct&&(e1=function(n,t){if(!Buffer.isBuffer(n))return mE(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},t1=function(n,t){if(!Buffer.isBuffer(n))return hE(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},n1=function(n,t){if(!Buffer.isBuffer(n))return vE(n,t);var r=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r-1)},r1=function(n,t){if(!Buffer.isBuffer(n))return xE(n,t);var r=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r)},o1=function(n,t){if(!Buffer.isBuffer(n))return _E(n,t);var r=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+r)},op=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):CE(n,t)},i1=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});function K3(){xp=function(e,n,t){return Bt.utils.decode(1200,e.slice(n,t)).replace(Vs,"")},qs=function(e,n,t){return Bt.utils.decode(65001,e.slice(n,t))},e1=function(e,n){var t=bn(e,n);return t>0?Bt.utils.decode(Hs,e.slice(n+4,n+4+t-1)):""},t1=function(e,n){var t=bn(e,n);return t>0?Bt.utils.decode(Ea,e.slice(n+4,n+4+t-1)):""},n1=function(e,n){var t=2*bn(e,n);return t>0?Bt.utils.decode(1200,e.slice(n+4,n+4+t-1)):""},r1=function(e,n){var t=bn(e,n);return t>0?Bt.utils.decode(1200,e.slice(n+4,n+4+t)):""},o1=function(e,n){var t=bn(e,n);return t>0?Bt.utils.decode(65001,e.slice(n+4,n+4+t)):""}}typeof Bt<"u"&&K3();var Ls=function(e,n){return e[n]},Ol=function(e,n){return e[n+1]*256+e[n]},Z3=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},bn=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},wa=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},Q3=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function Pl(e,n){var t="",r,o,i=[],a,l,u,p;switch(n){case"dbcs":if(p=this.l,Ct&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)t+=String.fromCharCode(Ol(this,p)),p+=2;e*=2;break;case"utf8":t=qs(this,this.l,this.l+e);break;case"utf16le":e*=2,t=xp(this,this.l,this.l+e);break;case"wstr":if(typeof Bt<"u")t=Bt.utils.decode(Ea,this.slice(this.l,this.l+2*e));else return Pl.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":t=e1(this,this.l),e=4+bn(this,this.l);break;case"lpstr-cp":t=t1(this,this.l),e=4+bn(this,this.l);break;case"lpwstr":t=n1(this,this.l),e=4+2*bn(this,this.l);break;case"lpp4":e=4+bn(this,this.l),t=r1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+bn(this,this.l),t=o1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(a=Ls(this,this.l+e++))!==0;)i.push($f(a));t=i.join("");break;case"_wstr":for(e=0,t="";(a=Ol(this,this.l+e))!==0;)i.push($f(a)),e+=2;e+=2,t=i.join("");break;case"dbcs-cont":for(t="",p=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(p)!==-1)return a=Ls(this,p),this.l=p+1,l=Pl.call(this,e-u,a?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push($f(Ol(this,p))),p+=2}t=i.join(""),e*=2;break;case"cpstr":if(typeof Bt<"u"){t=Bt.utils.decode(Ea,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",p=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(p)!==-1)return a=Ls(this,p),this.l=p+1,l=Pl.call(this,e-u,a?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push($f(Ls(this,p))),p+=1}t=i.join("");break;default:switch(e){case 1:return r=Ls(this,this.l),this.l++,r;case 2:return r=(n==="i"?Z3:Ol)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?wa:Q3)(this,this.l),this.l+=4,r):(o=bn(this,this.l),this.l+=4,o);case 8:case-8:if(n==="f")return e==8?o=op(this,this.l):o=op([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,o;e=8;case 16:t=gE(this,this.l,e);break}}return this.l+=e,t}var J3=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},eN=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},tN=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function nN(e,n,t){var r=0,o=0;if(t==="dbcs"){for(o=0;o!=n.length;++o)tN(this,n.charCodeAt(o),this.l+2*o);r=2*n.length}else if(t==="sbcs"){if(typeof Bt<"u"&&Hs==874)for(o=0;o!=n.length;++o){var i=Bt.utils.encode(Hs,n.charAt(o));this[this.l+o]=i[0]}else for(n=n.replace(/[^\x00-\x7F]/g,"_"),o=0;o!=n.length;++o)this[this.l+o]=n.charCodeAt(o)&255;r=n.length}else if(t==="hex"){for(;o<e;++o)this[this.l++]=parseInt(n.slice(2*o,2*o+2),16)||0;return this}else if(t==="utf16le"){var a=Math.min(this.l+e,this.length);for(o=0;o<Math.min(n.length,e);++o){var l=n.charCodeAt(o);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,J3(this,n,this.l);break;case 8:if(r=8,t==="f"){Y3(this,n,this.l);break}case 16:break;case-4:r=4,eN(this,n,this.l);break}return this.l+=r,this}function bE(e,n){var t=gE(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Or(e,n){e.l=n,e.read_shift=Pl,e.chk=bE,e.write_shift=nN}function Ao(e,n){e.l+=n}function Z(e){var n=Ta(e);return Or(n,0),n}function mr(){var e=[],n=Ct?256:2048,t=function(p){var g=Z(p);return Or(g,0),g},r=t(n),o=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},i=function(p){return r&&p<r.length-r.l?r:(o(),r=t(Math.max(p+1,n)))},a=function(){return o(),Vn(e)},l=function(p){o(),r=p,r.l==null&&(r.l=r.length),i(n)};return{next:i,push:l,end:a,_bufs:e}}function ie(e,n,t,r){var o=+n,i;if(!isNaN(o)){r||(r=Y5[o].p||(t||[]).length||0),i=1+(o>=128?1:0)+1,r>=128&&++i,r>=16384&&++i,r>=2097152&&++i;var a=e.next(i);o<=127?a.write_shift(1,o):(a.write_shift(1,(o&127)+128),a.write_shift(1,o>>7));for(var l=0;l!=4;++l)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&i1(t)&&e.push(t)}}function Sl(e,n,t){var r=vr(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Sw(e,n,t){var r=vr(e);return r.s=Sl(r.s,n.s,t),r.e=Sl(r.e,n.s,t),r}function Dl(e,n){if(e.cRel&&e.c<0)for(e=vr(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=vr(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=kt(e);return!e.cRel&&e.cRel!=null&&(t=iN(t)),!e.rRel&&e.rRel!=null&&(t=rN(t)),t}function Bv(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Yn(e.s.c)+":"+(e.e.cRel?"":"$")+Yn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Un(e.s.r)+":"+(e.e.rRel?"":"$")+Un(e.e.r):Dl(e.s,n.biff)+":"+Dl(e.e,n.biff)}function a1(e){return parseInt(oN(e),10)-1}function Un(e){return""+(e+1)}function rN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function oN(e){return e.replace(/\$(\d+)$/,"$1")}function s1(e){for(var n=aN(e),t=0,r=0;r!==n.length;++r)t=26*t+n.charCodeAt(r)-64;return t-1}function Yn(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function iN(e){return e.replace(/^([A-Z])/,"$$$1")}function aN(e){return e.replace(/^\$([A-Z])/,"$1")}function sN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Mn(e){for(var n=0,t=0,r=0;r<e.length;++r){var o=e.charCodeAt(r);o>=48&&o<=57?n=10*n+(o-48):o>=65&&o<=90&&(t=26*t+(o-64))}return{c:t-1,r:n-1}}function kt(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function Pr(e){var n=e.indexOf(":");return n==-1?{s:Mn(e),e:Mn(e)}:{s:Mn(e.slice(0,n)),e:Mn(e.slice(n+1))}}function dn(e,n){return typeof n>"u"||typeof n=="number"?dn(e.s,e.e):(typeof e!="string"&&(e=kt(e)),typeof n!="string"&&(n=kt(n)),e==n?e:e+":"+n)}function Ht(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,o=0,i=e.length;for(t=0;r<i&&!((o=e.charCodeAt(r)-64)<1||o>26);++r)t=26*t+o;for(n.s.c=--t,t=0;r<i&&!((o=e.charCodeAt(r)-48)<0||o>9);++r)t=10*t+o;if(n.s.r=--t,r===i||o!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,t=0;r!=i&&!((o=e.charCodeAt(r)-64)<1||o>26);++r)t=26*t+o;for(n.e.c=--t,t=0;r!=i&&!((o=e.charCodeAt(r)-48)<0||o>9);++r)t=10*t+o;return n.e.r=--t,n}function Dw(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Ri(e.z,t?hr(n):n)}catch{}try{return e.w=Ri((e.XF||{}).numFmtId||(t?14:0),t?hr(n):n)}catch{return""+n}}function li(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Ul[e.v]||e.v:n==null?Dw(e,e.v):Dw(e,n))}function Da(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function yE(e,n,t){var r=t||{},o=e?Array.isArray(e):r.dense;Io!=null&&o==null&&(o=Io);var i=e||(o?[]:{}),a=0,l=0;if(i&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var u=typeof r.origin=="string"?Mn(r.origin):r.origin;a=u.r,l=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var p={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var g=Ht(i["!ref"]);p.s.c=g.s.c,p.s.r=g.s.r,p.e.c=Math.max(p.e.c,g.e.c),p.e.r=Math.max(p.e.r,g.e.r),a==-1&&(p.e.r=a=g.e.r+1)}for(var m=0;m!=n.length;++m)if(n[m]){if(!Array.isArray(n[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=n[m].length;++v)if(!(typeof n[m][v]>"u")){var h={v:n[m][v]},b=a+m,x=l+v;if(p.s.r>b&&(p.s.r=b),p.s.c>x&&(p.s.c=x),p.e.r<b&&(p.e.r=b),p.e.c<x&&(p.e.c=x),n[m][v]&&typeof n[m][v]=="object"&&!Array.isArray(n[m][v])&&!(n[m][v]instanceof Date))h=n[m][v];else if(Array.isArray(h.v)&&(h.f=n[m][v][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(r.nullError)h.t="e",h.v=0;else if(r.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=r.dateNF||en[14],r.cellDates?(h.t="d",h.w=Ri(h.z,hr(h.v))):(h.t="n",h.v=hr(h.v),h.w=Ri(h.z,h.v))):h.t="s";if(o)i[b]||(i[b]=[]),i[b][x]&&i[b][x].z&&(h.z=i[b][x].z),i[b][x]=h;else{var y=kt({c:x,r:b});i[y]&&i[y].z&&(h.z=i[y].z),i[y]=h}}}return p.s.c<1e7&&(i["!ref"]=dn(p)),i}function Xs(e,n){return yE(null,e,n)}function cN(e){return e.read_shift(4,"i")}function go(e,n){return n||(n=Z(4)),n.write_shift(4,e),n}function Kn(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function wn(e,n){var t=!1;return n==null&&(t=!0,n=Z(4+2*e.length)),n.write_shift(4,e.length),e.length>0&&n.write_shift(0,e,"dbcs"),t?n.slice(0,n.l):n}function lN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function dN(e,n){return n||(n=Z(4)),n.write_shift(2,e.ich||0),n.write_shift(2,e.ifnt||0),n}function c1(e,n){var t=e.l,r=e.read_shift(1),o=Kn(e),i=[],a={t:o,h:o};if((r&1)!==0){for(var l=e.read_shift(4),u=0;u!=l;++u)i.push(lN(e));a.r=i}else a.r=[{ich:0,ifnt:0}];return e.l=t+n,a}function uN(e,n){var t=!1;return n==null&&(t=!0,n=Z(15+4*e.t.length)),n.write_shift(1,0),wn(e.t,n),t?n.slice(0,n.l):n}var fN=c1;function pN(e,n){var t=!1;return n==null&&(t=!0,n=Z(23+4*e.t.length)),n.write_shift(1,1),wn(e.t,n),n.write_shift(4,1),dN({ich:0,ifnt:0},n),t?n.slice(0,n.l):n}function $r(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function ka(e,n){return n==null&&(n=Z(8)),n.write_shift(-4,e.c),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}function Ia(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}function Aa(e,n){return n==null&&(n=Z(4)),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}var gN=Kn,ME=wn;function l1(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}function ip(e,n){var t=!1;return n==null&&(t=!0,n=Z(127)),n.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&n.write_shift(0,e,"dbcs"),t?n.slice(0,n.l):n}var mN=Kn,Gv=l1,d1=ip;function wE(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,r=n[0]&2;e.l+=4;var o=r===0?op([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):wa(n,0)>>2;return t?o/100:o}function EE(e,n){n==null&&(n=Z(4));var t=0,r=0,o=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?r=1:o==(o|0)&&o>=-(1<<29)&&o<1<<29&&(r=1,t=1),r)n.write_shift(-4,((t?o:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function OE(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}function hN(e,n){return n||(n=Z(16)),n.write_shift(4,e.s.r),n.write_shift(4,e.e.r),n.write_shift(4,e.s.c),n.write_shift(4,e.e.c),n}var Na=OE,Ys=hN;function Ks(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Pa(e,n){return(n||Z(8)).write_shift(8,e,"f")}function vN(e){var n={},t=e.read_shift(1),r=t>>>1,o=e.read_shift(1),i=e.read_shift(2,"i"),a=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=o;var p=ON[o];p&&(n.rgb=Uw(p));break;case 2:n.rgb=Uw([a,l,u]);break;case 3:n.theme=o;break}return i!=0&&(n.tint=i>0?i/32767:i/32768),n}function ap(e,n){if(n||(n=Z(8)),!e||e.auto)return n.write_shift(4,0),n.write_shift(4,0),n;e.index!=null?(n.write_shift(1,2),n.write_shift(1,e.index)):e.theme!=null?(n.write_shift(1,6),n.write_shift(1,e.theme)):(n.write_shift(1,5),n.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),n.write_shift(2,t),!e.rgb||e.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),n.write_shift(1,parseInt(r.slice(0,2),16)),n.write_shift(1,parseInt(r.slice(2,4),16)),n.write_shift(1,parseInt(r.slice(4,6),16)),n.write_shift(1,255)}return n}function xN(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function _N(e,n){n||(n=Z(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return n.write_shift(1,t),n.write_shift(1,0),n}var TE=2,Er=3,Kf=11;var sp=19;var Zf=64,CN=65,bN=71;var yN=4108,MN=4126,Bn=80;var kw={1:{n:"CodePage",t:TE},2:{n:"Category",t:Bn},3:{n:"PresentationFormat",t:Bn},4:{n:"ByteCount",t:Er},5:{n:"LineCount",t:Er},6:{n:"ParagraphCount",t:Er},7:{n:"SlideCount",t:Er},8:{n:"NoteCount",t:Er},9:{n:"HiddenCount",t:Er},10:{n:"MultimediaClipCount",t:Er},11:{n:"ScaleCrop",t:Kf},12:{n:"HeadingPairs",t:yN},13:{n:"TitlesOfParts",t:MN},14:{n:"Manager",t:Bn},15:{n:"Company",t:Bn},16:{n:"LinksUpToDate",t:Kf},17:{n:"CharacterCount",t:Er},19:{n:"SharedDoc",t:Kf},22:{n:"HyperlinksChanged",t:Kf},23:{n:"AppVersion",t:Er,p:"version"},24:{n:"DigSig",t:CN},26:{n:"ContentType",t:Bn},27:{n:"ContentStatus",t:Bn},28:{n:"Language",t:Bn},29:{n:"Version",t:Bn},255:{},2147483648:{n:"Locale",t:sp},2147483651:{n:"Behavior",t:sp},1919054434:{}},Iw={1:{n:"CodePage",t:TE},2:{n:"Title",t:Bn},3:{n:"Subject",t:Bn},4:{n:"Author",t:Bn},5:{n:"Keywords",t:Bn},6:{n:"Comments",t:Bn},7:{n:"Template",t:Bn},8:{n:"LastAuthor",t:Bn},9:{n:"RevNumber",t:Bn},10:{n:"EditTime",t:Zf},11:{n:"LastPrinted",t:Zf},12:{n:"CreatedDate",t:Zf},13:{n:"ModifiedDate",t:Zf},14:{n:"PageCount",t:Er},15:{n:"WordCount",t:Er},16:{n:"CharCount",t:Er},17:{n:"Thumbnail",t:bN},18:{n:"Application",t:Bn},19:{n:"DocSecurity",t:Er},255:{},2147483648:{n:"Locale",t:sp},2147483651:{n:"Behavior",t:sp},1919054434:{}};function wN(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var EN=wN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ON=vr(EN),Ul={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var TN={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Qf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function PE(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function SE(e,n){var t=R3(TN),r=[],o;r[r.length]=un,r[r.length]=me("Types",null,{xmlns:yn.CT,"xmlns:xsd":yn.xsd,"xmlns:xsi":yn.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return me("Default",null,{Extension:u[0],ContentType:u[1]})}));var i=function(u){e[u]&&e[u].length>0&&(o=e[u][0],r[r.length]=me("Override",null,{PartName:(o[0]=="/"?"":"/")+o,ContentType:Qf[u][n.bookType]||Qf[u].xlsx}))},a=function(u){(e[u]||[]).forEach(function(p){r[r.length]=me("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:Qf[u][n.bookType]||Qf[u].xlsx})})},l=function(u){(e[u]||[]).forEach(function(p){r[r.length]=me("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:t[u][0]})})};return i("workbooks"),a("sheets"),a("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),a("metadata"),l("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var vt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function DE(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function Us(e){var n=[un,me("Relationships",null,{xmlns:yn.RELS})];return Wn(e["!id"]).forEach(function(t){n[n.length]=me("Relationship",null,e["!id"][t])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function St(e,n,t,r,o,i){if(o||(o={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),n<0)for(n=e["!idx"];e["!id"]["rId"+n];++n);if(e["!idx"]=n+1,o.Id="rId"+n,o.Type=r,o.Target=t,i?o.TargetMode=i:[vt.HLINK,vt.XPATH,vt.XMISS].indexOf(o.Type)>-1&&(o.TargetMode="External"),e["!id"][o.Id])throw new Error("Cannot rewrite rId "+n);return e["!id"][o.Id]=o,e[("/"+o.Target).replace("//","/")]=o,n}function PN(e){var n=[un];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)n.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function Aw(e,n,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function SN(e,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function DN(e){var n=[un];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)n.push(Aw(e[t][0],e[t][1])),n.push(SN("",e[t][0]));return n.push(Aw("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function kE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Il.version+"</meta:generator></office:meta></office:document-meta>"}var Oa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Vv(e,n,t,r,o){o[e]!=null||n==null||n===""||(o[e]=n,n=Dt(n),r[r.length]=t?me(e,n,t):jn(e,n))}function IE(e,n){var t=n||{},r=[un,me("cp:coreProperties",null,{"xmlns:cp":yn.CORE_PROPS,"xmlns:dc":yn.dc,"xmlns:dcterms":yn.dcterms,"xmlns:dcmitype":yn.dcmitype,"xmlns:xsi":yn.xsi})],o={};if(!e&&!t.Props)return r.join("");e&&(e.CreatedDate!=null&&Vv("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:$v(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,o),e.ModifiedDate!=null&&Vv("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:$v(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,o));for(var i=0;i!=Oa.length;++i){var a=Oa[i],l=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e?e[a[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Vv(a[0],l,null,r,o)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ws=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],AE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function NE(e){var n=[],t=me;return e||(e={}),e.Application="SheetJS",n[n.length]=un,n[n.length]=me("Properties",null,{xmlns:yn.EXT_PROPS,"xmlns:vt":yn.vt}),Ws.forEach(function(r){if(e[r[1]]!==void 0){var o;switch(r[2]){case"string":o=Dt(String(e[r[1]]));break;case"bool":o=e[r[1]]?"true":"false";break}o!==void 0&&(n[n.length]=t(r[0],o))}}),n[n.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+Dt(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}function FE(e){var n=[un,me("Properties",null,{xmlns:yn.CUST_PROPS,"xmlns:vt":yn.vt})];if(!e)return n.join("");var t=1;return Wn(e).forEach(function(o){++t,n[n.length]=me("property",q3(e[o],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Dt(o)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var Nw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function kN(e,n){var t=[];return Wn(Nw).map(function(r){for(var o=0;o<Oa.length;++o)if(Oa[o][1]==r)return Oa[o];for(o=0;o<Ws.length;++o)if(Ws[o][1]==r)return Ws[o];throw r}).forEach(function(r){if(e[r[1]]!=null){var o=n&&n.Props&&n.Props[r[1]]!=null?n.Props[r[1]]:e[r[1]];r[2]==="date"&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"Z")),typeof o=="number"?o=String(o):o===!0||o===!1?o=o?"1":"0":o instanceof Date&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"")),t.push(jn(Nw[r[1]]||r[1],o))}}),me("DocumentProperties",t.join(""),{xmlns:Tr.o})}function IN(e,n){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",o=[];return e&&Wn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var a=0;a<Oa.length;++a)if(i==Oa[a][1])return;for(a=0;a<Ws.length;++a)if(i==Ws[a][1])return;for(a=0;a<t.length;++a)if(i==t[a])return;var l=e[i],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l=String(l),o.push(me(bw(i),l,{"dt:dt":u}))}}),n&&Wn(n).forEach(function(i){if(Object.prototype.hasOwnProperty.call(n,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var a=n[i],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a instanceof Date?(l="dateTime.tz",a=a.toISOString()):a=String(a),o.push(me(bw(i),a,{"dt:dt":l}))}}),"<"+r+' xmlns="'+Tr.o+'">'+o.join("")+"</"+r+">"}function AN(e){var n=typeof e=="string"?new Date(Date.parse(e)):e,t=n.getTime()/1e3+11644473600,r=t%Math.pow(2,32),o=(t-r)/Math.pow(2,32);r*=1e7,o*=1e7;var i=r/Math.pow(2,32)|0;i>0&&(r=r%Math.pow(2,32),o+=i);var a=Z(8);return a.write_shift(4,r),a.write_shift(4,o),a}function Fw(e,n){var t=Z(4),r=Z(4);switch(t.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,n);break;case 5:r=Z(8),r.write_shift(8,n,"f");break;case 11:r.write_shift(4,n?1:0);break;case 64:r=AN(n);break;case 31:case 80:for(r=Z(4+2*(n.length+1)+(n.length%2?0:2)),r.write_shift(4,n.length+1),r.write_shift(0,n,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}return Vn([t,r])}var RE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function NN(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Rw(e,n,t){var r=Z(8),o=[],i=[],a=8,l=0,u=Z(8),p=Z(8);if(u.write_shift(4,2),u.write_shift(4,1200),p.write_shift(4,1),i.push(u),o.push(p),a+=8+u.length,!n){p=Z(8),p.write_shift(4,0),o.unshift(p);var g=[Z(4)];for(g[0].write_shift(4,e.length),l=0;l<e.length;++l){var m=e[l][0];for(u=Z(8+2*(m.length+1)+(m.length%2?0:2)),u.write_shift(4,l+2),u.write_shift(4,m.length+1),u.write_shift(0,m,"dbcs");u.l!=u.length;)u.write_shift(1,0);g.push(u)}u=Vn(g),i.unshift(u),a+=8+u.length}for(l=0;l<e.length;++l)if(!(n&&!n[e[l][0]])&&!(RE.indexOf(e[l][0])>-1||AE.indexOf(e[l][0])>-1)&&e[l][1]!=null){var v=e[l][1],h=0;if(n){h=+n[e[l][0]];var b=t[h];if(b.p=="version"&&typeof v=="string"){var x=v.split(".");v=(+x[0]<<16)+(+x[1]||0)}u=Fw(b.t,v)}else{var y=NN(v);y==-1&&(y=31,v=String(v)),u=Fw(y,v)}i.push(u),p=Z(8),p.write_shift(4,n?h:2+l),o.push(p),a+=8+u.length}var A=8*(i.length+1);for(l=0;l<i.length;++l)o[l].write_shift(4,A),A+=i[l].length;return r.write_shift(4,a),r.write_shift(4,i.length),Vn([r].concat(o).concat(i))}function Lw(e,n,t,r,o,i){var a=Z(o?68:48),l=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ft.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,o?2:1),a.write_shift(16,n,"hex"),a.write_shift(4,o?68:48);var u=Rw(e,t,r);if(l.push(u),o){var p=Rw(o,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+u.length),l.push(p)}return Vn(l)}function FN(e,n){n||(n=Z(e));for(var t=0;t<e;++t)n.write_shift(1,0);return n}function RN(e,n){return e.read_shift(n)===1}function ir(e,n){return n||(n=Z(2)),n.write_shift(2,+!!e),n}function LE(e){return e.read_shift(2,"u")}function Hr(e,n){return n||(n=Z(2)),n.write_shift(2,e),n}function BE(e,n,t){return t||(t=Z(2)),t.write_shift(1,n=="e"?+e:+!!e),t.write_shift(1,n=="e"?1:0),t}function VE(e,n,t){var r=e.read_shift(t&&t.biff>=12?2:1),o="sbcs-cont",i=Ea;if(t&&t.biff>=8&&(Ea=1200),!t||t.biff==8){var a=e.read_shift(1);a&&(o="dbcs-cont")}else t.biff==12&&(o="wstr");t.biff>=2&&t.biff<=5&&(o="cpstr");var l=r?e.read_shift(r,o):"";return Ea=i,l}function LN(e){var n=e.t||"",t=1,r=Z(3+(t>1?2:0));r.write_shift(2,n.length),r.write_shift(1,(t>1?8:0)|1),t>1&&r.write_shift(2,t);var o=Z(2*n.length);o.write_shift(2*n.length,n,"utf16le");var i=[r,o];return Vn(i)}function BN(e,n,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var o=e.read_shift(1);return o===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function VN(e,n,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):BN(e,r,t)}function jN(e,n,t){if(t.biff>5)return VN(e,n,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function jE(e,n,t){return t||(t=Z(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function Bw(e,n){n||(n=Z(6+e.length*2)),n.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)n.write_shift(2,e.charCodeAt(t));return n.write_shift(2,0),n}function UN(e){var n=Z(512),t=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var o=r.indexOf("#"),i=o>-1?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3;break}n.write_shift(4,2),n.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)n.write_shift(4,a[t]);if(i==28)r=r.slice(1),Bw(r,n);else if(i&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)n.write_shift(1,parseInt(a[t],16));var l=o>-1?r.slice(0,o):r;for(n.write_shift(4,2*(l.length+1)),t=0;t<l.length;++t)n.write_shift(2,l.charCodeAt(t));n.write_shift(2,0),i&8&&Bw(o>-1?r.slice(o+1):"",n)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)n.write_shift(1,parseInt(a[t],16));for(var u=0;r.slice(u*3,u*3+3)=="../"||r.slice(u*3,u*3+3)=="..\\";)++u;for(n.write_shift(2,u),n.write_shift(4,r.length-3*u+1),t=0;t<r.length-3*u;++t)n.write_shift(1,r.charCodeAt(t+3*u)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),t=0;t<6;++t)n.write_shift(4,0)}return n.slice(0,n.l)}function Sa(e,n,t,r){return r||(r=Z(6)),r.write_shift(2,e),r.write_shift(2,n),r.write_shift(2,t||0),r}function WN(e,n,t){var r=t.biff>8?4:2,o=e.read_shift(r),i=e.read_shift(r,"i"),a=e.read_shift(r,"i");return[o,i,a]}function zN(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),o=e.read_shift(2);return{s:{c:r,r:n},e:{c:o,r:t}}}function UE(e,n){return n||(n=Z(8)),n.write_shift(2,e.s.r),n.write_shift(2,e.e.r),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c),n}function u1(e,n,t){var r=1536,o=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,o=8;break;case"biff4":r=4,o=6;break;case"biff3":r=3,o=6;break;case"biff2":r=2,o=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Z(o);return i.write_shift(2,r),i.write_shift(2,n),o>4&&i.write_shift(2,29282),o>6&&i.write_shift(2,1997),o>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function HN(e,n){var t=!n||n.biff==8,r=Z(t?112:54);for(r.write_shift(n.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function $N(e,n){var t=!n||n.biff>=8?2:1,r=Z(8+t*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),n.biff>=8&&r.write_shift(1,1),r.write_shift(t*e.name.length,e.name,n.biff<8?"sbcs":"utf16le");var o=r.slice(0,r.l);return o.l=r.l,o}function GN(e,n){var t=Z(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var r=[],o=0;o<e.length;++o)r[o]=LN(e[o],n);var i=Vn([t].concat(r));return i.parts=[t.length].concat(r.map(function(a){return a.length})),i}function qN(){var e=Z(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function XN(e){var n=Z(18),t=1718;return e&&e.RTL&&(t|=64),n.write_shift(2,t),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function YN(e,n){var t=e.name||"Arial",r=n&&n.biff==5,o=r?15+t.length:16+2*t.length,i=Z(o);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,t.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),i}function KN(e,n,t,r){var o=Z(10);return Sa(e,n,r,o),o.write_shift(4,t),o}function ZN(e,n,t,r,o){var i=!o||o.biff==8,a=Z(8+ +i+(1+i)*t.length);return Sa(e,n,r,a),a.write_shift(2,t.length),i&&a.write_shift(1,1),a.write_shift((1+i)*t.length,t,i?"utf16le":"sbcs"),a}function QN(e,n,t,r){var o=t&&t.biff==5;r||(r=Z(o?3+n.length:5+2*n.length)),r.write_shift(2,e),r.write_shift(o?1:2,n.length),o||r.write_shift(1,1),r.write_shift((o?1:2)*n.length,n,o?"sbcs":"utf16le");var i=r.length>r.l?r.slice(0,r.l):r;return i.l==null&&(i.l=i.length),i}function JN(e,n){var t=n.biff==8||!n.biff?4:2,r=Z(2*t+6);return r.write_shift(t,e.s.r),r.write_shift(t,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function Vw(e,n,t,r){var o=t&&t.biff==5;r||(r=Z(o?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,n<<4));var i=0;return e.numFmtId>0&&o&&(i|=1024),r.write_shift(4,i),r.write_shift(4,0),o||r.write_shift(4,0),r.write_shift(2,0),r}function eF(e){var n=Z(8);return n.write_shift(4,0),n.write_shift(2,e[0]?e[0]+1:0),n.write_shift(2,e[1]?e[1]+1:0),n}function tF(e,n,t,r,o,i){var a=Z(8);return Sa(e,n,r,a),BE(t,i,a),a}function nF(e,n,t,r){var o=Z(14);return Sa(e,n,r,o),Pa(t,o),o}function rF(e,n,t){if(t.biff<8)return oF(e,n,t);for(var r=[],o=e.l+n,i=e.read_shift(t.biff>8?4:2);i--!==0;)r.push(WN(e,t.biff>8?12:6,t));if(e.l!=o)throw new Error("Bad ExternSheet: "+e.l+" != "+o);return r}function oF(e,n,t){e[e.l+1]==3&&e[e.l]++;var r=VE(e,n,t);return r.charCodeAt(0)==3?r.slice(1):r}function iF(e){var n=Z(2+e.length*8);n.write_shift(2,e.length);for(var t=0;t<e.length;++t)UE(e[t],n);return n}function aF(e){var n=Z(24),t=Mn(e[0]);n.write_shift(2,t.r),n.write_shift(2,t.r),n.write_shift(2,t.c),n.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<16;++o)n.write_shift(1,parseInt(r[o],16));return Vn([n,UN(e[1])])}function sF(e){var n=e[1].Tooltip,t=Z(10+2*(n.length+1));t.write_shift(2,2048);var r=Mn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var o=0;o<n.length;++o)t.write_shift(2,n.charCodeAt(o));return t.write_shift(2,0),t}function cF(e){return e||(e=Z(4)),e.write_shift(2,1),e.write_shift(2,1),e}function lF(e,n,t){if(!t.cellStyles)return Ao(e,n);var r=t&&t.biff>=12?4:2,o=e.read_shift(r),i=e.read_shift(r),a=e.read_shift(r),l=e.read_shift(r),u=e.read_shift(2);r==2&&(e.l+=2);var p={s:o,e:i,w:a,ixfe:l,flags:u};return(t.biff>=5||!t.biff)&&(p.level=u>>8&7),p}function dF(e,n){var t=Z(12);t.write_shift(2,n),t.write_shift(2,n),t.write_shift(2,e.width*256),t.write_shift(2,0);var r=0;return e.hidden&&(r|=1),t.write_shift(1,r),r=e.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function uF(e){for(var n=Z(2*e),t=0;t<e;++t)n.write_shift(2,t+1);return n}function fF(e,n,t){var r=Z(15);return zl(r,e,n),r.write_shift(8,t,"f"),r}function pF(e,n,t){var r=Z(9);return zl(r,e,n),r.write_shift(2,t),r}var gF=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=Kv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(l,u){var p=[],g=Ta(1);switch(u.type){case"base64":g=fo(ci(l));break;case"binary":g=fo(l);break;case"buffer":case"array":g=l;break}Or(g,0);var m=g.read_shift(1),v=!!(m&136),h=!1,b=!1;switch(m){case 2:break;case 3:break;case 48:h=!0,v=!0;break;case 49:h=!0,v=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var x=0,y=521;m==2&&(x=g.read_shift(2)),g.l+=3,m!=2&&(x=g.read_shift(4)),x>1048576&&(x=1e6),m!=2&&(y=g.read_shift(2));var A=g.read_shift(2),L=u.codepage||1252;m!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(L=e[g[g.l]]),g.l+=1,g.l+=2),b&&(g.l+=36);for(var V=[],X={},ae=Math.min(g.length,m==2?521:y-10-(h?264:0)),Te=b?32:11;g.l<ae&&g[g.l]!=13;)switch(X={},X.name=Bt.utils.decode(L,g.slice(g.l,g.l+Te)).replace(/[\u0000\r\n].*$/g,""),g.l+=Te,X.type=String.fromCharCode(g.read_shift(1)),m!=2&&!b&&(X.offset=g.read_shift(4)),X.len=g.read_shift(1),m==2&&(X.offset=g.read_shift(2)),X.dec=g.read_shift(1),X.name.length&&V.push(X),m!=2&&(g.l+=b?13:14),X.type){case"B":(!h||X.len!=8)&&u.WTF&&console.log("Skipping "+X.name+":"+X.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+X.name+":"+X.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+X.type)}if(g[g.l]!==13&&(g.l=y-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=y;var B=0,oe=0;for(p[0]=[],oe=0;oe!=V.length;++oe)p[0][oe]=V[oe].name;for(;x-- >0;){if(g[g.l]===42){g.l+=A;continue}for(++g.l,p[++B]=[],oe=0,oe=0;oe!=V.length;++oe){var J=g.slice(g.l,g.l+V[oe].len);g.l+=V[oe].len,Or(J,0);var te=Bt.utils.decode(L,J);switch(V[oe].type){case"C":te.trim().length&&(p[B][oe]=te.replace(/\s+$/,""));break;case"D":te.length===8?p[B][oe]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):p[B][oe]=te;break;case"F":p[B][oe]=parseFloat(te.trim());break;case"+":case"I":p[B][oe]=b?J.read_shift(-4,"i")^2147483648:J.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":p[B][oe]=!0;break;case"N":case"F":p[B][oe]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));p[B][oe]="##MEMO##"+(b?parseInt(te.trim(),10):J.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(p[B][oe]=+te||0);break;case"@":p[B][oe]=new Date(J.read_shift(-8,"f")-621356832e5);break;case"T":p[B][oe]=new Date((J.read_shift(4)-2440588)*864e5+J.read_shift(4));break;case"Y":p[B][oe]=J.read_shift(4,"i")/1e4+J.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":p[B][oe]=-J.read_shift(-8,"f");break;case"B":if(h&&V[oe].len==8){p[B][oe]=J.read_shift(8,"f");break}case"G":case"P":J.l+=V[oe].len;break;case"0":if(V[oe].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+V[oe].type)}}}if(m!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return u&&u.sheetRows&&(p=p.slice(0,u.sheetRows)),u.DBF=V,p}function r(l,u){var p=u||{};p.dateNF||(p.dateNF="yyyymmdd");var g=Xs(t(l,p),p);return g["!cols"]=p.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete p.DBF,g}function o(l,u){try{return Da(r(l,u),u)}catch(p){if(u&&u.WTF)throw p}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(l,u){var p=u||{};if(+p.codepage>=0&&Al(+p.codepage),p.type=="string")throw new Error("Cannot write DBF to JS string");var g=mr(),m=fp(l,{header:1,raw:!0,cellDates:!0}),v=m[0],h=m.slice(1),b=l["!cols"]||[],x=0,y=0,A=0,L=1;for(x=0;x<v.length;++x){if(((b[x]||{}).DBF||{}).name){v[x]=b[x].DBF.name,++A;continue}if(v[x]!=null){if(++A,typeof v[x]=="number"&&(v[x]=v[x].toString(10)),typeof v[x]!="string")throw new Error("DBF Invalid column name "+v[x]+" |"+typeof v[x]+"|");if(v.indexOf(v[x])!==x){for(y=0;y<1024;++y)if(v.indexOf(v[x]+"_"+y)==-1){v[x]+="_"+y;break}}}}var V=Ht(l["!ref"]),X=[],ae=[],Te=[];for(x=0;x<=V.e.c-V.s.c;++x){var B="",oe="",J=0,te=[];for(y=0;y<h.length;++y)h[y][x]!=null&&te.push(h[y][x]);if(te.length==0||v[x]==null){X[x]="?";continue}for(y=0;y<te.length;++y){switch(typeof te[y]){case"number":oe="B";break;case"string":oe="C";break;case"boolean":oe="L";break;case"object":oe=te[y]instanceof Date?"D":"C";break;default:oe="C"}J=Math.max(J,String(te[y]).length),B=B&&B!=oe?"C":oe}J>250&&(J=250),oe=((b[x]||{}).DBF||{}).type,oe=="C"&&b[x].DBF.len>J&&(J=b[x].DBF.len),B=="B"&&oe=="N"&&(B="N",Te[x]=b[x].DBF.dec,J=b[x].DBF.len),ae[x]=B=="C"||oe=="N"?J:i[B]||0,L+=ae[x],X[x]=B}var de=g.next(32);for(de.write_shift(4,318902576),de.write_shift(4,h.length),de.write_shift(2,296+32*A),de.write_shift(2,L),x=0;x<4;++x)de.write_shift(4,0);for(de.write_shift(4,0|(+n[Hs]||3)<<8),x=0,y=0;x<v.length;++x)if(v[x]!=null){var fe=g.next(32),Be=(v[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);fe.write_shift(1,Be,"sbcs"),fe.write_shift(1,X[x]=="?"?"C":X[x],"sbcs"),fe.write_shift(4,y),fe.write_shift(1,ae[x]||i[X[x]]||0),fe.write_shift(1,Te[x]||0),fe.write_shift(1,2),fe.write_shift(4,0),fe.write_shift(1,0),fe.write_shift(4,0),fe.write_shift(4,0),y+=ae[x]||i[X[x]]||0}var bt=g.next(264);for(bt.write_shift(4,13),x=0;x<65;++x)bt.write_shift(4,0);for(x=0;x<h.length;++x){var ze=g.next(L);for(ze.write_shift(1,0),y=0;y<v.length;++y)if(v[y]!=null)switch(X[y]){case"L":ze.write_shift(1,h[x][y]==null?63:h[x][y]?84:70);break;case"B":ze.write_shift(8,h[x][y]||0,"f");break;case"N":var vn="0";for(typeof h[x][y]=="number"&&(vn=h[x][y].toFixed(Te[y]||0)),A=0;A<ae[y]-vn.length;++A)ze.write_shift(1,32);ze.write_shift(1,vn,"sbcs");break;case"D":h[x][y]?(ze.write_shift(4,("0000"+h[x][y].getFullYear()).slice(-4),"sbcs"),ze.write_shift(2,("00"+(h[x][y].getMonth()+1)).slice(-2),"sbcs"),ze.write_shift(2,("00"+h[x][y].getDate()).slice(-2),"sbcs")):ze.write_shift(8,"00000000","sbcs");break;case"C":var xn=String(h[x][y]!=null?h[x][y]:"").slice(0,ae[y]);for(ze.write_shift(1,xn,"sbcs"),A=0;A<ae[y]-xn.length;++A)ze.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:o,to_sheet:r,from_sheet:a}})(),mF=(function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Wn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(v,h){var b=e[h];return typeof b=="number"?lw(b):b},r=function(v,h,b){var x=h.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return x==59?v:lw(x)};e["|"]=254;function o(v,h){switch(h.type){case"base64":return i(ci(v),h);case"binary":return i(v,h);case"buffer":return i(Ct&&Buffer.isBuffer(v)?v.toString("binary"):Vl(v),h);case"array":return i(vp(v),h)}throw new Error("Unrecognized type "+h.type)}function i(v,h){var b=v.split(/[\n\r]+/),x=-1,y=-1,A=0,L=0,V=[],X=[],ae=null,Te={},B=[],oe=[],J=[],te=0,de;for(+h.codepage>=0&&Al(+h.codepage);A!==b.length;++A){te=0;var fe=b[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,t),Be=fe.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),bt=Be[0],ze;if(fe.length>0)switch(bt){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Be[1].charAt(0)=="P"&&X.push(fe.slice(3).replace(/;;/g,";"));break;case"C":var vn=!1,xn=!1,sr=!1,Zn=!1,En=-1,cr=-1;for(L=1;L<Be.length;++L)switch(Be[L].charAt(0)){case"A":break;case"X":y=parseInt(Be[L].slice(1))-1,xn=!0;break;case"Y":for(x=parseInt(Be[L].slice(1))-1,xn||(y=0),de=V.length;de<=x;++de)V[de]=[];break;case"K":ze=Be[L].slice(1),ze.charAt(0)==='"'?ze=ze.slice(1,ze.length-1):ze==="TRUE"?ze=!0:ze==="FALSE"?ze=!1:isNaN(ai(ze))?isNaN(Fl(ze).getDate())||(ze=ar(ze)):(ze=ai(ze),ae!==null&&aE(ae)&&(ze=dE(ze))),typeof Bt<"u"&&typeof ze=="string"&&(h||{}).type!="string"&&(h||{}).codepage&&(ze=Bt.utils.decode(h.codepage,ze)),vn=!0;break;case"E":Zn=!0;var N=pR(Be[L].slice(1),{r:x,c:y});V[x][y]=[V[x][y],N];break;case"S":sr=!0,V[x][y]=[V[x][y],"S5S"];break;case"G":break;case"R":En=parseInt(Be[L].slice(1))-1;break;case"C":cr=parseInt(Be[L].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+fe)}if(vn&&(V[x][y]&&V[x][y].length==2?V[x][y][0]=ze:V[x][y]=ze,ae=null),sr){if(Zn)throw new Error("SYLK shared formula cannot have own formula");var ee=En>-1&&V[En][cr];if(!ee||!ee[1])throw new Error("SYLK shared formula cannot find base");V[x][y][1]=gR(ee[1],{r:x-En,c:y-cr})}break;case"F":var R=0;for(L=1;L<Be.length;++L)switch(Be[L].charAt(0)){case"X":y=parseInt(Be[L].slice(1))-1,++R;break;case"Y":for(x=parseInt(Be[L].slice(1))-1,de=V.length;de<=x;++de)V[de]=[];break;case"M":te=parseInt(Be[L].slice(1))/20;break;case"F":break;case"G":break;case"P":ae=X[parseInt(Be[L].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(J=Be[L].slice(1).split(" "),de=parseInt(J[0],10);de<=parseInt(J[1],10);++de)te=parseInt(J[2],10),oe[de-1]=te===0?{hidden:!0}:{wch:te},f1(oe[de-1]);break;case"C":y=parseInt(Be[L].slice(1))-1,oe[y]||(oe[y]={});break;case"R":x=parseInt(Be[L].slice(1))-1,B[x]||(B[x]={}),te>0?(B[x].hpt=te,B[x].hpx=GE(te)):te===0&&(B[x].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+fe)}R<1&&(ae=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+fe)}}return B.length>0&&(Te["!rows"]=B),oe.length>0&&(Te["!cols"]=oe),h&&h.sheetRows&&(V=V.slice(0,h.sheetRows)),[V,Te]}function a(v,h){var b=o(v,h),x=b[0],y=b[1],A=Xs(x,h);return Wn(y).forEach(function(L){A[L]=y[L]}),A}function l(v,h){return Da(a(v,h),h)}function u(v,h,b,x){var y="C;Y"+(b+1)+";X"+(x+1)+";K";switch(v.t){case"n":y+=v.v||0,v.f&&!v.F&&(y+=";E"+g1(v.f,{r:b,c:x}));break;case"b":y+=v.v?"TRUE":"FALSE";break;case"e":y+=v.w||v.v;break;case"d":y+='"'+(v.w||v.v)+'"';break;case"s":y+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function p(v,h){h.forEach(function(b,x){var y="F;W"+(x+1)+" "+(x+1)+" ";b.hidden?y+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=cp(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=lp(b.wpx)),typeof b.wch=="number"&&(y+=Math.round(b.wch))),y.charAt(y.length-1)!=" "&&v.push(y)})}function g(v,h){h.forEach(function(b,x){var y="F;";b.hidden?y+="M0;":b.hpt?y+="M"+20*b.hpt+";":b.hpx&&(y+="M"+20*dp(b.hpx)+";"),y.length>2&&v.push(y+"R"+(x+1))})}function m(v,h){var b=["ID;PWXL;N;E"],x=[],y=Ht(v["!ref"]),A,L=Array.isArray(v),V=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),v["!cols"]&&p(b,v["!cols"]),v["!rows"]&&g(b,v["!rows"]),b.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var X=y.s.r;X<=y.e.r;++X)for(var ae=y.s.c;ae<=y.e.c;++ae){var Te=kt({r:X,c:ae});A=L?(v[X]||[])[ae]:v[Te],!(!A||A.v==null&&(!A.f||A.F))&&x.push(u(A,v,X,ae,h))}return b.join(V)+V+x.join(V)+V+"E"+V}return{to_workbook:l,to_sheet:a,from_sheet:m}})(),hF=(function(){function e(i,a){switch(a.type){case"base64":return n(ci(i),a);case"binary":return n(i,a);case"buffer":return n(Ct&&Buffer.isBuffer(i)?i.toString("binary"):Vl(i),a);case"array":return n(vp(i),a)}throw new Error("Unrecognized type "+a.type)}function n(i,a){for(var l=i.split(`
`),u=-1,p=-1,g=0,m=[];g!==l.length;++g){if(l[g].trim()==="BOT"){m[++u]=[],p=0;continue}if(!(u<0)){var v=l[g].trim().split(","),h=v[0],b=v[1];++g;for(var x=l[g]||"";(x.match(/["]/g)||[]).length&1&&g<l.length-1;)x+=`
`+l[++g];switch(x=x.trim(),+h){case-1:if(x==="BOT"){m[++u]=[],p=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?m[u][p]=!0:x==="FALSE"?m[u][p]=!1:isNaN(ai(b))?isNaN(Fl(b).getDate())?m[u][p]=b:m[u][p]=ar(b):m[u][p]=ai(b),++p;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),wl&&x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),m[u][p++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(m=m.slice(0,a.sheetRows)),m}function t(i,a){return Xs(e(i,a),a)}function r(i,a){return Da(t(i,a),a)}var o=(function(){var i=function(u,p,g,m,v){u.push(p),u.push(g+","+m),u.push('"'+v.replace(/"/g,'""')+'"')},a=function(u,p,g,m){u.push(p+","+g),u.push(p==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var p=[],g=Ht(u["!ref"]),m,v=Array.isArray(u);i(p,"TABLE",0,1,"sheetjs"),i(p,"VECTORS",0,g.e.r-g.s.r+1,""),i(p,"TUPLES",0,g.e.c-g.s.c+1,""),i(p,"DATA",0,0,"");for(var h=g.s.r;h<=g.e.r;++h){a(p,-1,0,"BOT");for(var b=g.s.c;b<=g.e.c;++b){var x=kt({r:h,c:b});if(m=v?(u[h]||[])[b]:u[x],!m){a(p,1,0,"");continue}switch(m.t){case"n":var y=wl?m.w:m.v;!y&&m.v!=null&&(y=m.v),y==null?wl&&m.f&&!m.F?a(p,1,0,"="+m.f):a(p,1,0,""):a(p,0,y,"V");break;case"b":a(p,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":a(p,1,0,!wl||isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Ri(m.z||en[14],hr(ar(m.v)))),wl?a(p,0,m.w,"V"):a(p,1,0,m.w);break;default:a(p,1,0,"")}}}a(p,-1,0,"EOD");var A=`\r
`,L=p.join(A);return L}})();return{to_workbook:r,to_sheet:t,from_sheet:o}})(),WE=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(m,v){for(var h=m.split(`
`),b=-1,x=-1,y=0,A=[];y!==h.length;++y){var L=h[y].trim().split(":");if(L[0]==="cell"){var V=Mn(L[1]);if(A.length<=V.r)for(b=A.length;b<=V.r;++b)A[b]||(A[b]=[]);switch(b=V.r,x=V.c,L[2]){case"t":A[b][x]=e(L[3]);break;case"v":A[b][x]=+L[3];break;case"vtf":var X=L[L.length-1];case"vtc":L[3]==="nl"?A[b][x]=!!+L[4]:A[b][x]=+L[4],L[2]=="vtf"&&(A[b][x]=[A[b][x],X])}}}return v&&v.sheetRows&&(A=A.slice(0,v.sheetRows)),A}function r(m,v){return Xs(t(m,v),v)}function o(m,v){return Da(r(m,v),v)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function p(m){if(!m||!m["!ref"])return"";for(var v=[],h=[],b,x="",y=Pr(m["!ref"]),A=Array.isArray(m),L=y.s.r;L<=y.e.r;++L)for(var V=y.s.c;V<=y.e.c;++V)if(x=kt({r:L,c:V}),b=A?(m[L]||[])[V]:m[x],!(!b||b.v==null||b.t==="z")){switch(h=["cell",x,"t"],b.t){case"s":case"str":h.push(n(b.v));break;case"n":b.f?(h[2]="vtf",h[3]="n",h[4]=b.v,h[5]=n(b.f)):(h[2]="v",h[3]=b.v);break;case"b":h[2]="vt"+(b.f?"f":"c"),h[3]="nl",h[4]=b.v?"1":"0",h[5]=n(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var X=hr(ar(b.v));h[2]="vtc",h[3]="nd",h[4]=""+X,h[5]=b.w||Ri(b.z||en[14],X);break;case"e":continue}v.push(h.join(":"))}return v.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function g(m){return[i,a,l,a,p(m),u].join(`
`)}return{to_workbook:o,to_sheet:r,from_sheet:g}})(),vF=(function(){function e(g,m,v,h,b){b.raw?m[v][h]=g:g===""||(g==="TRUE"?m[v][h]=!0:g==="FALSE"?m[v][h]=!1:isNaN(ai(g))?isNaN(Fl(g).getDate())?m[v][h]=g:m[v][h]=ar(g):m[v][h]=ai(g))}function n(g,m){var v=m||{},h=[];if(!g||g.length===0)return h;for(var b=g.split(/[\r\n]/),x=b.length-1;x>=0&&b[x].length===0;)--x;for(var y=10,A=0,L=0;L<=x;++L)A=b[L].indexOf(" "),A==-1?A=b[L].length:A++,y=Math.max(y,A);for(L=0;L<=x;++L){h[L]=[];var V=0;for(e(b[L].slice(0,y).trim(),h,L,V,v),V=1;V<=(b[L].length-y)/10+1;++V)e(b[L].slice(y+(V-1)*10,y+V*10).trim(),h,L,V,v)}return v.sheetRows&&(h=h.slice(0,v.sheetRows)),h}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function o(g){for(var m={},v=!1,h=0,b=0;h<g.length;++h)(b=g.charCodeAt(h))==34?v=!v:!v&&b in t&&(m[b]=(m[b]||0)+1);b=[];for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&b.push([m[h],h]);if(!b.length){m=r;for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&b.push([m[h],h])}return b.sort(function(x,y){return x[0]-y[0]||r[x[1]]-r[y[1]]}),t[b.pop()[1]]||44}function i(g,m){var v=m||{},h="";Io!=null&&v.dense==null&&(v.dense=Io);var b=v.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(h=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(h=g.charAt(4),g=g.slice(6)):h=o(g.slice(0,1024)):v&&v.FS?h=v.FS:h=o(g.slice(0,1024));var y=0,A=0,L=0,V=0,X=0,ae=h.charCodeAt(0),Te=!1,B=0,oe=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var J=v.dateNF!=null?I3(v.dateNF):null;function te(){var de=g.slice(V,X),fe={};if(de.charAt(0)=='"'&&de.charAt(de.length-1)=='"'&&(de=de.slice(1,-1).replace(/""/g,'"')),de.length===0)fe.t="z";else if(v.raw)fe.t="s",fe.v=de;else if(de.trim().length===0)fe.t="s",fe.v=de;else if(de.charCodeAt(0)==61)de.charCodeAt(1)==34&&de.charCodeAt(de.length-1)==34?(fe.t="s",fe.v=de.slice(2,-1).replace(/""/g,'"')):mR(de)?(fe.t="n",fe.f=de.slice(1)):(fe.t="s",fe.v=de);else if(de=="TRUE")fe.t="b",fe.v=!0;else if(de=="FALSE")fe.t="b",fe.v=!1;else if(!isNaN(L=ai(de)))fe.t="n",v.cellText!==!1&&(fe.w=de),fe.v=L;else if(!isNaN(Fl(de).getDate())||J&&de.match(J)){fe.z=v.dateNF||en[14];var Be=0;J&&de.match(J)&&(de=A3(de,v.dateNF,de.match(J)||[]),Be=1),v.cellDates?(fe.t="d",fe.v=ar(de,Be)):(fe.t="n",fe.v=hr(ar(de,Be))),v.cellText!==!1&&(fe.w=Ri(fe.z,fe.v instanceof Date?hr(fe.v):fe.v)),v.cellNF||delete fe.z}else fe.t="s",fe.v=de;if(fe.t=="z"||(v.dense?(b[y]||(b[y]=[]),b[y][A]=fe):b[kt({c:A,r:y})]=fe),V=X+1,oe=g.charCodeAt(V),x.e.c<A&&(x.e.c=A),x.e.r<y&&(x.e.r=y),B==ae)++A;else if(A=0,++y,v.sheetRows&&v.sheetRows<=y)return!0}e:for(;X<g.length;++X)switch(B=g.charCodeAt(X)){case 34:oe===34&&(Te=!Te);break;case ae:case 10:case 13:if(!Te&&te())break e;break;default:break}return X-V>0&&te(),b["!ref"]=dn(x),b}function a(g,m){return!(m&&m.PRN)||m.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?i(g,m):Xs(n(g,m),m)}function l(g,m){var v="",h=m.type=="string"?[0,0,0,0]:SL(g,m);switch(m.type){case"base64":v=ci(g);break;case"binary":v=g;break;case"buffer":m.codepage==65001?v=g.toString("utf8"):m.codepage&&typeof Bt<"u"?v=Bt.utils.decode(m.codepage,g):v=Ct&&Buffer.isBuffer(g)?g.toString("binary"):Vl(g);break;case"array":v=vp(g);break;case"string":v=g;break;default:throw new Error("Unrecognized type "+m.type)}return h[0]==239&&h[1]==187&&h[2]==191?v=Tl(v.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?v=Tl(v):m.type=="binary"&&typeof Bt<"u"&&m.codepage&&(v=Bt.utils.decode(m.codepage,Bt.utils.encode(28591,v))),v.slice(0,19)=="socialcalc:version:"?WE.to_sheet(m.type=="string"?v:Tl(v),m):a(v,m)}function u(g,m){return Da(l(g,m),m)}function p(g){for(var m=[],v=Ht(g["!ref"]),h,b=Array.isArray(g),x=v.s.r;x<=v.e.r;++x){for(var y=[],A=v.s.c;A<=v.e.c;++A){var L=kt({r:x,c:A});if(h=b?(g[x]||[])[A]:g[L],!h||h.v==null){y.push("          ");continue}for(var V=(h.w||(li(h),h.w)||"").slice(0,10);V.length<10;)V+=" ";y.push(V+(A===0?" ":""))}m.push(y.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:p}})();var jw=(function(){function e(N,ee,R){if(N){Or(N,N.l||0);for(var F=R.Enum||En;N.l<N.length;){var ce=N.read_shift(2),Re=F[ce]||F[65535],qe=N.read_shift(2),Ie=N.l+qe,_e=Re.f&&Re.f(N,qe,R);if(N.l=Ie,ee(_e,Re,ce))return}}}function n(N,ee){switch(ee.type){case"base64":return t(fo(ci(N)),ee);case"binary":return t(fo(N),ee);case"buffer":case"array":return t(N,ee)}throw"Unsupported type "+ee.type}function t(N,ee){if(!N)return N;var R=ee||{};Io!=null&&R.dense==null&&(R.dense=Io);var F=R.dense?[]:{},ce="Sheet1",Re="",qe=0,Ie={},_e=[],It=[],ut={s:{r:0,c:0},e:{r:0,c:0}},On=R.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)R.Enum=En,e(N,function(Fe,Sr,Fo){switch(Fo){case 0:R.vers=Fe,Fe>=4096&&(R.qpro=!0);break;case 6:ut=Fe;break;case 204:Fe&&(Re=Fe);break;case 222:Re=Fe;break;case 15:case 51:R.qpro||(Fe[1].v=Fe[1].v.slice(1));case 13:case 14:case 16:Fo==14&&(Fe[2]&112)==112&&(Fe[2]&15)>1&&(Fe[2]&15)<15&&(Fe[1].z=R.dateNF||en[14],R.cellDates&&(Fe[1].t="d",Fe[1].v=dE(Fe[1].v))),R.qpro&&Fe[3]>qe&&(F["!ref"]=dn(ut),Ie[ce]=F,_e.push(ce),F=R.dense?[]:{},ut={s:{r:0,c:0},e:{r:0,c:0}},qe=Fe[3],ce=Re||"Sheet"+(qe+1),Re="");var ji=R.dense?(F[Fe[0].r]||[])[Fe[0].c]:F[kt(Fe[0])];if(ji){ji.t=Fe[1].t,ji.v=Fe[1].v,Fe[1].z!=null&&(ji.z=Fe[1].z),Fe[1].f!=null&&(ji.f=Fe[1].f);break}R.dense?(F[Fe[0].r]||(F[Fe[0].r]=[]),F[Fe[0].r][Fe[0].c]=Fe[1]):F[kt(Fe[0])]=Fe[1];break;default:}},R);else if(N[2]==26||N[2]==14)R.Enum=cr,N[2]==14&&(R.qpro=!0,N.l=0),e(N,function(Fe,Sr,Fo){switch(Fo){case 204:ce=Fe;break;case 22:Fe[1].v=Fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Fe[3]>qe&&(F["!ref"]=dn(ut),Ie[ce]=F,_e.push(ce),F=R.dense?[]:{},ut={s:{r:0,c:0},e:{r:0,c:0}},qe=Fe[3],ce="Sheet"+(qe+1)),On>0&&Fe[0].r>=On)break;R.dense?(F[Fe[0].r]||(F[Fe[0].r]=[]),F[Fe[0].r][Fe[0].c]=Fe[1]):F[kt(Fe[0])]=Fe[1],ut.e.c<Fe[0].c&&(ut.e.c=Fe[0].c),ut.e.r<Fe[0].r&&(ut.e.r=Fe[0].r);break;case 27:Fe[14e3]&&(It[Fe[14e3][0]]=Fe[14e3][1]);break;case 1537:It[Fe[0]]=Fe[1],Fe[0]==qe&&(ce=Fe[1]);break;default:break}},R);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(F["!ref"]=dn(ut),Ie[Re||ce]=F,_e.push(Re||ce),!It.length)return{SheetNames:_e,Sheets:Ie};for(var pt={},Gr=[],Zt=0;Zt<It.length;++Zt)Ie[_e[Zt]]?(Gr.push(It[Zt]||_e[Zt]),pt[It[Zt]]=Ie[It[Zt]]||Ie[_e[Zt]]):(Gr.push(It[Zt]),pt[It[Zt]]={"!ref":"A1"});return{SheetNames:Gr,Sheets:pt}}function r(N,ee){var R=ee||{};if(+R.codepage>=0&&Al(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var F=mr(),ce=Ht(N["!ref"]),Re=Array.isArray(N),qe=[];he(F,0,i(1030)),he(F,6,u(ce));for(var Ie=Math.min(ce.e.r,8191),_e=ce.s.r;_e<=Ie;++_e)for(var It=Un(_e),ut=ce.s.c;ut<=ce.e.c;++ut){_e===ce.s.r&&(qe[ut]=Yn(ut));var On=qe[ut]+It,pt=Re?(N[_e]||[])[ut]:N[On];if(!(!pt||pt.t=="z"))if(pt.t=="n")(pt.v|0)==pt.v&&pt.v>=-32768&&pt.v<=32767?he(F,13,h(_e,ut,pt.v)):he(F,14,x(_e,ut,pt.v));else{var Gr=li(pt);he(F,15,m(_e,ut,Gr.slice(0,239)))}}return he(F,1),F.end()}function o(N,ee){var R=ee||{};if(+R.codepage>=0&&Al(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var F=mr();he(F,0,a(N));for(var ce=0,Re=0;ce<N.SheetNames.length;++ce)(N.Sheets[N.SheetNames[ce]]||{})["!ref"]&&he(F,27,Zn(N.SheetNames[ce],Re++));var qe=0;for(ce=0;ce<N.SheetNames.length;++ce){var Ie=N.Sheets[N.SheetNames[ce]];if(!(!Ie||!Ie["!ref"])){for(var _e=Ht(Ie["!ref"]),It=Array.isArray(Ie),ut=[],On=Math.min(_e.e.r,8191),pt=_e.s.r;pt<=On;++pt)for(var Gr=Un(pt),Zt=_e.s.c;Zt<=_e.e.c;++Zt){pt===_e.s.r&&(ut[Zt]=Yn(Zt));var Fe=ut[Zt]+Gr,Sr=It?(Ie[pt]||[])[Zt]:Ie[Fe];if(!(!Sr||Sr.t=="z"))if(Sr.t=="n")he(F,23,te(pt,Zt,qe,Sr.v));else{var Fo=li(Sr);he(F,22,B(pt,Zt,qe,Fo.slice(0,239)))}}++qe}}return he(F,1),F.end()}function i(N){var ee=Z(2);return ee.write_shift(2,N),ee}function a(N){var ee=Z(26);ee.write_shift(2,4096),ee.write_shift(2,4),ee.write_shift(4,0);for(var R=0,F=0,ce=0,Re=0;Re<N.SheetNames.length;++Re){var qe=N.SheetNames[Re],Ie=N.Sheets[qe];if(!(!Ie||!Ie["!ref"])){++ce;var _e=Pr(Ie["!ref"]);R<_e.e.r&&(R=_e.e.r),F<_e.e.c&&(F=_e.e.c)}}return R>8191&&(R=8191),ee.write_shift(2,R),ee.write_shift(1,ce),ee.write_shift(1,F),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(1,1),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(4,0),ee}function l(N,ee,R){var F={s:{c:0,r:0},e:{c:0,r:0}};return ee==8&&R.qpro?(F.s.c=N.read_shift(1),N.l++,F.s.r=N.read_shift(2),F.e.c=N.read_shift(1),N.l++,F.e.r=N.read_shift(2),F):(F.s.c=N.read_shift(2),F.s.r=N.read_shift(2),ee==12&&R.qpro&&(N.l+=2),F.e.c=N.read_shift(2),F.e.r=N.read_shift(2),ee==12&&R.qpro&&(N.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function u(N){var ee=Z(8);return ee.write_shift(2,N.s.c),ee.write_shift(2,N.s.r),ee.write_shift(2,N.e.c),ee.write_shift(2,N.e.r),ee}function p(N,ee,R){var F=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(F[0].c=N.read_shift(1),F[3]=N.read_shift(1),F[0].r=N.read_shift(2),N.l+=2):(F[2]=N.read_shift(1),F[0].c=N.read_shift(2),F[0].r=N.read_shift(2)),F}function g(N,ee,R){var F=N.l+ee,ce=p(N,ee,R);if(ce[1].t="s",R.vers==20768){N.l++;var Re=N.read_shift(1);return ce[1].v=N.read_shift(Re,"utf8"),ce}return R.qpro&&N.l++,ce[1].v=N.read_shift(F-N.l,"cstr"),ce}function m(N,ee,R){var F=Z(7+R.length);F.write_shift(1,255),F.write_shift(2,ee),F.write_shift(2,N),F.write_shift(1,39);for(var ce=0;ce<F.length;++ce){var Re=R.charCodeAt(ce);F.write_shift(1,Re>=128?95:Re)}return F.write_shift(1,0),F}function v(N,ee,R){var F=p(N,ee,R);return F[1].v=N.read_shift(2,"i"),F}function h(N,ee,R){var F=Z(7);return F.write_shift(1,255),F.write_shift(2,ee),F.write_shift(2,N),F.write_shift(2,R,"i"),F}function b(N,ee,R){var F=p(N,ee,R);return F[1].v=N.read_shift(8,"f"),F}function x(N,ee,R){var F=Z(13);return F.write_shift(1,255),F.write_shift(2,ee),F.write_shift(2,N),F.write_shift(8,R,"f"),F}function y(N,ee,R){var F=N.l+ee,ce=p(N,ee,R);if(ce[1].v=N.read_shift(8,"f"),R.qpro)N.l=F;else{var Re=N.read_shift(2);X(N.slice(N.l,N.l+Re),ce),N.l+=Re}return ce}function A(N,ee,R){var F=ee&32768;return ee&=-32769,ee=(F?N:0)+(ee>=8192?ee-16384:ee),(F?"":"$")+(R?Yn(ee):Un(ee))}var L={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},V=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function X(N,ee){Or(N,0);for(var R=[],F=0,ce="",Re="",qe="",Ie="";N.l<N.length;){var _e=N[N.l++];switch(_e){case 0:R.push(N.read_shift(8,"f"));break;case 1:Re=A(ee[0].c,N.read_shift(2),!0),ce=A(ee[0].r,N.read_shift(2),!1),R.push(Re+ce);break;case 2:{var It=A(ee[0].c,N.read_shift(2),!0),ut=A(ee[0].r,N.read_shift(2),!1);Re=A(ee[0].c,N.read_shift(2),!0),ce=A(ee[0].r,N.read_shift(2),!1),R.push(It+ut+":"+Re+ce)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(N.read_shift(2));break;case 6:{for(var On="";_e=N[N.l++];)On+=String.fromCharCode(_e);R.push('"'+On.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:Ie=R.pop(),qe=R.pop(),R.push(["AND","OR"][_e-20]+"("+qe+","+Ie+")");break;default:if(_e<32&&V[_e])Ie=R.pop(),qe=R.pop(),R.push(qe+V[_e]+Ie);else if(L[_e]){if(F=L[_e][1],F==69&&(F=N[N.l++]),F>R.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+R.join("|")+"|");return}var pt=R.slice(-F);R.length-=F,R.push(L[_e][0]+"("+pt.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}R.length==1?ee[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function ae(N){var ee=[{c:0,r:0},{t:"n",v:0},0];return ee[0].r=N.read_shift(2),ee[3]=N[N.l++],ee[0].c=N[N.l++],ee}function Te(N,ee){var R=ae(N,ee);return R[1].t="s",R[1].v=N.read_shift(ee-4,"cstr"),R}function B(N,ee,R,F){var ce=Z(6+F.length);ce.write_shift(2,N),ce.write_shift(1,R),ce.write_shift(1,ee),ce.write_shift(1,39);for(var Re=0;Re<F.length;++Re){var qe=F.charCodeAt(Re);ce.write_shift(1,qe>=128?95:qe)}return ce.write_shift(1,0),ce}function oe(N,ee){var R=ae(N,ee);R[1].v=N.read_shift(2);var F=R[1].v>>1;if(R[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return R[1].v=F,R}function J(N,ee){var R=ae(N,ee),F=N.read_shift(4),ce=N.read_shift(4),Re=N.read_shift(2);if(Re==65535)return F===0&&ce===3221225472?(R[1].t="e",R[1].v=15):F===0&&ce===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var qe=Re&32768;return Re=(Re&32767)-16446,R[1].v=(1-qe*2)*(ce*Math.pow(2,Re+32)+F*Math.pow(2,Re)),R}function te(N,ee,R,F){var ce=Z(14);if(ce.write_shift(2,N),ce.write_shift(1,R),ce.write_shift(1,ee),F==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var Re=0,qe=0,Ie=0,_e=0;return F<0&&(Re=1,F=-F),qe=Math.log2(F)|0,F/=Math.pow(2,qe-31),_e=F>>>0,(_e&2147483648)==0&&(F/=2,++qe,_e=F>>>0),F-=_e,_e|=2147483648,_e>>>=0,F*=Math.pow(2,32),Ie=F>>>0,ce.write_shift(4,Ie),ce.write_shift(4,_e),qe+=16383+(Re?32768:0),ce.write_shift(2,qe),ce}function de(N,ee){var R=J(N,14);return N.l+=ee-14,R}function fe(N,ee){var R=ae(N,ee),F=N.read_shift(4);return R[1].v=F>>6,R}function Be(N,ee){var R=ae(N,ee),F=N.read_shift(8,"f");return R[1].v=F,R}function bt(N,ee){var R=Be(N,14);return N.l+=ee-10,R}function ze(N,ee){return N[N.l+ee-1]==0?N.read_shift(ee,"cstr"):""}function vn(N,ee){var R=N[N.l++];R>ee-1&&(R=ee-1);for(var F="";F.length<R;)F+=String.fromCharCode(N[N.l++]);return F}function xn(N,ee,R){if(!(!R.qpro||ee<21)){var F=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var ce=N.read_shift(ee-21,"cstr");return[F,ce]}}function sr(N,ee){for(var R={},F=N.l+ee;N.l<F;){var ce=N.read_shift(2);if(ce==14e3){for(R[ce]=[0,""],R[ce][0]=N.read_shift(2);N[N.l];)R[ce][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return R}function Zn(N,ee){var R=Z(5+N.length);R.write_shift(2,14e3),R.write_shift(2,ee);for(var F=0;F<N.length;++F){var ce=N.charCodeAt(F);R[R.l++]=ce>127?95:ce}return R[R.l++]=0,R}var En={0:{n:"BOF",f:LE},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ze},222:{n:"SHEETNAMELP",f:vn},65535:{n:""}},cr={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Te},23:{n:"NUMBER17",f:J},24:{n:"NUMBER18",f:oe},25:{n:"FORMULA19",f:de},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:sr},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:fe},38:{n:"??"},39:{n:"NUMBER27",f:Be},40:{n:"FORMULA28",f:bt},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ze},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:xn},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:o,to_workbook:n}})();var xF=/^\s|\s$|[\t\n\r]/;function zE(e,n){if(!n.bookSST)return"";var t=[un];t[t.length]=me("sst",null,{xmlns:Gs[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var o=e[r],i="<si>";o.r?i+=o.r:(i+="<t",o.t||(o.t=""),o.t.match(xF)&&(i+=' xml:space="preserve"'),i+=">"+Dt(o.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function _F(e){return[e.read_shift(4),e.read_shift(4)]}function CF(e,n){return n||(n=Z(8)),n.write_shift(4,e.Count),n.write_shift(4,e.Unique),n}var bF=uN;function yF(e){var n=mr();ie(n,159,CF(e));for(var t=0;t<e.length;++t)ie(n,19,bF(e[t]));return ie(n,160),n.end()}function MF(e){if(typeof Bt<"u")return Bt.utils.encode(Hs,e);for(var n=[],t=e.split(""),r=0;r<t.length;++r)n[r]=t[r].charCodeAt(0);return n}function HE(e){var n=0,t,r=MF(e),o=r.length+1,i,a,l,u,p;for(t=Ta(o),t[0]=r.length,i=1;i!=o;++i)t[i]=r[i-1];for(i=o-1;i>=0;--i)a=t[i],l=(n&16384)===0?0:1,u=n<<1&32767,p=l|u,n=p^a;return n^52811}var wF=(function(){function e(o,i){switch(i.type){case"base64":return n(ci(o),i);case"binary":return n(o,i);case"buffer":return n(Ct&&Buffer.isBuffer(o)?o.toString("binary"):Vl(o),i);case"array":return n(vp(o),i)}throw new Error("Unrecognized type "+i.type)}function n(o,i){var a=i||{},l=a.dense?[]:{},u=o.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var p={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(g,m){Array.isArray(l)&&(l[m]=[]);for(var v=/\\\w+\b/g,h=0,b,x=-1;b=v.exec(g);){switch(b[0]){case"\\cell":var y=g.slice(h,v.lastIndex-b[0].length);if(y[0]==" "&&(y=y.slice(1)),++x,y.length){var A={v:y,t:"s"};Array.isArray(l)?l[m][x]=A:l[kt({r:m,c:x})]=A}break}h=v.lastIndex}x>p.e.c&&(p.e.c=x)}),l["!ref"]=dn(p),l}function t(o,i){return Da(e(o,i),i)}function r(o){for(var i=["{\\rtf1\\ansi"],a=Ht(o["!ref"]),l,u=Array.isArray(o),p=a.s.r;p<=a.e.r;++p){i.push("\\trowd\\trautofit1");for(var g=a.s.c;g<=a.e.c;++g)i.push("\\cellx"+(g+1));for(i.push("\\pard\\intbl"),g=a.s.c;g<=a.e.c;++g){var m=kt({r:p,c:g});l=u?(o[p]||[])[g]:o[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(li(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}})();function Uw(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}var EF=6;var si=EF;function cp(e){return Math.floor((e+Math.round(128/si)/256)*si)}function lp(e){return Math.floor((e-5)/si*100+.5)/100}function qv(e){return Math.round((e*si+5)/si*256)/256}function f1(e){e.width?(e.wpx=cp(e.width),e.wch=lp(e.wpx),e.MDW=si):e.wpx?(e.wch=lp(e.wpx),e.width=qv(e.wch),e.MDW=si):typeof e.wch=="number"&&(e.width=qv(e.wch),e.wpx=cp(e.width),e.MDW=si),e.customWidth&&delete e.customWidth}var OF=96,$E=OF;function dp(e){return e*96/$E}function GE(e){return e*$E/96}function TF(e){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)e[r]!=null&&(n[n.length]=me("numFmt",null,{numFmtId:r,formatCode:Dt(e[r])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=me("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function PF(e){var n=[];return n[n.length]=me("cellXfs",null),e.forEach(function(t){n[n.length]=me("xf",null,t)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=me("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function qE(e,n){var t=[un,me("styleSheet",null,{xmlns:Gs[0],"xmlns:vt":yn.vt})],r;return e.SSF&&(r=TF(e.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=PF(n.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function SF(e,n){var t=e.read_shift(2),r=Kn(e,n-2);return[t,r]}function DF(e,n,t){t||(t=Z(6+4*n.length)),t.write_shift(2,e),wn(n,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function kF(e,n,t){var r={};r.sz=e.read_shift(2)/20;var o=xN(e,2,t);o.fItalic&&(r.italic=1),o.fCondense&&(r.condense=1),o.fExtend&&(r.extend=1),o.fShadow&&(r.shadow=1),o.fOutline&&(r.outline=1),o.fStrikeout&&(r.strike=1);var i=e.read_shift(2);switch(i===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(r.underline=a);var l=e.read_shift(1);l>0&&(r.family=l);var u=e.read_shift(1);switch(u>0&&(r.charset=u),e.l++,r.color=vN(e,8),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Kn(e,n-21),r}function IF(e,n){n||(n=Z(153)),n.write_shift(2,e.sz*20),_N(e,n),n.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),n.write_shift(2,t),n.write_shift(1,e.underline||0),n.write_shift(1,e.family||0),n.write_shift(1,e.charset||0),n.write_shift(1,0),ap(e.color,n);var r=0;return e.scheme=="major"&&(r=1),e.scheme=="minor"&&(r=2),n.write_shift(1,r),wn(e.name,n),n.length>n.l?n.slice(0,n.l):n}var AF=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],jv,NF=Ao;function Ww(e,n){n||(n=Z(84)),jv||(jv=Kv(AF));var t=jv[e.patternType];t==null&&(t=40),n.write_shift(4,t);var r=0;if(t!=40)for(ap({auto:1},n),ap({auto:1},n);r<12;++r)n.write_shift(4,0);else{for(;r<4;++r)n.write_shift(4,0);for(;r<12;++r)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function FF(e,n){var t=e.l+n,r=e.read_shift(2),o=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:o}}function XE(e,n,t){t||(t=Z(16)),t.write_shift(2,n||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function El(e,n){return n||(n=Z(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var RF=Ao;function LF(e,n){return n||(n=Z(51)),n.write_shift(1,0),El(null,n),El(null,n),El(null,n),El(null,n),El(null,n),n.length>n.l?n.slice(0,n.l):n}function BF(e,n){return n||(n=Z(52)),n.write_shift(4,e.xfId),n.write_shift(2,1),n.write_shift(1,+e.builtinId),n.write_shift(1,0),ip(e.name||"",n),n.length>n.l?n.slice(0,n.l):n}function VF(e,n,t){var r=Z(2052);return r.write_shift(4,e),ip(n,r),ip(t,r),r.length>r.l?r.slice(0,r.l):r}function jF(e,n){if(n){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var o=r[0];o<=r[1];++o)n[o]!=null&&++t}),t!=0&&(ie(e,615,go(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var o=r[0];o<=r[1];++o)n[o]!=null&&ie(e,44,DF(o,n[o]))}),ie(e,616))}}function UF(e){var n=1;n!=0&&(ie(e,611,go(n)),ie(e,43,IF({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ie(e,612))}function WF(e){var n=2;n!=0&&(ie(e,603,go(n)),ie(e,45,Ww({patternType:"none"})),ie(e,45,Ww({patternType:"gray125"})),ie(e,604))}function zF(e){var n=1;n!=0&&(ie(e,613,go(n)),ie(e,46,LF({})),ie(e,614))}function HF(e){var n=1;ie(e,626,go(n)),ie(e,47,XE({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ie(e,627)}function $F(e,n){ie(e,617,go(n.length)),n.forEach(function(t){ie(e,47,XE(t,0))}),ie(e,618)}function GF(e){var n=1;ie(e,619,go(n)),ie(e,48,BF({xfId:0,builtinId:0,name:"Normal"})),ie(e,620)}function qF(e){var n=0;ie(e,505,go(n)),ie(e,506)}function XF(e){var n=0;ie(e,508,VF(n,"TableStyleMedium9","PivotStyleMedium4")),ie(e,509)}function YF(e,n){var t=mr();return ie(t,278),jF(t,e.SSF),UF(t,e),WF(t,e),zF(t,e),HF(t,e),$F(t,n.cellXfs),GF(t,e),qF(t,e),XF(t,e),ie(t,279),t.end()}function YE(e,n){if(n&&n.themeXLSX)return n.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[un];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function KF(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Kn(e,n-8)}}function ZF(e){var n=Z(12+2*e.name.length);return n.write_shift(4,e.flags),n.write_shift(4,e.version),wn(e.name,n),n.slice(0,n.l)}function QF(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function JF(e){var n=Z(4+8*e.length);n.write_shift(4,e.length);for(var t=0;t<e.length;++t)n.write_shift(4,e[t][0]),n.write_shift(4,e[t][1]);return n}function eR(e,n){var t=Z(8+2*n.length);return t.write_shift(4,e),wn(n,t),t.slice(0,t.l)}function tR(e){return e.l+=4,e.read_shift(4)!=0}function nR(e,n){var t=Z(8);return t.write_shift(4,e),t.write_shift(4,n?1:0),t}function rR(){var e=mr();return ie(e,332),ie(e,334,go(1)),ie(e,335,ZF({name:"XLDAPR",version:12e4,flags:3496657072})),ie(e,336),ie(e,339,eR(1,"XLDAPR")),ie(e,52),ie(e,35,go(514)),ie(e,4096,go(0)),ie(e,4097,Hr(1)),ie(e,36),ie(e,53),ie(e,340),ie(e,337,nR(1,!0)),ie(e,51,JF([[1,0]])),ie(e,338),ie(e,333),e.end()}function KE(){var e=[un];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function oR(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=kt(t);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}var Bs=1024;function ZE(e,n){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),o=[me("xml",null,{"xmlns:v":Tr.v,"xmlns:o":Tr.o,"xmlns:x":Tr.x,"xmlns:mv":Tr.mv}).replace(/\/>/,">"),me("o:shapelayout",me("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),me("v:shapetype",[me("v:stroke",null,{joinstyle:"miter"}),me("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];Bs<e*1e3;)Bs+=1e3;return n.forEach(function(i){var a=Mn(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var u=l.type=="gradient"?me("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,p=me("v:fill",u,l),g={on:"t",obscured:"t"};++Bs,o=o.concat(["<v:shape"+Rl({id:"_x0000_s"+Bs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",p,me("v:shadow",null,g),me("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",jn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),jn("x:AutoFill","False"),jn("x:Row",String(a.r)),jn("x:Column",String(a.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o.push("</xml>"),o.join("")}function QE(e){var n=[un,me("comments",null,{xmlns:Gs[0]})],t=[];return n.push("<authors>"),e.forEach(function(r){r[1].forEach(function(o){var i=Dt(o.a);t.indexOf(i)==-1&&(t.push(i),n.push("<author>"+i+"</author>")),o.T&&o.ID&&t.indexOf("tc="+o.ID)==-1&&(t.push("tc="+o.ID),n.push("<author>tc="+o.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),e.forEach(function(r){var o=0,i=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?o=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(u){u.a&&(o=t.indexOf(Dt(u.a))),i.push(u.t||"")}),n.push('<comment ref="'+r[0]+'" authorId="'+o+'"><text>'),i.length<=1)n.push(jn("t",Dt(i[0]||"")));else{for(var a=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)a+=`Reply:
    `+i[l]+`
`;n.push(jn("t",Dt(a)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function iR(e,n,t){var r=[un,me("ThreadedComments",null,{xmlns:yn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(o){var i="";(o[1]||[]).forEach(function(a,l){if(!a.T){delete a.ID;return}a.a&&n.indexOf(a.a)==-1&&n.push(a.a);var u={ref:o[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};l==0?i=u.id:u.parentId=i,a.ID=u.id,a.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(a.a)).slice(-12)+"}"),r.push(me("threadedComment",jn("text",a.t||""),u))})}),r.push("</ThreadedComments>"),r.join("")}function aR(e){var n=[un,me("personList",null,{xmlns:yn.TCMNT,"xmlns:x":Gs[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,r){n.push(me("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),n.push("</personList>"),n.join("")}function sR(e){var n={};n.iauthor=e.read_shift(4);var t=Na(e,16);return n.rfx=t.s,n.ref=kt(t.s),e.l+=16,n}function cR(e,n){return n==null&&(n=Z(36)),n.write_shift(4,e[1].iauthor),Ys(e[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var lR=Kn;function dR(e){return wn(e.slice(0,54))}function uR(e){var n=mr(),t=[];return ie(n,628),ie(n,630),e.forEach(function(r){r[1].forEach(function(o){t.indexOf(o.a)>-1||(t.push(o.a.slice(0,54)),ie(n,632,dR(o.a)))})}),ie(n,631),ie(n,633),e.forEach(function(r){r[1].forEach(function(o){o.iauthor=t.indexOf(o.a);var i={s:Mn(r[0]),e:Mn(r[0])};ie(n,635,cR([i,o])),o.t&&o.t.length>0&&ie(n,637,pN(o)),ie(n,636),delete o.iauthor})}),ie(n,634),ie(n,629),n.end()}function fR(e,n){n.FullPaths.forEach(function(t,r){if(r!=0){var o=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");o.slice(-1)!=="/"&&Ft.utils.cfb_add(e,o,n.FileIndex[r].content)}})}var JE=["xlsb","xlsm","xlam","biff8","xla"];var pR=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(r,o,i,a){var l=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1));var p=i.length>0?parseInt(i,10)|0:0,g=a.length>0?parseInt(a,10)|0:0;return l?g+=n.c:--g,u?p+=n.r:--p,o+(l?"":"$")+Yn(g)+(u?"":"$")+Un(p)}return function(o,i){return n=i,o.replace(e,t)}})(),p1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,g1=(function(){return function(n,t){return n.replace(p1,function(r,o,i,a,l,u){var p=s1(a)-(i?0:t.c),g=a1(u)-(l?0:t.r),m=g==0?"":l?g+1:"["+g+"]",v=p==0?"":i?p+1:"["+p+"]";return o+"R"+m+"C"+v})}})();function gR(e,n){return e.replace(p1,function(t,r,o,i,a,l){return r+(o=="$"?o+i:Yn(s1(i)+n.c))+(a=="$"?a+l:Un(a1(l)+n.r))})}function mR(e){return e.length!=1}function ln(e){e.l+=1}function Li(e,n){var t=e.read_shift(n==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function e2(e,n,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return t2(e,n,t);t.biff==12&&(r=4)}var o=e.read_shift(r),i=e.read_shift(r),a=Li(e,2),l=Li(e,2);return{s:{r:o,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function t2(e){var n=Li(e,2),t=Li(e,2),r=e.read_shift(1),o=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:t[0],c:o,cRel:t[1],rRel:t[2]}}}function hR(e,n,t){if(t.biff<8)return t2(e,n,t);var r=e.read_shift(t.biff==12?4:2),o=e.read_shift(t.biff==12?4:2),i=Li(e,2),a=Li(e,2);return{s:{r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:o,c:a[0],cRel:a[1],rRel:a[2]}}}function n2(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return vR(e,n,t);var r=e.read_shift(t&&t.biff==12?4:2),o=Li(e,2);return{r,c:o[0],cRel:o[1],rRel:o[2]}}function vR(e){var n=Li(e,2),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function xR(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function _R(e,n,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return CR(e,n,t);var o=e.read_shift(r>=12?4:2),i=e.read_shift(2),a=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;o>524287;)o-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:o,c:i,cRel:a,rRel:l}}function CR(e){var n=e.read_shift(2),t=e.read_shift(1),r=(n&32768)>>15,o=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),o==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:o,rRel:r}}function bR(e,n,t){var r=(e[e.l++]&96)>>5,o=e2(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,o]}function yR(e,n,t){var r=(e[e.l++]&96)>>5,o=e.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var a=e2(e,i,t);return[r,o,a]}function MR(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function wR(e,n,t){var r=(e[e.l++]&96)>>5,o=e.read_shift(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[r,o]}function ER(e,n,t){var r=(e[e.l++]&96)>>5,o=hR(e,n-1,t);return[r,o]}function OR(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function zw(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function TR(e,n,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),o=[],i=0;i<=r;++i)o.push(e.read_shift(t&&t.biff==2?1:2));return o}function PR(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function SR(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function DR(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function kR(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function r2(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function IR(e){return e.read_shift(2),r2(e,2)}function AR(e){return e.read_shift(2),r2(e,2)}function NR(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var o=n2(e,0,t);return[r,o]}function FR(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var o=_R(e,0,t);return[r,o]}function RR(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var i=n2(e,0,t);return[r,o,i]}function LR(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(t&&t.biff<=3?1:2);return[L6[o],a2[o],r]}function BR(e,n,t){var r=e[e.l++],o=e.read_shift(1),i=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:VR(e);return[o,(i[0]===0?a2:R6)[i[1]]]}function VR(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function jR(e,n,t){e.l+=t&&t.biff==2?3:4}function UR(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),o=e.read_shift(t&&t.biff==2?1:2);return[r,o]}function WR(e){return e.l++,Ul[e.read_shift(1)]}function zR(e){return e.l++,e.read_shift(2)}function HR(e){return e.l++,e.read_shift(1)!==0}function $R(e){return e.l++,Ks(e,8)}function GR(e,n,t){return e.l++,VE(e,n-1,t)}function qR(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=RN(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=Ul[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Ks(e,8);break;case 2:t[1]=jN(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function XR(e,n,t){for(var r=e.read_shift(t.biff==12?4:2),o=[],i=0;i!=r;++i)o.push((t.biff==12?Na:zN)(e,8));return o}function YR(e,n,t){var r=0,o=0;t.biff==12?(r=e.read_shift(4),o=e.read_shift(4)):(o=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--o==0&&(o=256));for(var i=0,a=[];i!=r&&(a[i]=[]);++i)for(var l=0;l!=o;++l)a[i][l]=qR(e,t.biff);return a}function KR(e,n,t){var r=e.read_shift(1)>>>5&3,o=!t||t.biff>=8?4:2,i=e.read_shift(o);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,i]}function ZR(e,n,t){if(t.biff==5)return QR(e,n,t);var r=e.read_shift(1)>>>5&3,o=e.read_shift(2),i=e.read_shift(4);return[r,o,i]}function QR(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,t,r]}function JR(e,n,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var o=e.read_shift(t&&t.biff==2?1:2);return[r,o]}function e6(e,n,t){var r=e.read_shift(1)>>>5&3,o=e.read_shift(t&&t.biff==2?1:2);return[r,o]}function t6(e,n,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function n6(e,n,t){var r=(e[e.l++]&96)>>5,o=e.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[r,o]}var r6=Ao,o6=Ao,i6=Ao;function Wl(e,n,t){return e.l+=2,[xR(e,4,t)]}function m1(e){return e.l+=6,[]}var a6=Wl,s6=m1,c6=m1,l6=Wl;function o2(e){return e.l+=2,[LE(e),e.read_shift(2)&1]}var d6=Wl,u6=o2,f6=m1,p6=Wl,g6=Wl,m6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function h6(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),o=e.read_shift(2),i=e.read_shift(2),a=m6[t>>2&31];return{ixti:n,coltype:t&3,rt:a,idx:r,c:o,C:i}}function v6(e){return e.l+=2,[e.read_shift(4)]}function x6(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function _6(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function C6(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function b6(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function y6(e){return e.l+=4,[0,0]}var Hw={1:{n:"PtgExp",f:UR},2:{n:"PtgTbl",f:i6},3:{n:"PtgAdd",f:ln},4:{n:"PtgSub",f:ln},5:{n:"PtgMul",f:ln},6:{n:"PtgDiv",f:ln},7:{n:"PtgPower",f:ln},8:{n:"PtgConcat",f:ln},9:{n:"PtgLt",f:ln},10:{n:"PtgLe",f:ln},11:{n:"PtgEq",f:ln},12:{n:"PtgGe",f:ln},13:{n:"PtgGt",f:ln},14:{n:"PtgNe",f:ln},15:{n:"PtgIsect",f:ln},16:{n:"PtgUnion",f:ln},17:{n:"PtgRange",f:ln},18:{n:"PtgUplus",f:ln},19:{n:"PtgUminus",f:ln},20:{n:"PtgPercent",f:ln},21:{n:"PtgParen",f:ln},22:{n:"PtgMissArg",f:ln},23:{n:"PtgStr",f:GR},26:{n:"PtgSheet",f:x6},27:{n:"PtgEndSheet",f:_6},28:{n:"PtgErr",f:WR},29:{n:"PtgBool",f:HR},30:{n:"PtgInt",f:zR},31:{n:"PtgNum",f:$R},32:{n:"PtgArray",f:OR},33:{n:"PtgFunc",f:LR},34:{n:"PtgFuncVar",f:BR},35:{n:"PtgName",f:KR},36:{n:"PtgRef",f:NR},37:{n:"PtgArea",f:bR},38:{n:"PtgMemArea",f:JR},39:{n:"PtgMemErr",f:r6},40:{n:"PtgMemNoMem",f:o6},41:{n:"PtgMemFunc",f:e6},42:{n:"PtgRefErr",f:t6},43:{n:"PtgAreaErr",f:MR},44:{n:"PtgRefN",f:FR},45:{n:"PtgAreaN",f:ER},46:{n:"PtgMemAreaN",f:C6},47:{n:"PtgMemNoMemN",f:b6},57:{n:"PtgNameX",f:ZR},58:{n:"PtgRef3d",f:RR},59:{n:"PtgArea3d",f:yR},60:{n:"PtgRefErr3d",f:n6},61:{n:"PtgAreaErr3d",f:wR},255:{}},M6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},w6={1:{n:"PtgElfLel",f:o2},2:{n:"PtgElfRw",f:p6},3:{n:"PtgElfCol",f:a6},6:{n:"PtgElfRwV",f:g6},7:{n:"PtgElfColV",f:l6},10:{n:"PtgElfRadical",f:d6},11:{n:"PtgElfRadicalS",f:f6},13:{n:"PtgElfColS",f:s6},15:{n:"PtgElfColSV",f:c6},16:{n:"PtgElfRadicalLel",f:u6},25:{n:"PtgList",f:h6},29:{n:"PtgSxName",f:v6},255:{}},E6={0:{n:"PtgAttrNoop",f:y6},1:{n:"PtgAttrSemi",f:kR},2:{n:"PtgAttrIf",f:SR},4:{n:"PtgAttrChoose",f:TR},8:{n:"PtgAttrGoto",f:PR},16:{n:"PtgAttrSum",f:jR},32:{n:"PtgAttrBaxcel",f:zw},33:{n:"PtgAttrBaxcel",f:zw},64:{n:"PtgAttrSpace",f:IR},65:{n:"PtgAttrSpaceSemi",f:AR},128:{n:"PtgAttrIfError",f:DR},255:{}};function O6(e,n,t,r){if(r.biff<8)return Ao(e,n);for(var o=e.l+n,i=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=YR(e,0,r),i.push(t[a][1]);break;case"PtgMemArea":t[a][2]=XR(e,t[a][1],r),i.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=e.read_shift(4),i.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0];default:break}return n=o-e.l,n!==0&&i.push(Ao(e,n)),i}function T6(e,n,t){for(var r=e.l+n,o,i,a=[];r!=e.l;)n=r-e.l,i=e[e.l],o=Hw[i]||Hw[M6[i]],(i===24||i===25)&&(o=(i===24?w6:E6)[e[e.l+1]]),!o||!o.f?Ao(e,n):a.push([o.n,o.f(e,n,t)]);return a}function P6(e){for(var n=[],t=0;t<e.length;++t){for(var r=e[t],o=[],i=0;i<r.length;++i){var a=r[i];a?a[0]===2?o.push('"'+a[1].replace(/"/g,'""')+'"'):o.push(a[1]):o.push("")}n.push(o.join(","))}return n.join(";")}var S6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function D6(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function i2(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var o="";if(t.biff>8)switch(e[r[0]][0]){case 357:return o=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?o:o+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return o=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?o:o+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[r[0]][0][3]?(o=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?o:o+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function $w(e,n,t){var r=i2(e,n,t);return r=="#REF"?r:D6(r,t)}function $s(e,n,t,r,o){var i=o&&o.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},l=[],u,p,g,m=0,v=0,h,b="";if(!e[0]||!e[0][0])return"";for(var x=-1,y="",A=0,L=e[0].length;A<L;++A){var V=e[0][A];switch(V[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),p=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:y=Jt(" ",e[0][x][1][1]);break;case 1:y=Jt("\r",e[0][x][1][1]);break;default:if(y="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}p=p+y,x=-1}l.push(p+S6[V[0]]+u);break;case"PtgIsect":u=l.pop(),p=l.pop(),l.push(p+" "+u);break;case"PtgUnion":u=l.pop(),p=l.pop(),l.push(p+","+u);break;case"PtgRange":u=l.pop(),p=l.pop(),l.push(p+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Sl(V[1][1],a,o),l.push(Dl(g,i));break;case"PtgRefN":g=t?Sl(V[1][1],t,o):V[1][1],l.push(Dl(g,i));break;case"PtgRef3d":m=V[1][1],g=Sl(V[1][2],a,o),b=$w(r,m,o);var X=b;l.push(b+"!"+Dl(g,i));break;case"PtgFunc":case"PtgFuncVar":var ae=V[1][0],Te=V[1][1];ae||(ae=0),ae&=127;var B=ae==0?[]:l.slice(-ae);l.length-=ae,Te==="User"&&(Te=B.shift()),l.push(Te+"("+B.join(",")+")");break;case"PtgBool":l.push(V[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(V[1]);break;case"PtgNum":l.push(String(V[1]));break;case"PtgStr":l.push('"'+V[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(V[1]);break;case"PtgAreaN":h=Sw(V[1][1],t?{s:t}:a,o),l.push(Bv(h,o));break;case"PtgArea":h=Sw(V[1][1],a,o),l.push(Bv(h,o));break;case"PtgArea3d":m=V[1][1],h=V[1][2],b=$w(r,m,o),l.push(b+"!"+Bv(h,o));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=V[1][2];var oe=(r.names||[])[v-1]||(r[0]||[])[v],J=oe?oe.Name:"SH33TJSNAME"+String(v);J&&J.slice(0,6)=="_xlfn."&&!o.xlfn&&(J=J.slice(6)),l.push(J);break;case"PtgNameX":var te=V[1][1];v=V[1][2];var de;if(o.biff<=5)te<0&&(te=-te),r[te]&&(de=r[te][v]);else{var fe="";if(((r[te]||[])[0]||[])[0]==14849||(((r[te]||[])[0]||[])[0]==1025?r[te][v]&&r[te][v].itab>0&&(fe=r.SheetNames[r[te][v].itab-1]+"!"):fe=r.SheetNames[v-1]+"!"),r[te]&&r[te][v])fe+=r[te][v].Name;else if(r[0]&&r[0][v])fe+=r[0][v].Name;else{var Be=(i2(r,te,o)||"").split(";;");Be[v-1]?fe=Be[v-1]:fe+="SH33TJSERRX"}l.push(fe);break}de||(de={Name:"SH33TJSERRY"}),l.push(de.Name);break;case"PtgParen":var bt="(",ze=")";if(x>=0){switch(y="",e[0][x][1][0]){case 2:bt=Jt(" ",e[0][x][1][1])+bt;break;case 3:bt=Jt("\r",e[0][x][1][1])+bt;break;case 4:ze=Jt(" ",e[0][x][1][1])+ze;break;case 5:ze=Jt("\r",e[0][x][1][1])+ze;break;default:if(o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(bt+l.pop()+ze);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":g={c:V[1][1],r:V[1][0]};var vn={c:t.c,r:t.r};if(r.sharedf[kt(g)]){var xn=r.sharedf[kt(g)];l.push($s(xn,a,vn,r,o))}else{var sr=!1;for(u=0;u!=r.arrayf.length;++u)if(p=r.arrayf[u],!(g.c<p[0].s.c||g.c>p[0].e.c)&&!(g.r<p[0].s.r||g.r>p[0].e.r)){l.push($s(p[1],a,vn,r,o)),sr=!0;break}sr||l.push(V[1])}break;case"PtgArray":l.push("{"+P6(V[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+V[1].idx+"[#"+V[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(V));default:throw new Error("Unrecognized Formula Token: "+String(V))}var Zn=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(o.biff!=3&&x>=0&&Zn.indexOf(e[0][A][0])==-1){V=e[0][x];var En=!0;switch(V[1][0]){case 4:En=!1;case 0:y=Jt(" ",V[1][1]);break;case 5:En=!1;case 1:y=Jt("\r",V[1][1]);break;default:if(y="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+V[1][0])}l.push((En?y:"")+l.pop()+(En?"":y)),x=-1}}if(l.length>1&&o.WTF)throw new Error("bad formula stack");return l[0]}function k6(e){if(e==null){var n=Z(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof e=="number")return Pa(e);return Pa(0)}function I6(e,n,t,r,o){var i=Sa(n,t,o),a=k6(e.v),l=Z(6),u=33;l.write_shift(2,u),l.write_shift(4,0);for(var p=Z(e.bf.length),g=0;g<e.bf.length;++g)p[g]=e.bf[g];var m=Vn([i,a,l,p]);return m}function _p(e,n,t){var r=e.read_shift(4),o=T6(e,r,t),i=e.read_shift(4),a=i>0?O6(e,i,o,t):null;return[o,a]}var A6=_p,Cp=_p,N6=_p,F6=_p,R6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},a2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},L6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function B6(e){var n="of:="+e.replace(p1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function V6(e){return e.replace(/\./,"!")}var kl=typeof Map<"u";function h1(e,n,t){var r=0,o=e.length;if(t){if(kl?t.has(n):Object.prototype.hasOwnProperty.call(t,n)){for(var i=kl?t.get(n):t[n];r<i.length;++r)if(e[i[r]].t===n)return e.Count++,i[r]}}else for(;r<o;++r)if(e[r].t===n)return e.Count++,r;return e[o]={t:n},e.Count++,e.Unique++,t&&(kl?(t.has(n)||t.set(n,[]),t.get(n).push(o)):(Object.prototype.hasOwnProperty.call(t,n)||(t[n]=[]),t[n].push(o))),o}function bp(e,n){var t={min:e+1,max:e+1},r=-1;return n.MDW&&(si=n.MDW),n.width!=null?t.customWidth=1:n.wpx!=null?r=lp(n.wpx):n.wch!=null&&(r=n.wch),r>-1?(t.width=qv(r),t.customWidth=1):n.width!=null&&(t.width=n.width),n.hidden&&(t.hidden=!0),n.level!=null&&(t.outlineLevel=t.level=n.level),t}function s2(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Vi(e,n,t){var r=t.revssf[n.z!=null?n.z:"General"],o=60,i=e.length;if(r==null&&t.ssf){for(;o<392;++o)if(t.ssf[o]==null){sE(n.z,o),t.ssf[o]=n.z,t.revssf[n.z]=r=o;break}}for(o=0;o!=i;++o)if(e[o].numFmtId===r)return o;return e[i]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function j6(e,n,t){if(e&&e["!ref"]){var r=Ht(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function U6(e){if(e.length===0)return"";for(var n='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)n+='<mergeCell ref="'+dn(e[t])+'"/>';return n+"</mergeCells>"}function W6(e,n,t,r,o){var i=!1,a={},l=null;if(r.bookType!=="xlsx"&&n.vbaraw){var u=n.SheetNames[t];try{n.Workbook&&(u=n.Workbook.Sheets[t].CodeName||u)}catch{}i=!0,a.codeName=oi(Dt(u))}if(e&&e["!outline"]){var p={summaryBelow:1,summaryRight:1};e["!outline"].above&&(p.summaryBelow=0),e["!outline"].left&&(p.summaryRight=0),l=(l||"")+me("outlinePr",null,p)}!i&&!l||(o[o.length]=me("sheetPr",l,a))}var z6=["objects","scenarios","selectLockedCells","selectUnlockedCells"],H6=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $6(e){var n={sheet:1};return z6.forEach(function(t){e[t]!=null&&e[t]&&(n[t]="1")}),H6.forEach(function(t){e[t]!=null&&!e[t]&&(n[t]="0")}),e.password&&(n.password=HE(e.password).toString(16).toUpperCase()),me("sheetProtection",null,n)}function G6(e){return s2(e),me("pageMargins",null,e)}function q6(e,n){for(var t=["<cols>"],r,o=0;o!=n.length;++o)(r=n[o])&&(t[t.length]=me("col",null,bp(o,r)));return t[t.length]="</cols>",t.join("")}function X6(e,n,t,r){var o=typeof e.ref=="string"?e.ref:dn(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,a=Pr(o);a.s.r==a.e.r&&(a.e.r=Pr(n["!ref"]).e.r,o=dn(a));for(var l=0;l<i.length;++l){var u=i[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+t.SheetNames[r]+"'!"+o;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+o}),me("autoFilter",null,{ref:o})}function Y6(e,n,t,r){var o={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),me("sheetViews",me("sheetView",null,o),{})}function K6(e,n,t,r){if(e.c&&t["!comments"].push([n,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var o="",i=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":o=e.v?"1":"0";break;case"n":o=""+e.v;break;case"e":o=Ul[e.v];break;case"d":r&&r.cellDates?o=ar(e.v,-1).toISOString():(e=vr(e),e.t="n",o=""+(e.v=hr(ar(e.v)))),typeof e.z>"u"&&(e.z=en[14]);break;default:o=e.v;break}var l=jn("v",Dt(o)),u={r:n},p=Vi(r.cellXfs,e,r);switch(p!==0&&(u.s=p),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){l=jn("v",""+h1(r.Strings,e.v,r.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=i&&(e.t=i,e.v=a),typeof e.f=="string"&&e.f){var g=e.F&&e.F.slice(0,n.length)==n?{t:"array",ref:e.F}:null;l=me("f",Dt(e.f),g)+(e.v!=null?l:"")}return e.l&&t["!links"].push([n,e.l]),e.D&&(u.cm=1),me("c",l,u)}function Z6(e,n,t,r){var o=[],i=[],a=Ht(e["!ref"]),l="",u,p="",g=[],m=0,v=0,h=e["!rows"],b=Array.isArray(e),x={r:p},y,A=-1;for(v=a.s.c;v<=a.e.c;++v)g[v]=Yn(v);for(m=a.s.r;m<=a.e.r;++m){for(i=[],p=Un(m),v=a.s.c;v<=a.e.c;++v){u=g[v]+p;var L=b?(e[m]||[])[v]:e[u];L!==void 0&&(l=K6(L,u,e,n,t,r))!=null&&i.push(l)}(i.length>0||h&&h[m])&&(x={r:p},h&&h[m]&&(y=h[m],y.hidden&&(x.hidden=1),A=-1,y.hpx?A=dp(y.hpx):y.hpt&&(A=y.hpt),A>-1&&(x.ht=A,x.customHeight=1),y.level&&(x.outlineLevel=y.level)),o[o.length]=me("row",i.join(""),x))}if(h)for(;m<h.length;++m)h&&h[m]&&(x={r:m+1},y=h[m],y.hidden&&(x.hidden=1),A=-1,y.hpx?A=dp(y.hpx):y.hpt&&(A=y.hpt),A>-1&&(x.ht=A,x.customHeight=1),y.level&&(x.outlineLevel=y.level),o[o.length]=me("row","",x));return o.join("")}function c2(e,n,t,r){var o=[un,me("worksheet",null,{xmlns:Gs[0],"xmlns:r":yn.r})],i=t.SheetNames[e],a=0,l="",u=t.Sheets[i];u==null&&(u={});var p=u["!ref"]||"A1",g=Ht(p);if(g.e.c>16383||g.e.r>1048575){if(n.WTF)throw new Error("Range "+p+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),p=dn(g)}r||(r={}),u["!comments"]=[];var m=[];W6(u,t,e,n,o),o[o.length]=me("dimension",null,{ref:p}),o[o.length]=Y6(u,n,e,t),n.sheetFormat&&(o[o.length]=me("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(o[o.length]=q6(u,u["!cols"])),o[a=o.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(l=Z6(u,n,e,t,r),l.length>0&&(o[o.length]=l)),o.length>a+1&&(o[o.length]="</sheetData>",o[a]=o[a].replace("/>",">")),u["!protect"]&&(o[o.length]=$6(u["!protect"])),u["!autofilter"]!=null&&(o[o.length]=X6(u["!autofilter"],u,t,e)),u["!merges"]!=null&&u["!merges"].length>0&&(o[o.length]=U6(u["!merges"]));var v=-1,h,b=-1;return u["!links"].length>0&&(o[o.length]="<hyperlinks>",u["!links"].forEach(function(x){x[1].Target&&(h={ref:x[0]},x[1].Target.charAt(0)!="#"&&(b=St(r,-1,Dt(x[1].Target).replace(/#.*$/,""),vt.HLINK),h["r:id"]="rId"+b),(v=x[1].Target.indexOf("#"))>-1&&(h.location=Dt(x[1].Target.slice(v+1))),x[1].Tooltip&&(h.tooltip=Dt(x[1].Tooltip)),o[o.length]=me("hyperlink",null,h))}),o[o.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(o[o.length]=G6(u["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(o[o.length]=jn("ignoredErrors",me("ignoredError",null,{numberStoredAsText:1,sqref:p}))),m.length>0&&(b=St(r,-1,"../drawings/drawing"+(e+1)+".xml",vt.DRAW),o[o.length]=me("drawing",null,{"r:id":"rId"+b}),u["!drawing"]=m),u["!comments"].length>0&&(b=St(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",vt.VML),o[o.length]=me("legacyDrawing",null,{"r:id":"rId"+b}),u["!legacy"]=b),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function Q6(e,n){var t={},r=e.l+n;t.r=e.read_shift(4),e.l+=4;var o=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=r,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=o/20),t}function J6(e,n,t){var r=Z(145),o=(t["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var i=320;o.hpx?i=dp(o.hpx)*20:o.hpt&&(i=o.hpt*20),r.write_shift(2,i),r.write_shift(1,0);var a=0;o.level&&(a|=o.level),o.hidden&&(a|=16),(o.hpx||o.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var l=0,u=r.l;r.l+=4;for(var p={r:e,c:0},g=0;g<16;++g)if(!(n.s.c>g+1<<10||n.e.c<g<<10)){for(var m=-1,v=-1,h=g<<10;h<g+1<<10;++h){p.c=h;var b=Array.isArray(t)?(t[p.r]||[])[p.c]:t[kt(p)];b&&(m<0&&(m=h),v=h)}m<0||(++l,r.write_shift(4,m),r.write_shift(4,v))}var x=r.l;return r.l=u,r.write_shift(4,l),r.l=x,r.length>r.l?r.slice(0,r.l):r}function e8(e,n,t,r){var o=J6(r,t,n);(o.length>17||(n["!rows"]||[])[r])&&ie(e,0,o)}var t8=Na,n8=Ys;function r8(){}function o8(e,n){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=gN(e,n-19),t}function i8(e,n,t){t==null&&(t=Z(84+4*e.length));var r=192;n&&(n.above&&(r&=-65),n.left&&(r&=-129)),t.write_shift(1,r);for(var o=1;o<3;++o)t.write_shift(1,0);return ap({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),ME(e,t),t.slice(0,t.l)}function a8(e){var n=$r(e);return[n]}function s8(e,n,t){return t==null&&(t=Z(8)),ka(n,t)}function c8(e){var n=Ia(e);return[n]}function l8(e,n,t){return t==null&&(t=Z(4)),Aa(n,t)}function d8(e){var n=$r(e),t=e.read_shift(1);return[n,t,"b"]}function u8(e,n,t){return t==null&&(t=Z(9)),ka(n,t),t.write_shift(1,e.v?1:0),t}function f8(e){var n=Ia(e),t=e.read_shift(1);return[n,t,"b"]}function p8(e,n,t){return t==null&&(t=Z(5)),Aa(n,t),t.write_shift(1,e.v?1:0),t}function g8(e){var n=$r(e),t=e.read_shift(1);return[n,t,"e"]}function m8(e,n,t){return t==null&&(t=Z(9)),ka(n,t),t.write_shift(1,e.v),t}function h8(e){var n=Ia(e),t=e.read_shift(1);return[n,t,"e"]}function v8(e,n,t){return t==null&&(t=Z(8)),Aa(n,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function x8(e){var n=$r(e),t=e.read_shift(4);return[n,t,"s"]}function _8(e,n,t){return t==null&&(t=Z(12)),ka(n,t),t.write_shift(4,n.v),t}function C8(e){var n=Ia(e),t=e.read_shift(4);return[n,t,"s"]}function b8(e,n,t){return t==null&&(t=Z(8)),Aa(n,t),t.write_shift(4,n.v),t}function y8(e){var n=$r(e),t=Ks(e);return[n,t,"n"]}function M8(e,n,t){return t==null&&(t=Z(16)),ka(n,t),Pa(e.v,t),t}function w8(e){var n=Ia(e),t=Ks(e);return[n,t,"n"]}function E8(e,n,t){return t==null&&(t=Z(12)),Aa(n,t),Pa(e.v,t),t}function O8(e){var n=$r(e),t=wE(e);return[n,t,"n"]}function T8(e,n,t){return t==null&&(t=Z(12)),ka(n,t),EE(e.v,t),t}function P8(e){var n=Ia(e),t=wE(e);return[n,t,"n"]}function S8(e,n,t){return t==null&&(t=Z(8)),Aa(n,t),EE(e.v,t),t}function D8(e){var n=$r(e),t=c1(e);return[n,t,"is"]}function k8(e){var n=$r(e),t=Kn(e);return[n,t,"str"]}function I8(e,n,t){return t==null&&(t=Z(12+4*e.v.length)),ka(n,t),wn(e.v,t),t.length>t.l?t.slice(0,t.l):t}function A8(e){var n=Ia(e),t=Kn(e);return[n,t,"str"]}function N8(e,n,t){return t==null&&(t=Z(8+4*e.v.length)),Aa(n,t),wn(e.v,t),t.length>t.l?t.slice(0,t.l):t}function F8(e,n,t){var r=e.l+n,o=$r(e);o.r=t["!row"];var i=e.read_shift(1),a=[o,i,"b"];if(t.cellFormula){e.l+=2;var l=Cp(e,r-e.l,t);a[3]=$s(l,null,o,t.supbooks,t)}else e.l=r;return a}function R8(e,n,t){var r=e.l+n,o=$r(e);o.r=t["!row"];var i=e.read_shift(1),a=[o,i,"e"];if(t.cellFormula){e.l+=2;var l=Cp(e,r-e.l,t);a[3]=$s(l,null,o,t.supbooks,t)}else e.l=r;return a}function L8(e,n,t){var r=e.l+n,o=$r(e);o.r=t["!row"];var i=Ks(e),a=[o,i,"n"];if(t.cellFormula){e.l+=2;var l=Cp(e,r-e.l,t);a[3]=$s(l,null,o,t.supbooks,t)}else e.l=r;return a}function B8(e,n,t){var r=e.l+n,o=$r(e);o.r=t["!row"];var i=Kn(e),a=[o,i,"str"];if(t.cellFormula){e.l+=2;var l=Cp(e,r-e.l,t);a[3]=$s(l,null,o,t.supbooks,t)}else e.l=r;return a}var V8=Na,j8=Ys;function U8(e,n){return n==null&&(n=Z(4)),n.write_shift(4,e),n}function W8(e,n){var t=e.l+n,r=Na(e,16),o=l1(e),i=Kn(e),a=Kn(e),l=Kn(e);e.l=t;var u={rfx:r,relId:o,loc:i,display:l};return a&&(u.Tooltip=a),u}function z8(e,n){var t=Z(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ys({s:Mn(e[0]),e:Mn(e[0])},t),d1("rId"+n,t);var r=e[1].Target.indexOf("#"),o=r==-1?"":e[1].Target.slice(r+1);return wn(o||"",t),wn(e[1].Tooltip||"",t),wn("",t),t.slice(0,t.l)}function H8(){}function $8(e,n,t){var r=e.l+n,o=OE(e,16),i=e.read_shift(1),a=[o];if(a[2]=i,t.cellFormula){var l=A6(e,r-e.l,t);a[1]=l}else e.l=r;return a}function G8(e,n,t){var r=e.l+n,o=Na(e,16),i=[o];if(t.cellFormula){var a=F6(e,r-e.l,t);i[1]=a,e.l=r}else e.l=r;return i}function q8(e,n,t){t==null&&(t=Z(18));var r=bp(e,n);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var o=0;return n.hidden&&(o|=1),typeof r.width=="number"&&(o|=2),n.level&&(o|=n.level<<8),t.write_shift(2,o),t}var l2=["left","right","top","bottom","header","footer"];function X8(e){var n={};return l2.forEach(function(t){n[t]=Ks(e,8)}),n}function Y8(e,n){return n==null&&(n=Z(48)),s2(e),l2.forEach(function(t){Pa(e[t],n)}),n}function K8(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function Z8(e,n,t){t==null&&(t=Z(30));var r=924;return(((n||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function Q8(e){var n=Z(24);return n.write_shift(4,4),n.write_shift(4,1),Ys(e,n),n}function J8(e,n){return n==null&&(n=Z(66)),n.write_shift(2,e.password?HE(e.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?n.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):n.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),n}function e5(){}function t5(){}function n5(e,n,t,r,o,i,a){if(n.v===void 0)return!1;var l="";switch(n.t){case"b":l=n.v?"1":"0";break;case"d":n=vr(n),n.z=n.z||en[14],n.v=hr(ar(n.v)),n.t="n";break;case"n":case"e":l=""+n.v;break;default:l=n.v;break}var u={r:t,c:r};switch(u.s=Vi(o.cellXfs,n,o),n.l&&i["!links"].push([kt(u),n.l]),n.c&&i["!comments"].push([kt(u),n.c]),n.t){case"s":case"str":return o.bookSST?(l=h1(o.Strings,n.v,o.revStrings),u.t="s",u.v=l,a?ie(e,18,b8(n,u)):ie(e,7,_8(n,u))):(u.t="str",a?ie(e,17,N8(n,u)):ie(e,6,I8(n,u))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?a?ie(e,13,S8(n,u)):ie(e,2,T8(n,u)):a?ie(e,16,E8(n,u)):ie(e,5,M8(n,u)),!0;case"b":return u.t="b",a?ie(e,15,p8(n,u)):ie(e,4,u8(n,u)),!0;case"e":return u.t="e",a?ie(e,14,v8(n,u)):ie(e,3,m8(n,u)),!0}return a?ie(e,12,l8(n,u)):ie(e,1,s8(n,u)),!0}function r5(e,n,t,r){var o=Ht(n["!ref"]||"A1"),i,a="",l=[];ie(e,145);var u=Array.isArray(n),p=o.e.r;n["!rows"]&&(p=Math.max(o.e.r,n["!rows"].length-1));for(var g=o.s.r;g<=p;++g){a=Un(g),e8(e,n,o,g);var m=!1;if(g<=o.e.r)for(var v=o.s.c;v<=o.e.c;++v){g===o.s.r&&(l[v]=Yn(v)),i=l[v]+a;var h=u?(n[g]||[])[v]:n[i];if(!h){m=!1;continue}m=n5(e,h,g,v,r,n,m)}}ie(e,146)}function o5(e,n){!n||!n["!merges"]||(ie(e,177,U8(n["!merges"].length)),n["!merges"].forEach(function(t){ie(e,176,j8(t))}),ie(e,178))}function i5(e,n){!n||!n["!cols"]||(ie(e,390),n["!cols"].forEach(function(t,r){t&&ie(e,60,q8(r,t))}),ie(e,391))}function a5(e,n){!n||!n["!ref"]||(ie(e,648),ie(e,649,Q8(Ht(n["!ref"]))),ie(e,650))}function s5(e,n,t){n["!links"].forEach(function(r){if(r[1].Target){var o=St(t,-1,r[1].Target.replace(/#.*$/,""),vt.HLINK);ie(e,494,z8(r,o))}}),delete n["!links"]}function c5(e,n,t,r){if(n["!comments"].length>0){var o=St(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",vt.VML);ie(e,551,d1("rId"+o)),n["!legacy"]=o}}function l5(e,n,t,r){if(n["!autofilter"]){var o=n["!autofilter"],i=typeof o.ref=="string"?o.ref:dn(o.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,l=Pr(i);l.s.r==l.e.r&&(l.e.r=Pr(n["!ref"]).e.r,i=dn(l));for(var u=0;u<a.length;++u){var p=a[u];if(p.Name=="_xlnm._FilterDatabase"&&p.Sheet==r){p.Ref="'"+t.SheetNames[r]+"'!"+i;break}}u==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),ie(e,161,Ys(Ht(i))),ie(e,162)}}function d5(e,n,t){ie(e,133),ie(e,137,Z8(n,t)),ie(e,138),ie(e,134)}function u5(e,n){n["!protect"]&&ie(e,535,J8(n["!protect"]))}function f5(e,n,t,r){var o=mr(),i=t.SheetNames[e],a=t.Sheets[i]||{},l=i;try{t&&t.Workbook&&(l=t.Workbook.Sheets[e].CodeName||l)}catch{}var u=Ht(a["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(n.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ie(o,129),(t.vbaraw||a["!outline"])&&ie(o,147,i8(l,a["!outline"])),ie(o,148,n8(u)),d5(o,a,t.Workbook),i5(o,a,e,n,t),r5(o,a,e,n,t),u5(o,a),l5(o,a,t,e),o5(o,a),s5(o,a,r),a["!margins"]&&ie(o,476,Y8(a["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&a5(o,a),c5(o,a,e,r),ie(o,130),o.end()}function p5(e,n){e.l+=10;var t=Kn(e,n-10);return{name:t}}var g5=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function m5(e){return!e.Workbook||!e.Workbook.WBProps?"false":$3(e.Workbook.WBProps.date1904)?"true":"false"}var h5="][*?/\\".split("");function d2(e,n){if(e.length>31){if(n)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return h5.forEach(function(r){if(e.indexOf(r)!=-1){if(!n)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}function v5(e,n,t){e.forEach(function(r,o){d2(r);for(var i=0;i<o;++i)if(r==e[i])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=n&&n[o]&&n[o].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function x5(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var n=e.Workbook&&e.Workbook.Sheets||[];v5(e.SheetNames,n,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)j6(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}function u2(e){var n=[un];n[n.length]=me("workbook",null,{xmlns:Gs[0],"xmlns:r":yn.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(g5.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(r[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),n[n.length]=me("workbookPr",null,r);var o=e.Workbook&&e.Workbook.Sheets||[],i=0;if(o&&o[0]&&o[0].Hidden){for(n[n.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!o[i]||!o[i].Hidden);++i);i==e.SheetNames.length&&(i=0),n[n.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var a={name:Dt(e.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),o[i])switch(o[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}n[n.length]=me("sheet",null,a)}return n[n.length]="</sheets>",t&&(n[n.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var u={name:l.Name};l.Comment&&(u.comment=l.Comment),l.Sheet!=null&&(u.localSheetId=""+l.Sheet),l.Hidden&&(u.hidden="1"),l.Ref&&(n[n.length]=me("definedName",Dt(l.Ref),u))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function _5(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Gv(e,n-8),t.name=Kn(e),t}function C5(e,n){return n||(n=Z(127)),n.write_shift(4,e.Hidden),n.write_shift(4,e.iTabID),d1(e.strRelID,n),wn(e.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function b5(e,n){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var o=n>8?Kn(e):"";return o.length>0&&(t.CodeName=o),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function y5(e,n){n||(n=Z(72));var t=0;return e&&e.filterPrivacy&&(t|=8),n.write_shift(4,t),n.write_shift(4,0),ME(e&&e.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function M5(e,n,t){var r=e.l+n;e.l+=4,e.l+=1;var o=e.read_shift(4),i=mN(e),a=N6(e,0,t),l=l1(e);e.l=r;var u={Name:i,Ptg:a};return o<268435455&&(u.Sheet=o),l&&(u.Comment=l),u}function w5(e,n){ie(e,143);for(var t=0;t!=n.SheetNames.length;++t){var r=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t]&&n.Workbook.Sheets[t].Hidden||0,o={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:n.SheetNames[t]};ie(e,156,C5(o))}ie(e,144)}function E5(e,n){n||(n=Z(127));for(var t=0;t!=4;++t)n.write_shift(4,0);return wn("SheetJS",n),wn(Il.version,n),wn(Il.version,n),wn("7262",n),n.length>n.l?n.slice(0,n.l):n}function O5(e,n){n||(n=Z(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,e),n.write_shift(4,e);var t=120;return n.write_shift(1,t),n.length>n.l?n.slice(0,n.l):n}function T5(e,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var t=n.Workbook.Sheets,r=0,o=-1,i=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&o==-1?o=r:t[r].Hidden==1&&i==-1&&(i=r);i>o||(ie(e,135),ie(e,158,O5(o)),ie(e,136))}}function P5(e,n){var t=mr();return ie(t,131),ie(t,128,E5()),ie(t,153,y5(e.Workbook&&e.Workbook.WBProps||null)),T5(t,e,n),w5(t,e,n),ie(t,132),t.end()}function S5(e,n,t){return(n.slice(-4)===".bin"?P5:u2)(e,t)}function D5(e,n,t,r,o){return(n.slice(-4)===".bin"?f5:c2)(e,t,r,o)}function k5(e,n,t){return(n.slice(-4)===".bin"?YF:qE)(e,t)}function I5(e,n,t){return(n.slice(-4)===".bin"?yF:zE)(e,t)}function A5(e,n,t){return(n.slice(-4)===".bin"?uR:QE)(e,t)}function N5(e){return(e.slice(-4)===".bin"?rR:KE)()}function F5(e,n){var t=[];return e.Props&&t.push(kN(e.Props,n)),e.Custprops&&t.push(IN(e.Props,e.Custprops,n)),t.join("")}function R5(){return""}function L5(e,n){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(r,o){var i=[];i.push(me("NumberFormat",null,{"ss:Format":Dt(en[r.numFmtId])}));var a={"ss:ID":"s"+(21+o)};t.push(me("Style",i.join(""),a))}),me("Styles",t.join(""))}function f2(e){return me("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+g1(e.Ref,{r:0,c:0})})}function B5(e){if(!((e||{}).Workbook||{}).Names)return"";for(var n=e.Workbook.Names,t=[],r=0;r<n.length;++r){var o=n[r];o.Sheet==null&&(o.Name.match(/^_xlfn\./)||t.push(f2(o)))}return me("Names",t.join(""))}function V5(e,n,t,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var o=r.Workbook.Names,i=[],a=0;a<o.length;++a){var l=o[a];l.Sheet==t&&(l.Name.match(/^_xlfn\./)||i.push(f2(l)))}return i.join("")}function j5(e,n,t,r){if(!e)return"";var o=[];if(e["!margins"]&&(o.push("<PageSetup>"),e["!margins"].header&&o.push(me("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&o.push(me("Footer",null,{"x:Margin":e["!margins"].footer})),o.push(me("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),o.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)o.push(me("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&!(r.Workbook.Sheets[i]&&!r.Workbook.Sheets[i].Hidden);++i);i==t&&o.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),e["!protect"]&&(o.push(jn("ProtectContents","True")),e["!protect"].objects&&o.push(jn("ProtectObjects","True")),e["!protect"].scenarios&&o.push(jn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?o.push(jn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&o.push(jn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&o.push("<"+a[1]+"/>")})),o.length==0?"":me("WorksheetOptions",o.join(""),{xmlns:Tr.x})}function U5(e){return e.map(function(n){var t=H3(n.t||""),r=me("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return me("Comment",r,{"ss:Author":n.a})}).join("")}function W5(e,n,t,r,o,i,a){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Dt(g1(e.f,a))),e.F&&e.F.slice(0,n.length)==n){var u=Mn(e.F.slice(n.length+1));l["ss:ArrayRange"]="RC:R"+(u.r==a.r?"":"["+(u.r-a.r)+"]")+"C"+(u.c==a.c?"":"["+(u.c-a.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Dt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Dt(e.l.Tooltip))),t["!merges"])for(var p=t["!merges"],g=0;g!=p.length;++g)p[g].s.c!=a.c||p[g].s.r!=a.r||(p[g].e.c>p[g].s.c&&(l["ss:MergeAcross"]=p[g].e.c-p[g].s.c),p[g].e.r>p[g].s.r&&(l["ss:MergeDown"]=p[g].e.r-p[g].s.r));var m="",v="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":m="Number",v=String(e.v);break;case"b":m="Boolean",v=e.v?"1":"0";break;case"e":m="Error",v=Ul[e.v];break;case"d":m="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||en[14]);break;case"s":m="String",v=z3(e.v||"");break}var h=Vi(r.cellXfs,e,r);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=a.c+1;var b=e.v!=null?v:"",x=e.t=="z"?"":'<Data ss:Type="'+m+'">'+b+"</Data>";return(e.c||[]).length>0&&(x+=U5(e.c)),me("Cell",x,l)}function z5(e,n){var t='<Row ss:Index="'+(e+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=GE(n.hpt)),n.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(t+=' ss:Hidden="1"')),t+">"}function H5(e,n,t,r){if(!e["!ref"])return"";var o=Ht(e["!ref"]),i=e["!merges"]||[],a=0,l=[];e["!cols"]&&e["!cols"].forEach(function(y,A){f1(y);var L=!!y.width,V=bp(A,y),X={"ss:Index":A+1};L&&(X["ss:Width"]=cp(V.width)),y.hidden&&(X["ss:Hidden"]="1"),l.push(me("Column",null,X))});for(var u=Array.isArray(e),p=o.s.r;p<=o.e.r;++p){for(var g=[z5(p,(e["!rows"]||[])[p])],m=o.s.c;m<=o.e.c;++m){var v=!1;for(a=0;a!=i.length;++a)if(!(i[a].s.c>m)&&!(i[a].s.r>p)&&!(i[a].e.c<m)&&!(i[a].e.r<p)){(i[a].s.c!=m||i[a].s.r!=p)&&(v=!0);break}if(!v){var h={r:p,c:m},b=kt(h),x=u?(e[p]||[])[m]:e[b];g.push(W5(x,b,e,n,t,r,h))}}g.push("</Row>"),g.length>2&&l.push(g.join(""))}return l.join("")}function $5(e,n,t){var r=[],o=t.SheetNames[e],i=t.Sheets[o],a=i?V5(i,n,e,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=i?H5(i,n,e,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(j5(i,n,e,t)),r.join("")}function G5(e,n){n||(n={}),e.SSF||(e.SSF=vr(en)),e.SSF&&(mp(),gp(e.SSF),n.revssf=hp(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF,n.cellXfs=[],Vi(n.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(F5(e,n)),t.push(R5(e,n)),t.push(""),t.push("");for(var r=0;r<e.SheetNames.length;++r)t.push(me("Worksheet",$5(r,n,e),{"ss:Name":Dt(e.SheetNames[r])}));return t[2]=L5(e,n),t[3]=B5(e,n),un+me("Workbook",t.join(""),{xmlns:Tr.ss,"xmlns:o":Tr.o,"xmlns:x":Tr.x,"xmlns:ss":Tr.ss,"xmlns:dt":Tr.dt,"xmlns:html":Tr.html})}var Uv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function q5(e,n){var t=[],r=[],o=[],i=0,a,l=xw(kw,"n"),u=xw(Iw,"n");if(e.Props)for(a=Wn(e.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(l,a[i])?t:Object.prototype.hasOwnProperty.call(u,a[i])?r:o).push([a[i],e.Props[a[i]]]);if(e.Custprops)for(a=Wn(e.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(l,a[i])?t:Object.prototype.hasOwnProperty.call(u,a[i])?r:o).push([a[i],e.Custprops[a[i]]]);var p=[];for(i=0;i<o.length;++i)RE.indexOf(o[i][0])>-1||AE.indexOf(o[i][0])>-1||o[i][1]!=null&&p.push(o[i]);r.length&&Ft.utils.cfb_add(n,"/SummaryInformation",Lw(r,Uv.SI,u,Iw)),(t.length||p.length)&&Ft.utils.cfb_add(n,"/DocumentSummaryInformation",Lw(t,Uv.DSI,l,kw,p.length?p:null,Uv.UDI))}function X5(e,n){var t=n||{},r=Ft.utils.cfb_new({root:"R"}),o="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":o="/Workbook",t.biff=8;break;case"biff5":o="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Ft.utils.cfb_add(r,o,p2(e,t)),t.biff==8&&(e.Props||e.Custprops)&&q5(e,r),t.biff==8&&e.vbaraw&&fR(r,Ft.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var Y5={0:{f:Q6},1:{f:a8},2:{f:O8},3:{f:g8},4:{f:d8},5:{f:y8},6:{f:k8},7:{f:x8},8:{f:B8},9:{f:L8},10:{f:F8},11:{f:R8},12:{f:c8},13:{f:P8},14:{f:h8},15:{f:f8},16:{f:w8},17:{f:A8},18:{f:C8},19:{f:c1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:M5},40:{},42:{},43:{f:kF},44:{f:SF},45:{f:NF},46:{f:RF},47:{f:FF},48:{},49:{f:cN},50:{},51:{f:QF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:lF},62:{f:D8},63:{f:oR},64:{f:e5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ao,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:K8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:o8},148:{f:t8,p:16},151:{f:H8},152:{},153:{f:b5},154:{},155:{},156:{f:_5},157:{},158:{},159:{T:1,f:_F},160:{T:-1},161:{T:1,f:Na},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:V8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:KF},336:{T:-1},337:{f:tR,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Gv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:rF},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$8},427:{f:G8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:X8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:r8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:W8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Gv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:lR},633:{T:1},634:{T:-1},635:{T:1,f:sR},636:{T:-1},637:{f:fN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:p5},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:t5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function he(e,n,t,r){var o=n;if(!isNaN(o)){var i=r||(t||[]).length||0,a=e.next(4);a.write_shift(2,o),a.write_shift(2,i),i>0&&i1(t)&&e.push(t)}}function K5(e,n,t,r){var o=r||(t||[]).length||0;if(o<=8224)return he(e,n,t,o);var i=n;if(!isNaN(i)){for(var a=t.parts||[],l=0,u=0,p=0;p+(a[l]||8224)<=8224;)p+=a[l]||8224,l++;var g=e.next(4);for(g.write_shift(2,i),g.write_shift(2,p),e.push(t.slice(u,u+p)),u+=p;u<o;){for(g=e.next(4),g.write_shift(2,60),p=0;p+(a[l]||8224)<=8224;)p+=a[l]||8224,l++;g.write_shift(2,p),e.push(t.slice(u,u+p)),u+=p}}}function zl(e,n,t){return e||(e=Z(7)),e.write_shift(2,n),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function Z5(e,n,t,r){var o=Z(9);return zl(o,e,n),BE(t,r||"b",o),o}function Q5(e,n,t){var r=Z(8+2*t.length);return zl(r,e,n),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function J5(e,n,t,r){if(n.v!=null)switch(n.t){case"d":case"n":var o=n.t=="d"?hr(ar(n.v)):n.v;o==(o|0)&&o>=0&&o<65536?he(e,2,pF(t,r,o)):he(e,3,fF(t,r,o));return;case"b":case"e":he(e,5,Z5(t,r,n.v,n.t));return;case"s":case"str":he(e,4,Q5(t,r,(n.v||"").slice(0,255)));return}he(e,1,zl(null,t,r))}function eL(e,n,t,r){var o=Array.isArray(n),i=Ht(n["!ref"]||"A1"),a,l="",u=[];if(i.e.c>255||i.e.r>16383){if(r.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=dn(i)}for(var p=i.s.r;p<=i.e.r;++p){l=Un(p);for(var g=i.s.c;g<=i.e.c;++g){p===i.s.r&&(u[g]=Yn(g)),a=u[g]+l;var m=o?(n[p]||[])[g]:n[a];m&&J5(e,m,p,g,r)}}}function tL(e,n){var t=n||{};Io!=null&&t.dense==null&&(t.dense=Io);for(var r=mr(),o=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==t.sheet&&(o=i);if(o==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return he(r,t.biff==4?1033:t.biff==3?521:9,u1(e,16,t)),eL(r,e.Sheets[e.SheetNames[o]],o,t,e),he(r,10),r.end()}function nL(e,n,t){he(e,49,YN({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}function rL(e,n,t){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var o=r[0];o<=r[1];++o)n[o]!=null&&he(e,1054,QN(o,n[o],t))})}function oL(e,n){var t=Z(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),he(e,2151,t),t=Z(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),UE(Ht(n["!ref"]||"A1"),t),t.write_shift(4,4),he(e,2152,t)}function iL(e,n){for(var t=0;t<16;++t)he(e,224,Vw({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(r){he(e,224,Vw(r,0,n))})}function aL(e,n){for(var t=0;t<n["!links"].length;++t){var r=n["!links"][t];he(e,440,aF(r)),r[1].Tooltip&&he(e,2048,sF(r))}delete n["!links"]}function sL(e,n){if(n){var t=0;n.forEach(function(r,o){++t<=256&&r&&he(e,125,dF(bp(o,r),o))})}}function cL(e,n,t,r,o){var i=16+Vi(o.cellXfs,n,o);if(n.v==null&&!n.bf){he(e,513,Sa(t,r,i));return}if(n.bf)he(e,6,I6(n,t,r,o,i));else switch(n.t){case"d":case"n":var a=n.t=="d"?hr(ar(n.v)):n.v;he(e,515,nF(t,r,a,i,o));break;case"b":case"e":he(e,517,tF(t,r,n.v,i,o,n.t));break;case"s":case"str":if(o.bookSST){var l=h1(o.Strings,n.v,o.revStrings);he(e,253,KN(t,r,l,i,o))}else he(e,516,ZN(t,r,(n.v||"").slice(0,255),i,o));break;default:he(e,513,Sa(t,r,i))}}function lL(e,n,t){var r=mr(),o=t.SheetNames[e],i=t.Sheets[o]||{},a=(t||{}).Workbook||{},l=(a.Sheets||[])[e]||{},u=Array.isArray(i),p=n.biff==8,g,m="",v=[],h=Ht(i["!ref"]||"A1"),b=p?65536:16384;if(h.e.c>255||h.e.r>=b){if(n.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,b-1)}he(r,2057,u1(t,16,n)),he(r,13,Hr(1)),he(r,12,Hr(100)),he(r,15,ir(!0)),he(r,17,ir(!1)),he(r,16,Pa(.001)),he(r,95,ir(!0)),he(r,42,ir(!1)),he(r,43,ir(!1)),he(r,130,Hr(1)),he(r,128,eF([0,0])),he(r,131,ir(!1)),he(r,132,ir(!1)),p&&sL(r,i["!cols"]),he(r,512,JN(h,n)),p&&(i["!links"]=[]);for(var x=h.s.r;x<=h.e.r;++x){m=Un(x);for(var y=h.s.c;y<=h.e.c;++y){x===h.s.r&&(v[y]=Yn(y)),g=v[y]+m;var A=u?(i[x]||[])[y]:i[g];A&&(cL(r,A,x,y,n),p&&A.l&&i["!links"].push([g,A.l]))}}var L=l.CodeName||l.name||o;return p&&he(r,574,XN((a.Views||[])[0])),p&&(i["!merges"]||[]).length&&he(r,229,iF(i["!merges"])),p&&aL(r,i),he(r,442,jE(L,n)),p&&oL(r,i),he(r,10),r.end()}function dL(e,n,t){var r=mr(),o=(e||{}).Workbook||{},i=o.Sheets||[],a=o.WBProps||{},l=t.biff==8,u=t.biff==5;if(he(r,2057,u1(e,5,t)),t.bookType=="xla"&&he(r,135),he(r,225,l?Hr(1200):null),he(r,193,FN(2)),u&&he(r,191),u&&he(r,192),he(r,226),he(r,92,HN("SheetJS",t)),he(r,66,Hr(l?1200:1252)),l&&he(r,353,Hr(0)),l&&he(r,448),he(r,317,uF(e.SheetNames.length)),l&&e.vbaraw&&he(r,211),l&&e.vbaraw){var p=a.CodeName||"ThisWorkbook";he(r,442,jE(p,t))}he(r,156,Hr(17)),he(r,25,ir(!1)),he(r,18,ir(!1)),he(r,19,Hr(0)),l&&he(r,431,ir(!1)),l&&he(r,444,Hr(0)),he(r,61,qN(t)),he(r,64,ir(!1)),he(r,141,Hr(0)),he(r,34,ir(m5(e)=="true")),he(r,14,ir(!0)),l&&he(r,439,ir(!1)),he(r,218,Hr(0)),nL(r,e,t),rL(r,e.SSF,t),iL(r,t),l&&he(r,352,ir(!1));var g=r.end(),m=mr();l&&he(m,140,cF()),l&&t.Strings&&K5(m,252,GN(t.Strings,t)),he(m,10);var v=m.end(),h=mr(),b=0,x=0;for(x=0;x<e.SheetNames.length;++x)b+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var y=g.length+b+v.length;for(x=0;x<e.SheetNames.length;++x){var A=i[x]||{};he(h,133,$N({pos:y,hs:A.Hidden||0,dt:0,name:e.SheetNames[x]},t)),y+=n[x].length}var L=h.end();if(b!=L.length)throw new Error("BS8 "+b+" != "+L.length);var V=[];return g.length&&V.push(g),L.length&&V.push(L),v.length&&V.push(v),Vn(V)}function uL(e,n){var t=n||{},r=[];e&&!e.SSF&&(e.SSF=vr(en)),e&&e.SSF&&(mp(),gp(e.SSF),t.revssf=hp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,v1(t),t.cellXfs=[],Vi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var o=0;o<e.SheetNames.length;++o)r[r.length]=lL(o,t,e);return r.unshift(dL(e,r,t)),Vn(r)}function p2(e,n){for(var t=0;t<=e.SheetNames.length;++t){var r=e.Sheets[e.SheetNames[t]];if(!(!r||!r["!ref"])){var o=Pr(r["!ref"]);o.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var i=n||{};switch(i.biff||2){case 8:case 5:return uL(e,n);case 4:case 3:case 2:return tL(e,n)}throw new Error("invalid type "+i.bookType+" for BIFF")}function fL(e,n,t,r){for(var o=e["!merges"]||[],i=[],a=n.s.c;a<=n.e.c;++a){for(var l=0,u=0,p=0;p<o.length;++p)if(!(o[p].s.r>t||o[p].s.c>a)&&!(o[p].e.r<t||o[p].e.c<a)){if(o[p].s.r<t||o[p].s.c<a){l=-1;break}l=o[p].e.r-o[p].s.r+1,u=o[p].e.c-o[p].s.c+1;break}if(!(l<0)){var g=kt({r:t,c:a}),m=r.dense?(e[t]||[])[a]:e[g],v=m&&m.v!=null&&(m.h||W3(m.w||(li(m),m.w)||""))||"",h={};l>1&&(h.rowspan=l),u>1&&(h.colspan=u),r.editable?v='<span contenteditable="true">'+v+"</span>":m&&(h["data-t"]=m&&m.t||"z",m.v!=null&&(h["data-v"]=m.v),m.z!=null&&(h["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+m.l.Target+'">'+v+"</a>")),h.id=(r.id||"sjs")+"-"+g,i.push(me("td",v,h))}}var b="<tr>";return b+i.join("")+"</tr>"}var pL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',gL="</body></html>";function mL(e,n,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function g2(e,n){var t=n||{},r=t.header!=null?t.header:pL,o=t.footer!=null?t.footer:gL,i=[r],a=Pr(e["!ref"]);t.dense=Array.isArray(e),i.push(mL(e,a,t));for(var l=a.s.r;l<=a.e.r;++l)i.push(fL(e,a,l,t));return i.push("</table>"+o),i.join("")}function m2(e,n,t){var r=t||{};Io!=null&&(r.dense=Io);var o=0,i=0;if(r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var a=typeof r.origin=="string"?Mn(r.origin):r.origin;o=a.r,i=a.c}var l=n.getElementsByTagName("tr"),u=Math.min(r.sheetRows||1e7,l.length),p={s:{r:0,c:0},e:{r:o,c:i}};if(e["!ref"]){var g=Pr(e["!ref"]);p.s.r=Math.min(p.s.r,g.s.r),p.s.c=Math.min(p.s.c,g.s.c),p.e.r=Math.max(p.e.r,g.e.r),p.e.c=Math.max(p.e.c,g.e.c),o==-1&&(p.e.r=o=g.e.r+1)}var m=[],v=0,h=e["!rows"]||(e["!rows"]=[]),b=0,x=0,y=0,A=0,L=0,V=0;for(e["!cols"]||(e["!cols"]=[]);b<l.length&&x<u;++b){var X=l[b];if(Gw(X)){if(r.display)continue;h[x]={hidden:!0}}var ae=X.children;for(y=A=0;y<ae.length;++y){var Te=ae[y];if(!(r.display&&Gw(Te))){var B=Te.hasAttribute("data-v")?Te.getAttribute("data-v"):Te.hasAttribute("v")?Te.getAttribute("v"):G3(Te.innerHTML),oe=Te.getAttribute("data-z")||Te.getAttribute("z");for(v=0;v<m.length;++v){var J=m[v];J.s.c==A+i&&J.s.r<x+o&&x+o<=J.e.r&&(A=J.e.c+1-i,v=-1)}V=+Te.getAttribute("colspan")||1,((L=+Te.getAttribute("rowspan")||1)>1||V>1)&&m.push({s:{r:x+o,c:A+i},e:{r:x+o+(L||1)-1,c:A+i+(V||1)-1}});var te={t:"s",v:B},de=Te.getAttribute("data-t")||Te.getAttribute("t")||"";B!=null&&(B.length==0?te.t=de||"z":r.raw||B.trim().length==0||de=="s"||(B==="TRUE"?te={t:"b",v:!0}:B==="FALSE"?te={t:"b",v:!1}:isNaN(ai(B))?isNaN(Fl(B).getDate())||(te={t:"d",v:ar(B)},r.cellDates||(te={t:"n",v:hr(te.v)}),te.z=r.dateNF||en[14]):te={t:"n",v:ai(B)})),te.z===void 0&&oe!=null&&(te.z=oe);var fe="",Be=Te.getElementsByTagName("A");if(Be&&Be.length)for(var bt=0;bt<Be.length&&!(Be[bt].hasAttribute("href")&&(fe=Be[bt].getAttribute("href"),fe.charAt(0)!="#"));++bt);fe&&fe.charAt(0)!="#"&&(te.l={Target:fe}),r.dense?(e[x+o]||(e[x+o]=[]),e[x+o][A+i]=te):e[kt({c:A+i,r:x+o})]=te,p.e.c<A+i&&(p.e.c=A+i),A+=V}}++x}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),p.e.r=Math.max(p.e.r,x-1+o),e["!ref"]=dn(p),x>=u&&(e["!fullref"]=dn((p.e.r=l.length-b+x-1+o,p))),e}function h2(e,n){var t=n||{},r=t.dense?[]:{};return m2(r,e,n)}function hL(e,n){return Da(h2(e,n),n)}function Gw(e){var n="",t=vL(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function vL(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var xL=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+Rl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return un+n}})(),qw=(function(){var e=function(i){return Dt(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(i,a,l){var u=[];u.push('      <table:table table:name="'+Dt(a.SheetNames[l])+`" table:style-name="ta1">
`);var p=0,g=0,m=Pr(i["!ref"]||"A1"),v=i["!merges"]||[],h=0,b=Array.isArray(i);if(i["!cols"])for(g=0;g<=m.e.c;++g)u.push("        <table:table-column"+(i["!cols"][g]?' table:style-name="co'+i["!cols"][g].ods+'"':"")+`></table:table-column>
`);var x="",y=i["!rows"]||[];for(p=0;p<m.s.r;++p)x=y[p]?' table:style-name="ro'+y[p].ods+'"':"",u.push("        <table:table-row"+x+`></table:table-row>
`);for(;p<=m.e.r;++p){for(x=y[p]?' table:style-name="ro'+y[p].ods+'"':"",u.push("        <table:table-row"+x+`>
`),g=0;g<m.s.c;++g)u.push(n);for(;g<=m.e.c;++g){var A=!1,L={},V="";for(h=0;h!=v.length;++h)if(!(v[h].s.c>g)&&!(v[h].s.r>p)&&!(v[h].e.c<g)&&!(v[h].e.r<p)){(v[h].s.c!=g||v[h].s.r!=p)&&(A=!0),L["table:number-columns-spanned"]=v[h].e.c-v[h].s.c+1,L["table:number-rows-spanned"]=v[h].e.r-v[h].s.r+1;break}if(A){u.push(t);continue}var X=kt({r:p,c:g}),ae=b?(i[p]||[])[g]:i[X];if(ae&&ae.f&&(L["table:formula"]=Dt(B6(ae.f)),ae.F&&ae.F.slice(0,X.length)==X)){var Te=Pr(ae.F);L["table:number-matrix-columns-spanned"]=Te.e.c-Te.s.c+1,L["table:number-matrix-rows-spanned"]=Te.e.r-Te.s.r+1}if(!ae){u.push(n);continue}switch(ae.t){case"b":V=ae.v?"TRUE":"FALSE",L["office:value-type"]="boolean",L["office:boolean-value"]=ae.v?"true":"false";break;case"n":V=ae.w||String(ae.v||0),L["office:value-type"]="float",L["office:value"]=ae.v||0;break;case"s":case"str":V=ae.v==null?"":ae.v,L["office:value-type"]="string";break;case"d":V=ae.w||ar(ae.v).toISOString(),L["office:value-type"]="date",L["office:date-value"]=ar(ae.v).toISOString(),L["table:style-name"]="ce1";break;default:u.push(n);continue}var B=e(V);if(ae.l&&ae.l.Target){var oe=ae.l.Target;oe=oe.charAt(0)=="#"?"#"+V6(oe.slice(1)):oe,oe.charAt(0)!="#"&&!oe.match(/^\w+:/)&&(oe="../"+oe),B=me("text:a",B,{"xlink:href":oe.replace(/&/g,"&amp;")})}u.push("          "+me("table:table-cell",me("text:p",B,{}),L)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},o=function(i,a){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;a.SheetNames.map(function(p){return a.Sheets[p]}).forEach(function(p){if(p&&p["!cols"]){for(var g=0;g<p["!cols"].length;++g)if(p["!cols"][g]){var m=p["!cols"][g];if(m.width==null&&m.wpx==null&&m.wch==null)continue;f1(m),m.ods=l;var v=p["!cols"][g].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),i.push(`  </style:style>
`),++l}}});var u=0;a.SheetNames.map(function(p){return a.Sheets[p]}).forEach(function(p){if(p&&p["!rows"]){for(var g=0;g<p["!rows"].length;++g)if(p["!rows"][g]){p["!rows"][g].ods=u;var m=p["!rows"][g].hpx+"px";i.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++u}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(a,l){var u=[un],p=Rl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=Rl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(u.push("<office:document"+p+g+`>
`),u.push(kE().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+p+`>
`),o(u,a),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var m=0;m!=a.SheetNames.length;++m)u.push(r(a.Sheets[a.SheetNames[m]],a,m,l));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),l.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function v2(e,n){if(n.bookType=="fods")return qw(e,n);var t=Zv(),r="",o=[],i=[];return r="mimetype",ot(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",ot(t,r,qw(e,n)),o.push([r,"text/xml"]),i.push([r,"ContentFile"]),r="styles.xml",ot(t,r,xL(e,n)),o.push([r,"text/xml"]),i.push([r,"StylesFile"]),r="meta.xml",ot(t,r,un+kE()),o.push([r,"text/xml"]),i.push([r,"MetadataFile"]),r="manifest.rdf",ot(t,r,DN(i)),o.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",ot(t,r,PN(o)),t}function up(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function _L(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):fo(oi(e))}function CL(e,n){e:for(var t=0;t<=e.length-n.length;++t){for(var r=0;r<n.length;++r)if(e[t+r]!=n[r])continue e;return!0}return!1}function Bi(e){var n=e.reduce(function(o,i){return o+i.length},0),t=new Uint8Array(n),r=0;return e.forEach(function(o){t.set(o,r),r+=o.length}),t}function bL(e,n,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,o=t/Math.pow(10,r-6176);e[n+15]|=r>>7,e[n+14]|=(r&127)<<1;for(var i=0;o>=1;++i,o/=256)e[n+i]=o&255;e[n+15]|=t>=0?0:128}function Ll(e,n){var t=n?n[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),r}function Pt(e){var n=new Uint8Array(7);n[0]=e&127;var t=1;e:if(e>127){if(n[t-1]|=128,n[t]=e>>7&127,++t,e<=16383||(n[t-1]|=128,n[t]=e>>14&127,++t,e<=2097151)||(n[t-1]|=128,n[t]=e>>21&127,++t,e<=268435455)||(n[t-1]|=128,n[t]=e/256>>>21&127,++t,e<=34359738367)||(n[t-1]|=128,n[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;n[t-1]|=128,n[t]=e/16777216>>>21&127,++t}return n.slice(0,t)}function zs(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function hn(e){for(var n=[],t=[0];t[0]<e.length;){var r=t[0],o=Ll(e,t),i=o&7;o=Math.floor(o/8);var a=0,l;if(o==0)break;switch(i){case 0:{for(var u=t[0];e[t[0]++]>=128;);l=e.slice(u,t[0])}break;case 5:a=4,l=e.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,l=e.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=Ll(e,t),l=e.slice(t[0],t[0]+a),t[0]+=a;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(o," at offset ").concat(r))}var p={data:l,type:i};n[o]==null?n[o]=[p]:n[o].push(p)}return n}function Ln(e){var n=[];return e.forEach(function(t,r){t.forEach(function(o){o.data&&(n.push(Pt(r*8+o.type)),o.type==2&&n.push(Pt(o.data.length)),n.push(o.data))})}),Bi(n)}function lo(e){for(var n,t=[],r=[0];r[0]<e.length;){var o=Ll(e,r),i=hn(e.slice(r[0],r[0]+o));r[0]+=o;var a={id:zs(i[1][0].data),messages:[]};i[2].forEach(function(l){var u=hn(l.data),p=zs(u[3][0].data);a.messages.push({meta:u,data:e.slice(r[0],r[0]+p)}),r[0]+=p}),(n=i[3])!=null&&n[0]&&(a.merge=zs(i[3][0].data)>>>0>0),t.push(a)}return t}function Fs(e){var n=[];return e.forEach(function(t){var r=[];r[1]=[{data:Pt(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Pt(+!!t.merge),type:0}]);var o=[];t.messages.forEach(function(a){o.push(a.data),a.meta[3]=[{type:0,data:Pt(a.data.length)}],r[2].push({data:Ln(a.meta),type:2})});var i=Ln(r);n.push(Pt(i.length)),n.push(i),o.forEach(function(a){return n.push(a)})}),Bi(n)}function yL(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=Ll(n,t),o=[];t[0]<n.length;){var i=n[t[0]]&3;if(i==0){var a=n[t[0]++]>>2;if(a<60)++a;else{var l=a-59;a=n[t[0]],l>1&&(a|=n[t[0]+1]<<8),l>2&&(a|=n[t[0]+2]<<16),l>3&&(a|=n[t[0]+3]<<24),a>>>=0,a++,t[0]+=l}o.push(n.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var u=0,p=0;if(i==1?(p=(n[t[0]]>>2&7)+4,u=(n[t[0]++]&224)<<3,u|=n[t[0]++]):(p=(n[t[0]++]>>2)+1,i==2?(u=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(u=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),o=[Bi(o)],u==0)throw new Error("Invalid offset 0");if(u>o[0].length)throw new Error("Invalid offset beyond length");if(p>=u)for(o.push(o[0].slice(-u)),p-=u;p>=o[o.length-1].length;)o.push(o[o.length-1]),p-=o[o.length-1].length;o.push(o[0].slice(-u,-u+p))}}var g=Bi(o);if(g.length!=r)throw new Error("Unexpected length: ".concat(g.length," != ").concat(r));return g}function uo(e){for(var n=[],t=0;t<e.length;){var r=e[t++],o=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(yL(r,e.slice(t,t+o))),t+=o}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Bi(n)}function Rs(e){for(var n=[],t=0;t<e.length;){var r=Math.min(e.length-t,268435455),o=new Uint8Array(4);n.push(o);var i=Pt(r),a=i.length;n.push(i),r<=60?(a++,n.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,n.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,n.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,n.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,n.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),n.push(e.slice(t,t+r)),a+=r,o[0]=0,o[1]=a&255,o[2]=a>>8&255,o[3]=a>>16&255,t+=r}return Bi(n)}function Wv(e,n){var t=new Uint8Array(32),r=up(t),o=12,i=0;switch(t[0]=5,e.t){case"n":t[1]=2,bL(t,o,e.v),i|=1,o+=16;break;case"b":t[1]=6,r.setFloat64(o,e.v?1:0,!0),i|=2,o+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,r.setUint32(o,n.indexOf(e.v),!0),i|=8,o+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,i,!0),t.slice(0,o)}function zv(e,n){var t=new Uint8Array(32),r=up(t),o=12,i=0;switch(t[0]=3,e.t){case"n":t[2]=2,r.setFloat64(o,e.v,!0),i|=32,o+=8;break;case"b":t[2]=6,r.setFloat64(o,e.v?1:0,!0),i|=32,o+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,r.setUint32(o,n.indexOf(e.v),!0),i|=16,o+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,i,!0),t.slice(0,o)}function Ai(e){var n=hn(e);return Ll(n[1][0].data)}function ML(e,n,t){var r,o,i,a;if(!((r=e[6])!=null&&r[0])||!((o=e[7])!=null&&o[0]))throw"Mutation only works on post-BNC storages!";var l=((a=(i=e[8])==null?void 0:i[0])==null?void 0:a.data)&&zs(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var u=0,p=up(e[7][0].data),g=0,m=[],v=up(e[4][0].data),h=0,b=[],x=0;x<n.length;++x){if(n[x]==null){p.setUint16(x*2,65535,!0),v.setUint16(x*2,65535);continue}p.setUint16(x*2,g,!0),v.setUint16(x*2,h,!0);var y,A;switch(typeof n[x]){case"string":y=Wv({t:"s",v:n[x]},t),A=zv({t:"s",v:n[x]},t);break;case"number":y=Wv({t:"n",v:n[x]},t),A=zv({t:"n",v:n[x]},t);break;case"boolean":y=Wv({t:"b",v:n[x]},t),A=zv({t:"b",v:n[x]},t);break;default:throw new Error("Unsupported value "+n[x])}m.push(y),g+=y.length,b.push(A),h+=A.length,++u}for(e[2][0].data=Pt(u);x<e[7][0].data.length/2;++x)p.setUint16(x*2,65535,!0),v.setUint16(x*2,65535,!0);return e[6][0].data=Bi(m),e[3][0].data=Bi(b),u}function wL(e,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Pr(t["!ref"]);r.s.r=r.s.c=0;var o=!1;r.e.c>9&&(o=!0,r.e.c=9),r.e.r>49&&(o=!0,r.e.r=49),o&&console.error("The Numbers writer is currently limited to ".concat(dn(r)));var i=fp(t,{range:r,header:1}),a=["~Sh33tJ5~"];i.forEach(function(R){return R.forEach(function(F){typeof F=="string"&&a.push(F)})});var l={},u=[],p=Ft.read(n.numbers,{type:"base64"});p.FileIndex.map(function(R,F){return[R,p.FullPaths[F]]}).forEach(function(R){var F=R[0],ce=R[1];if(F.type==2&&F.name.match(/\.iwa/)){var Re=F.content,qe=uo(Re),Ie=lo(qe);Ie.forEach(function(_e){u.push(_e.id),l[_e.id]={deps:[],location:ce,type:zs(_e.messages[0].meta[1][0].data)}})}}),u.sort(function(R,F){return R-F});var g=u.filter(function(R){return R>1}).map(function(R){return[R,Pt(R)]});p.FileIndex.map(function(R,F){return[R,p.FullPaths[F]]}).forEach(function(R){var F=R[0],ce=R[1];if(F.name.match(/\.iwa/)){var Re=lo(uo(F.content));Re.forEach(function(qe){qe.messages.forEach(function(Ie){g.forEach(function(_e){qe.messages.some(function(It){return zs(It.meta[1][0].data)!=11006&&CL(It.data,_e[1])})&&l[_e[0]].deps.push(qe.id)})})})}});function m(){for(var R=927262;R<2e6;++R)if(!l[R])return R;throw new Error("Too many messages")}for(var v=Ft.find(p,l[1].location),h=lo(uo(v.content)),b,x=0;x<h.length;++x){var y=h[x];y.id==1&&(b=y)}var A=Ai(hn(b.messages[0].data)[1][0].data);for(v=Ft.find(p,l[A].location),h=lo(uo(v.content)),x=0;x<h.length;++x)y=h[x],y.id==A&&(b=y);for(A=Ai(hn(b.messages[0].data)[2][0].data),v=Ft.find(p,l[A].location),h=lo(uo(v.content)),x=0;x<h.length;++x)y=h[x],y.id==A&&(b=y);for(A=Ai(hn(b.messages[0].data)[2][0].data),v=Ft.find(p,l[A].location),h=lo(uo(v.content)),x=0;x<h.length;++x)y=h[x],y.id==A&&(b=y);var L=hn(b.messages[0].data);{L[6][0].data=Pt(r.e.r+1),L[7][0].data=Pt(r.e.c+1);var V=Ai(L[46][0].data),X=Ft.find(p,l[V].location),ae=lo(uo(X.content));{for(var Te=0;Te<ae.length&&ae[Te].id!=V;++Te);if(ae[Te].id!=V)throw"Bad ColumnRowUIDMapArchive";var B=hn(ae[Te].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var oe=0;oe<=r.e.c;++oe){var J=[];J[1]=J[2]=[{type:0,data:Pt(oe+420690)}],B[1].push({type:2,data:Ln(J)}),B[2].push({type:0,data:Pt(oe)}),B[3].push({type:0,data:Pt(oe)})}B[4]=[],B[5]=[],B[6]=[];for(var te=0;te<=r.e.r;++te)J=[],J[1]=J[2]=[{type:0,data:Pt(te+726270)}],B[4].push({type:2,data:Ln(J)}),B[5].push({type:0,data:Pt(te)}),B[6].push({type:0,data:Pt(te)});ae[Te].messages[0].data=Ln(B)}X.content=Rs(Fs(ae)),X.size=X.content.length,delete L[46];var de=hn(L[4][0].data);{de[7][0].data=Pt(r.e.r+1);var fe=hn(de[1][0].data),Be=Ai(fe[2][0].data);X=Ft.find(p,l[Be].location),ae=lo(uo(X.content));{if(ae[0].id!=Be)throw"Bad HeaderStorageBucket";var bt=hn(ae[0].messages[0].data);for(te=0;te<i.length;++te){var ze=hn(bt[2][0].data);ze[1][0].data=Pt(te),ze[4][0].data=Pt(i[te].length),bt[2][te]={type:bt[2][0].type,data:Ln(ze)}}ae[0].messages[0].data=Ln(bt)}X.content=Rs(Fs(ae)),X.size=X.content.length;var vn=Ai(de[2][0].data);X=Ft.find(p,l[vn].location),ae=lo(uo(X.content));{if(ae[0].id!=vn)throw"Bad HeaderStorageBucket";for(bt=hn(ae[0].messages[0].data),oe=0;oe<=r.e.c;++oe)ze=hn(bt[2][0].data),ze[1][0].data=Pt(oe),ze[4][0].data=Pt(r.e.r+1),bt[2][oe]={type:bt[2][0].type,data:Ln(ze)};ae[0].messages[0].data=Ln(bt)}X.content=Rs(Fs(ae)),X.size=X.content.length;var xn=Ai(de[4][0].data);(function(){for(var R=Ft.find(p,l[xn].location),F=lo(uo(R.content)),ce,Re=0;Re<F.length;++Re){var qe=F[Re];qe.id==xn&&(ce=qe)}var Ie=hn(ce.messages[0].data);{Ie[3]=[];var _e=[];a.forEach(function(On,pt){_e[1]=[{type:0,data:Pt(pt)}],_e[2]=[{type:0,data:Pt(1)}],_e[3]=[{type:2,data:_L(On)}],Ie[3].push({type:2,data:Ln(_e)})})}ce.messages[0].data=Ln(Ie);var It=Fs(F),ut=Rs(It);R.content=ut,R.size=R.content.length})();var sr=hn(de[3][0].data);{var Zn=sr[1][0];delete sr[2];var En=hn(Zn.data);{var cr=Ai(En[2][0].data);(function(){for(var R=Ft.find(p,l[cr].location),F=lo(uo(R.content)),ce,Re=0;Re<F.length;++Re){var qe=F[Re];qe.id==cr&&(ce=qe)}var Ie=hn(ce.messages[0].data);{delete Ie[6],delete sr[7];var _e=new Uint8Array(Ie[5][0].data);Ie[5]=[];for(var It=0,ut=0;ut<=r.e.r;++ut){var On=hn(_e);It+=ML(On,i[ut],a),On[1][0].data=Pt(ut),Ie[5].push({data:Ln(On),type:2})}Ie[1]=[{type:0,data:Pt(r.e.c+1)}],Ie[2]=[{type:0,data:Pt(r.e.r+1)}],Ie[3]=[{type:0,data:Pt(It)}],Ie[4]=[{type:0,data:Pt(r.e.r+1)}]}ce.messages[0].data=Ln(Ie);var pt=Fs(F),Gr=Rs(pt);R.content=Gr,R.size=R.content.length})()}Zn.data=Ln(En)}de[3][0].data=Ln(sr)}L[4][0].data=Ln(de)}b.messages[0].data=Ln(L);var N=Fs(h),ee=Rs(N);return v.content=ee,v.size=v.content.length,p}function EL(e){return function(t){for(var r=0;r!=e.length;++r){var o=e[r];t[o[0]]===void 0&&(t[o[0]]=o[1]),o[2]==="n"&&(t[o[0]]=Number(t[o[0]]))}}}function v1(e){EL([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function OL(e,n){return n.bookType=="ods"?v2(e,n):n.bookType=="numbers"?wL(e,n):n.bookType=="xlsb"?TL(e,n):PL(e,n)}function TL(e,n){Bs=1024,e&&!e.SSF&&(e.SSF=vr(en)),e&&e.SSF&&(mp(),gp(e.SSF),n.revssf=hp(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,kl?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var t=n.bookType=="xlsb"?"bin":"xml",r=JE.indexOf(n.bookType)>-1,o=PE();v1(n=n||{});var i=Zv(),a="",l=0;if(n.cellXfs=[],Vi(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",ot(i,a,IE(e.Props,n)),o.coreprops.push(a),St(n.rels,2,a,vt.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],p=0;p<e.SheetNames.length;++p)(e.Workbook.Sheets[p]||{}).Hidden!=2&&u.push(e.SheetNames[p]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,ot(i,a,NE(e.Props,n)),o.extprops.push(a),St(n.rels,3,a,vt.EXT_PROPS),e.Custprops!==e.Props&&Wn(e.Custprops||{}).length>0&&(a="docProps/custom.xml",ot(i,a,FE(e.Custprops,n)),o.custprops.push(a),St(n.rels,4,a,vt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var g={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],v=(m||{})["!type"]||"sheet";if(a="xl/worksheets/sheet"+l+"."+t,ot(i,a,D5(l-1,a,n,e,g)),o.sheets.push(a),St(n.wbrels,-1,"worksheets/sheet"+l+"."+t,vt.WS[0]),m){var h=m["!comments"],b=!1,x="";h&&h.length>0&&(x="xl/comments"+l+"."+t,ot(i,x,A5(h,x,n)),o.comments.push(x),St(g,-1,"../comments"+l+"."+t,vt.CMNT),b=!0),m["!legacy"]&&b&&ot(i,"xl/drawings/vmlDrawing"+l+".vml",ZE(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&ot(i,DE(a),Us(g))}return n.Strings!=null&&n.Strings.length>0&&(a="xl/sharedStrings."+t,ot(i,a,I5(n.Strings,a,n)),o.strs.push(a),St(n.wbrels,-1,"sharedStrings."+t,vt.SST)),a="xl/workbook."+t,ot(i,a,S5(e,a,n)),o.workbooks.push(a),St(n.rels,1,a,vt.WB),a="xl/theme/theme1.xml",ot(i,a,YE(e.Themes,n)),o.themes.push(a),St(n.wbrels,-1,"theme/theme1.xml",vt.THEME),a="xl/styles."+t,ot(i,a,k5(e,a,n)),o.styles.push(a),St(n.wbrels,-1,"styles."+t,vt.STY),e.vbaraw&&r&&(a="xl/vbaProject.bin",ot(i,a,e.vbaraw),o.vba.push(a),St(n.wbrels,-1,"vbaProject.bin",vt.VBA)),a="xl/metadata."+t,ot(i,a,N5(a)),o.metadata.push(a),St(n.wbrels,-1,"metadata."+t,vt.XLMETA),ot(i,"[Content_Types].xml",SE(o,n)),ot(i,"_rels/.rels",Us(n.rels)),ot(i,"xl/_rels/workbook."+t+".rels",Us(n.wbrels)),delete n.revssf,delete n.ssf,i}function PL(e,n){Bs=1024,e&&!e.SSF&&(e.SSF=vr(en)),e&&e.SSF&&(mp(),gp(e.SSF),n.revssf=hp(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,kl?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var t="xml",r=JE.indexOf(n.bookType)>-1,o=PE();v1(n=n||{});var i=Zv(),a="",l=0;if(n.cellXfs=[],Vi(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",ot(i,a,IE(e.Props,n)),o.coreprops.push(a),St(n.rels,2,a,vt.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],p=0;p<e.SheetNames.length;++p)(e.Workbook.Sheets[p]||{}).Hidden!=2&&u.push(e.SheetNames[p]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,ot(i,a,NE(e.Props,n)),o.extprops.push(a),St(n.rels,3,a,vt.EXT_PROPS),e.Custprops!==e.Props&&Wn(e.Custprops||{}).length>0&&(a="docProps/custom.xml",ot(i,a,FE(e.Custprops,n)),o.custprops.push(a),St(n.rels,4,a,vt.CUST_PROPS));var g=["SheetJ5"];for(n.tcid=0,l=1;l<=e.SheetNames.length;++l){var m={"!id":{}},v=e.Sheets[e.SheetNames[l-1]],h=(v||{})["!type"]||"sheet";if(a="xl/worksheets/sheet"+l+"."+t,ot(i,a,c2(l-1,n,e,m)),o.sheets.push(a),St(n.wbrels,-1,"worksheets/sheet"+l+"."+t,vt.WS[0]),v){var b=v["!comments"],x=!1,y="";if(b&&b.length>0){var A=!1;b.forEach(function(L){L[1].forEach(function(V){V.T==!0&&(A=!0)})}),A&&(y="xl/threadedComments/threadedComment"+l+"."+t,ot(i,y,iR(b,g,n)),o.threadedcomments.push(y),St(m,-1,"../threadedComments/threadedComment"+l+"."+t,vt.TCMNT)),y="xl/comments"+l+"."+t,ot(i,y,QE(b,n)),o.comments.push(y),St(m,-1,"../comments"+l+"."+t,vt.CMNT),x=!0}v["!legacy"]&&x&&ot(i,"xl/drawings/vmlDrawing"+l+".vml",ZE(l,v["!comments"])),delete v["!comments"],delete v["!legacy"]}m["!id"].rId1&&ot(i,DE(a),Us(m))}return n.Strings!=null&&n.Strings.length>0&&(a="xl/sharedStrings."+t,ot(i,a,zE(n.Strings,n)),o.strs.push(a),St(n.wbrels,-1,"sharedStrings."+t,vt.SST)),a="xl/workbook."+t,ot(i,a,u2(e,n)),o.workbooks.push(a),St(n.rels,1,a,vt.WB),a="xl/theme/theme1.xml",ot(i,a,YE(e.Themes,n)),o.themes.push(a),St(n.wbrels,-1,"theme/theme1.xml",vt.THEME),a="xl/styles."+t,ot(i,a,qE(e,n)),o.styles.push(a),St(n.wbrels,-1,"styles."+t,vt.STY),e.vbaraw&&r&&(a="xl/vbaProject.bin",ot(i,a,e.vbaraw),o.vba.push(a),St(n.wbrels,-1,"vbaProject.bin",vt.VBA)),a="xl/metadata."+t,ot(i,a,KE()),o.metadata.push(a),St(n.wbrels,-1,"metadata."+t,vt.XLMETA),g.length>1&&(a="xl/persons/person.xml",ot(i,a,aR(g,n)),o.people.push(a),St(n.wbrels,-1,"persons/person.xml",vt.PEOPLE)),ot(i,"[Content_Types].xml",SE(o,n)),ot(i,"_rels/.rels",Us(n.rels)),ot(i,"xl/_rels/workbook."+t+".rels",Us(n.wbrels)),delete n.revssf,delete n.ssf,i}function SL(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=ci(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function x2(e,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return jl(n.file,Ft.write(e,{type:Ct?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return Ft.write(e,n)}function DL(e,n){var t=vr(n||{}),r=OL(e,t);return kL(r,t)}function kL(e,n){var t={},r=Ct?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(t.compression="DEFLATE"),n.password)t.type=r;else switch(n.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+n.type)}var o=e.FullPaths?Ft.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!n.compression}):e.generate(t);if(typeof Deno<"u"&&typeof o=="string"){if(n.type=="binary"||n.type=="base64")return o;o=new Uint8Array(pp(o))}return n.password&&typeof encrypt_agile<"u"?x2(encrypt_agile(o,n.password),n):n.type==="file"?jl(n.file,o):n.type=="string"?Tl(o):o}function IL(e,n){var t=n||{},r=X5(e,t);return x2(r,t)}function ko(e,n,t){t||(t="");var r=t+e;switch(n.type){case"base64":return Nl(oi(r));case"binary":return oi(r);case"string":return e;case"file":return jl(n.file,r,"utf8");case"buffer":return Ct?di(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):ko(r,{type:"binary"}).split("").map(function(o){return o.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function AL(e,n){switch(n.type){case"base64":return Nl(e);case"binary":return e;case"string":return e;case"file":return jl(n.file,e,"binary");case"buffer":return Ct?di(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function Jf(e,n){switch(n.type){case"string":case"base64":case"binary":for(var t="",r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return n.type=="base64"?Nl(t):n.type=="string"?Tl(t):t;case"file":return jl(n.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+n.type)}}function _2(e,n){i3(),x5(e);var t=vr(n||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=_2(e,t);return t.type="array",pp(r)}var o=0;if(t.sheet&&(typeof t.sheet=="number"?o=t.sheet:o=e.SheetNames.indexOf(t.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return ko(G5(e,t),t);case"slk":case"sylk":return ko(mF.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"htm":case"html":return ko(g2(e.Sheets[e.SheetNames[o]],t),t);case"txt":return AL(b2(e.Sheets[e.SheetNames[o]],t),t);case"csv":return ko(x1(e.Sheets[e.SheetNames[o]],t),t,"\uFEFF");case"dif":return ko(hF.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"dbf":return Jf(gF.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"prn":return ko(vF.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"rtf":return ko(wF.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"eth":return ko(WE.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"fods":return ko(v2(e,t),t);case"wk1":return Jf(jw.sheet_to_wk1(e.Sheets[e.SheetNames[o]],t),t);case"wk3":return Jf(jw.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Jf(p2(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),IL(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return DL(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function NL(e){if(!e.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=n[e.bookType]||e.bookType}}function C2(e,n,t){var r=t||{};return r.type="file",r.file=n,NL(r),_2(e,r)}function FL(e,n,t,r,o,i,a,l){var u=Un(t),p=l.defval,g=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,v=o===1?[]:{};if(o!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:t,enumerable:!1})}catch{v.__rowNum__=t}else v.__rowNum__=t;if(!a||e[t])for(var h=n.s.c;h<=n.e.c;++h){var b=a?e[t][h]:e[r[h]+u];if(b===void 0||b.t===void 0){if(p===void 0)continue;i[h]!=null&&(v[i[h]]=p);continue}var x=b.v;switch(b.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(i[h]!=null){if(x==null)if(b.t=="e"&&x===null)v[i[h]]=null;else if(p!==void 0)v[i[h]]=p;else if(g&&x===null)v[i[h]]=null;else continue;else v[i[h]]=g&&(b.t!=="n"||b.t==="n"&&l.rawNumbers!==!1)?x:li(b,x,l);x!=null&&(m=!1)}}return{row:v,isempty:m}}function fp(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,o=1,i=[],a=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},p=n||{},g=p.range!=null?p.range:e["!ref"];switch(p.header===1?r=1:p.header==="A"?r=2:Array.isArray(p.header)?r=3:p.header==null&&(r=0),typeof g){case"string":u=Ht(g);break;case"number":u=Ht(e["!ref"]),u.s.r=g;break;default:u=g}r>0&&(o=0);var m=Un(u.s.r),v=[],h=[],b=0,x=0,y=Array.isArray(e),A=u.s.r,L=0,V={};y&&!e[A]&&(e[A]=[]);var X=p.skipHidden&&e["!cols"]||[],ae=p.skipHidden&&e["!rows"]||[];for(L=u.s.c;L<=u.e.c;++L)if(!(X[L]||{}).hidden)switch(v[L]=Yn(L),t=y?e[A][L]:e[v[L]+m],r){case 1:i[L]=L-u.s.c;break;case 2:i[L]=v[L];break;case 3:i[L]=p.header[L-u.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),l=a=li(t,null,p),x=V[a]||0,!x)V[a]=1;else{do l=a+"_"+x++;while(V[l]);V[a]=x,V[l]=1}i[L]=l}for(A=u.s.r+o;A<=u.e.r;++A)if(!(ae[A]||{}).hidden){var Te=FL(e,u,A,v,r,i,y,p);(Te.isempty===!1||(r===1?p.blankrows!==!1:p.blankrows))&&(h[b++]=Te.row)}return h.length=b,h}var Xw=/"/g;function RL(e,n,t,r,o,i,a,l){for(var u=!0,p=[],g="",m=Un(t),v=n.s.c;v<=n.e.c;++v)if(r[v]){var h=l.dense?(e[t]||[])[v]:e[r[v]+m];if(h==null)g="";else if(h.v!=null){u=!1,g=""+(l.rawNumbers&&h.t=="n"?h.v:li(h,null,l));for(var b=0,x=0;b!==g.length;++b)if((x=g.charCodeAt(b))===o||x===i||x===34||l.forceQuotes){g='"'+g.replace(Xw,'""')+'"';break}g=="ID"&&(g='"ID"')}else h.f!=null&&!h.F?(u=!1,g="="+h.f,g.indexOf(",")>=0&&(g='"'+g.replace(Xw,'""')+'"')):g="";p.push(g)}return l.blankrows===!1&&u?null:p.join(a)}function x1(e,n){var t=[],r=n??{};if(e==null||e["!ref"]==null)return"";var o=Ht(e["!ref"]),i=r.FS!==void 0?r.FS:",",a=i.charCodeAt(0),l=r.RS!==void 0?r.RS:`
`,u=l.charCodeAt(0),p=new RegExp((i=="|"?"\\|":i)+"+$"),g="",m=[];r.dense=Array.isArray(e);for(var v=r.skipHidden&&e["!cols"]||[],h=r.skipHidden&&e["!rows"]||[],b=o.s.c;b<=o.e.c;++b)(v[b]||{}).hidden||(m[b]=Yn(b));for(var x=0,y=o.s.r;y<=o.e.r;++y)(h[y]||{}).hidden||(g=RL(e,o,y,m,a,u,i,r),g!=null&&(r.strip&&(g=g.replace(p,"")),(g||r.blankrows!==!1)&&t.push((x++?l:"")+g)));return delete r.dense,t.join("")}function b2(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=x1(e,n);if(typeof Bt>"u"||n.type=="string")return t;var r=Bt.utils.encode(1200,t,"str");return"\xFF\xFE"+r}function LL(e){var n="",t,r="";if(e==null||e["!ref"]==null)return[];var o=Ht(e["!ref"]),i="",a=[],l,u=[],p=Array.isArray(e);for(l=o.s.c;l<=o.e.c;++l)a[l]=Yn(l);for(var g=o.s.r;g<=o.e.r;++g)for(i=Un(g),l=o.s.c;l<=o.e.c;++l)if(n=a[l]+i,t=p?(e[g]||[])[l]:e[n],r="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;r=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}u[u.length]=n+"="+r}return u}function y2(e,n,t){var r=t||{},o=+!r.skipHeader,i=e||{},a=0,l=0;if(i&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var u=typeof r.origin=="string"?Mn(r.origin):r.origin;a=u.r,l=u.c}var p,g={s:{c:0,r:0},e:{c:l,r:a+n.length-1+o}};if(i["!ref"]){var m=Ht(i["!ref"]);g.e.c=Math.max(g.e.c,m.e.c),g.e.r=Math.max(g.e.r,m.e.r),a==-1&&(a=m.e.r+1,g.e.r=a+n.length-1+o)}else a==-1&&(a=0,g.e.r=n.length-1+o);var v=r.header||[],h=0;n.forEach(function(x,y){Wn(x).forEach(function(A){(h=v.indexOf(A))==-1&&(v[h=v.length]=A);var L=x[A],V="z",X="",ae=kt({c:l+h,r:a+y+o});p=Bl(i,ae),L&&typeof L=="object"&&!(L instanceof Date)?i[ae]=L:(typeof L=="number"?V="n":typeof L=="boolean"?V="b":typeof L=="string"?V="s":L instanceof Date?(V="d",r.cellDates||(V="n",L=hr(L)),X=r.dateNF||en[14]):L===null&&r.nullError&&(V="e",L=0),p?(p.t=V,p.v=L,delete p.w,delete p.R,X&&(p.z=X)):i[ae]=p={t:V,v:L},X&&(p.z=X))})}),g.e.c=Math.max(g.e.c,l+v.length-1);var b=Un(a);if(o)for(h=0;h<v.length;++h)i[Yn(h+l)+b]={t:"s",v:v[h]};return i["!ref"]=dn(g),i}function BL(e,n){return y2(null,e,n)}function Bl(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var r=Mn(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Bl(e,kt(n)):Bl(e,kt({r:n,c:t||0}))}function VL(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function jL(){return{SheetNames:[],Sheets:{}}}function UL(e,n,t,r){var o=1;if(!t)for(;o<=65535&&e.SheetNames.indexOf(t="Sheet"+o)!=-1;++o,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);o=i&&+i[2]||0;var a=i&&i[1]||t;for(++o;o<=65535&&e.SheetNames.indexOf(t=a+o)!=-1;++o);}if(d2(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function WL(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=VL(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function zL(e,n){return e.z=n,e}function M2(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function HL(e,n,t){return M2(e,"#"+n,t)}function $L(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function GL(e,n,t,r){for(var o=typeof n!="string"?n:Ht(n),i=typeof n=="string"?n:dn(n),a=o.s.r;a<=o.e.r;++a)for(var l=o.s.c;l<=o.e.c;++l){var u=Bl(e,a,l);u.t="n",u.F=i,delete u.v,a==o.s.r&&l==o.s.c&&(u.f=t,r&&(u.D=!0))}return e}var yp={encode_col:Yn,encode_row:Un,encode_cell:kt,encode_range:dn,decode_col:s1,decode_row:a1,split_cell:sN,decode_cell:Mn,decode_range:Pr,format_cell:li,sheet_add_aoa:yE,sheet_add_json:y2,sheet_add_dom:m2,aoa_to_sheet:Xs,json_to_sheet:BL,table_to_sheet:h2,table_to_book:hL,sheet_to_csv:x1,sheet_to_txt:b2,sheet_to_json:fp,sheet_to_html:g2,sheet_to_formulae:LL,sheet_to_row_object_array:fp,sheet_get_cell:Bl,book_new:jL,book_append_sheet:UL,book_set_sheet_visibility:WL,cell_set_number_format:zL,cell_set_hyperlink:M2,cell_set_internal_link:HL,cell_add_comment:$L,sheet_set_array_formula:GL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var Kte=Il.version;var Mp=class e{constructor(){}exportToExcel(n,t){if(!n||n.length===0){alert("No data to export.");return}let r=yp.json_to_sheet(n),o=yp.book_new();yp.book_append_sheet(o,r,"Sheet1"),C2(o,`${t}.xlsx`)}static \u0275fac=function(t){return new(t||e)};static \u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"})};var je=class e{constructor(n){this.exportService=n}data=[];filename="export_data";exportExcel(){this.exportService.exportToExcel(this.data,this.filename)}static \u0275fac=function(t){return new(t||e)(j(Mp))};static \u0275cmp=se({type:e,selectors:[["app-export-buttons"]],inputs:{data:"data",filename:"filename"},standalone:!1,decls:4,vars:0,consts:[[1,"export-actions"],["title","Export as Excel",1,"btn-export","btn-excel",3,"click"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"button",1),E("click",function(){return r.exportExcel()}),c(2,"span"),d(3,"\u{1F4CA} Export as Excel"),s()()())},styles:[".export-actions[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.btn-export[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;padding:6px 12px;font-size:.85rem;font-weight:600;border-radius:6px;border:none;cursor:pointer;transition:all .2s ease-in-out;box-shadow:0 2px 4px #0000000d}.btn-export[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 6px #0000001a}.btn-export[_ngcontent-%COMP%]:active{transform:translateY(0)}.btn-excel[_ngcontent-%COMP%]{background-color:#107c41;color:#fff}.btn-excel[_ngcontent-%COMP%]:hover{background-color:#0b5e31}"]})};function YL(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),He(6,"date"),s(),c(7,"td"),d(8),s(),c(9,"td"),d(10),s(),c(11,"td",48),d(12),s(),c(13,"td"),d(14),s(),c(15,"td")(16,"div",49)(17,"button",50),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(18,"\u270F\uFE0F"),s(),c(19,"button",51),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(20,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.voucherNumber),f(2),M($e(6,8,t.transactionDate,"dd-MM-yyyy")),f(3),M(t.repName),f(2),M(t.excursionName),f(2),ku("",t.adl," / ",t.chd," / ",t.inf),f(2),M(t.excursionSupplierName||"-")}}function KL(e,n){e&1&&(c(0,"tr")(1,"td",52),d(2,"No transactions found"),s()())}function ZL(e,n){if(e&1&&(c(0,"option",26),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.repName)}}function QL(e,n){if(e&1&&(c(0,"option",26),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.agentName)}}function JL(e,n){if(e&1&&(c(0,"option",26),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.nationalityName)}}function eB(e,n){if(e&1&&(c(0,"option",26),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.hotelName)}}function tB(e,n){if(e&1&&(c(0,"option",26),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.destinationName)}}function nB(e,n){if(e&1&&(c(0,"option",26),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.excursionName)}}function rB(e,n){if(e&1&&(c(0,"option",26),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.supplierName)}}function oB(e,n){if(e&1&&(c(0,"option",26),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.priceListName)}}function iB(e,n){if(e&1&&(c(0,"option",26),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t),f(),M(t)}}var wp=class e{constructor(n,t,r){this.svc=n;this.cdr=t;this.router=r}searchTerm="";transactions=[];reps=[];agents=[];nationalities=[];hotels=[];destinations=[];excursions=[];suppliers=[];priceLists=[];paymentTypes=["Cash","Credit","FOC"];isModalOpen=!1;isEdit=!1;saving=!1;model=this.emptyModel();showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadDropdowns(),this.searchTransactions()}get currentDayName(){return new Date().toLocaleDateString("en-US",{weekday:"long"})}get currentDate(){return new Date().toISOString().split("T")[0]}goBack(){this.router.navigate(["/operation/entries"])}loadDropdowns(){Lo({reps:this.svc.getReps(),agents:this.svc.getAgents(),nationalities:this.svc.getNationalities(),hotels:this.svc.getHotels(),destinations:this.svc.getHotelDestinations(),excursions:this.svc.getExcursions(),suppliers:this.svc.getExcursionSuppliers(),priceLists:this.svc.getPriceLists()}).subscribe({next:n=>{this.reps=n.reps,this.agents=n.agents,this.nationalities=n.nationalities,this.hotels=n.hotels,this.destinations=n.destinations,this.excursions=n.excursions,this.suppliers=n.suppliers,this.priceLists=n.priceLists,this.cdr.detectChanges()},error:n=>console.error("Error loading dropdowns:",n)})}searchTransactions(){this.svc.getEntryTransactions(this.searchTerm||void 0).subscribe({next:n=>{this.transactions=n,this.cdr.detectChanges()},error:n=>console.error("Error searching transactions:",n)})}openAdd(){this.model=this.emptyModel(),this.model.transactionDate=this.currentDate,this.model.revenueDate=this.currentDate,this.model.refundDate=this.currentDate,this.isEdit=!1,this.isModalOpen=!0}openEdit(n){n.entryTransactionId&&this.svc.getEntryTransaction(n.entryTransactionId).subscribe({next:t=>{this.model=Y({},t),this.model.transactionDate&&(this.model.transactionDate=this.model.transactionDate.split("T")[0]),this.model.revenueDate&&(this.model.revenueDate=this.model.revenueDate.split("T")[0]),this.model.refundDate&&(this.model.refundDate=this.model.refundDate.split("T")[0]),this.isEdit=!0,this.isModalOpen=!0,this.cdr.detectChanges()},error:t=>console.error("Error loading transaction for edit:",t)})}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.voucherNumber){alert("\u26A0\uFE0F Please enter a Voucher Number");return}this.saving=!0;let n=Y({},this.model);try{n.transactionDate?n.transactionDate=new Date(n.transactionDate).toISOString():n.transactionDate=null,n.revenueDate?n.revenueDate=new Date(n.revenueDate).toISOString():n.revenueDate=null,n.refundDate?n.refundDate=new Date(n.refundDate).toISOString():n.refundDate=null}catch{this.saving=!1,alert("Invalid date format.");return}this.isEdit&&this.model.entryTransactionId?this.svc.updateEntryTransaction(this.model.entryTransactionId,n).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.searchTransactions()},error:t=>{this.saving=!1,console.error("Update error:",t),alert("Failed to update: "+(t.error?.message||t.message))}}):(n.recordTime=new Date().toISOString(),this.svc.createEntryTransaction(n).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.searchTransactions()},error:t=>{this.saving=!1,console.error("Create error:",t),alert("Failed to create: "+(t.error?.message||t.message))}}))}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.entryTransactionId&&this.svc.deleteEntryTransaction(this.deleteTarget.entryTransactionId).subscribe({next:()=>{this.searchTransactions()},error:n=>{console.error("Delete error:",n),alert("Failed to delete")}}),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}emptyModel(){return{voucherNumber:"",transactionDate:"",repId:void 0,agentId:void 0,nationalityId:void 0,hotelId:void 0,hotelDestinationId:void 0,excursionId:void 0,excursionSupplierId:void 0,priceListId:void 0,paymentType:"Cash",roomNumber:"",pickUpTime:"",note:"",adl:0,chd:0,inf:0,revenueDate:"",revenueRecNo:"",revenueEGP:0,revenueUSD:0,revenueEUR:0,revenueGBP:0,revenueFree:!1,refundDate:"",refundRecNo:"",refundEGP:0,refundUSD:0,refundEUR:0,refundGBP:0,refundFree:!1,discountEGP:0,discountUSD:0,discountEUR:0,discountGBP:0,discountFree:!1,sellingEGP:0,sellingUSD:0,sellingEUR:0,sellingGBP:0,sellingFree:!1,costEGP:0,costUSD:0,costEUR:0,costGBP:0,costFree:!1,active:!0,recordBy:""}}static \u0275fac=function(t){return new(t||e)(j(tt),j(Se),j(ye))};static \u0275cmp=se({type:e,selectors:[["app-entry-transaction"]],standalone:!1,decls:249,vars:75,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search transactions...",3,"ngModelChange","keyup.enter","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","large",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],["type","text",3,"ngModelChange","ngModel"],["type","date",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-group",2,"display","flex","gap","5px"],[2,"flex","1"],["type","text","placeholder","Room",3,"ngModelChange","ngModel"],["type","time",3,"ngModelChange","ngModel"],["type","number","min","0",3,"ngModelChange","ngModel"],[1,"form-group",2,"flex","1"],["type","text","placeholder","Optional notes",2,"width","100%",3,"ngModelChange","ngModel"],[2,"margin","15px 0","border","0","border-top","1px dashed #ccc"],[1,"modal-financial-grid"],[1,"fin-table"],["type","date",1,"cell-input",3,"ngModelChange","ngModel"],["type","text",1,"cell-input",3,"ngModelChange","ngModel"],["type","number","step","0.01",1,"cell-input","num",3,"ngModelChange","ngModel"],[1,"text-center"],["type","checkbox",3,"ngModelChange","ngModel"],["colspan","2"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"num-cell"],[1,"actions-cell"],["title","Edit",1,"action-btn","edit-btn",3,"click"],["title","Delete",1,"action-btn","delete-btn",3,"click"],["colspan","7",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F93F} Entry Transaction"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Transaction"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),E("keyup.enter",function(){return r.searchTransactions()}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Voucher"),s(),c(23,"th"),d(24,"Date"),s(),c(25,"th"),d(26,"Rep Name"),s(),c(27,"th"),d(28,"Excursion Name"),s(),c(29,"th"),d(30,"Pax (A/C/I)"),s(),c(31,"th"),d(32,"Excursion Supplier"),s(),c(33,"th",13),d(34,"Actions"),s()()(),c(35,"tbody"),H(36,YL,21,11,"tr",14)(37,KL,3,0,"tr",15),s()(),c(38,"div",16)(39,"span",17),d(40),s(),le(41,"app-export-buttons",18),s()()(),c(42,"app-modal",19),E("closed",function(){return r.closeModal()}),c(43,"div",20)(44,"div",21)(45,"div",22)(46,"label"),d(47,"Voucher *"),s(),c(48,"input",23),P("ngModelChange",function(i){return S(r.model.voucherNumber,i)||(r.model.voucherNumber=i),i}),s()(),c(49,"div",22)(50,"label"),d(51,"Date *"),s(),c(52,"input",24),P("ngModelChange",function(i){return S(r.model.transactionDate,i)||(r.model.transactionDate=i),i}),s()()(),c(53,"div",21)(54,"div",22)(55,"label"),d(56,"Rep"),s(),c(57,"select",25),P("ngModelChange",function(i){return S(r.model.repId,i)||(r.model.repId=i),i}),c(58,"option",26),d(59,"-"),s(),H(60,ZL,2,2,"option",27),s()(),c(61,"div",22)(62,"label"),d(63,"Agent"),s(),c(64,"select",25),P("ngModelChange",function(i){return S(r.model.agentId,i)||(r.model.agentId=i),i}),c(65,"option",26),d(66,"-"),s(),H(67,QL,2,2,"option",27),s()(),c(68,"div",22)(69,"label"),d(70,"Nationality"),s(),c(71,"select",25),P("ngModelChange",function(i){return S(r.model.nationalityId,i)||(r.model.nationalityId=i),i}),c(72,"option",26),d(73,"-"),s(),H(74,JL,2,2,"option",27),s()()(),c(75,"div",21)(76,"div",22)(77,"label"),d(78,"Hotel"),s(),c(79,"select",25),P("ngModelChange",function(i){return S(r.model.hotelId,i)||(r.model.hotelId=i),i}),c(80,"option",26),d(81,"-"),s(),H(82,eB,2,2,"option",27),s()(),c(83,"div",28)(84,"div",29)(85,"label"),d(86,"Room"),s(),c(87,"input",30),P("ngModelChange",function(i){return S(r.model.roomNumber,i)||(r.model.roomNumber=i),i}),s()(),c(88,"div",29)(89,"label"),d(90,"Pick Up"),s(),c(91,"input",31),P("ngModelChange",function(i){return S(r.model.pickUpTime,i)||(r.model.pickUpTime=i),i}),s()()(),c(92,"div",22)(93,"label"),d(94,"Destination"),s(),c(95,"select",25),P("ngModelChange",function(i){return S(r.model.hotelDestinationId,i)||(r.model.hotelDestinationId=i),i}),c(96,"option",26),d(97,"-"),s(),H(98,tB,2,2,"option",27),s()()(),c(99,"div",21)(100,"div",22)(101,"label"),d(102,"Excursion"),s(),c(103,"select",25),P("ngModelChange",function(i){return S(r.model.excursionId,i)||(r.model.excursionId=i),i}),c(104,"option",26),d(105,"-"),s(),H(106,nB,2,2,"option",27),s()(),c(107,"div",28)(108,"div",29)(109,"label"),d(110,"ADL"),s(),c(111,"input",32),P("ngModelChange",function(i){return S(r.model.adl,i)||(r.model.adl=i),i}),s()(),c(112,"div",29)(113,"label"),d(114,"CHD"),s(),c(115,"input",32),P("ngModelChange",function(i){return S(r.model.chd,i)||(r.model.chd=i),i}),s()(),c(116,"div",29)(117,"label"),d(118,"INF"),s(),c(119,"input",32),P("ngModelChange",function(i){return S(r.model.inf,i)||(r.model.inf=i),i}),s()()()(),c(120,"div",21)(121,"div",22)(122,"label"),d(123,"Supplier"),s(),c(124,"select",25),P("ngModelChange",function(i){return S(r.model.excursionSupplierId,i)||(r.model.excursionSupplierId=i),i}),c(125,"option",26),d(126,"-"),s(),H(127,rB,2,2,"option",27),s()(),c(128,"div",22)(129,"label"),d(130,"Price List"),s(),c(131,"select",25),P("ngModelChange",function(i){return S(r.model.priceListId,i)||(r.model.priceListId=i),i}),c(132,"option",26),d(133,"-"),s(),H(134,oB,2,2,"option",27),s()(),c(135,"div",22)(136,"label"),d(137,"Payment"),s(),c(138,"select",25),P("ngModelChange",function(i){return S(r.model.paymentType,i)||(r.model.paymentType=i),i}),H(139,iB,2,2,"option",27),s()()(),c(140,"div",21)(141,"div",33)(142,"label"),d(143,"Note"),s(),c(144,"input",34),P("ngModelChange",function(i){return S(r.model.note,i)||(r.model.note=i),i}),s()()(),le(145,"hr",35),c(146,"div",36)(147,"table",37)(148,"thead")(149,"tr")(150,"th"),d(151,"Type"),s(),c(152,"th"),d(153,"Date"),s(),c(154,"th"),d(155,"Rec No"),s(),c(156,"th"),d(157,"EGP"),s(),c(158,"th"),d(159,"USD"),s(),c(160,"th"),d(161,"EUR"),s(),c(162,"th"),d(163,"GBP"),s(),c(164,"th"),d(165,"Free"),s()()(),c(166,"tbody")(167,"tr")(168,"td"),d(169,"Revenue"),s(),c(170,"td")(171,"input",38),P("ngModelChange",function(i){return S(r.model.revenueDate,i)||(r.model.revenueDate=i),i}),s()(),c(172,"td")(173,"input",39),P("ngModelChange",function(i){return S(r.model.revenueRecNo,i)||(r.model.revenueRecNo=i),i}),s()(),c(174,"td")(175,"input",40),P("ngModelChange",function(i){return S(r.model.revenueEGP,i)||(r.model.revenueEGP=i),i}),s()(),c(176,"td")(177,"input",40),P("ngModelChange",function(i){return S(r.model.revenueUSD,i)||(r.model.revenueUSD=i),i}),s()(),c(178,"td")(179,"input",40),P("ngModelChange",function(i){return S(r.model.revenueEUR,i)||(r.model.revenueEUR=i),i}),s()(),c(180,"td")(181,"input",40),P("ngModelChange",function(i){return S(r.model.revenueGBP,i)||(r.model.revenueGBP=i),i}),s()(),c(182,"td",41)(183,"input",42),P("ngModelChange",function(i){return S(r.model.revenueFree,i)||(r.model.revenueFree=i),i}),s()()(),c(184,"tr")(185,"td"),d(186,"Refund"),s(),c(187,"td")(188,"input",38),P("ngModelChange",function(i){return S(r.model.refundDate,i)||(r.model.refundDate=i),i}),s()(),c(189,"td")(190,"input",39),P("ngModelChange",function(i){return S(r.model.refundRecNo,i)||(r.model.refundRecNo=i),i}),s()(),c(191,"td")(192,"input",40),P("ngModelChange",function(i){return S(r.model.refundEGP,i)||(r.model.refundEGP=i),i}),s()(),c(193,"td")(194,"input",40),P("ngModelChange",function(i){return S(r.model.refundUSD,i)||(r.model.refundUSD=i),i}),s()(),c(195,"td")(196,"input",40),P("ngModelChange",function(i){return S(r.model.refundEUR,i)||(r.model.refundEUR=i),i}),s()(),c(197,"td")(198,"input",40),P("ngModelChange",function(i){return S(r.model.refundGBP,i)||(r.model.refundGBP=i),i}),s()(),c(199,"td",41)(200,"input",42),P("ngModelChange",function(i){return S(r.model.refundFree,i)||(r.model.refundFree=i),i}),s()()(),c(201,"tr")(202,"td"),d(203,"Discount"),s(),le(204,"td",43),c(205,"td")(206,"input",40),P("ngModelChange",function(i){return S(r.model.discountEGP,i)||(r.model.discountEGP=i),i}),s()(),c(207,"td")(208,"input",40),P("ngModelChange",function(i){return S(r.model.discountUSD,i)||(r.model.discountUSD=i),i}),s()(),c(209,"td")(210,"input",40),P("ngModelChange",function(i){return S(r.model.discountEUR,i)||(r.model.discountEUR=i),i}),s()(),c(211,"td")(212,"input",40),P("ngModelChange",function(i){return S(r.model.discountGBP,i)||(r.model.discountGBP=i),i}),s()(),c(213,"td",41)(214,"input",42),P("ngModelChange",function(i){return S(r.model.discountFree,i)||(r.model.discountFree=i),i}),s()()(),c(215,"tr")(216,"td"),d(217,"Selling"),s(),le(218,"td",43),c(219,"td")(220,"input",40),P("ngModelChange",function(i){return S(r.model.sellingEGP,i)||(r.model.sellingEGP=i),i}),s()(),c(221,"td")(222,"input",40),P("ngModelChange",function(i){return S(r.model.sellingUSD,i)||(r.model.sellingUSD=i),i}),s()(),c(223,"td")(224,"input",40),P("ngModelChange",function(i){return S(r.model.sellingEUR,i)||(r.model.sellingEUR=i),i}),s()(),c(225,"td")(226,"input",40),P("ngModelChange",function(i){return S(r.model.sellingGBP,i)||(r.model.sellingGBP=i),i}),s()(),c(227,"td",41)(228,"input",42),P("ngModelChange",function(i){return S(r.model.sellingFree,i)||(r.model.sellingFree=i),i}),s()()(),c(229,"tr")(230,"td"),d(231,"Cost"),s(),le(232,"td",43),c(233,"td")(234,"input",40),P("ngModelChange",function(i){return S(r.model.costEGP,i)||(r.model.costEGP=i),i}),s()(),c(235,"td")(236,"input",40),P("ngModelChange",function(i){return S(r.model.costUSD,i)||(r.model.costUSD=i),i}),s()(),c(237,"td")(238,"input",40),P("ngModelChange",function(i){return S(r.model.costEUR,i)||(r.model.costEUR=i),i}),s()(),c(239,"td")(240,"input",40),P("ngModelChange",function(i){return S(r.model.costGBP,i)||(r.model.costGBP=i),i}),s()(),c(241,"td",41)(242,"input",42),P("ngModelChange",function(i){return S(r.model.costFree,i)||(r.model.costFree=i),i}),s()()()()()()(),c(243,"div",44)(244,"button",45),E("click",function(){return r.save()}),d(245),s(),c(246,"button",46),E("click",function(){return r.closeModal()}),d(247,"Cancel"),s()()(),c(248,"app-confirm-dialog",47),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.transactions.length," records"),f(8),T("ngModel",r.searchTerm),f(19),_("ngForOf",r.transactions),f(),_("ngIf",r.transactions.length===0),f(3),ue("Showing ",r.transactions.length," records"),f(),_("data",r.transactions),f(),_("title",r.isEdit?"Edit Transaction":"Add New Transaction")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.voucherNumber),f(4),T("ngModel",r.model.transactionDate),f(5),T("ngModel",r.model.repId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.reps),f(4),T("ngModel",r.model.agentId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.agents),f(4),T("ngModel",r.model.nationalityId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.nationalities),f(5),T("ngModel",r.model.hotelId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.hotels),f(5),T("ngModel",r.model.roomNumber),f(4),T("ngModel",r.model.pickUpTime),f(4),T("ngModel",r.model.hotelDestinationId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.destinations),f(5),T("ngModel",r.model.excursionId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.excursions),f(5),T("ngModel",r.model.adl),f(4),T("ngModel",r.model.chd),f(4),T("ngModel",r.model.inf),f(5),T("ngModel",r.model.excursionSupplierId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.suppliers),f(4),T("ngModel",r.model.priceListId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.priceLists),f(4),T("ngModel",r.model.paymentType),f(),_("ngForOf",r.paymentTypes),f(5),T("ngModel",r.model.note),f(27),T("ngModel",r.model.revenueDate),f(2),T("ngModel",r.model.revenueRecNo),f(2),T("ngModel",r.model.revenueEGP),f(2),T("ngModel",r.model.revenueUSD),f(2),T("ngModel",r.model.revenueEUR),f(2),T("ngModel",r.model.revenueGBP),f(2),T("ngModel",r.model.revenueFree),f(5),T("ngModel",r.model.refundDate),f(2),T("ngModel",r.model.refundRecNo),f(2),T("ngModel",r.model.refundEGP),f(2),T("ngModel",r.model.refundUSD),f(2),T("ngModel",r.model.refundEUR),f(2),T("ngModel",r.model.refundGBP),f(2),T("ngModel",r.model.refundFree),f(6),T("ngModel",r.model.discountEGP),f(2),T("ngModel",r.model.discountUSD),f(2),T("ngModel",r.model.discountEUR),f(2),T("ngModel",r.model.discountGBP),f(2),T("ngModel",r.model.discountFree),f(6),T("ngModel",r.model.sellingEGP),f(2),T("ngModel",r.model.sellingUSD),f(2),T("ngModel",r.model.sellingEUR),f(2),T("ngModel",r.model.sellingGBP),f(2),T("ngModel",r.model.sellingFree),f(6),T("ngModel",r.model.costEGP),f(2),T("ngModel",r.model.costUSD),f(2),T("ngModel",r.model.costEUR),f(2),T("ngModel",r.model.costGBP),f(2),T("ngModel",r.model.costFree),f(2),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add Transaction"),f(3),_("isOpen",r.showDeleteConfirm)("itemName","Transaction voucher "+((r.deleteTarget==null?null:r.deleteTarget.voucherNumber)||"")))},dependencies:[Ve,We,je,Oe,Pe,Et,Ot,De,Rn,at,mt,Ne,Ml,ke,rn],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}.modal-financial-grid[_ngcontent-%COMP%]{overflow-x:auto}.modal-financial-grid[_ngcontent-%COMP%]   .fin-table[_ngcontent-%COMP%]{min-width:600px;width:100%;border-collapse:collapse;font-size:12px}.modal-financial-grid[_ngcontent-%COMP%]   .fin-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#e9ecef;padding:6px;text-align:center;border:1px solid #dee2e6;color:#495057;font-weight:600}.modal-financial-grid[_ngcontent-%COMP%]   .fin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:4px;border:1px solid #dee2e6}.modal-financial-grid[_ngcontent-%COMP%]   .fin-table[_ngcontent-%COMP%]   td.row-header[_ngcontent-%COMP%]{background:#e9ecef;font-weight:600;color:var(--dm-primary);text-align:right;padding-right:8px;width:70px}.modal-financial-grid[_ngcontent-%COMP%]   .fin-table[_ngcontent-%COMP%]   .cell-input[_ngcontent-%COMP%]{width:100%;border:1px solid transparent;padding:4px 6px;font-size:12px;box-sizing:border-box;background:transparent;border:1px solid #ced4da;border-radius:2px;background:#fff}.modal-financial-grid[_ngcontent-%COMP%]   .fin-table[_ngcontent-%COMP%]   .cell-input.num[_ngcontent-%COMP%]{text-align:right;font-family:Consolas,Courier New,monospace}.modal-financial-grid[_ngcontent-%COMP%]   .fin-table[_ngcontent-%COMP%]   .cell-input.text-center[_ngcontent-%COMP%]{text-align:center}"]})};function aB(e,n){if(e&1&&(c(0,"option",11),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.excursionName)}}function sB(e,n){if(e&1&&(c(0,"option",11),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.priceListName)}}function cB(e,n){if(e&1&&(c(0,"option",11),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.agentName)}}function lB(e,n){if(e&1&&(c(0,"option",11),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.hotelName)}}function dB(e,n){if(e&1&&(c(0,"option",11),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.nationalityName)}}function uB(e,n){if(e&1&&(c(0,"option",11),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.supplierName)}}function fB(e,n){if(e&1&&(c(0,"option",11),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.boatName)}}function pB(e,n){if(e&1&&(c(0,"option",11),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.supplierName)}}function gB(e,n){e&1&&(c(0,"tr")(1,"td",21),d(2,"Loading data..."),s()())}function mB(e,n){if(e&1&&(c(0,"tr")(1,"td"),d(2),s(),c(3,"td"),d(4),s(),c(5,"td"),d(6),s(),c(7,"td"),d(8),s(),c(9,"td"),d(10),s(),c(11,"td"),d(12),s(),c(13,"td"),d(14),s(),c(15,"td",22),d(16),He(17,"number"),s(),c(18,"td",23),d(19),s(),c(20,"td"),d(21),s(),c(22,"td"),d(23),s(),c(24,"td",22),d(25),He(26,"number"),s(),c(27,"td"),d(28),s(),c(29,"td",23),d(30),s(),c(31,"td",23),d(32),s(),c(33,"td"),d(34),s(),c(35,"td",24),d(36),s(),c(37,"td",24),d(38),s(),c(39,"td",24),d(40),s(),c(41,"td",25),d(42),s()()),e&2){let t=n.$implicit;f(2),M(t.excursionName||"-"),f(2),M(t.agentName||"-"),f(2),M(t.priceListName||"-"),f(2),M(t.hotelName||"-"),f(2),M(t.nationalityName||"-"),f(2),M(t.excursionSupplierName||"-"),f(2),M(t.boatName||"-"),f(2),M($e(17,20,t.costSupplierGBP,"1.2-2")),f(3),M(t.freeSupplierCost||"No"),f(2),M(t.guideName||"-"),f(2),M(t.guideDuty||"-"),f(2),M($e(26,23,t.costGuideEGP,"1.2-2")),f(3),M(t.carTypeName||"-"),f(2),M(t.roundType||"-"),f(2),M(t.orderNumber||"0"),f(2),M(t.transportationSupplierName||"-"),f(2),M(t.adl||0),f(2),M(t.chd||0),f(2),M(t.inf||0),f(2),M((t.adl||0)+(t.chd||0)+(t.inf||0))}}function hB(e,n){e&1&&(c(0,"tr")(1,"td",21),d(2,"No traffic data found for the selected filters"),s()())}function vB(e,n){if(e&1&&(c(0,"div",26)(1,"div",27)(2,"span",28),d(3,"ADL"),s(),c(4,"span",29),d(5),s()(),c(6,"div",27)(7,"span",28),d(8,"CHD"),s(),c(9,"span",29),d(10),s()(),c(11,"div",27)(12,"span",28),d(13,"INF"),s(),c(14,"span",29),d(15),s()(),c(16,"div",30)(17,"span",28),d(18,"Count"),s(),c(19,"span",29),d(20),s()()()),e&2){let t=q();f(5),M(t.totalADL),f(5),M(t.totalCHD),f(5),M(t.totalINF),f(5),M(t.totalCount)}}var Ep=class e{constructor(n,t){this.codeService=n;this.cdr=t}filters={fromDate:"",toDate:"",excursionId:void 0,priceListId:void 0,agentId:void 0,hotelId:void 0,nationalityId:void 0,excursionSupplierId:void 0,boatId:void 0,transportationSupplierId:void 0};excursions=[];priceLists=[];agents=[];hotels=[];nationalities=[];excursionSuppliers=[];boats=[];transportationSuppliers=[];trafficData=[];loading=!1;ngOnInit(){this.setDefaultDates(),this.loadDropdowns(),this.viewTraffic()}setDefaultDates(){let t=new Date().toISOString().split("T")[0];this.filters.fromDate=t,this.filters.toDate=t}loadDropdowns(){this.loading=!0,Lo({excursions:this.codeService.getExcursions(),priceLists:this.codeService.getPriceLists(),agents:this.codeService.getAgents(),hotels:this.codeService.getHotels(),nationalities:this.codeService.getNationalities(),excursionSuppliers:this.codeService.getExcursionSuppliers(),boats:this.codeService.getBoats(),transportationSuppliers:this.codeService.getTransportationSuppliers()}).subscribe({next:n=>{this.excursions=n.excursions,this.priceLists=n.priceLists,this.agents=n.agents,this.hotels=n.hotels,this.nationalities=n.nationalities,this.excursionSuppliers=n.excursionSuppliers,this.boats=n.boats,this.transportationSuppliers=n.transportationSuppliers,this.loading=!1,this.cdr.detectChanges()},error:n=>{console.error("Error loading dropdowns",n),this.loading=!1}})}viewTraffic(){this.loading=!0,this.codeService.getEntryTraffic(this.filters).subscribe({next:n=>{this.trafficData=n||[],this.loading=!1,this.cdr.detectChanges()},error:n=>{console.error("Error fetching traffic data",n),this.loading=!1,this.cdr.detectChanges()}})}clearFilter(){this.filters={fromDate:"",toDate:"",excursionId:void 0,priceListId:void 0,agentId:void 0,hotelId:void 0,nationalityId:void 0,excursionSupplierId:void 0,boatId:void 0,transportationSupplierId:void 0},this.setDefaultDates(),this.trafficData=[],this.cdr.detectChanges()}get totalADL(){return this.trafficData.reduce((n,t)=>n+(t.adl||0),0)}get totalCHD(){return this.trafficData.reduce((n,t)=>n+(t.chd||0),0)}get totalINF(){return this.trafficData.reduce((n,t)=>n+(t.inf||0),0)}get totalCount(){return this.trafficData.reduce((n,t)=>n+((t.adl||0)+(t.chd||0)+(t.inf||0)),0)}static \u0275fac=function(t){return new(t||e)(j(tt),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-entry-traffic"]],standalone:!1,decls:128,vars:33,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"toolbar-right"],[1,"code-table-wrap"],[1,"filters-panel"],[1,"filters-grid"],[1,"filter-item"],["type","date",1,"filter-input",3,"ngModelChange","ngModel"],[1,"filter-select",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"filters-actions"],[1,"btn-filter",3,"click","disabled"],[1,"btn-clear",3,"click","disabled"],[1,"table-scroll-wrap"],[1,"code-table","traffic-table"],[4,"ngIf"],[4,"ngFor","ngForOf"],["class","totals-bar",4,"ngIf"],["colspan","20",1,"empty-row"],[1,"num-cell"],[1,"centered"],[1,"num-cell-center"],[1,"num-cell-center","sum-count"],[1,"totals-bar"],[1,"total-box"],[1,"label"],[1,"value"],[1,"total-box","highlight"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),d(5,"\u{1F6A6} Entry Traffic"),s()(),le(6,"div",4),s(),c(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"label"),d(12,"From Date:"),s(),c(13,"input",9),P("ngModelChange",function(i){return S(r.filters.fromDate,i)||(r.filters.fromDate=i),i}),s()(),c(14,"div",8)(15,"label"),d(16,"To Date:"),s(),c(17,"input",9),P("ngModelChange",function(i){return S(r.filters.toDate,i)||(r.filters.toDate=i),i}),s()(),c(18,"div",8)(19,"label"),d(20,"Excursion:"),s(),c(21,"select",10),P("ngModelChange",function(i){return S(r.filters.excursionId,i)||(r.filters.excursionId=i),i}),c(22,"option",11),d(23,"-- Select --"),s(),H(24,aB,2,2,"option",12),s()(),c(25,"div",8)(26,"label"),d(27,"Price List:"),s(),c(28,"select",10),P("ngModelChange",function(i){return S(r.filters.priceListId,i)||(r.filters.priceListId=i),i}),c(29,"option",11),d(30,"-- Select --"),s(),H(31,sB,2,2,"option",12),s()(),c(32,"div",8)(33,"label"),d(34,"Agent:"),s(),c(35,"select",10),P("ngModelChange",function(i){return S(r.filters.agentId,i)||(r.filters.agentId=i),i}),c(36,"option",11),d(37,"-- Select --"),s(),H(38,cB,2,2,"option",12),s()(),c(39,"div",8)(40,"label"),d(41,"Hotel Name:"),s(),c(42,"select",10),P("ngModelChange",function(i){return S(r.filters.hotelId,i)||(r.filters.hotelId=i),i}),c(43,"option",11),d(44,"-- Select --"),s(),H(45,lB,2,2,"option",12),s()(),c(46,"div",8)(47,"label"),d(48,"Nationality:"),s(),c(49,"select",10),P("ngModelChange",function(i){return S(r.filters.nationalityId,i)||(r.filters.nationalityId=i),i}),c(50,"option",11),d(51,"-- Select --"),s(),H(52,dB,2,2,"option",12),s()(),c(53,"div",8)(54,"label"),d(55,"Excursion Supplier:"),s(),c(56,"select",10),P("ngModelChange",function(i){return S(r.filters.excursionSupplierId,i)||(r.filters.excursionSupplierId=i),i}),c(57,"option",11),d(58,"-- Select --"),s(),H(59,uB,2,2,"option",12),s()(),c(60,"div",8)(61,"label"),d(62,"Boat:"),s(),c(63,"select",10),P("ngModelChange",function(i){return S(r.filters.boatId,i)||(r.filters.boatId=i),i}),c(64,"option",11),d(65,"-- Select --"),s(),H(66,fB,2,2,"option",12),s()(),c(67,"div",8)(68,"label"),d(69,"Trans. Supplier:"),s(),c(70,"select",10),P("ngModelChange",function(i){return S(r.filters.transportationSupplierId,i)||(r.filters.transportationSupplierId=i),i}),c(71,"option",11),d(72,"-- Select --"),s(),H(73,pB,2,2,"option",12),s()()(),c(74,"div",13)(75,"button",14),E("click",function(){return r.viewTraffic()}),d(76),s(),c(77,"button",15),E("click",function(){return r.clearFilter()}),d(78," \u2715 Clear Filter "),s()()(),c(79,"div",16)(80,"table",17)(81,"thead")(82,"tr")(83,"th"),d(84,"Excursion Name"),s(),c(85,"th"),d(86,"Agent Name"),s(),c(87,"th"),d(88,"Price List"),s(),c(89,"th"),d(90,"Hotel Name"),s(),c(91,"th"),d(92,"Nationality"),s(),c(93,"th"),d(94,"Excursion Suppl."),s(),c(95,"th"),d(96,"Boat"),s(),c(97,"th"),d(98,"Cost Suppl GBP"),s(),c(99,"th"),d(100,"Free Cost"),s(),c(101,"th"),d(102,"Guide Name"),s(),c(103,"th"),d(104,"Guide Duty"),s(),c(105,"th"),d(106,"Cost Guide EGP"),s(),c(107,"th"),d(108,"Car Type"),s(),c(109,"th"),d(110,"Round"),s(),c(111,"th"),d(112,"Order No"),s(),c(113,"th"),d(114,"Trans. Suppl."),s(),c(115,"th"),d(116,"ADL"),s(),c(117,"th"),d(118,"CHD"),s(),c(119,"th"),d(120,"INF"),s(),c(121,"th"),d(122,"Count"),s()()(),c(123,"tbody"),H(124,gB,3,0,"tr",18)(125,mB,43,26,"tr",19)(126,hB,3,0,"tr",18),s()()(),H(127,vB,21,4,"div",20),s()()()),t&2&&(f(13),T("ngModel",r.filters.fromDate),f(4),T("ngModel",r.filters.toDate),f(4),T("ngModel",r.filters.excursionId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.excursions),f(4),T("ngModel",r.filters.priceListId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.priceLists),f(4),T("ngModel",r.filters.agentId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.agents),f(4),T("ngModel",r.filters.hotelId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.hotels),f(4),T("ngModel",r.filters.nationalityId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.nationalities),f(4),T("ngModel",r.filters.excursionSupplierId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.excursionSuppliers),f(4),T("ngModel",r.filters.boatId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.boats),f(4),T("ngModel",r.filters.transportationSupplierId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.transportationSuppliers),f(2),_("disabled",r.loading),f(),ue(" ",r.loading?"\u23F3 Loading...":"\u{1F50D} View"," "),f(),_("disabled",r.loading),f(47),_("ngIf",r.loading),f(),_("ngForOf",r.trafficData),f(),_("ngIf",!r.loading&&r.trafficData.length===0),f(),_("ngIf",r.trafficData.length>0))},dependencies:[Oe,Pe,Et,Ot,De,mt,Ne,ke,fa],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}.table-scroll-wrap[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch;margin-top:15px}.filters-panel[_ngcontent-%COMP%]{background:var(--dm-hover);padding:16px;border-radius:var(--dm-radius-md);margin-bottom:20px;border:1px solid var(--dm-border)}.filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:15px;margin-bottom:20px}.filter-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.filter-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:var(--dm-text)}.filter-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:13px;outline:none;background:var(--dm-surface);font-family:inherit;color:var(--dm-text);width:100%;transition:border-color .2s,box-shadow .2s}.filter-input[_ngcontent-%COMP%]:focus, .filter-select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.filters-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;border-top:1px solid var(--dm-border);padding-top:15px}.btn-filter[_ngcontent-%COMP%], .btn-clear[_ngcontent-%COMP%]{padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit;min-width:100px}.btn-filter[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border:none}.btn-filter[_ngcontent-%COMP%]:hover:not([disabled]){box-shadow:0 2px 8px #0f346040}.btn-filter[disabled][_ngcontent-%COMP%]{opacity:.7;cursor:not-allowed}.btn-clear[_ngcontent-%COMP%]{background:transparent;color:var(--dm-highlight);border:1px solid var(--dm-highlight)}.btn-clear[_ngcontent-%COMP%]:hover:not([disabled]){background:#e945600d}.btn-clear[disabled][_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed;border-color:var(--dm-border)}.traffic-table[_ngcontent-%COMP%]{font-size:12px;width:max-content;min-width:100%}.traffic-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .traffic-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 12px;white-space:nowrap}.num-cell[_ngcontent-%COMP%]{text-align:right;font-family:Consolas,Courier New,monospace}.num-cell-center[_ngcontent-%COMP%]{text-align:center;font-family:Consolas,Courier New,monospace}.centered[_ngcontent-%COMP%]{text-align:center}.sum-count[_ngcontent-%COMP%]{font-weight:700;background:#00000005}.totals-bar[_ngcontent-%COMP%]{display:flex;gap:15px;margin-top:20px;background:var(--dm-surface);padding:15px;border-radius:var(--dm-radius-sm);border:1px solid var(--dm-border)}.totals-bar[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:8px 16px;background:var(--dm-hover);border:1px solid var(--dm-border);border-radius:4px;min-width:80px}.totals-bar[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:11px;color:var(--dm-text-muted);text-transform:uppercase;margin-bottom:4px;font-weight:700}.totals-bar[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:var(--dm-text);font-family:Consolas,Courier New,monospace}.totals-bar[_ngcontent-%COMP%]   .total-box.highlight[_ngcontent-%COMP%]{background:#0f34600d;border-color:var(--dm-accent)}.totals-bar[_ngcontent-%COMP%]   .total-box.highlight[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .totals-bar[_ngcontent-%COMP%]   .total-box.highlight[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--dm-accent)}"]})};var Op=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-entry-revenue"]],standalone:!1,decls:5,vars:0,consts:[[1,"entry-placeholder"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"h2"),d(2,"\u{1F4B0} Revenue"),s(),c(3,"p"),d(4,"Revenue entry \u2014 coming soon"),s()())},styles:[".entry-placeholder[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.entry-placeholder[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#1e3c72;margin-bottom:8px}.entry-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7a8599;font-size:14px}"]})};var Tp=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-entry-guide-allowance"]],standalone:!1,decls:5,vars:0,consts:[[1,"entry-placeholder"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"h2"),d(2,"\u{1F464} Guide Allowance"),s(),c(3,"p"),d(4,"Guide allowance entry \u2014 coming soon"),s()())},styles:[".entry-placeholder[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.entry-placeholder[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#1e3c72;margin-bottom:8px}.entry-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7a8599;font-size:14px}"]})};var Pp=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-entry-rep-commission"]],standalone:!1,decls:5,vars:0,consts:[[1,"entry-placeholder"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"h2"),d(2,"\u{1F4DD} Rep Commission"),s(),c(3,"p"),d(4,"Rep commission entry \u2014 coming soon"),s()())},styles:[".entry-placeholder[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.entry-placeholder[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#1e3c72;margin-bottom:8px}.entry-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7a8599;font-size:14px}"]})};var Sp=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-entry-boat-coast"]],standalone:!1,decls:5,vars:0,consts:[[1,"entry-placeholder"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"h2"),d(2,"\u{1F6A2} Boat Coast"),s(),c(3,"p"),d(4,"Boat coast entry \u2014 coming soon"),s()())},styles:[".entry-placeholder[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.entry-placeholder[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#1e3c72;margin-bottom:8px}.entry-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7a8599;font-size:14px}"]})};function xB(e,n){if(e&1&&(c(0,"div",3)(1,"div",4),d(2),s(),c(3,"div",5),d(4),s()()),e&2){let t=n.$implicit;nn("background",t.gradient),f(2),M(t.value),f(2),M(t.label)}}var Hl=class e{stats=[{label:"Occupancy Rate",value:"85%",gradient:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"},{label:"Monthly Revenue",value:"$12,450",gradient:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)"},{label:"Total Dives",value:"156",gradient:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)"}];static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-reports"]],standalone:!1,decls:7,vars:1,consts:[[1,"page-section"],[1,"stats-container"],["class","stat-card",3,"background",4,"ngFor","ngForOf"],[1,"stat-card"],[1,"stat-number"],[1,"stat-label"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"h2"),d(2,"\u{1F4CA} Reports & Analytics"),s(),c(3,"p"),d(4,"Comprehensive reports about center performance"),s(),c(5,"div",1),H(6,xB,5,4,"div",2),s()()),t&2&&(f(6),_("ngForOf",r.stats))},dependencies:[Oe],styles:[".page-section[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);padding:48px 36px;text-align:center;box-shadow:var(--dm-shadow);max-width:900px;margin:40px auto;position:relative;z-index:1}.page-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--dm-primary);font-size:28px;margin-bottom:10px;font-weight:700}.page-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-size:15px;line-height:1.6}.stats-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:16px;margin-top:32px}.stat-card[_ngcontent-%COMP%]{padding:24px 18px;border-radius:var(--dm-radius);color:#fff;text-align:center;transition:transform .2s ease;box-shadow:var(--dm-shadow-md)}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}.stat-number[_ngcontent-%COMP%]{font-size:32px;font-weight:700;margin-bottom:6px;letter-spacing:-.5px}.stat-label[_ngcontent-%COMP%]{font-size:13px;opacity:.9;font-weight:500}@media(max-width:768px){.page-section[_ngcontent-%COMP%]{padding:32px 24px;margin:20px auto}.page-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px}.page-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}}"]})};function _B(e,n){if(e&1&&(c(0,"span",23),d(1),s()),e&2){let t=q().$implicit;f(),ue("",t.count," records")}}function CB(e,n){if(e&1){let t=be();c(0,"div",14),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openCode(o))}),le(1,"div",15),c(2,"div",16)(3,"div",17)(4,"span",18),d(5),s()(),c(6,"div",19)(7,"h3"),d(8),s(),c(9,"p"),d(10),s()(),c(11,"div",20),H(12,_B,2,1,"span",21),c(13,"span",22),d(14,"\u2192"),s()()()()}if(e&2){let t=n.$implicit;f(),nn("background",t.gradient),f(2),nn("background",t.gradient),f(2),M(t.icon),f(3),M(t.label),f(2),M(t.desc),f(2),_("ngIf",t.count>0)}}function bB(e,n){e&1&&(c(0,"div",24)(1,"span",25),d(2,"\u23F3"),s(),c(3,"h3"),d(4,"Loading codes..."),s(),c(5,"p"),d(6,"Please wait while we fetch the required data"),s()())}function yB(e,n){e&1&&(c(0,"div",26)(1,"span",27),d(2,"\u{1F50D}"),s(),c(3,"h3"),d(4,"No codes found"),s(),c(5,"p"),d(6,"Try adjusting your search term"),s()())}var Dp=class e{constructor(n,t,r){this.router=n;this.svc=t;this.cdr=r}searchTerm="";codes=[];isLoading=!0;codeMetadata={agents:{icon:"\u{1F3E2}",desc:"Manage travel agents & contacts",gradient:"linear-gradient(135deg, #667eea, #764ba2)",route:"/operation/codes/agent"},boats:{icon:"\u{1F6A2}",desc:"Boats, capacity & availability",gradient:"linear-gradient(135deg, #43e97b, #38f9d7)",route:"/operation/codes/boat"},excursions:{icon:"\u{1F3D6}\uFE0F",desc:"Excursion packages & details",gradient:"linear-gradient(135deg, #fa709a, #fee140)",route:"/operation/codes/excursion"},excursionsuppliers:{icon:"\u{1F91D}",desc:"Suppliers for excursion services",gradient:"linear-gradient(135deg, #a18cd1, #fbc2eb)",route:"/operation/codes/excursion-supplier"},excursioncostsellings:{icon:"\u{1F4B0}",desc:"Excursion cost & selling prices",gradient:"linear-gradient(135deg, #f6d365, #fda085)",route:"/operation/codes/excursion-cost-selling"},reps:{icon:"\u{1F468}\u200D\u{1F4BC}",desc:"Sales representatives",gradient:"linear-gradient(135deg, #f093fb, #f5576c)",route:"/operation/codes/rep"},guides:{icon:"\u{1F464}",desc:"Tour guides & contact info",gradient:"linear-gradient(135deg, #ffecd2, #fcb69f)",route:"/operation/codes/guide"},hotels:{icon:"\u{1F3E8}",desc:"Hotel listings & destinations",gradient:"linear-gradient(135deg, #a1c4fd, #c2e9fb)",route:"/operation/codes/hotel"},hoteldestinations:{icon:"\u{1F4CD}",desc:"Destination areas for hotels",gradient:"linear-gradient(135deg, #d4fc79, #96e6a1)",route:"/operation/codes/hotel-destination"},nationalities:{icon:"\u{1F30D}",desc:"Customer nationality codes",gradient:"linear-gradient(135deg, #84fab0, #8fd3f4)",route:"/operation/codes/nationality"},pricelists:{icon:"\u{1F4B2}",desc:"Pricing configurations",gradient:"linear-gradient(135deg, #fccb90, #d57eeb)",route:"/operation/codes/price-list"},rates:{icon:"\u{1F4B1}",desc:"Currency exchange rates",gradient:"linear-gradient(135deg, #e0c3fc, #8ec5fc)",route:"/operation/codes/rate"},transportationtypes:{icon:"\u{1F697}",desc:"Vehicle types & categories",gradient:"linear-gradient(135deg, #4facfe, #00f2fe)",route:"/operation/codes/transportation-type"},transportationsuppliers:{icon:"\u{1F3D7}\uFE0F",desc:"Transportation service providers",gradient:"linear-gradient(135deg, #43e97b, #38f9d7)",route:"/operation/codes/transportation-supplier"},transportationcosts:{icon:"\u{1F4B5}",desc:"Cost per route & vehicle",gradient:"linear-gradient(135deg, #fa709a, #fee140)",route:"/operation/codes/transportation-cost"},repvouchers:{icon:"\u{1F3AB}",desc:"Voucher numbers & tracking",gradient:"linear-gradient(135deg, #a18cd1, #fbc2eb)",route:"/operation/codes/voucher"}};ngOnInit(){this.svc.getCodes().subscribe({next:n=>{this.codes=n.map(t=>{let r=this.codeMetadata[t.key]||{icon:"\u{1F4CB}",desc:t.displayName,gradient:"linear-gradient(135deg, #667eea, #764ba2)",route:`/operation/codes/${t.key}`};return{key:t.key,label:t.displayName.replace("Code ",""),route:r.route,icon:r.icon,desc:r.desc,gradient:r.gradient,count:0}}),this.isLoading=!1,this.cdr.detectChanges()},error:n=>{console.error("Error fetching codes",n),this.isLoading=!1,this.cdr.detectChanges()}})}get filteredCodes(){if(!this.searchTerm)return this.codes;let n=this.searchTerm.toLowerCase();return this.codes.filter(t=>t.label.toLowerCase().includes(n)||t.desc.toLowerCase().includes(n))}openCode(n){this.router.navigate([n.route])}static \u0275fac=function(t){return new(t||e)(j(ye),j(tt),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-codes-list"]],standalone:!1,decls:26,vars:6,consts:[[1,"codes-page"],[1,"page-header"],[1,"header-content"],[1,"header-search"],[1,"search-icon"],["type","text","placeholder","Search codes...",3,"ngModelChange","ngModel"],[1,"summary-bar"],[1,"summary-stat"],[1,"stat-val"],[1,"stat-lbl"],[1,"cards-grid"],["class","card-item",3,"click",4,"ngFor","ngForOf"],["class","empty-state","style","text-align: center; padding: 40px;",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"card-item",3,"click"],[1,"card-accent"],[1,"card-body"],[1,"card-icon-wrap"],[1,"card-icon"],[1,"card-info"],[1,"card-meta"],["class","record-badge",4,"ngIf"],[1,"arrow-circle"],[1,"record-badge"],[1,"empty-state",2,"text-align","center","padding","40px"],[1,"empty-icon",2,"animation","pulse 1.5s infinite"],[1,"empty-state"],[1,"empty-icon"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),d(4,"\u{1F3F7}\uFE0F System Codes"),s(),c(5,"p"),d(6,"Manage all system codes and configuration tables"),s()(),c(7,"div",3)(8,"span",4),d(9,"\u{1F50D}"),s(),c(10,"input",5),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()()(),c(11,"div",6)(12,"div",7)(13,"span",8),d(14),s(),c(15,"span",9),d(16,"Total Code Types"),s()(),c(17,"div",7)(18,"span",8),d(19),s(),c(20,"span",9),d(21,"Showing"),s()()(),c(22,"div",10),H(23,CB,15,8,"div",11),s(),H(24,bB,7,0,"div",12)(25,yB,7,0,"div",13),s()),t&2&&(f(10),T("ngModel",r.searchTerm),f(4),M(r.codes.length),f(5),M(r.filteredCodes.length),f(4),_("ngForOf",r.filteredCodes),f(),_("ngIf",r.isLoading),f(),_("ngIf",!r.isLoading&&r.filteredCodes.length===0))},dependencies:[Oe,Pe,De,Ne,ke],styles:[".page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:20px;flex-wrap:wrap;gap:14px}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:var(--dm-primary);margin:0 0 4px;letter-spacing:-.3px}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-size:14px;margin:0}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]{position:relative}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:10px 16px 10px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;width:260px;outline:none;background:var(--dm-surface);box-shadow:var(--dm-shadow);font-family:inherit;color:var(--dm-text);transition:border-color .2s,box-shadow .2s,width .2s}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014;width:300px}.summary-bar[_ngcontent-%COMP%]{display:flex;gap:14px;margin-bottom:20px;flex-wrap:wrap}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]{background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);padding:10px 18px;display:flex;align-items:center;gap:10px;box-shadow:var(--dm-shadow)}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-val[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:var(--dm-primary)}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-lbl[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.cards-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px}.card-item[_ngcontent-%COMP%]{display:block;position:relative;background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius);text-decoration:none;color:inherit;overflow:hidden;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease,border-color .2s ease;box-shadow:var(--dm-shadow)}.card-item[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:var(--dm-shadow-md);border-color:var(--dm-accent)}.card-item[_ngcontent-%COMP%]:hover   .arrow-circle[_ngcontent-%COMP%]{background:var(--dm-primary);color:#fff}.card-item[_ngcontent-%COMP%]:hover   .card-accent[_ngcontent-%COMP%]{height:4px}.card-item[_ngcontent-%COMP%]:hover   .card-icon-wrap[_ngcontent-%COMP%]{transform:scale(1.05)}.card-item[_ngcontent-%COMP%]   .card-accent[_ngcontent-%COMP%]{height:3px;transition:height .2s}.card-item[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;align-items:center;gap:14px;padding:16px 18px}.card-item[_ngcontent-%COMP%]   .card-icon-wrap[_ngcontent-%COMP%]{width:46px;height:46px;border-radius:var(--dm-radius-sm);display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:var(--dm-shadow);transition:transform .2s ease}.card-item[_ngcontent-%COMP%]   .card-icon-wrap[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{font-size:22px}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]{flex:1;min-width:0}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--dm-text);margin:0 0 2px;letter-spacing:-.2px}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;color:var(--dm-text-muted);margin:0;line-height:1.3;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.card-item[_ngcontent-%COMP%]   .card-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:6px;flex-shrink:0}.card-item[_ngcontent-%COMP%]   .record-badge[_ngcontent-%COMP%]{background:#10b98114;color:#059669;padding:2px 10px;border-radius:20px;font-size:11px;font-weight:600;white-space:nowrap}.card-item[_ngcontent-%COMP%]   .arrow-circle[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:50%;background:var(--dm-hover);display:flex;align-items:center;justify-content:center;font-size:13px;color:var(--dm-text-muted);transition:all .2s}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:56px 20px;background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius);margin-top:16px;box-shadow:var(--dm-shadow)}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:44px;display:block;margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--dm-primary);font-size:17px;margin:0 0 4px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-size:14px;margin:0}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:3.5rem 2rem;color:var(--dm-text-muted);text-align:center}.loading-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:38px;height:38px;border:3px solid rgba(15,52,96,.1);border-top:3px solid var(--dm-accent);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;font-weight:500}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:3.5rem 2rem;text-align:center}.error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:44px;margin-bottom:.75rem;opacity:.7}.error-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--dm-highlight);font-size:18px;font-weight:600;margin-bottom:.5rem}.error-container[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:var(--dm-text-muted);margin-bottom:1.5rem;font-size:14px}.error-container[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border:none;padding:.65rem 1.25rem;border-radius:var(--dm-radius-sm);cursor:pointer;font-weight:600;font-size:14px;transition:box-shadow .2s}.error-container[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]:hover{box-shadow:var(--dm-shadow-md)}@media(max-width:768px){.cards-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{width:100%}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]{flex:1;min-width:100px}}.codes-page[_ngcontent-%COMP%]{position:relative;z-index:1}"]})};function MB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td"),d(2),s(),c(3,"td")(4,"strong"),d(5),s()(),c(6,"td"),d(7),s(),c(8,"td"),d(9),s(),c(10,"td"),d(11),s(),c(12,"td")(13,"div",35)(14,"button",36),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(15,"\u270F\uFE0F"),s(),c(16,"button",37),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(17,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(2),M(t.agentCode),f(3),M(t.agentName),f(2),M(t.nationality),f(2),M(t.email),f(2),M(t.phone)}}function wB(e,n){e&1&&(c(0,"tr")(1,"td",38),d(2,"No agents found"),s()())}var kp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];saving=!1;model={agentName:""};isModalOpen=!1;isEdit=!1;searchTerm="";showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getAgents().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.agentName||"").toLowerCase().includes(n)||(t.nationality||"").toLowerCase().includes(n)||(t.agentCode||"").toLowerCase().includes(n))}openAdd(){this.model={agentName:""},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.agentName){alert("\u26A0\uFE0F Please fill in Agent Name");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateAgent(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createAgent(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteAgent(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-agent"]],standalone:!1,decls:84,vars:21,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search agents...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","medium",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],["type","text","placeholder","Enter code",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter agent name",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter nationality",3,"ngModelChange","ngModel"],["type","email","placeholder","Enter email",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter VAT number",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter file number",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter address",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter phone",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","6",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F3E2} Code Agent"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Agent"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Code"),s(),c(23,"th"),d(24,"Agent Name"),s(),c(25,"th"),d(26,"Nationality"),s(),c(27,"th"),d(28,"Email"),s(),c(29,"th"),d(30,"Phone"),s(),c(31,"th",13),d(32,"Actions"),s()()(),c(33,"tbody"),H(34,MB,18,5,"tr",14)(35,wB,3,0,"tr",15),s()(),c(36,"div",16)(37,"span",17),d(38),s(),le(39,"app-export-buttons",18),s()()(),c(40,"app-modal",19),E("closed",function(){return r.closeModal()}),c(41,"div",20)(42,"div",21)(43,"div",22)(44,"label"),d(45,"Agent Code"),s(),c(46,"input",23),P("ngModelChange",function(i){return S(r.model.agentCode,i)||(r.model.agentCode=i),i}),s()(),c(47,"div",22)(48,"label"),d(49,"Agent Name *"),s(),c(50,"input",24),P("ngModelChange",function(i){return S(r.model.agentName,i)||(r.model.agentName=i),i}),s()()(),c(51,"div",21)(52,"div",22)(53,"label"),d(54,"Nationality"),s(),c(55,"input",25),P("ngModelChange",function(i){return S(r.model.nationality,i)||(r.model.nationality=i),i}),s()(),c(56,"div",22)(57,"label"),d(58,"E-Mail"),s(),c(59,"input",26),P("ngModelChange",function(i){return S(r.model.email,i)||(r.model.email=i),i}),s()()(),c(60,"div",21)(61,"div",22)(62,"label"),d(63,"Vat No"),s(),c(64,"input",27),P("ngModelChange",function(i){return S(r.model.vatNo,i)||(r.model.vatNo=i),i}),s()(),c(65,"div",22)(66,"label"),d(67,"File No"),s(),c(68,"input",28),P("ngModelChange",function(i){return S(r.model.fileNo,i)||(r.model.fileNo=i),i}),s()()(),c(69,"div",21)(70,"div",22)(71,"label"),d(72,"Address"),s(),c(73,"input",29),P("ngModelChange",function(i){return S(r.model.address,i)||(r.model.address=i),i}),s()(),c(74,"div",22)(75,"label"),d(76,"Phone"),s(),c(77,"input",30),P("ngModelChange",function(i){return S(r.model.phone,i)||(r.model.phone=i),i}),s()()()(),c(78,"div",31)(79,"button",32),E("click",function(){return r.save()}),d(80),s(),c(81,"button",33),E("click",function(){return r.closeModal()}),d(82,"Cancel"),s()()(),c(83,"app-confirm-dialog",34),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(17),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Agent":"Add New Agent")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.agentCode),f(4),T("ngModel",r.model.agentName),f(5),T("ngModel",r.model.nationality),f(4),T("ngModel",r.model.email),f(5),T("ngModel",r.model.vatNo),f(4),T("ngModel",r.model.fileNo),f(5),T("ngModel",r.model.address),f(4),T("ngModel",r.model.phone),f(2),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update Agent":"\uFF0B Add Agent"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.agentName)||""))},dependencies:[Ve,We,je,Oe,Pe,De,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function EB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td")(5,"span"),d(6),s()(),c(7,"td")(8,"div",29)(9,"button",30),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(10,"\u270F\uFE0F"),s(),c(11,"button",31),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(12,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.boatName),f(2),st(t.isActive?"status-active":"status-inactive"),f(),M(t.isActive?"Active":"Inactive")}}function OB(e,n){e&1&&(c(0,"tr")(1,"td",32),d(2,"No boats found"),s()())}var Ip=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={boatName:"",isActive:!0};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getBoats().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.boatName||"").toLowerCase().includes(n))}openAdd(){this.model={boatName:"",isActive:!0},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.boatName){alert("\u26A0\uFE0F Boat Name is required");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateBoat(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createBoat(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteBoat(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-boat"]],standalone:!1,decls:50,vars:15,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search boats...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],["type","text","placeholder","Enter boat name",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","3",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F6A2} Code Boat"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Boat"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Boat Name"),s(),c(23,"th"),d(24,"Status"),s(),c(25,"th",13),d(26,"Actions"),s()()(),c(27,"tbody"),H(28,EB,13,4,"tr",14)(29,OB,3,0,"tr",15),s()(),c(30,"div",16)(31,"span",17),d(32),s(),le(33,"app-export-buttons",18),s()()(),c(34,"app-modal",19),E("closed",function(){return r.closeModal()}),c(35,"div",20)(36,"div",21)(37,"label"),d(38,"Boat Name *"),s(),c(39,"input",22),P("ngModelChange",function(i){return S(r.model.boatName,i)||(r.model.boatName=i),i}),s()(),c(40,"div",21)(41,"label",23)(42,"input",24),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(43," Active"),s()()(),c(44,"div",25)(45,"button",26),E("click",function(){return r.save()}),d(46),s(),c(47,"button",27),E("click",function(){return r.closeModal()}),d(48,"Cancel"),s()()(),c(49,"app-confirm-dialog",28),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(11),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Boat":"Add New Boat")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.boatName),f(3),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.boatName)||""))},dependencies:[Ve,We,je,Oe,Pe,De,at,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function TB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td")(7,"span"),d(8),s()(),c(9,"td")(10,"div",32)(11,"button",33),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(12,"\u270F\uFE0F"),s(),c(13,"button",34),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(14,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.excursionName),f(2),M(t.supplierName),f(2),st(t.isActive?"status-active":"status-inactive"),f(),M(t.isActive?"Active":"Inactive")}}function PB(e,n){e&1&&(c(0,"tr")(1,"td",35),d(2,"No excursions found"),s()())}function SB(e,n){if(e&1&&(c(0,"option",24),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.supplierName)}}var Ap=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={excursionName:"",isActive:!1};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;suppliers=[];showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData(),this.svc.getExcursionSuppliers().subscribe(n=>{this.suppliers=n,this.cdr.detectChanges()})}loadData(){this.svc.getExcursions().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.excursionName||"").toLowerCase().includes(n)||(t.supplierName||"").toLowerCase().includes(n))}openAdd(){this.model={excursionName:"",isActive:!1},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.excursionName){alert("\u26A0\uFE0F Required");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateExcursion(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createExcursion(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteExcursion(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-excursion"]],standalone:!1,decls:59,vars:18,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search excursions...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],["type","text","placeholder","Enter name",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","4",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F3D6}\uFE0F Code Excursion"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Excursion"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Excursion Name"),s(),c(23,"th"),d(24,"Supplier"),s(),c(25,"th"),d(26,"Status"),s(),c(27,"th",13),d(28,"Actions"),s()()(),c(29,"tbody"),H(30,TB,15,5,"tr",14)(31,PB,3,0,"tr",15),s()(),c(32,"div",16)(33,"span",17),d(34),s(),le(35,"app-export-buttons",18),s()()(),c(36,"app-modal",19),E("closed",function(){return r.closeModal()}),c(37,"div",20)(38,"div",21)(39,"label"),d(40,"Excursion Name *"),s(),c(41,"input",22),P("ngModelChange",function(i){return S(r.model.excursionName,i)||(r.model.excursionName=i),i}),s()(),c(42,"div",21)(43,"label"),d(44,"Supplier"),s(),c(45,"select",23),P("ngModelChange",function(i){return S(r.model.supplierId,i)||(r.model.supplierId=i),i}),c(46,"option",24),d(47,"Select..."),s(),H(48,SB,2,2,"option",25),s()(),c(49,"div",21)(50,"label",26)(51,"input",27),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(52," Active"),s()()(),c(53,"div",28)(54,"button",29),E("click",function(){return r.save()}),d(55),s(),c(56,"button",30),E("click",function(){return r.closeModal()}),d(57,"Cancel"),s()()(),c(58,"app-confirm-dialog",31),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(13),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Excursion":"Add New Excursion")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.excursionName),f(4),T("ngModel",r.model.supplierId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.suppliers),f(3),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.excursionName)||""))},dependencies:[Ve,We,je,Oe,Pe,Et,Ot,De,at,mt,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function DB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td"),d(7),s(),c(8,"td")(9,"span"),d(10),s()(),c(11,"td")(12,"div",34)(13,"button",35),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(14,"\u270F\uFE0F"),s(),c(15,"button",36),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(16,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.supplierName),f(2),M(t.email),f(2),M(t.phone),f(2),st(t.isActive?"status-active":"status-inactive"),f(),M(t.isActive?"Active":"Inactive")}}function kB(e,n){e&1&&(c(0,"tr")(1,"td",37),d(2,"No suppliers found"),s()())}var Np=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={supplierName:"",vatNo:"",fileNo:"",email:"",address:"",phone:"",isActive:!1};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getExcursionSuppliers().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.supplierName||"").toLowerCase().includes(n))}openAdd(){this.model={supplierName:"",vatNo:"",fileNo:"",email:"",address:"",phone:"",isActive:!1},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.supplierName){alert("\u26A0\uFE0F Required");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateExcursionSupplier(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createExcursionSupplier(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteExcursionSupplier(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-excursion-supplier"]],standalone:!1,decls:74,vars:20,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search suppliers...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","medium",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],["type","text","placeholder","Enter name",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter VAT number",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter file number",3,"ngModelChange","ngModel"],["type","email","placeholder","Enter email",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter address",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter phone",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","5",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F91D} Code Excursion Supplier"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Supplier"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Supplier Name"),s(),c(23,"th"),d(24,"Email"),s(),c(25,"th"),d(26,"Phone"),s(),c(27,"th"),d(28,"Status"),s(),c(29,"th",13),d(30,"Actions"),s()()(),c(31,"tbody"),H(32,DB,17,6,"tr",14)(33,kB,3,0,"tr",15),s()(),c(34,"div",16)(35,"span",17),d(36),s(),le(37,"app-export-buttons",18),s()()(),c(38,"app-modal",19),E("closed",function(){return r.closeModal()}),c(39,"div",20)(40,"div",21)(41,"label"),d(42,"Supplier Name *"),s(),c(43,"input",22),P("ngModelChange",function(i){return S(r.model.supplierName,i)||(r.model.supplierName=i),i}),s()(),c(44,"div",21)(45,"label"),d(46,"VAT No"),s(),c(47,"input",23),P("ngModelChange",function(i){return S(r.model.vatNo,i)||(r.model.vatNo=i),i}),s()(),c(48,"div",21)(49,"label"),d(50,"File No"),s(),c(51,"input",24),P("ngModelChange",function(i){return S(r.model.fileNo,i)||(r.model.fileNo=i),i}),s()(),c(52,"div",21)(53,"label"),d(54,"Email"),s(),c(55,"input",25),P("ngModelChange",function(i){return S(r.model.email,i)||(r.model.email=i),i}),s()(),c(56,"div",21)(57,"label"),d(58,"Address"),s(),c(59,"input",26),P("ngModelChange",function(i){return S(r.model.address,i)||(r.model.address=i),i}),s()(),c(60,"div",21)(61,"label"),d(62,"Phone"),s(),c(63,"input",27),P("ngModelChange",function(i){return S(r.model.phone,i)||(r.model.phone=i),i}),s()(),c(64,"div",21)(65,"label",28)(66,"input",29),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(67," Active"),s()()(),c(68,"div",30)(69,"button",31),E("click",function(){return r.save()}),d(70),s(),c(71,"button",32),E("click",function(){return r.closeModal()}),d(72,"Cancel"),s()()(),c(73,"app-confirm-dialog",33),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(15),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Supplier":"Add New Supplier")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.supplierName),f(4),T("ngModel",r.model.vatNo),f(4),T("ngModel",r.model.fileNo),f(4),T("ngModel",r.model.email),f(4),T("ngModel",r.model.address),f(4),T("ngModel",r.model.phone),f(3),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.supplierName)||""))},dependencies:[Ve,We,je,Oe,Pe,De,at,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function IB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td"),d(7),s(),c(8,"td")(9,"span"),d(10),s()(),c(11,"td")(12,"div",32)(13,"button",33),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(14,"\u270F\uFE0F"),s(),c(15,"button",34),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(16,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.guideName),f(2),M(t.address),f(2),M(t.phone),f(2),st(t.isActive?"status-active":"status-inactive"),f(),M(t.isActive?"Active":"Inactive")}}function AB(e,n){e&1&&(c(0,"tr")(1,"td",35),d(2,"No guides found"),s()())}var Fp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={guideName:"",address:"",phone:"",isActive:!1};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getGuides().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.guideName||"").toLowerCase().includes(n))}openAdd(){this.model={guideName:"",address:"",phone:"",isActive:!1},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.guideName){alert("\u26A0\uFE0F Required");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateGuide(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createGuide(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteGuide(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-guide"]],standalone:!1,decls:63,vars:17,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search guides...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],["type","text","placeholder","Enter name",3,"ngModelChange","ngModel"],[1,"form-row"],["type","text","placeholder","Address",3,"ngModelChange","ngModel"],["type","text","placeholder","Phone",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","5",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F464} Code Guide"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Guide"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Guide Name"),s(),c(23,"th"),d(24,"Address"),s(),c(25,"th"),d(26,"Phone"),s(),c(27,"th"),d(28,"Status"),s(),c(29,"th",13),d(30,"Actions"),s()()(),c(31,"tbody"),H(32,IB,17,6,"tr",14)(33,AB,3,0,"tr",15),s()(),c(34,"div",16)(35,"span",17),d(36),s(),le(37,"app-export-buttons",18),s()()(),c(38,"app-modal",19),E("closed",function(){return r.closeModal()}),c(39,"div",20)(40,"div",21)(41,"label"),d(42,"Guide Name *"),s(),c(43,"input",22),P("ngModelChange",function(i){return S(r.model.guideName,i)||(r.model.guideName=i),i}),s()(),c(44,"div",23)(45,"div",21)(46,"label"),d(47,"Address"),s(),c(48,"input",24),P("ngModelChange",function(i){return S(r.model.address,i)||(r.model.address=i),i}),s()(),c(49,"div",21)(50,"label"),d(51,"Phone"),s(),c(52,"input",25),P("ngModelChange",function(i){return S(r.model.phone,i)||(r.model.phone=i),i}),s()()(),c(53,"div",21)(54,"label",26)(55,"input",27),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(56," Active"),s()()(),c(57,"div",28)(58,"button",29),E("click",function(){return r.save()}),d(59),s(),c(60,"button",30),E("click",function(){return r.closeModal()}),d(61,"Cancel"),s()()(),c(62,"app-confirm-dialog",31),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(15),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Guide":"Add New Guide")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.guideName),f(5),T("ngModel",r.model.address),f(4),T("ngModel",r.model.phone),f(3),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.guideName)||""))},dependencies:[Ve,We,je,Oe,Pe,De,at,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function NB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td")(7,"span"),d(8),s()(),c(9,"td")(10,"div",32)(11,"button",33),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(12,"\u270F\uFE0F"),s(),c(13,"button",34),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(14,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.hotelName),f(2),M(t.destinationName),f(2),st(t.isActive?"status-active":"status-inactive"),f(),M(t.isActive?"Active":"Inactive")}}function FB(e,n){e&1&&(c(0,"tr")(1,"td",35),d(2,"No hotels found"),s()())}function RB(e,n){if(e&1&&(c(0,"option",24),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.destinationName)}}var Rp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={hotelName:"",isActive:!1};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;destinations=[];showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData(),this.svc.getHotelDestinations().subscribe(n=>{this.destinations=n,this.cdr.detectChanges()})}loadData(){this.svc.getHotels().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.hotelName||"").toLowerCase().includes(n)||(t.destinationName||"").toLowerCase().includes(n))}openAdd(){this.model={hotelName:"",isActive:!1},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.hotelName){alert("\u26A0\uFE0F Required");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateHotel(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createHotel(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteHotel(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-hotel"]],standalone:!1,decls:59,vars:18,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search hotels...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],["type","text","placeholder","Enter name",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","4",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F3E8} Code Hotel"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Hotel"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Hotel Name"),s(),c(23,"th"),d(24,"Destination"),s(),c(25,"th"),d(26,"Status"),s(),c(27,"th",13),d(28,"Actions"),s()()(),c(29,"tbody"),H(30,NB,15,5,"tr",14)(31,FB,3,0,"tr",15),s()(),c(32,"div",16)(33,"span",17),d(34),s(),le(35,"app-export-buttons",18),s()()(),c(36,"app-modal",19),E("closed",function(){return r.closeModal()}),c(37,"div",20)(38,"div",21)(39,"label"),d(40,"Hotel Name *"),s(),c(41,"input",22),P("ngModelChange",function(i){return S(r.model.hotelName,i)||(r.model.hotelName=i),i}),s()(),c(42,"div",21)(43,"label"),d(44,"Destination"),s(),c(45,"select",23),P("ngModelChange",function(i){return S(r.model.destinationId,i)||(r.model.destinationId=i),i}),c(46,"option",24),d(47,"Select..."),s(),H(48,RB,2,2,"option",25),s()(),c(49,"div",21)(50,"label",26)(51,"input",27),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(52," Active"),s()()(),c(53,"div",28)(54,"button",29),E("click",function(){return r.save()}),d(55),s(),c(56,"button",30),E("click",function(){return r.closeModal()}),d(57,"Cancel"),s()()(),c(58,"app-confirm-dialog",31),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(13),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Hotel":"Add New Hotel")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.hotelName),f(4),T("ngModel",r.model.destinationId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.destinations),f(3),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.hotelName)||""))},dependencies:[Ve,We,je,Oe,Pe,Et,Ot,De,at,mt,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function LB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td")(5,"span"),d(6),s()(),c(7,"td")(8,"div",29)(9,"button",30),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(10,"\u270F\uFE0F"),s(),c(11,"button",31),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(12,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.destinationName),f(2),st(t.isActive?"status-active":"status-inactive"),f(),M(t.isActive?"Active":"Inactive")}}function BB(e,n){e&1&&(c(0,"tr")(1,"td",32),d(2,"No destinations found"),s()())}var Lp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={destinationName:"",isActive:!1};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getHotelDestinations().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.destinationName||"").toLowerCase().includes(n))}openAdd(){this.model={destinationName:"",isActive:!1},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.destinationName){alert("\u26A0\uFE0F Required");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateHotelDestination(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createHotelDestination(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteHotelDestination(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-hotel-destination"]],standalone:!1,decls:50,vars:15,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search destinations...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],["type","text","placeholder","Enter destination",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","3",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F4CD} Code Hotel Destination"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Destination"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Destination Name"),s(),c(23,"th"),d(24,"Status"),s(),c(25,"th",13),d(26,"Actions"),s()()(),c(27,"tbody"),H(28,LB,13,4,"tr",14)(29,BB,3,0,"tr",15),s()(),c(30,"div",16)(31,"span",17),d(32),s(),le(33,"app-export-buttons",18),s()()(),c(34,"app-modal",19),E("closed",function(){return r.closeModal()}),c(35,"div",20)(36,"div",21)(37,"label"),d(38,"Destination Name *"),s(),c(39,"input",22),P("ngModelChange",function(i){return S(r.model.destinationName,i)||(r.model.destinationName=i),i}),s()(),c(40,"div",21)(41,"label",23)(42,"input",24),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(43," Active"),s()()(),c(44,"div",25)(45,"button",26),E("click",function(){return r.save()}),d(46),s(),c(47,"button",27),E("click",function(){return r.closeModal()}),d(48,"Cancel"),s()()(),c(49,"app-confirm-dialog",28),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(11),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Destination":"Add New Destination")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.destinationName),f(3),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.destinationName)||""))},dependencies:[Ve,We,je,Oe,Pe,De,at,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function VB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td")(5,"span"),d(6),s()(),c(7,"td")(8,"div",29)(9,"button",30),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(10,"\u270F\uFE0F"),s(),c(11,"button",31),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(12,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.nationalityName),f(2),st(t.isActive?"status-active":"status-inactive"),f(),M(t.isActive?"Active":"Inactive")}}function jB(e,n){e&1&&(c(0,"tr")(1,"td",32),d(2,"No nationalities found"),s()())}var Bp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={nationalityName:"",isActive:!1};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getNationalities().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.nationalityName||"").toLowerCase().includes(n))}openAdd(){this.model={nationalityName:"",isActive:!1},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.nationalityName){alert("\u26A0\uFE0F Required");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateNationality(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createNationality(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteNationality(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-nationality"]],standalone:!1,decls:50,vars:15,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search nationalities...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],["type","text","placeholder","Enter nationality",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","3",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F30D} Code Nationality"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Nationality"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Nationality Name"),s(),c(23,"th"),d(24,"Status"),s(),c(25,"th",13),d(26,"Actions"),s()()(),c(27,"tbody"),H(28,VB,13,4,"tr",14)(29,jB,3,0,"tr",15),s()(),c(30,"div",16)(31,"span",17),d(32),s(),le(33,"app-export-buttons",18),s()()(),c(34,"app-modal",19),E("closed",function(){return r.closeModal()}),c(35,"div",20)(36,"div",21)(37,"label"),d(38,"Nationality Name *"),s(),c(39,"input",22),P("ngModelChange",function(i){return S(r.model.nationalityName,i)||(r.model.nationalityName=i),i}),s()(),c(40,"div",21)(41,"label",23)(42,"input",24),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(43," Active"),s()()(),c(44,"div",25)(45,"button",26),E("click",function(){return r.save()}),d(46),s(),c(47,"button",27),E("click",function(){return r.closeModal()}),d(48,"Cancel"),s()()(),c(49,"app-confirm-dialog",28),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(11),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Nationality":"Add New Nationality")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.nationalityName),f(3),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.nationalityName)||""))},dependencies:[Ve,We,je,Oe,Pe,De,at,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function UB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td")(5,"span"),d(6),s()(),c(7,"td")(8,"div",29)(9,"button",30),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(10,"\u270F\uFE0F"),s(),c(11,"button",31),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(12,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.priceListName),f(2),st(t.isActive?"status-active":"status-inactive"),f(),M(t.isActive?"Active":"Inactive")}}function WB(e,n){e&1&&(c(0,"tr")(1,"td",32),d(2,"No price lists found"),s()())}var Vp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={priceListName:"",isActive:!1};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getPriceLists().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.priceListName||"").toLowerCase().includes(n))}openAdd(){this.model={priceListName:"",isActive:!1},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.priceListName){alert("\u26A0\uFE0F Required");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updatePriceList(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createPriceList(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deletePriceList(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-price-list"]],standalone:!1,decls:50,vars:15,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search price lists...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],["type","text","placeholder","Enter name",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","3",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F4B0} Code Price List"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Price List"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Price List Name"),s(),c(23,"th"),d(24,"Status"),s(),c(25,"th",13),d(26,"Actions"),s()()(),c(27,"tbody"),H(28,UB,13,4,"tr",14)(29,WB,3,0,"tr",15),s()(),c(30,"div",16)(31,"span",17),d(32),s(),le(33,"app-export-buttons",18),s()()(),c(34,"app-modal",19),E("closed",function(){return r.closeModal()}),c(35,"div",20)(36,"div",21)(37,"label"),d(38,"Price List Name *"),s(),c(39,"input",22),P("ngModelChange",function(i){return S(r.model.priceListName,i)||(r.model.priceListName=i),i}),s()(),c(40,"div",21)(41,"label",23)(42,"input",24),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(43," Active"),s()()(),c(44,"div",25)(45,"button",26),E("click",function(){return r.save()}),d(46),s(),c(47,"button",27),E("click",function(){return r.closeModal()}),d(48,"Cancel"),s()()(),c(49,"app-confirm-dialog",28),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(11),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Price List":"Add New Price List")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.priceListName),f(3),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.priceListName)||""))},dependencies:[Ve,We,je,Oe,Pe,De,at,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function zB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td"),d(2),He(3,"date"),s(),c(4,"td"),d(5),He(6,"date"),s(),c(7,"td")(8,"strong"),d(9),s()(),c(10,"td"),d(11),s(),c(12,"td")(13,"div",35)(14,"button",36),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(15,"\u270F\uFE0F"),s(),c(16,"button",37),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(17,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(2),M($e(3,4,t.fromDate,"dd/MM/yyyy")),f(3),M($e(6,7,t.toDate,"dd/MM/yyyy")),f(4),M(t.currency),f(2),M(t.rateValue)}}function HB(e,n){e&1&&(c(0,"tr")(1,"td",38),d(2,"No rates found"),s()())}var jp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getRates().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.currency||"").toLowerCase().includes(n))}openAdd(){this.model={},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateRate(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createRate(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteRate(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-rate"]],standalone:!1,decls:74,vars:17,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search rates...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],["type","date",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["value",""],["value","USD"],["value","EUR"],["value","EGP"],["value","GBP"],["type","number","placeholder","Exchange rate",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","5",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F4B1} Code Rate"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Rate"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"From Date"),s(),c(23,"th"),d(24,"To Date"),s(),c(25,"th"),d(26,"Currency"),s(),c(27,"th"),d(28,"Rate Value"),s(),c(29,"th",13),d(30,"Actions"),s()()(),c(31,"tbody"),H(32,zB,18,10,"tr",14)(33,HB,3,0,"tr",15),s()(),c(34,"div",16)(35,"span",17),d(36),s(),le(37,"app-export-buttons",18),s()()(),c(38,"app-modal",19),E("closed",function(){return r.closeModal()}),c(39,"div",20)(40,"div",21)(41,"div",22)(42,"label"),d(43,"From Date"),s(),c(44,"input",23),P("ngModelChange",function(i){return S(r.model.fromDate,i)||(r.model.fromDate=i),i}),s()(),c(45,"div",22)(46,"label"),d(47,"To Date"),s(),c(48,"input",23),P("ngModelChange",function(i){return S(r.model.toDate,i)||(r.model.toDate=i),i}),s()()(),c(49,"div",21)(50,"div",22)(51,"label"),d(52,"Currency"),s(),c(53,"select",24),P("ngModelChange",function(i){return S(r.model.currency,i)||(r.model.currency=i),i}),c(54,"option",25),d(55,"Select..."),s(),c(56,"option",26),d(57,"USD"),s(),c(58,"option",27),d(59,"EUR"),s(),c(60,"option",28),d(61,"EGP"),s(),c(62,"option",29),d(63,"GBP"),s()()(),c(64,"div",22)(65,"label"),d(66,"Rate Value"),s(),c(67,"input",30),P("ngModelChange",function(i){return S(r.model.rateValue,i)||(r.model.rateValue=i),i}),s()()()(),c(68,"div",31)(69,"button",32),E("click",function(){return r.save()}),d(70),s(),c(71,"button",33),E("click",function(){return r.closeModal()}),d(72,"Cancel"),s()()(),c(73,"app-confirm-dialog",34),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(15),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Rate":"Add New Rate")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.fromDate),f(4),T("ngModel",r.model.toDate),f(5),T("ngModel",r.model.currency),f(14),T("ngModel",r.model.rateValue),f(2),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",((r.deleteTarget==null?null:r.deleteTarget.currency)||"")+" rate"))},dependencies:[Ve,We,je,Oe,Pe,Et,Ot,De,Rn,mt,Ne,ke,rn],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function $B(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td"),d(7),s(),c(8,"td")(9,"span"),d(10),s()(),c(11,"td")(12,"div",34)(13,"button",35),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(14,"\u270F\uFE0F"),s(),c(15,"button",36),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(16,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.repName),f(2),M(t.agentName),f(2),M(t.phone),f(2),st(t.isActive?"status-active":"status-inactive"),f(),M(t.isActive?"Active":"Inactive")}}function GB(e,n){e&1&&(c(0,"tr")(1,"td",37),d(2,"No reps found"),s()())}function qB(e,n){if(e&1&&(c(0,"option",24),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.agentName)}}var Up=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={repName:"",address:"",phone:"",isActive:!1};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;agents=[];showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData(),this.svc.getAgents().subscribe(n=>{this.agents=n,this.cdr.detectChanges()})}loadData(){this.svc.getReps().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.repName||"").toLowerCase().includes(n)||(t.agentName||"").toLowerCase().includes(n))}openAdd(){this.model={repName:"",address:"",phone:"",isActive:!1},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.repName){alert("\u26A0\uFE0F Required");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateRep(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createRep(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteRep(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-rep"]],standalone:!1,decls:69,vars:20,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search reps...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],["type","text","placeholder","Enter name",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["type","text","placeholder","Enter address",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter phone",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","5",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F468}\u200D\u{1F4BC} Code Rep"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Rep"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Rep Name"),s(),c(23,"th"),d(24,"Agent"),s(),c(25,"th"),d(26,"Phone"),s(),c(27,"th"),d(28,"Status"),s(),c(29,"th",13),d(30,"Actions"),s()()(),c(31,"tbody"),H(32,$B,17,6,"tr",14)(33,GB,3,0,"tr",15),s()(),c(34,"div",16)(35,"span",17),d(36),s(),le(37,"app-export-buttons",18),s()()(),c(38,"app-modal",19),E("closed",function(){return r.closeModal()}),c(39,"div",20)(40,"div",21)(41,"label"),d(42,"Rep Name *"),s(),c(43,"input",22),P("ngModelChange",function(i){return S(r.model.repName,i)||(r.model.repName=i),i}),s()(),c(44,"div",21)(45,"label"),d(46,"Agent"),s(),c(47,"select",23),P("ngModelChange",function(i){return S(r.model.agentId,i)||(r.model.agentId=i),i}),c(48,"option",24),d(49,"Select..."),s(),H(50,qB,2,2,"option",25),s()(),c(51,"div",21)(52,"label"),d(53,"Address"),s(),c(54,"input",26),P("ngModelChange",function(i){return S(r.model.address,i)||(r.model.address=i),i}),s()(),c(55,"div",21)(56,"label"),d(57,"Phone"),s(),c(58,"input",27),P("ngModelChange",function(i){return S(r.model.phone,i)||(r.model.phone=i),i}),s()(),c(59,"div",21)(60,"label",28)(61,"input",29),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(62," Active"),s()()(),c(63,"div",30)(64,"button",31),E("click",function(){return r.save()}),d(65),s(),c(66,"button",32),E("click",function(){return r.closeModal()}),d(67,"Cancel"),s()()(),c(68,"app-confirm-dialog",33),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(15),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Rep":"Add New Rep")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.repName),f(4),T("ngModel",r.model.agentId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.agents),f(4),T("ngModel",r.model.address),f(4),T("ngModel",r.model.phone),f(3),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.repName)||""))},dependencies:[Ve,We,je,Oe,Pe,Et,Ot,De,at,mt,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function XB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td")(7,"span"),d(8),s()(),c(9,"td")(10,"div",32)(11,"button",33),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(12,"\u270F\uFE0F"),s(),c(13,"button",34),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(14,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.typeName),f(2),M(t.supplierName),f(2),st(t.isActive?"status-active":"status-inactive"),f(),M(t.isActive?"Active":"Inactive")}}function YB(e,n){e&1&&(c(0,"tr")(1,"td",35),d(2,"No types found"),s()())}function KB(e,n){if(e&1&&(c(0,"option",24),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.supplierName)}}var Wp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={typeName:"",isActive:!1};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;suppliers=[];showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData(),this.svc.getTransportationSuppliers().subscribe(n=>{this.suppliers=n,this.cdr.detectChanges()})}loadData(){this.svc.getTransportationTypes().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.typeName||"").toLowerCase().includes(n))}openAdd(){this.model={typeName:"",isActive:!1},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.typeName){alert("\u26A0\uFE0F Required");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateTransportationType(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createTransportationType(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteTransportationType(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-transportation-type"]],standalone:!1,decls:59,vars:18,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search types...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],["type","text","placeholder","Enter type name",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","4",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F697} Code Transportation Type"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Type"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Type Name"),s(),c(23,"th"),d(24,"Supplier"),s(),c(25,"th"),d(26,"Status"),s(),c(27,"th",13),d(28,"Actions"),s()()(),c(29,"tbody"),H(30,XB,15,5,"tr",14)(31,YB,3,0,"tr",15),s()(),c(32,"div",16)(33,"span",17),d(34),s(),le(35,"app-export-buttons",18),s()()(),c(36,"app-modal",19),E("closed",function(){return r.closeModal()}),c(37,"div",20)(38,"div",21)(39,"label"),d(40,"Type Name *"),s(),c(41,"input",22),P("ngModelChange",function(i){return S(r.model.typeName,i)||(r.model.typeName=i),i}),s()(),c(42,"div",21)(43,"label"),d(44,"Supplier"),s(),c(45,"select",23),P("ngModelChange",function(i){return S(r.model.supplierId,i)||(r.model.supplierId=i),i}),c(46,"option",24),d(47,"Select..."),s(),H(48,KB,2,2,"option",25),s()(),c(49,"div",21)(50,"label",26)(51,"input",27),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(52," Active"),s()()(),c(53,"div",28)(54,"button",29),E("click",function(){return r.save()}),d(55),s(),c(56,"button",30),E("click",function(){return r.closeModal()}),d(57,"Cancel"),s()()(),c(58,"app-confirm-dialog",31),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(13),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Type":"Add New Type")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.typeName),f(4),T("ngModel",r.model.supplierId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.suppliers),f(3),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.typeName)||""))},dependencies:[Ve,We,je,Oe,Pe,Et,Ot,De,at,mt,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function ZB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td"),d(7),s(),c(8,"td")(9,"span"),d(10),s()(),c(11,"td")(12,"div",34)(13,"button",35),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(14,"\u270F\uFE0F"),s(),c(15,"button",36),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(16,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.supplierName),f(2),M(t.email),f(2),M(t.phone),f(2),st(t.isActive?"status-active":"status-inactive"),f(),M(t.isActive?"Active":"Inactive")}}function QB(e,n){e&1&&(c(0,"tr")(1,"td",37),d(2,"No suppliers found"),s()())}var zp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={supplierName:"",vatNo:"",fileNo:"",email:"",address:"",phone:"",isActive:!1};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getTransportationSuppliers().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.supplierName||"").toLowerCase().includes(n))}openAdd(){this.model={supplierName:"",vatNo:"",fileNo:"",email:"",address:"",phone:"",isActive:!1},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.supplierName){alert("\u26A0\uFE0F Required");return}this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateTransportationSupplier(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createTransportationSupplier(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteTransportationSupplier(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-transportation-supplier"]],standalone:!1,decls:74,vars:20,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search suppliers...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","medium",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],["type","text","placeholder","Enter name",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter VAT number",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter file number",3,"ngModelChange","ngModel"],["type","email","placeholder","Enter email",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter address",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter phone",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","5",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F3D7}\uFE0F Code Transportation Supplier"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Supplier"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Supplier Name"),s(),c(23,"th"),d(24,"Email"),s(),c(25,"th"),d(26,"Phone"),s(),c(27,"th"),d(28,"Status"),s(),c(29,"th",13),d(30,"Actions"),s()()(),c(31,"tbody"),H(32,ZB,17,6,"tr",14)(33,QB,3,0,"tr",15),s()(),c(34,"div",16)(35,"span",17),d(36),s(),le(37,"app-export-buttons",18),s()()(),c(38,"app-modal",19),E("closed",function(){return r.closeModal()}),c(39,"div",20)(40,"div",21)(41,"label"),d(42,"Supplier Name *"),s(),c(43,"input",22),P("ngModelChange",function(i){return S(r.model.supplierName,i)||(r.model.supplierName=i),i}),s()(),c(44,"div",21)(45,"label"),d(46,"VAT No"),s(),c(47,"input",23),P("ngModelChange",function(i){return S(r.model.vatNo,i)||(r.model.vatNo=i),i}),s()(),c(48,"div",21)(49,"label"),d(50,"File No"),s(),c(51,"input",24),P("ngModelChange",function(i){return S(r.model.fileNo,i)||(r.model.fileNo=i),i}),s()(),c(52,"div",21)(53,"label"),d(54,"Email"),s(),c(55,"input",25),P("ngModelChange",function(i){return S(r.model.email,i)||(r.model.email=i),i}),s()(),c(56,"div",21)(57,"label"),d(58,"Address"),s(),c(59,"input",26),P("ngModelChange",function(i){return S(r.model.address,i)||(r.model.address=i),i}),s()(),c(60,"div",21)(61,"label"),d(62,"Phone"),s(),c(63,"input",27),P("ngModelChange",function(i){return S(r.model.phone,i)||(r.model.phone=i),i}),s()(),c(64,"div",21)(65,"label",28)(66,"input",29),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(67," Active"),s()()(),c(68,"div",30)(69,"button",31),E("click",function(){return r.save()}),d(70),s(),c(71,"button",32),E("click",function(){return r.closeModal()}),d(72,"Cancel"),s()()(),c(73,"app-confirm-dialog",33),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(15),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Supplier":"Add New Supplier")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.supplierName),f(4),T("ngModel",r.model.vatNo),f(4),T("ngModel",r.model.fileNo),f(4),T("ngModel",r.model.email),f(4),T("ngModel",r.model.address),f(4),T("ngModel",r.model.phone),f(3),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.supplierName)||""))},dependencies:[Ve,We,je,Oe,Pe,De,at,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function JB(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td"),d(7),s(),c(8,"td"),d(9),s(),c(10,"td"),d(11),s(),c(12,"td")(13,"div",33)(14,"button",34),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(15,"\u270F\uFE0F"),s(),c(16,"button",35),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(17,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.supplierName),f(2),M(t.carTypeName),f(2),M(t.destinationName),f(2),M(t.roundType),f(2),M(t.costEGP)}}function e7(e,n){e&1&&(c(0,"tr")(1,"td",36),d(2,"No costs found"),s()())}function t7(e,n){if(e&1&&(c(0,"option",23),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.supplierName)}}function n7(e,n){if(e&1&&(c(0,"option",23),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.typeName)}}function r7(e,n){if(e&1&&(c(0,"option",23),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.destinationName)}}var Hp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={roundType:"One Way"};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;suppliers=[];carTypes=[];destinations=[];showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData(),this.svc.getTransportationSuppliers().subscribe(n=>{this.suppliers=n,this.cdr.detectChanges()}),this.svc.getTransportationTypes().subscribe(n=>{this.carTypes=n,this.cdr.detectChanges()}),this.svc.getHotelDestinations().subscribe(n=>{this.destinations=n,this.cdr.detectChanges()})}loadData(){this.svc.getTransportationCosts().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.supplierName||"").toLowerCase().includes(n)||(t.carTypeName||"").toLowerCase().includes(n)||(t.destinationName||"").toLowerCase().includes(n))}openAdd(){this.model={roundType:"One Way"},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateTransportationCost(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createTransportationCost(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteTransportationCost(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-transportation-cost"]],standalone:!1,decls:82,vars:24,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search costs...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","medium",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],[3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-row"],["value","One Way"],["value","Two Way"],["type","number","placeholder","Enter cost",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","6",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F4B5} Code Transportation Cost"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Cost"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Supplier"),s(),c(23,"th"),d(24,"Car Type"),s(),c(25,"th"),d(26,"Destination"),s(),c(27,"th"),d(28,"Round Type"),s(),c(29,"th"),d(30,"Cost (EGP)"),s(),c(31,"th",13),d(32,"Actions"),s()()(),c(33,"tbody"),H(34,JB,18,5,"tr",14)(35,e7,3,0,"tr",15),s()(),c(36,"div",16)(37,"span",17),d(38),s(),le(39,"app-export-buttons",18),s()()(),c(40,"app-modal",19),E("closed",function(){return r.closeModal()}),c(41,"div",20)(42,"div",21)(43,"label"),d(44,"Supplier"),s(),c(45,"select",22),P("ngModelChange",function(i){return S(r.model.supplierId,i)||(r.model.supplierId=i),i}),c(46,"option",23),d(47,"Select..."),s(),H(48,t7,2,2,"option",24),s()(),c(49,"div",21)(50,"label"),d(51,"Car Type"),s(),c(52,"select",22),P("ngModelChange",function(i){return S(r.model.carTypeId,i)||(r.model.carTypeId=i),i}),c(53,"option",23),d(54,"Select..."),s(),H(55,n7,2,2,"option",24),s()(),c(56,"div",21)(57,"label"),d(58,"Destination"),s(),c(59,"select",22),P("ngModelChange",function(i){return S(r.model.destinationId,i)||(r.model.destinationId=i),i}),c(60,"option",23),d(61,"Select..."),s(),H(62,r7,2,2,"option",24),s()(),c(63,"div",25)(64,"div",21)(65,"label"),d(66,"Round Type"),s(),c(67,"select",22),P("ngModelChange",function(i){return S(r.model.roundType,i)||(r.model.roundType=i),i}),c(68,"option",26),d(69,"One Way"),s(),c(70,"option",27),d(71,"Two Way"),s()()(),c(72,"div",21)(73,"label"),d(74,"Cost (EGP)"),s(),c(75,"input",28),P("ngModelChange",function(i){return S(r.model.costEGP,i)||(r.model.costEGP=i),i}),s()()()(),c(76,"div",29)(77,"button",30),E("click",function(){return r.save()}),d(78),s(),c(79,"button",31),E("click",function(){return r.closeModal()}),d(80,"Cancel"),s()()(),c(81,"app-confirm-dialog",32),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(17),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Cost":"Add New Cost")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.supplierId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.suppliers),f(4),T("ngModel",r.model.carTypeId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.carTypes),f(4),T("ngModel",r.model.destinationId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.destinations),f(5),T("ngModel",r.model.roundType),f(8),T("ngModel",r.model.costEGP),f(2),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",((r.deleteTarget==null?null:r.deleteTarget.supplierName)||"")+" - "+((r.deleteTarget==null?null:r.deleteTarget.carTypeName)||"")))},dependencies:[Ve,We,je,Oe,Pe,Et,Ot,De,Rn,mt,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function o7(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td"),d(7),s(),c(8,"td")(9,"div",32)(10,"button",33),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(11,"\u270F\uFE0F"),s(),c(12,"button",34),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(13,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.repName),f(2),M(t.fromNumber),f(2),M(t.toNumber)}}function i7(e,n){e&1&&(c(0,"tr")(1,"td",35),d(2,"No vouchers found"),s()())}function a7(e,n){if(e&1&&(c(0,"option",23),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.repName)}}var $p=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;reps=[];showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData(),this.svc.getReps().subscribe(n=>{this.reps=n,this.cdr.detectChanges()})}loadData(){this.svc.getVouchers().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.repName||"").toLowerCase().includes(n)||String(t.fromNumber||"").includes(n))}openAdd(){this.model={},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){this.saving=!0,this.model.recordBy="Ibram Wahib",this.isEdit&&this.model.id?this.svc.updateVoucher(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()}):this.svc.createVoucher(this.model).subscribe(()=>{this.saving=!1,this.loadData(),this.closeModal()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteVoucher(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-voucher"]],standalone:!1,decls:60,vars:18,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search vouchers...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-group"],[3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-row"],["type","number","placeholder","From number",3,"ngModelChange","ngModel"],["type","number","placeholder","To number",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","4",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F3AB} Code Voucher"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Voucher"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Rep"),s(),c(23,"th"),d(24,"From Number"),s(),c(25,"th"),d(26,"To Number"),s(),c(27,"th",13),d(28,"Actions"),s()()(),c(29,"tbody"),H(30,o7,14,3,"tr",14)(31,i7,3,0,"tr",15),s()(),c(32,"div",16)(33,"span",17),d(34),s(),le(35,"app-export-buttons",18),s()()(),c(36,"app-modal",19),E("closed",function(){return r.closeModal()}),c(37,"div",20)(38,"div",21)(39,"label"),d(40,"Rep"),s(),c(41,"select",22),P("ngModelChange",function(i){return S(r.model.repId,i)||(r.model.repId=i),i}),c(42,"option",23),d(43,"Select..."),s(),H(44,a7,2,2,"option",24),s()(),c(45,"div",25)(46,"div",21)(47,"label"),d(48,"From Number"),s(),c(49,"input",26),P("ngModelChange",function(i){return S(r.model.fromNumber,i)||(r.model.fromNumber=i),i}),s()(),c(50,"div",21)(51,"label"),d(52,"To Number"),s(),c(53,"input",27),P("ngModelChange",function(i){return S(r.model.toNumber,i)||(r.model.toNumber=i),i}),s()()()(),c(54,"div",28)(55,"button",29),E("click",function(){return r.save()}),d(56),s(),c(57,"button",30),E("click",function(){return r.closeModal()}),d(58,"Cancel"),s()()(),c(59,"app-confirm-dialog",31),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(13),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Voucher":"Add New Voucher")("isOpen",r.isModalOpen),f(5),T("ngModel",r.model.repId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.reps),f(5),T("ngModel",r.model.fromNumber),f(4),T("ngModel",r.model.toNumber),f(2),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName","Voucher "+((r.deleteTarget==null?null:r.deleteTarget.fromNumber)||"")))},dependencies:[Ve,We,je,Oe,Pe,Et,Ot,De,Rn,mt,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function s7(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td"),d(7),s(),c(8,"td"),d(9),s(),c(10,"td"),d(11),s(),c(12,"td")(13,"div",37)(14,"button",38),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(15,"\u270F\uFE0F"),s(),c(16,"button",39),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(17,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.excursionName),f(2),M(t.agentName),f(2),M(t.destinationName),f(2),M(t.priceListName),f(2),M(t.supplierName)}}function c7(e,n){e&1&&(c(0,"tr")(1,"td",40),d(2,"No cost sellings found"),s()())}function l7(e,n){if(e&1&&(c(0,"option",24),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.excursionName)}}function d7(e,n){if(e&1&&(c(0,"option",24),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.agentName)}}function u7(e,n){if(e&1&&(c(0,"option",24),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.destinationName)}}function f7(e,n){if(e&1&&(c(0,"option",24),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.supplierName)}}function p7(e,n){if(e&1&&(c(0,"option",24),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),M(t.priceListName)}}var Gp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;excursions=[];destinations=[];agents=[];suppliers=[];priceLists=[];showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData(),this.svc.getExcursions().subscribe(n=>{this.excursions=n,this.cdr.detectChanges()}),this.svc.getHotelDestinations().subscribe(n=>{this.destinations=n,this.cdr.detectChanges()}),this.svc.getAgents().subscribe(n=>{this.agents=n,this.cdr.detectChanges()}),this.svc.getExcursionSuppliers().subscribe(n=>{this.suppliers=n,this.cdr.detectChanges()}),this.svc.getPriceLists().subscribe(n=>{this.priceLists=n,this.cdr.detectChanges()})}loadData(){this.svc.getExcursionCostSellings().subscribe(n=>{this.items=n,this.cdr.detectChanges()})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.excursionName||"").toLowerCase().includes(n)||(t.agentName||"").toLowerCase().includes(n)||(t.destinationName||"").toLowerCase().includes(n)||(t.supplierName||"").toLowerCase().includes(n)||(t.priceListName||"").toLowerCase().includes(n))}openAdd(){this.model={},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){this.saving=!0,this.model.recordBy="Ibram Wahib",this.closeModal(),this.isEdit&&this.model.id?this.svc.updateExcursionCostSelling(this.model.id,this.model).subscribe(()=>{this.saving=!1,this.loadData()}):this.svc.createExcursionCostSelling(this.model).subscribe(()=>{this.saving=!1,this.loadData()})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteExcursionCostSelling(this.deleteTarget.id).subscribe(()=>this.loadData()),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/operation/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-code-excursion-cost-selling"]],standalone:!1,decls:173,vars:48,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search cost sellings...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","large",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],[3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-fieldset"],[1,"currency-grid"],[1,"grid-header"],[1,"grid-label"],[1,"grid-cell"],["type","number","placeholder","0.00",3,"ngModelChange","ngModel"],[1,"currency-grid",2,"grid-template-columns","auto repeat(2, 1fr)"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","6",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F4B0} Code Excursion Cost Selling"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Cost Selling"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Excursion"),s(),c(23,"th"),d(24,"Agent"),s(),c(25,"th"),d(26,"Destination"),s(),c(27,"th"),d(28,"Price List"),s(),c(29,"th"),d(30,"Supplier"),s(),c(31,"th",13),d(32,"Actions"),s()()(),c(33,"tbody"),H(34,s7,18,5,"tr",14)(35,c7,3,0,"tr",15),s()(),c(36,"div",16)(37,"span",17),d(38),s(),le(39,"app-export-buttons",18),s()()(),c(40,"app-modal",19),E("closed",function(){return r.closeModal()}),c(41,"div",20)(42,"div",21)(43,"div",22)(44,"label"),d(45,"Excursion"),s(),c(46,"select",23),P("ngModelChange",function(i){return S(r.model.excursionId,i)||(r.model.excursionId=i),i}),c(47,"option",24),d(48,"Select..."),s(),H(49,l7,2,2,"option",25),s()(),c(50,"div",22)(51,"label"),d(52,"Agent"),s(),c(53,"select",23),P("ngModelChange",function(i){return S(r.model.agentId,i)||(r.model.agentId=i),i}),c(54,"option",24),d(55,"Select..."),s(),H(56,d7,2,2,"option",25),s()()(),c(57,"div",21)(58,"div",22)(59,"label"),d(60,"Hotel Destination"),s(),c(61,"select",23),P("ngModelChange",function(i){return S(r.model.destinationId,i)||(r.model.destinationId=i),i}),c(62,"option",24),d(63,"Select..."),s(),H(64,u7,2,2,"option",25),s()(),c(65,"div",22)(66,"label"),d(67,"Supplier"),s(),c(68,"select",23),P("ngModelChange",function(i){return S(r.model.supplierId,i)||(r.model.supplierId=i),i}),c(69,"option",24),d(70,"Select..."),s(),H(71,f7,2,2,"option",25),s()()(),c(72,"div",21)(73,"div",22)(74,"label"),d(75,"Price List"),s(),c(76,"select",23),P("ngModelChange",function(i){return S(r.model.priceListId,i)||(r.model.priceListId=i),i}),c(77,"option",24),d(78,"Select..."),s(),H(79,p7,2,2,"option",25),s()()(),c(80,"fieldset",26)(81,"legend"),d(82,"\u{1F4B2} Selling"),s(),c(83,"div",27),le(84,"div",28),c(85,"div",28),d(86,"EGP"),s(),c(87,"div",28),d(88,"USD"),s(),c(89,"div",28),d(90,"EUR"),s(),c(91,"div",28),d(92,"GBP"),s(),c(93,"div",29),d(94,"ADL"),s(),c(95,"div",30)(96,"input",31),P("ngModelChange",function(i){return S(r.model.sellingAdlEGP,i)||(r.model.sellingAdlEGP=i),i}),s()(),c(97,"div",30)(98,"input",31),P("ngModelChange",function(i){return S(r.model.sellingAdlUSD,i)||(r.model.sellingAdlUSD=i),i}),s()(),c(99,"div",30)(100,"input",31),P("ngModelChange",function(i){return S(r.model.sellingAdlEUR,i)||(r.model.sellingAdlEUR=i),i}),s()(),c(101,"div",30)(102,"input",31),P("ngModelChange",function(i){return S(r.model.sellingAdlGBP,i)||(r.model.sellingAdlGBP=i),i}),s()(),c(103,"div",29),d(104,"CHD"),s(),c(105,"div",30)(106,"input",31),P("ngModelChange",function(i){return S(r.model.sellingChdEGP,i)||(r.model.sellingChdEGP=i),i}),s()(),c(107,"div",30)(108,"input",31),P("ngModelChange",function(i){return S(r.model.sellingChdUSD,i)||(r.model.sellingChdUSD=i),i}),s()(),c(109,"div",30)(110,"input",31),P("ngModelChange",function(i){return S(r.model.sellingChdEUR,i)||(r.model.sellingChdEUR=i),i}),s()(),c(111,"div",30)(112,"input",31),P("ngModelChange",function(i){return S(r.model.sellingChdGBP,i)||(r.model.sellingChdGBP=i),i}),s()()()(),c(113,"fieldset",26)(114,"legend"),d(115,"\u{1F4CA} Cost"),s(),c(116,"div",27),le(117,"div",28),c(118,"div",28),d(119,"EGP"),s(),c(120,"div",28),d(121,"USD"),s(),c(122,"div",28),d(123,"EUR"),s(),c(124,"div",28),d(125,"GBP"),s(),c(126,"div",29),d(127,"ADL"),s(),c(128,"div",30)(129,"input",31),P("ngModelChange",function(i){return S(r.model.costAdlEGP,i)||(r.model.costAdlEGP=i),i}),s()(),c(130,"div",30)(131,"input",31),P("ngModelChange",function(i){return S(r.model.costAdlUSD,i)||(r.model.costAdlUSD=i),i}),s()(),c(132,"div",30)(133,"input",31),P("ngModelChange",function(i){return S(r.model.costAdlEUR,i)||(r.model.costAdlEUR=i),i}),s()(),c(134,"div",30)(135,"input",31),P("ngModelChange",function(i){return S(r.model.costAdlGBP,i)||(r.model.costAdlGBP=i),i}),s()(),c(136,"div",29),d(137,"CHD"),s(),c(138,"div",30)(139,"input",31),P("ngModelChange",function(i){return S(r.model.costChdEGP,i)||(r.model.costChdEGP=i),i}),s()(),c(140,"div",30)(141,"input",31),P("ngModelChange",function(i){return S(r.model.costChdUSD,i)||(r.model.costChdUSD=i),i}),s()(),c(142,"div",30)(143,"input",31),P("ngModelChange",function(i){return S(r.model.costChdEUR,i)||(r.model.costChdEUR=i),i}),s()(),c(144,"div",30)(145,"input",31),P("ngModelChange",function(i){return S(r.model.costChdGBP,i)||(r.model.costChdGBP=i),i}),s()()()(),c(146,"fieldset",26)(147,"legend"),d(148,"\u{1F3DB}\uFE0F National Fee"),s(),c(149,"div",32),le(150,"div",28),c(151,"div",28),d(152,"EGP"),s(),c(153,"div",28),d(154,"USD"),s(),c(155,"div",29),d(156,"ADL"),s(),c(157,"div",30)(158,"input",31),P("ngModelChange",function(i){return S(r.model.nationalFeeAdlEGP,i)||(r.model.nationalFeeAdlEGP=i),i}),s()(),c(159,"div",30)(160,"input",31),P("ngModelChange",function(i){return S(r.model.nationalFeeAdlUSD,i)||(r.model.nationalFeeAdlUSD=i),i}),s()(),c(161,"div",29),d(162,"CHD"),s(),c(163,"div",30)(164,"input",31),P("ngModelChange",function(i){return S(r.model.nationalFeeChdEGP,i)||(r.model.nationalFeeChdEGP=i),i}),s()(),c(165,"div",30)(166,"input",31),P("ngModelChange",function(i){return S(r.model.nationalFeeChdUSD,i)||(r.model.nationalFeeChdUSD=i),i}),s()()()()(),c(167,"div",33)(168,"button",34),E("click",function(){return r.save()}),d(169),s(),c(170,"button",35),E("click",function(){return r.closeModal()}),d(171,"Cancel"),s()()(),c(172,"app-confirm-dialog",36),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(17),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Cost Selling":"Add New Cost Selling")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.excursionId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.excursions),f(4),T("ngModel",r.model.agentId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.agents),f(5),T("ngModel",r.model.destinationId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.destinations),f(4),T("ngModel",r.model.supplierId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.suppliers),f(5),T("ngModel",r.model.priceListId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.priceLists),f(17),T("ngModel",r.model.sellingAdlEGP),f(2),T("ngModel",r.model.sellingAdlUSD),f(2),T("ngModel",r.model.sellingAdlEUR),f(2),T("ngModel",r.model.sellingAdlGBP),f(4),T("ngModel",r.model.sellingChdEGP),f(2),T("ngModel",r.model.sellingChdUSD),f(2),T("ngModel",r.model.sellingChdEUR),f(2),T("ngModel",r.model.sellingChdGBP),f(17),T("ngModel",r.model.costAdlEGP),f(2),T("ngModel",r.model.costAdlUSD),f(2),T("ngModel",r.model.costAdlEUR),f(2),T("ngModel",r.model.costAdlGBP),f(4),T("ngModel",r.model.costChdEGP),f(2),T("ngModel",r.model.costChdUSD),f(2),T("ngModel",r.model.costChdEUR),f(2),T("ngModel",r.model.costChdGBP),f(13),T("ngModel",r.model.nationalFeeAdlEGP),f(2),T("ngModel",r.model.nationalFeeAdlUSD),f(4),T("ngModel",r.model.nationalFeeChdEGP),f(2),T("ngModel",r.model.nationalFeeChdUSD),f(2),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",((r.deleteTarget==null?null:r.deleteTarget.excursionName)||"")+" - "+((r.deleteTarget==null?null:r.deleteTarget.agentName)||"")))},dependencies:[Ve,We,je,Oe,Pe,Et,Ot,De,Rn,mt,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}.form-fieldset[_ngcontent-%COMP%]{border:1px solid #d3d7dc;border-radius:10px;padding:16px 18px 10px;margin-bottom:18px;background:#f8fafb;position:relative}.form-fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{font-size:13px;font-weight:700;color:#1e3c72;text-transform:uppercase;letter-spacing:.6px;padding:0 10px;background:#f8fafb}.form-fieldset[_ngcontent-%COMP%]   .currency-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto repeat(4,1fr);gap:0;border:1px solid #dee2e6;border-radius:8px;overflow:hidden;background:#fff;margin-bottom:8px}.form-fieldset[_ngcontent-%COMP%]   .grid-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2a5298,#1e3c72);color:#fff;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;padding:8px 12px;text-align:center;border-right:1px solid rgba(255,255,255,.15)}.form-fieldset[_ngcontent-%COMP%]   .grid-header[_ngcontent-%COMP%]:last-child{border-right:none}.form-fieldset[_ngcontent-%COMP%]   .grid-label[_ngcontent-%COMP%]{background:#eef1f7;font-size:12px;font-weight:600;color:#444;padding:6px 14px;display:flex;align-items:center;border-bottom:1px solid #e8ecf0;border-right:1px solid #e8ecf0}.form-fieldset[_ngcontent-%COMP%]   .grid-cell[_ngcontent-%COMP%]{padding:4px 6px;border-bottom:1px solid #e8ecf0;border-right:1px solid #e8ecf0}.form-fieldset[_ngcontent-%COMP%]   .grid-cell[_ngcontent-%COMP%]:last-child{border-right:none}.form-fieldset[_ngcontent-%COMP%]   .grid-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:7px 8px;border:1px solid transparent;border-radius:5px;font-size:13px;text-align:right;background:transparent;font-family:Segoe UI,monospace;outline:none;transition:all .2s}.form-fieldset[_ngcontent-%COMP%]   .grid-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#2a5298;background:#f0f4ff;box-shadow:0 0 0 2px #2a52981f}.form-fieldset[_ngcontent-%COMP%]   .grid-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover:not(:focus){background:#f5f6f8}"]})};function g7(e,n){if(e&1){let t=be();c(0,"div",6)(1,"span",7),d(2,"\u{1F50D}"),s(),c(3,"input",8),E("ngModelChange",function(o){ne(t);let i=q();return re(i.searchTerm.set(o))}),s()()}if(e&2){let t=q();f(3),_("ngModel",t.searchTerm())}}function m7(e,n){e&1&&(c(0,"div",4),le(1,"div",9),c(2,"p"),d(3,"Loading accounting codes..."),s()())}function h7(e,n){if(e&1){let t=be();c(0,"div",5)(1,"span",10),d(2,"\u26A0\uFE0F"),s(),c(3,"h3"),d(4,"Failed to Load"),s(),c(5,"p",11),d(6),s(),c(7,"button",12),E("click",function(){ne(t);let o=q();return re(o.loadAccountingCodes())}),d(8,"Retry"),s()()}if(e&2){let t=q();f(6),M(t.error())}}function v7(e,n){if(e&1){let t=be();c(0,"div",20),E("click",function(){let o=ne(t).$implicit,i=q(2);return re(i.openCode(o))}),le(1,"div",21),c(2,"div",22)(3,"div",23)(4,"span",24),d(5),s()(),c(6,"div",25)(7,"h3"),d(8),s(),c(9,"p"),d(10),s()(),c(11,"div",26)(12,"span",27),d(13,"\u2192"),s()()()()}if(e&2){let t=n.$implicit;f(),nn("background",t.gradient),f(2),nn("background",t.gradient),f(2),M(t.icon),f(3),M(t.displayName),f(2),M(t.desc)}}function x7(e,n){e&1&&(c(0,"div",19)(1,"span",28),d(2,"\u{1F50D}"),s(),c(3,"h3"),d(4,"No codes found"),s(),c(5,"p"),d(6,"Try adjusting your search term"),s()())}function _7(e,n){if(e&1&&(c(0,"div",13)(1,"div",14)(2,"span",15),d(3),s(),c(4,"span",16),d(5,"Total Code Types"),s()(),c(6,"div",14)(7,"span",15),d(8),s(),c(9,"span",16),d(10,"Showing"),s()()(),c(11,"div",17),H(12,v7,14,7,"div",18),s(),Yo(13,x7,7,0,"div",19)),e&2){let t=q();f(3),M(t.codes().length),f(5),M(t.filteredCodes().length),f(4),_("ngForOf",t.filteredCodes()),f(),Ko(t.filteredCodes().length===0?13:-1)}}var qp=class e{accountingService=K(Ut);router=K(ye);codes=Rt([]);loading=Rt(!0);error=Rt(null);searchTerm=Rt("");filteredCodes=Oo(()=>{let n=this.codes(),t=this.searchTerm().toLowerCase();return t?n.filter(r=>r.displayName.toLowerCase().includes(t)||r.desc.toLowerCase().includes(t)):n});codeVisuals={operationaccounts:{icon:"\u{1F4CA}",desc:"Operation account tree",gradient:"linear-gradient(135deg, #fa709a, #fee140)",route:"/accounting/codes/operationaccounts"},codeperiods:{icon:"\u{1F4C5}",desc:"Manage accounting periods",gradient:"linear-gradient(135deg, #667eea, #764ba2)",route:"/accounting/codes/codeperiods"},codeagents:{icon:"\u{1F468}\u200D\u{1F4BC}",desc:"Agent code management",gradient:"linear-gradient(135deg, #f093fb, #f5576c)",route:"/accounting/codes/codeagents"},codebeneficiarynames:{icon:"\u{1F464}",desc:"Beneficiary name records",gradient:"linear-gradient(135deg, #43e97b, #38f9d7)",route:"/accounting/codes/codebeneficiarynames"},codebeneficiarytypes:{icon:"\u{1F3F7}\uFE0F",desc:"Beneficiary type classification",gradient:"linear-gradient(135deg, #f6d365, #fda085)",route:"/accounting/codes/codebeneficiarytypes"},codecostcenters:{icon:"\u{1F3E2}",desc:"Cost center management",gradient:"linear-gradient(135deg, #a18cd1, #fbc2eb)",route:"/accounting/codes/codecostercenters"},codefilenumbers:{icon:"\u{1F4C1}",desc:"File number tracking",gradient:"linear-gradient(135deg, #4facfe, #00f2fe)",route:"/accounting/codes/codefilenumbers"},operationrates:{icon:"\u{1F4B1}",desc:"Exchange rate management",gradient:"linear-gradient(135deg, #e0c3fc, #8ec5fc)",route:"/accounting/codes/operationrates"}};defaultGradients=["linear-gradient(135deg, #a8edea, #fed6e3)","linear-gradient(135deg, #ffecd2, #fcb69f)","linear-gradient(135deg, #89f7fe, #66a6ff)"];ngOnInit(){this.loadAccountingCodes()}loadAccountingCodes(){this.loading.set(!0),this.error.set(null),this.accountingService.getAccountingCodes().subscribe({next:n=>{let t=n.map((r,o)=>{let i=this.codeVisuals[r.key.toLowerCase()]||{icon:"\u{1F3F7}\uFE0F",desc:r.displayName,gradient:this.defaultGradients[o%this.defaultGradients.length],route:`/accounting/codes/${r.key}`};return{key:r.key,displayName:r.displayName,icon:i.icon,desc:i.desc,gradient:i.gradient,route:i.route}});this.codes.set(t),this.loading.set(!1)},error:n=>{console.error("Error loading accounting codes:",n),this.error.set("Failed to load accounting codes"),this.loading.set(!1)}})}openCode(n){this.router.navigate([n.route])}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-accounting-codes-list"]],standalone:!1,decls:11,vars:2,consts:[[1,"component-container"],[1,"page-header"],[1,"header-content"],["class","header-search",4,"ngIf"],[1,"loading-container"],[1,"error-container"],[1,"header-search"],[1,"search-icon"],["type","text","placeholder","Search codes...",3,"ngModelChange","ngModel"],[1,"spinner"],[1,"error-icon"],[1,"error-message"],[1,"retry-btn",3,"click"],[1,"summary-bar"],[1,"summary-stat"],[1,"stat-val"],[1,"stat-lbl"],[1,"cards-grid"],["class","card-item",3,"click",4,"ngFor","ngForOf"],[1,"empty-state"],[1,"card-item",3,"click"],[1,"card-accent"],[1,"card-body"],[1,"card-icon-wrap"],[1,"card-icon"],[1,"card-info"],[1,"card-meta"],[1,"arrow-circle"],[1,"empty-icon"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),d(4,"\u{1F3F7}\uFE0F Accounting Codes"),s(),c(5,"p"),d(6,"Manage accounting codes and configuration tables"),s()(),H(7,g7,4,1,"div",3),s(),Yo(8,m7,4,0,"div",4)(9,h7,9,1,"div",5)(10,_7,14,4),s()),t&2&&(f(7),_("ngIf",!r.loading()),f(),Ko(r.loading()?8:r.error()?9:10))},dependencies:[Oe,Pe,De,Ne,ke],styles:[".page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:20px;flex-wrap:wrap;gap:14px}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:var(--dm-primary);margin:0 0 4px;letter-spacing:-.3px}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-size:14px;margin:0}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]{position:relative}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:10px 16px 10px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;width:260px;outline:none;background:var(--dm-surface);box-shadow:var(--dm-shadow);font-family:inherit;color:var(--dm-text);transition:border-color .2s,box-shadow .2s,width .2s}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014;width:300px}.summary-bar[_ngcontent-%COMP%]{display:flex;gap:14px;margin-bottom:20px;flex-wrap:wrap}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]{background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);padding:10px 18px;display:flex;align-items:center;gap:10px;box-shadow:var(--dm-shadow)}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-val[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:var(--dm-primary)}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-lbl[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.cards-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px}.card-item[_ngcontent-%COMP%]{display:block;position:relative;background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius);text-decoration:none;color:inherit;overflow:hidden;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease,border-color .2s ease;box-shadow:var(--dm-shadow)}.card-item[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:var(--dm-shadow-md);border-color:var(--dm-accent)}.card-item[_ngcontent-%COMP%]:hover   .arrow-circle[_ngcontent-%COMP%]{background:var(--dm-primary);color:#fff}.card-item[_ngcontent-%COMP%]:hover   .card-accent[_ngcontent-%COMP%]{height:4px}.card-item[_ngcontent-%COMP%]:hover   .card-icon-wrap[_ngcontent-%COMP%]{transform:scale(1.05)}.card-item[_ngcontent-%COMP%]   .card-accent[_ngcontent-%COMP%]{height:3px;transition:height .2s}.card-item[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;align-items:center;gap:14px;padding:16px 18px}.card-item[_ngcontent-%COMP%]   .card-icon-wrap[_ngcontent-%COMP%]{width:46px;height:46px;border-radius:var(--dm-radius-sm);display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:var(--dm-shadow);transition:transform .2s ease}.card-item[_ngcontent-%COMP%]   .card-icon-wrap[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{font-size:22px}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]{flex:1;min-width:0}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--dm-text);margin:0 0 2px;letter-spacing:-.2px}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;color:var(--dm-text-muted);margin:0;line-height:1.3;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.card-item[_ngcontent-%COMP%]   .card-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:6px;flex-shrink:0}.card-item[_ngcontent-%COMP%]   .record-badge[_ngcontent-%COMP%]{background:#10b98114;color:#059669;padding:2px 10px;border-radius:20px;font-size:11px;font-weight:600;white-space:nowrap}.card-item[_ngcontent-%COMP%]   .arrow-circle[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:50%;background:var(--dm-hover);display:flex;align-items:center;justify-content:center;font-size:13px;color:var(--dm-text-muted);transition:all .2s}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:56px 20px;background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius);margin-top:16px;box-shadow:var(--dm-shadow)}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:44px;display:block;margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--dm-primary);font-size:17px;margin:0 0 4px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-size:14px;margin:0}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:3.5rem 2rem;color:var(--dm-text-muted);text-align:center}.loading-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:38px;height:38px;border:3px solid rgba(15,52,96,.1);border-top:3px solid var(--dm-accent);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;font-weight:500}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:3.5rem 2rem;text-align:center}.error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:44px;margin-bottom:.75rem;opacity:.7}.error-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--dm-highlight);font-size:18px;font-weight:600;margin-bottom:.5rem}.error-container[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:var(--dm-text-muted);margin-bottom:1.5rem;font-size:14px}.error-container[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border:none;padding:.65rem 1.25rem;border-radius:var(--dm-radius-sm);cursor:pointer;font-weight:600;font-size:14px;transition:box-shadow .2s}.error-container[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]:hover{box-shadow:var(--dm-shadow-md)}@media(max-width:768px){.cards-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{width:100%}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]{flex:1;min-width:100px}}.component-container[_ngcontent-%COMP%]{padding:0 10px}"],changeDetection:0})};function C7(e,n){if(e&1){let t=be();c(0,"button",34),E("click",function(){ne(t);let o=q();return re(o.clearSearch())}),d(1,"\u2715"),s()}}function b7(e,n){if(e&1){let t=be();c(0,"button",44),E("click",function(){ne(t);let o=q().$implicit,i=q();return re(i.toggleExpand(o))}),c(1,"span",45),d(2,"\u25B6"),s()()}if(e&2){let t=q().$implicit,r=q();nn("margin-left",r.getIndentPadding(t.level)),f(),Fn("expanded",t.expanded)}}function y7(e,n){if(e&1&&(c(0,"span",46),d(1," \u2022 "),s()),e&2){let t=q().$implicit,r=q();nn("margin-left",r.getIndentPadding(t.level))}}function M7(e,n){if(e&1&&(c(0,"span",47),d(1),s()),e&2){let t=q().$implicit;f(),ue(" ",t.parentAccountName," ")}}function w7(e,n){e&1&&(c(0,"span",48),d(1,"\u2014"),s())}function E7(e,n){if(e&1){let t=be();c(0,"button",49),E("click",function(){ne(t);let o=q().$implicit,i=q();return re(i.openAddChild(o))}),d(1,"\u2795"),s()}}function O7(e,n){if(e&1){let t=be();c(0,"tr")(1,"td"),H(2,b7,3,4,"button",35)(3,y7,2,2,"span",36),s(),c(4,"td")(5,"strong"),d(6),s()(),c(7,"td")(8,"span",37),d(9),s()(),c(10,"td")(11,"span"),d(12),s()(),c(13,"td"),H(14,M7,2,1,"span",38)(15,w7,2,0,"span",39),s(),c(16,"td")(17,"span"),d(18),s()(),c(19,"td")(20,"div",40),H(21,E7,2,0,"button",41),c(22,"button",42),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(23,"\u270F\uFE0F"),s(),c(24,"button",43),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(25,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit,r=q();Fn("level-row",!0)("root-row",t.level===0),f(2),_("ngIf",!r.isSearching&&(t.hasChildren||t.hasChildren===void 0)),f(),_("ngIf",r.isSearching||t.hasChildren===!1),f(3),M(t.accountNumber),f(3),M(t.accountName),f(2),st(ph("level-badge level-",t.level)),f(),ue("L",t.level),f(2),_("ngIf",t.parentAccountName),f(),_("ngIf",!t.parentAccountName),f(2),st(t.isActive?"status-active":"status-inactive"),f(),ue(" ",t.isActive?"Active":"Inactive"," "),f(3),_("ngIf",!r.isSearching)}}function T7(e,n){if(e&1&&(c(0,"tr")(1,"td",50),d(2),s()()),e&2){let t=q();f(2),ue(" ",t.isSearching?"No accounts found matching your search":"No accounts found"," ")}}function P7(e,n){e&1&&(c(0,"span"),d(1," (search results)"),s())}function S7(e,n){if(e&1&&(c(0,"div",24)(1,"div",51)(2,"label"),d(3,"Parent Account"),s(),le(4,"input",52),s()()),e&2){let t=q();f(4),_("value",t.addingChildOf.accountNumber+" - "+t.addingChildOf.accountName)}}var Xp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];flatList=[];saving=!1;isModalOpen=!1;isEdit=!1;searchTerm="";searchResults=[];isSearching=!1;showDeleteConfirm=!1;deleteTarget=null;model={accountNumber:"",accountName:"",parentId:null,isActive:!0};addingChildOf=null;ngOnInit(){this.loadRoots()}loadRoots(){this.svc.getRootAccounts().subscribe({next:n=>{this.items=n.map(t=>nt(Y({},t),{expanded:!1,childrenLoaded:!1,children:[]})),this.rebuildFlatList(),this.cdr.detectChanges()},error:n=>console.error("Error loading root accounts:",n)})}toggleExpand(n){if(n.expanded){n.expanded=!1,this.rebuildFlatList(),this.cdr.detectChanges();return}if(n.childrenLoaded){n.expanded=!0,this.rebuildFlatList(),this.cdr.detectChanges();return}this.svc.getChildAccounts(n.id).subscribe({next:t=>{n.children=t.map(r=>nt(Y({},r),{expanded:!1,childrenLoaded:!1,children:[]})),n.childrenLoaded=!0,n.hasChildren=t.length>0,n.expanded=!0,this.rebuildFlatList(),this.cdr.detectChanges()},error:t=>console.error("Error loading children:",t)})}rebuildFlatList(){this.flatList=[],this.flattenTree(this.items)}flattenTree(n){for(let t of n)this.flatList.push(t),t.expanded&&t.children&&t.children.length>0&&this.flattenTree(t.children)}get displayList(){return this.isSearching&&this.searchTerm?this.searchResults:this.flatList}get totalCount(){return this.isSearching?this.searchResults.length:this.countAll(this.items)}countAll(n){let t=n.length;for(let r of n)r.children&&(t+=this.countAll(r.children));return t}onSearch(){if(!this.searchTerm.trim()){this.isSearching=!1,this.searchResults=[],this.cdr.detectChanges();return}this.isSearching=!0,this.svc.searchAccounts(this.searchTerm.trim()).subscribe({next:n=>{this.searchResults=n,this.cdr.detectChanges()},error:n=>console.error("Search error:",n)})}clearSearch(){this.searchTerm="",this.isSearching=!1,this.searchResults=[],this.cdr.detectChanges()}openAddRoot(){this.model={accountNumber:"",accountName:"",parentId:null,isActive:!0},this.addingChildOf=null,this.isEdit=!1,this.isModalOpen=!0}openAddChild(n){this.model={accountNumber:"",accountName:"",parentId:n.id,isActive:!0},this.addingChildOf=n,this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model={id:n.id,accountNumber:n.accountNumber,accountName:n.accountName,parentId:n.parentId,isActive:n.isActive},this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1,this.addingChildOf=null}save(){if(!this.model.accountName||!this.model.accountNumber){alert("\u26A0\uFE0F Please fill in Account Number and Account Name");return}if(this.saving=!0,this.isEdit&&this.model.id)this.svc.updateAccount(this.model.id,{accountNumber:this.model.accountNumber,accountName:this.model.accountName,isActive:this.model.isActive}).subscribe({next:()=>{this.saving=!1,this.refreshAfterChange(),this.closeModal()},error:n=>{this.saving=!1,console.error("Update error:",n),alert("Failed to update account")}});else{let n={accountNumber:this.model.accountNumber,accountName:this.model.accountName,parentId:this.model.parentId,isActive:this.model.isActive,createdBy:"admin"};this.svc.createAccount(n).subscribe({next:()=>{this.saving=!1,this.refreshAfterChange(),this.closeModal()},error:t=>{this.saving=!1,console.error("Create error:",t),alert("Failed to create account")}})}}refreshAfterChange(){if(this.addingChildOf){let n=this.addingChildOf;this.svc.getChildAccounts(n.id).subscribe({next:t=>{n.children=t.map(r=>nt(Y({},r),{expanded:!1,childrenLoaded:!1,children:[]})),n.childrenLoaded=!0,n.hasChildren=t.length>0,n.expanded=!0,this.rebuildFlatList(),this.cdr.detectChanges()}})}else this.loadRoots()}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget&&this.svc.deleteAccount(this.deleteTarget.id).subscribe({next:()=>{this.loadRoots()},error:n=>{console.error("Delete error:",n),alert("Failed to delete account")}}),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/accounting/codes"])}getIndentPadding(n){return`${n*28+8}px`}static \u0275fac=function(t){return new(t||e)(j(Ut),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-accounting-code-account"]],standalone:!1,decls:66,vars:18,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search accounts...",3,"ngModelChange","input","keyup.escape","ngModel"],["class","clear-search-btn",3,"click",4,"ngIf"],[1,"code-table"],[2,"width","50px"],[2,"width","120px"],[3,"level-row","root-row",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer",2,"display","flex","justify-content","space-between","align-items","center"],[1,"records-info"],[3,"data"],["size","medium",3,"closed","title","isOpen"],[1,"modal-form"],["class","form-row",4,"ngIf"],[1,"form-row"],[1,"form-group"],["type","text","placeholder","Enter account number",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter account name",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"clear-search-btn",3,"click"],["class","expand-btn",3,"marginLeft","click",4,"ngIf"],["class","leaf-indent",3,"marginLeft",4,"ngIf"],[1,"account-name"],["class","parent-info",4,"ngIf"],["class","no-parent",4,"ngIf"],[1,"actions-cell"],["class","action-btn add-child-btn","title","Add Child",3,"click",4,"ngIf"],["title","Edit",1,"action-btn","edit-btn",3,"click"],["title","Delete",1,"action-btn","delete-btn",3,"click"],[1,"expand-btn",3,"click"],[1,"expand-arrow"],[1,"leaf-indent"],[1,"parent-info"],[1,"no-parent"],["title","Add Child",1,"action-btn","add-child-btn",3,"click"],["colspan","7",1,"empty-row"],[1,"form-group",2,"grid-column","1 / -1"],["type","text","readonly","",1,"readonly-input",3,"value"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F4CB} Operation Accounts"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAddRoot()}),d(12,"\uFF0B Add Root Account"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),E("input",function(){return r.onSearch()})("keyup.escape",function(){return r.clearSearch()}),s(),H(18,C7,2,0,"button",12),s(),c(19,"table",13)(20,"thead")(21,"tr"),le(22,"th",14),c(23,"th"),d(24,"Account Number"),s(),c(25,"th"),d(26,"Account Name"),s(),c(27,"th"),d(28,"Level"),s(),c(29,"th"),d(30,"Parent Account"),s(),c(31,"th"),d(32,"Status"),s(),c(33,"th",15),d(34,"Actions"),s()()(),c(35,"tbody"),H(36,O7,26,18,"tr",16)(37,T7,3,1,"tr",17),s()(),c(38,"div",18)(39,"span",19),d(40),H(41,P7,2,0,"span",17),s(),le(42,"app-export-buttons",20),s()()(),c(43,"app-modal",21),E("closed",function(){return r.closeModal()}),c(44,"div",22),H(45,S7,5,1,"div",23),c(46,"div",24)(47,"div",25)(48,"label"),d(49,"Account Number *"),s(),c(50,"input",26),P("ngModelChange",function(i){return S(r.model.accountNumber,i)||(r.model.accountNumber=i),i}),s()(),c(51,"div",25)(52,"label"),d(53,"Account Name *"),s(),c(54,"input",27),P("ngModelChange",function(i){return S(r.model.accountName,i)||(r.model.accountName=i),i}),s()()(),c(55,"div",24)(56,"div",25)(57,"label",28)(58,"input",29),P("ngModelChange",function(i){return S(r.model.isActive,i)||(r.model.isActive=i),i}),s(),d(59," Active "),s()()()(),c(60,"div",30)(61,"button",31),E("click",function(){return r.save()}),d(62),s(),c(63,"button",32),E("click",function(){return r.closeModal()}),d(64,"Cancel"),s()()(),c(65,"app-confirm-dialog",33),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.displayList.length," records"),f(8),T("ngModel",r.searchTerm),f(),_("ngIf",r.searchTerm),f(18),_("ngForOf",r.displayList),f(),_("ngIf",r.displayList.length===0),f(3),ue(" Showing ",r.displayList.length," records "),f(),_("ngIf",r.isSearching),f(),_("data",r.displayList),f(),_("title",r.isEdit?"Edit Account":r.addingChildOf?"Add Child Account":"Add Root Account")("isOpen",r.isModalOpen),f(2),_("ngIf",r.addingChildOf&&!r.isEdit),f(5),T("ngModel",r.model.accountNumber),f(4),T("ngModel",r.model.accountName),f(4),T("ngModel",r.model.isActive),f(3),_("disabled",r.saving),f(),ue(" ",r.isEdit?"\u{1F4BE} Update Account":"\uFF0B Add Account"," "),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.accountName)||""))},dependencies:[Oe,Pe,Ve,We,je,De,at,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}.expand-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:4px;display:inline-flex;align-items:center;justify-content:center;border-radius:4px;transition:all .2s}.expand-btn[_ngcontent-%COMP%]:hover{background:#2a52981a}.expand-btn[_ngcontent-%COMP%]   .expand-arrow[_ngcontent-%COMP%]{font-size:10px;color:#2a5298;transition:transform .25s ease;display:inline-block}.expand-btn[_ngcontent-%COMP%]   .expand-arrow.expanded[_ngcontent-%COMP%]{transform:rotate(90deg)}.leaf-indent[_ngcontent-%COMP%]{color:#ccc;font-size:12px;display:inline-block}.level-badge[_ngcontent-%COMP%]{display:inline-block;padding:2px 10px;border-radius:12px;font-size:11px;font-weight:600;letter-spacing:.3px}.level-badge.level-0[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.level-badge.level-1[_ngcontent-%COMP%]{background:linear-gradient(135deg,#43e97b,#38d06e);color:#fff}.level-badge.level-2[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f6d365,#fda085);color:#333}.level-badge.level-3[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a18cd1,#fbc2eb);color:#333}.root-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background:#2a529808}.account-name[_ngcontent-%COMP%]{font-weight:500;color:#333}.parent-info[_ngcontent-%COMP%]{font-size:13px;color:#888}.no-parent[_ngcontent-%COMP%]{color:#ccc}.add-child-btn[_ngcontent-%COMP%]{background:#e8f5e9!important;color:#2e7d32!important}.add-child-btn[_ngcontent-%COMP%]:hover{background:#c8e6c9!important;transform:scale(1.1)}.clear-search-btn[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;font-size:16px;color:#999;padding:4px 8px;border-radius:50%;transition:all .2s}.clear-search-btn[_ngcontent-%COMP%]:hover{background:#f0f0f0;color:#333}.table-search[_ngcontent-%COMP%]{position:relative}"]})};function D7(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td")(5,"span"),d(6),s()(),c(7,"td"),d(8),s(),c(9,"td"),d(10),He(11,"date"),s(),c(12,"td")(13,"div",30)(14,"button",31),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(15,"\u270F\uFE0F"),s(),c(16,"button",32),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(17,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.periodName),f(2),st(t.active?"status-active":"status-inactive"),f(),ue(" ",t.active?"Active":"Inactive"," "),f(2),M(t.recordBy),f(2),M($e(11,6,t.recordTime,"yyyy-MM-dd HH:mm"))}}function k7(e,n){e&1&&(c(0,"tr")(1,"td",33),d(2,"No periods found"),s()())}var Yp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];saving=!1;model={periodName:"",active:!0};isModalOpen=!1;isEdit=!1;searchTerm="";showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getCodePeriods().subscribe({next:n=>{this.items=n,this.cdr.detectChanges()},error:n=>console.error("Error loading periods:",n)})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.periodName||"").toLowerCase().includes(n)||(t.recordBy||"").toLowerCase().includes(n))}openAdd(){this.model={periodName:"",active:!0},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.periodName){alert("\u26A0\uFE0F Please fill in Period Name");return}this.saving=!0,this.isEdit&&this.model.periodId?this.svc.updateCodePeriod(this.model.periodId,this.model).subscribe({next:()=>{this.saving=!1,this.loadData(),this.closeModal()},error:n=>{this.saving=!1,console.error("Update error:",n),alert("Failed to update period")}}):this.svc.createCodePeriod(this.model).subscribe({next:()=>{this.saving=!1,this.loadData(),this.closeModal()},error:n=>{this.saving=!1,console.error("Create error:",n),alert("Failed to create period")}})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.periodId&&this.svc.deleteCodePeriod(this.deleteTarget.periodId).subscribe({next:()=>this.loadData(),error:n=>{console.error("Delete error:",n),alert("Failed to delete period")}}),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/accounting/codes"])}static \u0275fac=function(t){return new(t||e)(j(Ut),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-accounting-code-period"]],standalone:!1,decls:55,vars:15,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search periods...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","medium",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],["type","text","placeholder","e.g. 2026-12",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","5",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F4C5} Code Period"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Period"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Period Name"),s(),c(23,"th"),d(24,"Status"),s(),c(25,"th"),d(26,"Recorded By"),s(),c(27,"th"),d(28,"Record Time"),s(),c(29,"th",13),d(30,"Actions"),s()()(),c(31,"tbody"),H(32,D7,18,9,"tr",14)(33,k7,3,0,"tr",15),s()(),c(34,"div",16)(35,"span",17),d(36),s(),le(37,"app-export-buttons",18),s()()(),c(38,"app-modal",19),E("closed",function(){return r.closeModal()}),c(39,"div",20)(40,"div",21)(41,"div",22)(42,"label"),d(43,"Period Name *"),s(),c(44,"input",23),P("ngModelChange",function(i){return S(r.model.periodName,i)||(r.model.periodName=i),i}),s()(),c(45,"div",22)(46,"label",24)(47,"input",25),P("ngModelChange",function(i){return S(r.model.active,i)||(r.model.active=i),i}),s(),d(48," Active "),s()()()(),c(49,"div",26)(50,"button",27),E("click",function(){return r.save()}),d(51),s(),c(52,"button",28),E("click",function(){return r.closeModal()}),d(53,"Cancel"),s()()(),c(54,"app-confirm-dialog",29),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(15),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Period":"Add New Period")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.periodName),f(3),T("ngModel",r.model.active),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update Period":"\uFF0B Add Period"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.periodName)||""))},dependencies:[Oe,Pe,Ve,We,je,De,at,Ne,ke,rn],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function I7(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td")(5,"span"),d(6),s()(),c(7,"td"),d(8),s(),c(9,"td"),d(10),He(11,"date"),s(),c(12,"td")(13,"div",30)(14,"button",31),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(15,"\u270F\uFE0F"),s(),c(16,"button",32),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(17,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.agentName),f(2),st(t.active?"status-active":"status-inactive"),f(),ue(" ",t.active?"Active":"Inactive"," "),f(2),M(t.recordBy),f(2),M($e(11,6,t.recordTime,"yyyy-MM-dd HH:mm"))}}function A7(e,n){e&1&&(c(0,"tr")(1,"td",33),d(2,"No agents found"),s()())}var Kp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];saving=!1;model={agentName:"",active:!0};isModalOpen=!1;isEdit=!1;searchTerm="";showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getCodeAgents().subscribe({next:n=>{this.items=n,this.cdr.detectChanges()},error:n=>console.error("Error loading agents:",n)})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.agentName||"").toLowerCase().includes(n)||(t.recordBy||"").toLowerCase().includes(n))}openAdd(){this.model={agentName:"",active:!0},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.agentName){alert("\u26A0\uFE0F Please fill in Agent Name");return}this.saving=!0,this.isEdit&&this.model.agentId?this.svc.updateCodeAgent(this.model.agentId,this.model).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.loadData(),this.cdr.detectChanges()},error:n=>{this.saving=!1,console.error("Update error:",n),alert("Failed to update")}}):this.svc.createCodeAgent(this.model).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.loadData(),this.cdr.detectChanges()},error:n=>{this.saving=!1,console.error("Create error:",n),alert("Failed to create")}})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.agentId&&this.svc.deleteCodeAgent(this.deleteTarget.agentId).subscribe({next:()=>this.loadData(),error:n=>{console.error("Delete error:",n),alert("Failed to delete")}}),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/accounting/codes"])}static \u0275fac=function(t){return new(t||e)(j(Ut),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-accounting-code-agent"]],standalone:!1,decls:55,vars:15,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search agents...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","medium",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],["type","text","placeholder","Enter agent name",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","5",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F3EA} Code Agents"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Agent"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Agent Name"),s(),c(23,"th"),d(24,"Status"),s(),c(25,"th"),d(26,"Recorded By"),s(),c(27,"th"),d(28,"Record Time"),s(),c(29,"th",13),d(30,"Actions"),s()()(),c(31,"tbody"),H(32,I7,18,9,"tr",14)(33,A7,3,0,"tr",15),s()(),c(34,"div",16)(35,"span",17),d(36),s(),le(37,"app-export-buttons",18),s()()(),c(38,"app-modal",19),E("closed",function(){return r.closeModal()}),c(39,"div",20)(40,"div",21)(41,"div",22)(42,"label"),d(43,"Agent Name *"),s(),c(44,"input",23),P("ngModelChange",function(i){return S(r.model.agentName,i)||(r.model.agentName=i),i}),s()(),c(45,"div",22)(46,"label",24)(47,"input",25),P("ngModelChange",function(i){return S(r.model.active,i)||(r.model.active=i),i}),s(),d(48," Active "),s()()()(),c(49,"div",26)(50,"button",27),E("click",function(){return r.save()}),d(51),s(),c(52,"button",28),E("click",function(){return r.closeModal()}),d(53,"Cancel"),s()()(),c(54,"app-confirm-dialog",29),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(15),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Agent":"Add New Agent")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.agentName),f(3),T("ngModel",r.model.active),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update Agent":"\uFF0B Add Agent"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.agentName)||""))},dependencies:[Oe,Pe,Ve,We,je,De,at,Ne,ke,rn],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function N7(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td"),d(7),s(),c(8,"td"),d(9),s(),c(10,"td"),d(11),s(),c(12,"td"),d(13),s(),c(14,"td")(15,"span"),d(16),s()(),c(17,"td")(18,"div",38)(19,"button",39),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(20,"\u270F\uFE0F"),s(),c(21,"button",40),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(22,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.beneficiaryName),f(2),M(t.beneficiaryTypeName),f(2),M(t.commercialName),f(2),M(t.vatNo),f(2),M(t.fileNo),f(2),M(t.phone),f(2),st(t.active?"status-active":"status-inactive"),f(),ue(" ",t.active?"Active":"Inactive"," ")}}function F7(e,n){e&1&&(c(0,"tr")(1,"td",41),d(2,"No beneficiaries found"),s()())}function R7(e,n){if(e&1&&(c(0,"option",42),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.beneficiaryTypeId),f(),ue(" ",t.beneficiaryTypeName," ")}}var Zp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];beneficiaryTypes=[];saving=!1;model={beneficiaryName:"",active:!0};isModalOpen=!1;isEdit=!1;searchTerm="";showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData(),this.loadTypes()}loadTypes(){this.svc.getCodeBeneficiaryTypes().subscribe({next:n=>{this.beneficiaryTypes=n,this.cdr.detectChanges()},error:n=>console.error("Error loading beneficiary types:",n)})}loadData(){this.svc.getCodeBeneficiaryNames().subscribe({next:n=>{this.items=n,this.cdr.detectChanges()},error:n=>console.error("Error loading beneficiary names:",n)})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.beneficiaryName||"").toLowerCase().includes(n)||(t.beneficiaryTypeName||"").toLowerCase().includes(n)||(t.commercialName||"").toLowerCase().includes(n)||(t.phone||"").toLowerCase().includes(n))}openAdd(){this.model={beneficiaryName:"",active:!0},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.beneficiaryName){alert("\u26A0\uFE0F Please fill in Beneficiary Name");return}this.saving=!0,this.isEdit&&this.model.beneficiaryId?this.svc.updateCodeBeneficiaryName(this.model.beneficiaryId,this.model).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.loadData(),this.cdr.detectChanges()},error:n=>{this.saving=!1,console.error("Update error:",n),alert("Failed to update")}}):this.svc.createCodeBeneficiaryName(this.model).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.loadData(),this.cdr.detectChanges()},error:n=>{this.saving=!1,console.error("Create error:",n),alert("Failed to create")}})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.beneficiaryId&&this.svc.deleteCodeBeneficiaryName(this.deleteTarget.beneficiaryId).subscribe({next:()=>this.loadData(),error:n=>{console.error("Delete error:",n),alert("Failed to delete")}}),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/accounting/codes"])}static \u0275fac=function(t){return new(t||e)(j(Ut),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-accounting-code-beneficiary-name"]],standalone:!1,decls:91,vars:23,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search beneficiaries...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","medium",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],["type","text","placeholder","Enter beneficiary name",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["disabled","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["type","text","placeholder","Enter commercial name",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter VAT number",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter file number",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter phone",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter address",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","8",1,"empty-row"],[3,"ngValue"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F464} Beneficiary Names"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Beneficiary"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Beneficiary Name"),s(),c(23,"th"),d(24,"Type"),s(),c(25,"th"),d(26,"Commercial Name"),s(),c(27,"th"),d(28,"VAT No"),s(),c(29,"th"),d(30,"File No"),s(),c(31,"th"),d(32,"Phone"),s(),c(33,"th"),d(34,"Status"),s(),c(35,"th",13),d(36,"Actions"),s()()(),c(37,"tbody"),H(38,N7,23,9,"tr",14)(39,F7,3,0,"tr",15),s()(),c(40,"div",16)(41,"span",17),d(42),s(),le(43,"app-export-buttons",18),s()()(),c(44,"app-modal",19),E("closed",function(){return r.closeModal()}),c(45,"div",20)(46,"div",21)(47,"div",22)(48,"label"),d(49,"Beneficiary Name *"),s(),c(50,"input",23),P("ngModelChange",function(i){return S(r.model.beneficiaryName,i)||(r.model.beneficiaryName=i),i}),s()(),c(51,"div",22)(52,"label"),d(53,"Beneficiary Type *"),s(),c(54,"select",24),P("ngModelChange",function(i){return S(r.model.beneficiaryTypeId,i)||(r.model.beneficiaryTypeId=i),i}),c(55,"option",25),d(56,"Select type"),s(),H(57,R7,2,2,"option",26),s()()(),c(58,"div",21)(59,"div",22)(60,"label"),d(61,"Commercial Name"),s(),c(62,"input",27),P("ngModelChange",function(i){return S(r.model.commercialName,i)||(r.model.commercialName=i),i}),s()(),c(63,"div",22)(64,"label"),d(65,"VAT No"),s(),c(66,"input",28),P("ngModelChange",function(i){return S(r.model.vatNo,i)||(r.model.vatNo=i),i}),s()()(),c(67,"div",21)(68,"div",22)(69,"label"),d(70,"File No"),s(),c(71,"input",29),P("ngModelChange",function(i){return S(r.model.fileNo,i)||(r.model.fileNo=i),i}),s()(),c(72,"div",22)(73,"label"),d(74,"Phone"),s(),c(75,"input",30),P("ngModelChange",function(i){return S(r.model.phone,i)||(r.model.phone=i),i}),s()()(),c(76,"div",21)(77,"div",22)(78,"label"),d(79,"Address"),s(),c(80,"input",31),P("ngModelChange",function(i){return S(r.model.address,i)||(r.model.address=i),i}),s()(),c(81,"div",22)(82,"label",32)(83,"input",33),P("ngModelChange",function(i){return S(r.model.active,i)||(r.model.active=i),i}),s(),d(84," Active "),s()()()(),c(85,"div",34)(86,"button",35),E("click",function(){return r.save()}),d(87),s(),c(88,"button",36),E("click",function(){return r.closeModal()}),d(89,"Cancel"),s()()(),c(90,"app-confirm-dialog",37),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(21),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Beneficiary":"Add New Beneficiary")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.beneficiaryName),f(4),T("ngModel",r.model.beneficiaryTypeId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.beneficiaryTypes),f(5),T("ngModel",r.model.commercialName),f(4),T("ngModel",r.model.vatNo),f(5),T("ngModel",r.model.fileNo),f(4),T("ngModel",r.model.phone),f(5),T("ngModel",r.model.address),f(3),T("ngModel",r.model.active),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update Beneficiary":"\uFF0B Add Beneficiary"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.beneficiaryName)||""))},dependencies:[Oe,Pe,Ve,We,je,Et,Ot,De,at,mt,Ne,ke],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function L7(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td")(5,"span"),d(6),s()(),c(7,"td"),d(8),s(),c(9,"td"),d(10),He(11,"date"),s(),c(12,"td")(13,"div",30)(14,"button",31),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(15,"\u270F\uFE0F"),s(),c(16,"button",32),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(17,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.beneficiaryTypeName),f(2),st(t.active?"status-active":"status-inactive"),f(),ue(" ",t.active?"Active":"Inactive"," "),f(2),M(t.recordBy),f(2),M($e(11,6,t.recordTime,"yyyy-MM-dd HH:mm"))}}function B7(e,n){e&1&&(c(0,"tr")(1,"td",33),d(2,"No beneficiary types found"),s()())}var Qp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];saving=!1;model={beneficiaryTypeName:"",active:!0};isModalOpen=!1;isEdit=!1;searchTerm="";showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getCodeBeneficiaryTypes().subscribe({next:n=>{this.items=n,this.cdr.detectChanges()},error:n=>console.error("Error loading beneficiary types:",n)})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.beneficiaryTypeName||"").toLowerCase().includes(n)||(t.recordBy||"").toLowerCase().includes(n))}openAdd(){this.model={beneficiaryTypeName:"",active:!0},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.beneficiaryTypeName){alert("\u26A0\uFE0F Please fill in Beneficiary Type Name");return}this.saving=!0,this.isEdit&&this.model.beneficiaryTypeId?this.svc.updateCodeBeneficiaryType(this.model.beneficiaryTypeId,this.model).subscribe({next:()=>{this.saving=!1,this.loadData(),this.closeModal()},error:n=>{this.saving=!1,console.error("Update error:",n),alert("Failed to update")}}):this.svc.createCodeBeneficiaryType(this.model).subscribe({next:()=>{this.saving=!1,this.loadData(),this.closeModal()},error:n=>{this.saving=!1,console.error("Create error:",n),alert("Failed to create")}})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.beneficiaryTypeId&&this.svc.deleteCodeBeneficiaryType(this.deleteTarget.beneficiaryTypeId).subscribe({next:()=>this.loadData(),error:n=>{console.error("Delete error:",n),alert("Failed to delete")}}),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/accounting/codes"])}static \u0275fac=function(t){return new(t||e)(j(Ut),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-accounting-code-beneficiary-type"]],standalone:!1,decls:55,vars:15,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search types...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","medium",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],["type","text","placeholder","Enter beneficiary type name",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","5",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F3F7}\uFE0F Beneficiary Types"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Type"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Type Name"),s(),c(23,"th"),d(24,"Status"),s(),c(25,"th"),d(26,"Recorded By"),s(),c(27,"th"),d(28,"Record Time"),s(),c(29,"th",13),d(30,"Actions"),s()()(),c(31,"tbody"),H(32,L7,18,9,"tr",14)(33,B7,3,0,"tr",15),s()(),c(34,"div",16)(35,"span",17),d(36),s(),le(37,"app-export-buttons",18),s()()(),c(38,"app-modal",19),E("closed",function(){return r.closeModal()}),c(39,"div",20)(40,"div",21)(41,"div",22)(42,"label"),d(43,"Type Name *"),s(),c(44,"input",23),P("ngModelChange",function(i){return S(r.model.beneficiaryTypeName,i)||(r.model.beneficiaryTypeName=i),i}),s()(),c(45,"div",22)(46,"label",24)(47,"input",25),P("ngModelChange",function(i){return S(r.model.active,i)||(r.model.active=i),i}),s(),d(48," Active "),s()()()(),c(49,"div",26)(50,"button",27),E("click",function(){return r.save()}),d(51),s(),c(52,"button",28),E("click",function(){return r.closeModal()}),d(53,"Cancel"),s()()(),c(54,"app-confirm-dialog",29),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(15),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Beneficiary Type":"Add New Beneficiary Type")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.beneficiaryTypeName),f(3),T("ngModel",r.model.active),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update Type":"\uFF0B Add Type"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.beneficiaryTypeName)||""))},dependencies:[Oe,Pe,Ve,We,je,De,at,Ne,ke,rn],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function V7(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td"),d(7),s(),c(8,"td")(9,"span"),d(10),s()(),c(11,"td"),d(12),s(),c(13,"td"),d(14),He(15,"date"),s(),c(16,"td")(17,"div",32)(18,"button",33),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(19,"\u270F\uFE0F"),s(),c(20,"button",34),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(21,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.costCenterNumber),f(2),M(t.costCenterName),f(2),M(t.costCenterGroup),f(2),st(t.active?"status-active":"status-inactive"),f(),ue(" ",t.active?"Active":"Inactive"," "),f(2),M(t.recordBy),f(2),M($e(15,8,t.recordTime,"yyyy-MM-dd HH:mm"))}}function j7(e,n){e&1&&(c(0,"tr")(1,"td",35),d(2,"No cost centers found"),s()())}var Jp=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];saving=!1;model={costCenterNumber:"",costCenterName:"",costCenterGroup:"",active:!0};isModalOpen=!1;isEdit=!1;searchTerm="";showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getCodeCostCenters().subscribe({next:n=>{this.items=n,this.cdr.detectChanges()},error:n=>console.error("Error loading cost centers:",n)})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.costCenterNumber||"").toLowerCase().includes(n)||(t.costCenterName||"").toLowerCase().includes(n)||(t.costCenterGroup||"").toLowerCase().includes(n))}openAdd(){this.model={costCenterNumber:"",costCenterName:"",costCenterGroup:"",active:!0},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.costCenterName){alert("\u26A0\uFE0F Please fill in Cost Center Name");return}this.saving=!0,this.isEdit&&this.model.costCenterId?this.svc.updateCodeCostCenter(this.model.costCenterId,this.model).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.loadData(),this.cdr.detectChanges()},error:n=>{this.saving=!1,console.error("Update error:",n),alert("Failed to update")}}):this.svc.createCodeCostCenter(this.model).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.loadData(),this.cdr.detectChanges()},error:n=>{this.saving=!1,console.error("Create error:",n),alert("Failed to create")}})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.costCenterId&&this.svc.deleteCodeCostCenter(this.deleteTarget.costCenterId).subscribe({next:()=>this.loadData(),error:n=>{console.error("Delete error:",n),alert("Failed to delete")}}),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/accounting/codes"])}static \u0275fac=function(t){return new(t||e)(j(Ut),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-accounting-code-cost-center"]],standalone:!1,decls:68,vars:17,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search cost centers...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","medium",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],["type","text","placeholder","e.g. 1-00-0000",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter cost center name",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g. Class",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","7",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F3E2} Cost Centers"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Cost Center"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"Number"),s(),c(23,"th"),d(24,"Name"),s(),c(25,"th"),d(26,"Group"),s(),c(27,"th"),d(28,"Status"),s(),c(29,"th"),d(30,"Recorded By"),s(),c(31,"th"),d(32,"Record Time"),s(),c(33,"th",13),d(34,"Actions"),s()()(),c(35,"tbody"),H(36,V7,22,11,"tr",14)(37,j7,3,0,"tr",15),s()(),c(38,"div",16)(39,"span",17),d(40),s(),le(41,"app-export-buttons",18),s()()(),c(42,"app-modal",19),E("closed",function(){return r.closeModal()}),c(43,"div",20)(44,"div",21)(45,"div",22)(46,"label"),d(47,"Cost Center Number *"),s(),c(48,"input",23),P("ngModelChange",function(i){return S(r.model.costCenterNumber,i)||(r.model.costCenterNumber=i),i}),s()(),c(49,"div",22)(50,"label"),d(51,"Cost Center Name *"),s(),c(52,"input",24),P("ngModelChange",function(i){return S(r.model.costCenterName,i)||(r.model.costCenterName=i),i}),s()()(),c(53,"div",21)(54,"div",22)(55,"label"),d(56,"Group"),s(),c(57,"input",25),P("ngModelChange",function(i){return S(r.model.costCenterGroup,i)||(r.model.costCenterGroup=i),i}),s()(),c(58,"div",22)(59,"label",26)(60,"input",27),P("ngModelChange",function(i){return S(r.model.active,i)||(r.model.active=i),i}),s(),d(61," Active "),s()()()(),c(62,"div",28)(63,"button",29),E("click",function(){return r.save()}),d(64),s(),c(65,"button",30),E("click",function(){return r.closeModal()}),d(66,"Cancel"),s()()(),c(67,"app-confirm-dialog",31),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(19),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Cost Center":"Add New Cost Center")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.costCenterNumber),f(4),T("ngModel",r.model.costCenterName),f(5),T("ngModel",r.model.costCenterGroup),f(3),T("ngModel",r.model.active),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update Cost Center":"\uFF0B Add Cost Center"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.costCenterName)||""))},dependencies:[Oe,Pe,Ve,We,je,De,at,Ne,ke,rn],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function U7(e,n){if(e&1){let t=be();c(0,"tr")(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td"),d(7),s(),c(8,"td"),d(9),s(),c(10,"td")(11,"span"),d(12),s()(),c(13,"td"),d(14),He(15,"date"),s(),c(16,"td")(17,"div",34)(18,"button",35),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(19,"\u270F\uFE0F"),s(),c(20,"button",36),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(21,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(3),M(t.fileNumber),f(2),M(t.fileName),f(2),M(t.agentName),f(2),M(t.periodName),f(2),st(t.active?"status-active":"status-inactive"),f(),ue(" ",t.active?"Active":"Inactive"," "),f(2),M($e(15,8,t.recordTime,"yyyy-MM-dd HH:mm"))}}function W7(e,n){e&1&&(c(0,"tr")(1,"td",37),d(2,"No file numbers found"),s()())}function z7(e,n){if(e&1&&(c(0,"option",38),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.agentId),f(),ue(" ",t.agentName," ")}}function H7(e,n){if(e&1&&(c(0,"option",38),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.periodId),f(),ue(" ",t.periodName," ")}}var e0=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];agents=[];periods=[];saving=!1;model={fileNumber:"",fileName:"",active:!0};isModalOpen=!1;isEdit=!1;searchTerm="";showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData(),this.loadLookups()}loadData(){this.svc.getCodeFileNumbers().subscribe({next:n=>{this.items=n,this.cdr.detectChanges()},error:n=>console.error("Error loading file numbers:",n)})}loadLookups(){this.svc.getCodeAgents().subscribe({next:n=>{this.agents=n,this.cdr.detectChanges()},error:n=>console.error("Error loading agents:",n)}),this.svc.getCodePeriods().subscribe({next:n=>{this.periods=n,this.cdr.detectChanges()},error:n=>console.error("Error loading periods:",n)})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.fileNumber||"").toLowerCase().includes(n)||(t.fileName||"").toLowerCase().includes(n)||(t.agentName||"").toLowerCase().includes(n)||(t.periodName||"").toLowerCase().includes(n))}openAdd(){this.model={fileNumber:"",fileName:"",active:!0},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){if(!this.model.fileName){alert("\u26A0\uFE0F Please fill in File Name");return}this.saving=!0,this.isEdit&&this.model.fileId?this.svc.updateCodeFileNumber(this.model.fileId,this.model).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.loadData(),this.cdr.detectChanges()},error:n=>{this.saving=!1,console.error("Update error:",n),alert("Failed to update")}}):this.svc.createCodeFileNumber(this.model).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.loadData(),this.cdr.detectChanges()},error:n=>{this.saving=!1,console.error("Create error:",n),alert("Failed to create")}})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.fileId&&this.svc.deleteCodeFileNumber(this.deleteTarget.fileId).subscribe({next:()=>this.loadData(),error:n=>{console.error("Delete error:",n),alert("Failed to delete")}}),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/accounting/codes"])}static \u0275fac=function(t){return new(t||e)(j(Ut),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-accounting-code-file"]],standalone:!1,decls:79,vars:22,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search files...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","medium",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],["type","text","placeholder","e.g. 2024-01-001",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter file name",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["disabled","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","7",1,"empty-row"],[3,"ngValue"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F4C1} File Numbers"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New File"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"File Number"),s(),c(23,"th"),d(24,"File Name"),s(),c(25,"th"),d(26,"Agent"),s(),c(27,"th"),d(28,"Period"),s(),c(29,"th"),d(30,"Status"),s(),c(31,"th"),d(32,"Record Time"),s(),c(33,"th",13),d(34,"Actions"),s()()(),c(35,"tbody"),H(36,U7,22,11,"tr",14)(37,W7,3,0,"tr",15),s()(),c(38,"div",16)(39,"span",17),d(40),s(),le(41,"app-export-buttons",18),s()()(),c(42,"app-modal",19),E("closed",function(){return r.closeModal()}),c(43,"div",20)(44,"div",21)(45,"div",22)(46,"label"),d(47,"File Number *"),s(),c(48,"input",23),P("ngModelChange",function(i){return S(r.model.fileNumber,i)||(r.model.fileNumber=i),i}),s()(),c(49,"div",22)(50,"label"),d(51,"File Name *"),s(),c(52,"input",24),P("ngModelChange",function(i){return S(r.model.fileName,i)||(r.model.fileName=i),i}),s()()(),c(53,"div",21)(54,"div",22)(55,"label"),d(56,"Agent"),s(),c(57,"select",25),P("ngModelChange",function(i){return S(r.model.agentId,i)||(r.model.agentId=i),i}),c(58,"option",26),d(59,"Select agent"),s(),H(60,z7,2,2,"option",27),s()(),c(61,"div",22)(62,"label"),d(63,"Period"),s(),c(64,"select",25),P("ngModelChange",function(i){return S(r.model.periodId,i)||(r.model.periodId=i),i}),c(65,"option",26),d(66,"Select period"),s(),H(67,H7,2,2,"option",27),s()()(),c(68,"div",21)(69,"div",22)(70,"label",28)(71,"input",29),P("ngModelChange",function(i){return S(r.model.active,i)||(r.model.active=i),i}),s(),d(72," Active "),s()()()(),c(73,"div",30)(74,"button",31),E("click",function(){return r.save()}),d(75),s(),c(76,"button",32),E("click",function(){return r.closeModal()}),d(77,"Cancel"),s()()(),c(78,"app-confirm-dialog",33),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(19),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit File":"Add New File")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.fileNumber),f(4),T("ngModel",r.model.fileName),f(5),T("ngModel",r.model.agentId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.agents),f(4),T("ngModel",r.model.periodId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.periods),f(4),T("ngModel",r.model.active),f(3),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update File":"\uFF0B Add File"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",(r.deleteTarget==null?null:r.deleteTarget.fileName)||""))},dependencies:[Oe,Pe,Ve,We,je,Et,Ot,De,at,mt,Ne,ke,rn],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function $7(e,n){if(e&1){let t=be();c(0,"tr")(1,"td"),d(2),He(3,"date"),s(),c(4,"td"),d(5),He(6,"date"),s(),c(7,"td")(8,"strong"),d(9),s()(),c(10,"td"),d(11),s(),c(12,"td")(13,"div",35)(14,"button",36),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.openEdit(o))}),d(15,"\u270F\uFE0F"),s(),c(16,"button",37),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.confirmDelete(o))}),d(17,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit;f(2),M($e(3,4,t.fromDate,"dd/MM/yyyy")),f(3),M($e(6,7,t.toDate,"dd/MM/yyyy")),f(4),M(t.currency),f(2),M(t.rateValue)}}function G7(e,n){e&1&&(c(0,"tr")(1,"td",38),d(2,"No rates found"),s()())}var t0=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}items=[];model={};isModalOpen=!1;isEdit=!1;searchTerm="";saving=!1;showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadData()}loadData(){this.svc.getRates().subscribe({next:n=>{this.items=n,this.cdr.detectChanges()},error:n=>console.error("Error loading rates:",n)})}get filtered(){if(!this.searchTerm)return this.items;let n=this.searchTerm.toLowerCase();return this.items.filter(t=>(t.currency||"").toLowerCase().includes(n))}openAdd(){this.model={},this.isEdit=!1,this.isModalOpen=!0}openEdit(n){this.model=Y({},n),this.isEdit=!0,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){this.saving=!0,this.isEdit&&this.model.id?this.svc.updateRate(this.model.id,this.model).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.loadData(),this.cdr.detectChanges()},error:n=>{this.saving=!1,console.error("Update error:",n),alert("Failed to update")}}):this.svc.createRate(this.model).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.loadData(),this.cdr.detectChanges()},error:n=>{this.saving=!1,console.error("Create error:",n),alert("Failed to create")}})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.id&&this.svc.deleteRate(this.deleteTarget.id).subscribe({next:()=>this.loadData(),error:n=>{console.error("Delete error:",n),alert("Failed to delete")}}),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/accounting/codes"])}static \u0275fac=function(t){return new(t||e)(j(tt),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-accounting-code-rate"]],standalone:!1,decls:74,vars:17,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search rates...",3,"ngModelChange","ngModel"],[1,"code-table"],[2,"width","90px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["size","small",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],["type","date",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["value",""],["value","USD"],["value","EUR"],["value","EGP"],["value","GBP"],["type","number","placeholder","Exchange rate",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"confirmed","cancelled","isOpen","itemName"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","5",1,"empty-row"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F4B1} Code Rate"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Rate"),s()()(),c(13,"div",8)(14,"div",9)(15,"span",10),d(16,"\u{1F50D}"),s(),c(17,"input",11),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(18,"table",12)(19,"thead")(20,"tr")(21,"th"),d(22,"From Date"),s(),c(23,"th"),d(24,"To Date"),s(),c(25,"th"),d(26,"Currency"),s(),c(27,"th"),d(28,"Rate Value"),s(),c(29,"th",13),d(30,"Actions"),s()()(),c(31,"tbody"),H(32,$7,18,10,"tr",14)(33,G7,3,0,"tr",15),s()(),c(34,"div",16)(35,"span",17),d(36),s(),le(37,"app-export-buttons",18),s()()(),c(38,"app-modal",19),E("closed",function(){return r.closeModal()}),c(39,"div",20)(40,"div",21)(41,"div",22)(42,"label"),d(43,"From Date"),s(),c(44,"input",23),P("ngModelChange",function(i){return S(r.model.fromDate,i)||(r.model.fromDate=i),i}),s()(),c(45,"div",22)(46,"label"),d(47,"To Date"),s(),c(48,"input",23),P("ngModelChange",function(i){return S(r.model.toDate,i)||(r.model.toDate=i),i}),s()()(),c(49,"div",21)(50,"div",22)(51,"label"),d(52,"Currency"),s(),c(53,"select",24),P("ngModelChange",function(i){return S(r.model.currency,i)||(r.model.currency=i),i}),c(54,"option",25),d(55,"Select..."),s(),c(56,"option",26),d(57,"USD"),s(),c(58,"option",27),d(59,"EUR"),s(),c(60,"option",28),d(61,"EGP"),s(),c(62,"option",29),d(63,"GBP"),s()()(),c(64,"div",22)(65,"label"),d(66,"Rate Value"),s(),c(67,"input",30),P("ngModelChange",function(i){return S(r.model.rateValue,i)||(r.model.rateValue=i),i}),s()()()(),c(68,"div",31)(69,"button",32),E("click",function(){return r.save()}),d(70),s(),c(71,"button",33),E("click",function(){return r.closeModal()}),d(72,"Cancel"),s()()(),c(73,"app-confirm-dialog",34),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(8),T("ngModel",r.searchTerm),f(15),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.items.length," records"),f(),_("data",r.filtered),f(),_("title",r.isEdit?"Edit Rate":"Add New Rate")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.fromDate),f(4),T("ngModel",r.model.toDate),f(5),T("ngModel",r.model.currency),f(14),T("ngModel",r.model.rateValue),f(2),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update":"\uFF0B Add"),f(3),_("isOpen",r.showDeleteConfirm)("itemName",((r.deleteTarget==null?null:r.deleteTarget.currency)||"")+" rate"))},dependencies:[Oe,Pe,Ve,We,je,Et,Ot,De,Rn,mt,Ne,ke,rn],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}"]})};function q7(e,n){if(e&1){let t=be();c(0,"div",6)(1,"span",7),d(2,"\u{1F50D}"),s(),c(3,"input",8),E("ngModelChange",function(o){ne(t);let i=q();return re(i.searchTerm.set(o))}),s()()}if(e&2){let t=q();f(3),_("ngModel",t.searchTerm())}}function X7(e,n){e&1&&(c(0,"div",4),le(1,"div",9),c(2,"p"),d(3,"Loading accounting entries..."),s()())}function Y7(e,n){if(e&1){let t=be();c(0,"div",5)(1,"span",10),d(2,"\u26A0\uFE0F"),s(),c(3,"h3"),d(4,"Failed to Load"),s(),c(5,"p",11),d(6),s(),c(7,"button",12),E("click",function(){ne(t);let o=q();return re(o.loadAccountingEntries())}),d(8,"Retry"),s()()}if(e&2){let t=q();f(6),M(t.error())}}function K7(e,n){if(e&1){let t=be();c(0,"div",20),E("click",function(){let o=ne(t).$implicit,i=q(2);return re(i.openEntry(o))}),le(1,"div",21),c(2,"div",22)(3,"div",23)(4,"span",24),d(5),s()(),c(6,"div",25)(7,"h3"),d(8),s(),c(9,"p"),d(10),s()(),c(11,"div",26)(12,"span",27),d(13,"\u2192"),s()()()()}if(e&2){let t=n.$implicit;f(),nn("background",t.gradient),f(2),nn("background",t.gradient),f(2),M(t.icon),f(3),M(t.displayName),f(2),M(t.desc)}}function Z7(e,n){e&1&&(c(0,"div",19)(1,"span",28),d(2,"\u{1F50D}"),s(),c(3,"h3"),d(4,"No entries found"),s(),c(5,"p"),d(6,"Try adjusting your search term"),s()())}function Q7(e,n){if(e&1&&(c(0,"div",13)(1,"div",14)(2,"span",15),d(3),s(),c(4,"span",16),d(5,"Total Entry Types"),s()(),c(6,"div",14)(7,"span",15),d(8),s(),c(9,"span",16),d(10,"Showing"),s()()(),c(11,"div",17),H(12,K7,14,7,"div",18),s(),Yo(13,Z7,7,0,"div",19)),e&2){let t=q();f(3),M(t.entries().length),f(5),M(t.filteredEntries().length),f(4),_("ngForOf",t.filteredEntries()),f(),Ko(t.filteredEntries().length===0?13:-1)}}var n0=class e{accountingService=K(Ut);router=K(ye);entries=Rt([]);loading=Rt(!0);error=Rt(null);searchTerm=Rt("");filteredEntries=Oo(()=>{let n=this.entries(),t=this.searchTerm().toLowerCase();return t?n.filter(r=>r.displayName.toLowerCase().includes(t)||r.desc.toLowerCase().includes(t)):n});entryVisuals={entrytreasurytransaction:{icon:"\u{1F4B3}",desc:"Treasury transaction management",gradient:"linear-gradient(135deg, #f6d365, #fda085)",route:"/accounting/entries/entrytreasurytransaction"},entrycounter:{icon:"\u{1F3E6}",desc:"Treasury counter and denomination tracking",gradient:"linear-gradient(135deg, #667eea, #764ba2)",route:"/accounting/entries/entrycounter"},followcollection:{icon:"\u{1F4E5}",desc:"Follow up on collections",gradient:"linear-gradient(135deg, #43e97b, #38f9d7)",route:"/accounting/entries/followcollection"},followpayment:{icon:"\u{1F4E4}",desc:"Follow up on payments",gradient:"linear-gradient(135deg, #a18cd1, #fbc2eb)",route:"/accounting/entries/followpayment"},updatetransactionsrate:{icon:"\u{1F4B1}",desc:"Update transaction exchange rates",gradient:"linear-gradient(135deg, #4facfe, #00f2fe)",route:"/accounting/entries/updatetransactionsrate"},posttransactions:{icon:"\u{1F4EE}",desc:"Post pending transactions",gradient:"linear-gradient(135deg, #f093fb, #f5576c)",route:"/accounting/entries/posttransactions"}};defaultGradients=["linear-gradient(135deg, #a8edea, #fed6e3)","linear-gradient(135deg, #ffecd2, #fcb69f)","linear-gradient(135deg, #89f7fe, #66a6ff)","linear-gradient(135deg, #c3cfe2, #f5f7fa)"];ngOnInit(){this.loadAccountingEntries()}loadAccountingEntries(){this.loading.set(!0),this.error.set(null),this.accountingService.getAccountingEntries().subscribe({next:n=>{let t=n.map((r,o)=>{let i=this.entryVisuals[r.key.toLowerCase()]||{icon:"\u{1F4CB}",desc:r.displayName,gradient:this.defaultGradients[o%this.defaultGradients.length],route:`/accounting/entries/${r.key}`};return{key:r.key,displayName:r.displayName,icon:i.icon,desc:i.desc,gradient:i.gradient,route:i.route}});this.entries.set(t),this.loading.set(!1)},error:n=>{console.error("Error loading accounting entries:",n),this.error.set("Failed to load accounting entries"),this.loading.set(!1)}})}openEntry(n){this.router.navigate([n.route])}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-accounting-entries-list"]],standalone:!1,decls:11,vars:2,consts:[[1,"component-container"],[1,"page-header"],[1,"header-content"],["class","header-search",4,"ngIf"],[1,"loading-container"],[1,"error-container"],[1,"header-search"],[1,"search-icon"],["type","text","placeholder","Search entries...",3,"ngModelChange","ngModel"],[1,"spinner"],[1,"error-icon"],[1,"error-message"],[1,"retry-btn",3,"click"],[1,"summary-bar"],[1,"summary-stat"],[1,"stat-val"],[1,"stat-lbl"],[1,"cards-grid"],["class","card-item",3,"click",4,"ngFor","ngForOf"],[1,"empty-state"],[1,"card-item",3,"click"],[1,"card-accent"],[1,"card-body"],[1,"card-icon-wrap"],[1,"card-icon"],[1,"card-info"],[1,"card-meta"],[1,"arrow-circle"],[1,"empty-icon"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),d(4,"\u{1F4CB} Accounting Entries"),s(),c(5,"p"),d(6,"Manage accounting entry types and transactions"),s()(),H(7,q7,4,1,"div",3),s(),Yo(8,X7,4,0,"div",4)(9,Y7,9,1,"div",5)(10,Q7,14,4),s()),t&2&&(f(7),_("ngIf",!r.loading()),f(),Ko(r.loading()?8:r.error()?9:10))},dependencies:[Oe,Pe,De,Ne,ke],styles:[".page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:20px;flex-wrap:wrap;gap:14px}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:var(--dm-primary);margin:0 0 4px;letter-spacing:-.3px}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-size:14px;margin:0}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]{position:relative}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:10px 16px 10px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;width:260px;outline:none;background:var(--dm-surface);box-shadow:var(--dm-shadow);font-family:inherit;color:var(--dm-text);transition:border-color .2s,box-shadow .2s,width .2s}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014;width:300px}.summary-bar[_ngcontent-%COMP%]{display:flex;gap:14px;margin-bottom:20px;flex-wrap:wrap}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]{background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);padding:10px 18px;display:flex;align-items:center;gap:10px;box-shadow:var(--dm-shadow)}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-val[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:var(--dm-primary)}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-lbl[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.cards-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px}.card-item[_ngcontent-%COMP%]{display:block;position:relative;background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius);text-decoration:none;color:inherit;overflow:hidden;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease,border-color .2s ease;box-shadow:var(--dm-shadow)}.card-item[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:var(--dm-shadow-md);border-color:var(--dm-accent)}.card-item[_ngcontent-%COMP%]:hover   .arrow-circle[_ngcontent-%COMP%]{background:var(--dm-primary);color:#fff}.card-item[_ngcontent-%COMP%]:hover   .card-accent[_ngcontent-%COMP%]{height:4px}.card-item[_ngcontent-%COMP%]:hover   .card-icon-wrap[_ngcontent-%COMP%]{transform:scale(1.05)}.card-item[_ngcontent-%COMP%]   .card-accent[_ngcontent-%COMP%]{height:3px;transition:height .2s}.card-item[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;align-items:center;gap:14px;padding:16px 18px}.card-item[_ngcontent-%COMP%]   .card-icon-wrap[_ngcontent-%COMP%]{width:46px;height:46px;border-radius:var(--dm-radius-sm);display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:var(--dm-shadow);transition:transform .2s ease}.card-item[_ngcontent-%COMP%]   .card-icon-wrap[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{font-size:22px}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]{flex:1;min-width:0}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--dm-text);margin:0 0 2px;letter-spacing:-.2px}.card-item[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;color:var(--dm-text-muted);margin:0;line-height:1.3;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.card-item[_ngcontent-%COMP%]   .card-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:6px;flex-shrink:0}.card-item[_ngcontent-%COMP%]   .record-badge[_ngcontent-%COMP%]{background:#10b98114;color:#059669;padding:2px 10px;border-radius:20px;font-size:11px;font-weight:600;white-space:nowrap}.card-item[_ngcontent-%COMP%]   .arrow-circle[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:50%;background:var(--dm-hover);display:flex;align-items:center;justify-content:center;font-size:13px;color:var(--dm-text-muted);transition:all .2s}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:56px 20px;background:var(--dm-surface);border:1px solid var(--dm-border);border-radius:var(--dm-radius);margin-top:16px;box-shadow:var(--dm-shadow)}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:44px;display:block;margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--dm-primary);font-size:17px;margin:0 0 4px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-size:14px;margin:0}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:3.5rem 2rem;color:var(--dm-text-muted);text-align:center}.loading-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:38px;height:38px;border:3px solid rgba(15,52,96,.1);border-top:3px solid var(--dm-accent);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;font-weight:500}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:3.5rem 2rem;text-align:center}.error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:44px;margin-bottom:.75rem;opacity:.7}.error-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--dm-highlight);font-size:18px;font-weight:600;margin-bottom:.5rem}.error-container[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:var(--dm-text-muted);margin-bottom:1.5rem;font-size:14px}.error-container[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border:none;padding:.65rem 1.25rem;border-radius:var(--dm-radius-sm);cursor:pointer;font-weight:600;font-size:14px;transition:box-shadow .2s}.error-container[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]:hover{box-shadow:var(--dm-shadow-md)}@media(max-width:768px){.cards-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.page-header[_ngcontent-%COMP%]   .header-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{width:100%}.summary-bar[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]{flex:1;min-width:100px}}.component-container[_ngcontent-%COMP%]{padding:0 10px}"],changeDetection:0})};function J7(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.name),f(),M(t.name)}}function e9(e,n){if(e&1){let t=be();c(0,"tr",53),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.selectTransaction(o))}),c(1,"td")(2,"strong"),d(3),s()(),c(4,"td"),d(5),s(),c(6,"td"),d(7),He(8,"date"),s(),c(9,"td"),d(10),s(),c(11,"td"),d(12),s(),c(13,"td"),d(14),s(),c(15,"td",54),d(16),s(),c(17,"td"),d(18),s(),c(19,"td")(20,"div",55)(21,"button",56),E("click",function(o){let i=ne(t).$implicit;return q().openEdit(i),re(o.stopPropagation())}),d(22,"\u270F\uFE0F"),s(),c(23,"button",57),E("click",function(o){let i=ne(t).$implicit;return q().confirmDelete(i),re(o.stopPropagation())}),d(24,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit,r=q();Fn("selected",t.treasuryTransactionId===(r.selectedTransaction==null?null:r.selectedTransaction.treasuryTransactionId)),f(3),M(t.receiptNo),f(2),M(t.transactionTypeName),f(2),M($e(8,10,t.transactionDate,"dd/MM/yyyy")),f(3),M(t.beneficiaryNameValue||"-"),f(2),M(t.currency),f(2),M(t.paymentType),f(2),M(t.description),f(2),M(t.recordBy)}}function t9(e,n){e&1&&(c(0,"tr")(1,"td",58),d(2,"No transactions found"),s()())}function n9(e,n){if(e&1){let t=be();c(0,"tr")(1,"td"),d(2),s(),c(3,"td"),d(4),s(),c(5,"td"),d(6),s(),c(7,"td"),d(8),s(),c(9,"td"),d(10),s(),c(11,"td"),d(12),s(),c(13,"td"),d(14),s(),c(15,"td"),d(16),s(),c(17,"td",69),d(18),He(19,"number"),s(),c(20,"td",69),d(21),He(22,"number"),s(),c(23,"td",69),d(24),He(25,"number"),s(),c(26,"td",69),d(27),He(28,"number"),s(),c(29,"td")(30,"div",55)(31,"button",56),E("click",function(){let o=ne(t),i=o.$implicit,a=o.index,l=q(2);return re(l.openEditLine(i,a))}),d(32,"\u270F\uFE0F"),s(),c(33,"button",57),E("click",function(){let o=ne(t).index,i=q(2);return re(i.removeLine(o))}),d(34,"\u{1F5D1}\uFE0F"),s()()()()}if(e&2){let t=n.$implicit,r=n.index;f(2),M(r+1),f(2),M(t.accountName),f(2),M(t.fileNumberValue||"-"),f(2),M(t.costCenterName||"-"),f(2),M(t.periodName),f(2),M(t.taxPercent||0),f(2),M(t.taxNo||"-"),f(2),M(t.lineDescription),f(2),M($e(19,12,t.debit,"1.2-2")),f(3),M($e(22,15,t.credit,"1.2-2")),f(3),M($e(25,18,t.eqDebit,"1.2-2")),f(3),M($e(28,21,t.eqCredit,"1.2-2"))}}function r9(e,n){e&1&&(c(0,"tr")(1,"td",70),d(2,"No lines for this transaction"),s()())}function o9(e,n){if(e&1&&(c(0,"tr",71)(1,"td",72),d(2,"Totals"),s(),c(3,"td",69)(4,"strong"),d(5),He(6,"number"),s()(),c(7,"td",69)(8,"strong"),d(9),He(10,"number"),s()(),c(11,"td",69)(12,"strong"),d(13),He(14,"number"),s()(),c(15,"td",69)(16,"strong"),d(17),He(18,"number"),s()(),le(19,"td"),s()),e&2){let t=q(2);f(5),M($e(6,4,t.totalDebit,"1.2-2")),f(4),M($e(10,7,t.totalCredit,"1.2-2")),f(4),M($e(14,10,t.totalEqDebit,"1.2-2")),f(4),M($e(18,13,t.totalEqCredit,"1.2-2"))}}function i9(e,n){if(e&1&&(c(0,"span",67)(1,"strong"),d(2,"LU RecordBy:"),s(),d(3),s()),e&2){let t=q(2);f(3),ue(" ",t.selectedTransaction.luRecordBy)}}function a9(e,n){if(e&1&&(c(0,"span",67)(1,"strong"),d(2,"LU Record Time:"),s(),d(3),He(4,"date"),s()),e&2){let t=q(2);f(3),ue(" ",$e(4,1,t.selectedTransaction.luRecordTime,"dd/MM/yyyy hh:mm a"))}}function s9(e,n){if(e&1&&(c(0,"div",59)(1,"div",60)(2,"h3"),d(3),s(),c(4,"div",61)(5,"span",62)(6,"strong"),d(7,"Beneficiary:"),s(),d(8),s(),c(9,"span",62)(10,"strong"),d(11,"Description:"),s(),d(12),s(),c(13,"span",62)(14,"strong"),d(15,"Account:"),s(),d(16),s()()(),c(17,"table",63)(18,"thead")(19,"tr")(20,"th"),d(21,"#"),s(),c(22,"th"),d(23,"Account"),s(),c(24,"th"),d(25,"File"),s(),c(26,"th"),d(27,"Cost Center"),s(),c(28,"th"),d(29,"Period"),s(),c(30,"th"),d(31,"Tax %"),s(),c(32,"th"),d(33,"Tax #"),s(),c(34,"th"),d(35,"Description"),s(),c(36,"th"),d(37,"Debit"),s(),c(38,"th"),d(39,"Credit"),s(),c(40,"th"),d(41,"Eq Debit"),s(),c(42,"th"),d(43,"Eq Credit"),s(),c(44,"th",22),d(45,"Actions"),s()()(),c(46,"tbody"),H(47,n9,35,24,"tr",64)(48,r9,3,0,"tr",24)(49,o9,20,16,"tr",65),s()(),c(50,"div",66)(51,"span",67)(52,"strong"),d(53,"RecordBy:"),s(),d(54),s(),c(55,"span",67)(56,"strong"),d(57,"Record Time:"),s(),d(58),He(59,"date"),s(),H(60,i9,4,1,"span",68)(61,a9,5,4,"span",68),s()()),e&2){let t=q();f(3),Ue("\u{1F4CB} Lines for: ",t.selectedTransaction.receiptNo," \u2014 ",t.selectedTransaction.transactionTypeName),f(5),ue(" ",t.selectedTransaction.beneficiaryNameValue||"-"),f(4),ue(" ",t.selectedTransaction.description),f(4),ue(" ",t.selectedTransaction.paymentDefaultAccountName),f(31),_("ngForOf",t.lines),f(),_("ngIf",t.lines.length===0),f(),_("ngIf",t.lines.length>0),f(5),ue(" ",t.selectedTransaction.recordBy),f(4),ue(" ",$e(59,12,t.selectedTransaction.recordTime,"dd/MM/yyyy hh:mm a")),f(2),_("ngIf",t.selectedTransaction.luRecordBy),f(),_("ngIf",t.selectedTransaction.luRecordTime)}}function c9(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.name),f(),M(t.name)}}function l9(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.periodId),f(),M(t.periodName)}}function d9(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.beneficiaryId),f(),M(t.beneficiaryName)}}function u9(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.beneficiaryTypeId),f(),M(t.beneficiaryTypeName)}}function f9(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t),f(),M(t)}}function p9(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t),f(),M(t)}}function g9(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),Ue("",t.accountNumber," - ",t.accountName)}}function m9(e,n){if(e&1){let t=be();c(0,"tr")(1,"td"),d(2),s(),c(3,"td"),d(4),s(),c(5,"td"),d(6),s(),c(7,"td"),d(8),s(),c(9,"td"),d(10),s(),c(11,"td"),d(12),s(),c(13,"td",69),d(14),He(15,"number"),s(),c(16,"td",69),d(17),He(18,"number"),s(),c(19,"td")(20,"button",57),E("click",function(){let o=ne(t).index,i=q(2);return re(i.removeLine(o))}),d(21,"\u2715"),s()()()}if(e&2){let t=n.$implicit,r=n.index;f(2),M(r+1),f(2),M(t.accountName),f(2),M(t.fileNumberValue||"-"),f(2),M(t.costCenterName||"-"),f(2),M(t.periodName),f(2),M(t.lineDescription),f(2),M($e(15,8,t.debit,"1.2-2")),f(3),M($e(18,11,t.credit,"1.2-2"))}}function h9(e,n){if(e&1&&(c(0,"table",73)(1,"thead")(2,"tr")(3,"th"),d(4,"#"),s(),c(5,"th"),d(6,"Account"),s(),c(7,"th"),d(8,"File"),s(),c(9,"th"),d(10,"Cost Center"),s(),c(11,"th"),d(12,"Period"),s(),c(13,"th"),d(14,"Description"),s(),c(15,"th"),d(16,"Debit"),s(),c(17,"th"),d(18,"Credit"),s(),le(19,"th",74),s()(),c(20,"tbody"),H(21,m9,22,14,"tr",64),s()()),e&2){let t=q();f(21),_("ngForOf",t.lines)}}function v9(e,n){e&1&&(c(0,"p",75),d(1,"No lines added yet."),s())}function x9(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.id),f(),Ue("",t.accountNumber," - ",t.accountName)}}function _9(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.fileId),f(),M(t.fileNumber)}}function C9(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.costCenterId),f(),M(t.costCenterName)}}function b9(e,n){if(e&1&&(c(0,"option",17),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t.periodId),f(),M(t.periodName)}}var r0=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}transactionTypes=[{name:"Advance",id:2},{name:"Revenue",id:1},{name:"Expense",id:2},{name:"Advance Settlement",id:1}];paymentTypes=["Cash","Check","Transfer","Credit Card"];currencies=["EGP","USD","EUR","GBP"];searchTerm="";searchFromDate="";searchToDate="";searchTypeName=null;transactions=[];selectedTransaction=null;accounts=[];periods=[];beneficiaryNames=[];beneficiaryTypes=[];costCenters=[];fileNumbers=[];isModalOpen=!1;isEdit=!1;saving=!1;model=this.emptyModel();isLineModalOpen=!1;isLineEdit=!1;editingLineIndex=-1;lineSaving=!1;lineModel=this.emptyLine();lines=[];showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.loadDropdowns(),this.searchTransactions()}loadDropdowns(){Lo({accounts:this.svc.getRootAccounts(),periods:this.svc.getCodePeriods(),beneficiaryNames:this.svc.getCodeBeneficiaryNames(),beneficiaryTypes:this.svc.getCodeBeneficiaryTypes(),costCenters:this.svc.getCodeCostCenters(),fileNumbers:this.svc.getCodeFileNumbers()}).subscribe({next:n=>{this.accounts=n.accounts,this.periods=n.periods,this.beneficiaryNames=n.beneficiaryNames,this.beneficiaryTypes=n.beneficiaryTypes,this.costCenters=n.costCenters,this.fileNumbers=n.fileNumbers,this.cdr.detectChanges()},error:n=>console.error("Error loading dropdowns:",n)})}searchTransactions(){let n=this.transactionTypes.find(r=>r.name===this.searchTypeName),t=n?n.id:void 0;this.svc.searchTreasuryTransactions(this.searchTerm||void 0,this.searchFromDate||void 0,this.searchToDate||void 0,t).subscribe({next:r=>{this.transactions=r,this.cdr.detectChanges()},error:r=>console.error("Error searching transactions:",r)})}selectTransaction(n){n.treasuryTransactionId&&this.svc.getTreasuryTransaction(n.treasuryTransactionId).subscribe({next:t=>{this.selectedTransaction=t,this.model=Y({},t),this.lines=t.lines?t.lines.map(r=>Y({},r)):[],this.cdr.detectChanges()},error:t=>console.error("Error loading transaction:",t)})}openAdd(){this.model=this.emptyModel(),this.lines=[],this.isEdit=!1,this.isModalOpen=!0}openEdit(n){n.treasuryTransactionId&&this.svc.getTreasuryTransaction(n.treasuryTransactionId).subscribe({next:t=>{this.model=Y({},t);let r=this.transactionTypes.find(o=>o.name.toLowerCase()===t.transactionTypeName?.toLowerCase());r&&(this.model.transactionTypeName=r.name),this.lines=t.lines?t.lines.map(o=>Y({},o)):[],this.isEdit=!0,this.isModalOpen=!0,this.cdr.detectChanges()},error:t=>console.error("Error loading transaction:",t)})}closeModal(){this.isModalOpen=!1,this.saving=!1}save(){let n=this.transactionTypes.find(o=>o.name===this.model.transactionTypeName);if(!n){alert("\u26A0\uFE0F Please select a valid Transaction Type");return}if(this.model.transactionTypeId=n.id,!this.model.receiptNo){alert("\u26A0\uFE0F Please enter a Receipt No");return}if(this.lines.length===0){alert("\u26A0\uFE0F Please add at least one line");return}let t=this.lines[0];if((t.debit||0)<=0&&(t.credit||0)<=0){alert("\u26A0\uFE0F Manual line must have either Debit or Credit > 0");return}this.saving=!0;let r={transactionTypeId:this.model.transactionTypeId,receiptNo:this.model.receiptNo||"",transactionDate:this.model.transactionDate||new Date().toISOString(),periodId:this.model.periodId||0,beneficiaryNameId:this.model.beneficiaryNameId||void 0,beneficiaryTypeId:this.model.beneficiaryTypeId||void 0,currency:this.model.currency||"EGP",rate:this.model.rate||1,dueDate:this.model.dueDate||void 0,withdrawBank:this.model.withdrawBank||void 0,paymentType:this.model.paymentType||"Cash",paymentDefaultAccountId:this.model.paymentDefaultAccountId||0,description:this.model.description||"",recordBy:this.model.recordBy||"",manualLineAccountId:t.accountId||0,manualLineFileNumberId:t.fileNumberId||void 0,manualLineCostCenterId:t.costCenterId||void 0,manualLinePeriodId:t.periodId||void 0,manualLineServiceId:t.serviceId||void 0,manualLineTaxPercent:t.taxPercent||void 0,manualLineTaxNo:t.taxNo||void 0,manualLineDescription:t.lineDescription||"",manualLineDebit:t.debit||0,manualLineCredit:t.credit||0};this.isEdit&&this.model.treasuryTransactionId?this.svc.updateTreasuryTransaction(this.model.treasuryTransactionId,r).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.searchTransactions(),this.cdr.detectChanges()},error:o=>{this.saving=!1,console.error("Update error:",o),alert("Failed to update: "+(o.error?.message||o.message))}}):this.svc.createTreasuryTransaction(r).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.searchTransactions(),this.cdr.detectChanges()},error:o=>{this.saving=!1,console.error("Create error:",o),alert("Failed to create: "+(o.error?.message||o.message))}})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.treasuryTransactionId&&this.svc.deleteTreasuryTransaction(this.deleteTarget.treasuryTransactionId).subscribe({next:()=>{this.selectedTransaction?.treasuryTransactionId===this.deleteTarget?.treasuryTransactionId&&(this.selectedTransaction=null,this.lines=[]),this.searchTransactions()},error:n=>{console.error("Delete error:",n),alert("Failed to delete")}}),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}openAddLine(){this.lineModel=this.emptyLine(),this.isLineEdit=!1,this.editingLineIndex=-1,this.isLineModalOpen=!0}openEditLine(n,t){this.lineModel=Y({},n),this.isLineEdit=!0,this.editingLineIndex=t,this.isLineModalOpen=!0}closeLineModal(){this.isLineModalOpen=!1,this.isLineEdit=!1,this.editingLineIndex=-1,this.lineSaving=!1}saveLine(){if(!this.lineModel.accountId){alert("\u26A0\uFE0F Please select an Account");return}let n=this.accounts.find(a=>a.id===this.lineModel.accountId);n&&(this.lineModel.accountName=n.accountName);let t=this.periods.find(a=>a.periodId===this.lineModel.periodId);t&&(this.lineModel.periodName=t.periodName);let r=this.costCenters.find(a=>a.costCenterId===this.lineModel.costCenterId);r&&(this.lineModel.costCenterName=r.costCenterName);let o=this.fileNumbers.find(a=>a.fileId===this.lineModel.fileNumberId);o&&(this.lineModel.fileNumberValue=o.fileNumber);let i=this.model.rate||1;this.lineModel.eqDebit=this.lineModel.debit*i,this.lineModel.eqCredit=this.lineModel.credit*i,this.isLineEdit&&this.editingLineIndex>=0?this.lines[this.editingLineIndex]=Y({},this.lineModel):this.lines.push(Y({},this.lineModel)),this.closeLineModal(),this.cdr.detectChanges()}removeLine(n){this.lines.splice(n,1),this.cdr.detectChanges()}get filtered(){return this.transactions}get totalDebit(){return this.lines.reduce((n,t)=>n+(t.debit||0),0)}get totalCredit(){return this.lines.reduce((n,t)=>n+(t.credit||0),0)}get totalEqDebit(){return this.lines.reduce((n,t)=>n+(t.eqDebit||0),0)}get totalEqCredit(){return this.lines.reduce((n,t)=>n+(t.eqCredit||0),0)}getTransactionTypeName(n){return n&&this.transactionTypes.find(t=>t.id===n)?.name||""}goBack(){this.router.navigate(["/accounting/entries"])}emptyModel(){return{transactionTypeId:void 0,transactionTypeName:void 0,receiptNo:"",transactionDate:"",periodId:void 0,beneficiaryNameId:void 0,beneficiaryTypeId:void 0,currency:"EGP",rate:1,dueDate:"",withdrawBank:"",paymentType:"Cash",paymentDefaultAccountId:void 0,description:"",active:!0,recordBy:"",lines:[]}}emptyLine(){return{accountId:void 0,accountName:"",fileNumberId:void 0,fileNumberValue:"",serviceId:void 0,costCenterId:void 0,costCenterName:"",periodId:void 0,periodName:"",taxPercent:void 0,taxNo:"",lineDescription:"",debit:0,credit:0,eqDebit:0,eqCredit:0}}static \u0275fac=function(t){return new(t||e)(j(Ut),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-accounting-entry-treasury-transaction"]],standalone:!1,decls:212,vars:67,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"search-bar"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search transactions...",3,"ngModelChange","ngModel"],[1,"filter-group"],["type","date","placeholder","From Date",1,"filter-input",3,"ngModelChange","ngModel"],["type","date","placeholder","To Date",1,"filter-input",3,"ngModelChange","ngModel"],[1,"filter-select",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"btn-filter",3,"click"],[1,"table-scroll-wrap"],[1,"code-table"],[2,"width","90px"],[3,"selected","click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["class","lines-panel",4,"ngIf"],["size","large",3,"closed","title","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],[3,"ngModelChange","ngModel"],["type","text","placeholder","e.g. R-1001",3,"ngModelChange","ngModel"],["type","date",3,"ngModelChange","ngModel"],["type","number","step","0.01",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter bank name",3,"ngModelChange","ngModel"],[1,"form-group",2,"margin-top","4px"],["type","text","placeholder","Enter description",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g. Mohamed Hamza",3,"ngModelChange","ngModel"],[1,"modal-lines-section"],[1,"modal-lines-header"],[1,"btn-add-line",3,"click"],["class","code-table modal-lines-table",4,"ngIf"],["class","no-lines-msg",4,"ngIf"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],["size","medium",3,"closed","title","isOpen"],["type","text",3,"ngModelChange","ngModel"],["type","text","placeholder","Line description",3,"ngModelChange","ngModel"],[3,"confirmed","cancelled","isOpen","itemName"],[3,"click"],[1,"desc-cell"],[1,"actions-cell"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"],["colspan","9",1,"empty-row"],[1,"lines-panel"],[1,"lines-header"],[1,"lines-meta"],[1,"meta-item"],[1,"code-table","lines-table"],[4,"ngFor","ngForOf"],["class","totals-row",4,"ngIf"],[1,"lines-footer"],[1,"footer-info"],["class","footer-info",4,"ngIf"],[1,"num-cell"],["colspan","13",1,"empty-row"],[1,"totals-row"],["colspan","8",1,"totals-label"],[1,"code-table","modal-lines-table"],[2,"width","40px"],[1,"no-lines-msg"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F4B0} Treasury Transactions"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B Add New Transaction"),s()()(),c(13,"div",8)(14,"div",9)(15,"div",10)(16,"span",11),d(17,"\u{1F50D}"),s(),c(18,"input",12),P("ngModelChange",function(i){return S(r.searchTerm,i)||(r.searchTerm=i),i}),s()(),c(19,"div",13)(20,"input",14),P("ngModelChange",function(i){return S(r.searchFromDate,i)||(r.searchFromDate=i),i}),s(),c(21,"input",15),P("ngModelChange",function(i){return S(r.searchToDate,i)||(r.searchToDate=i),i}),s(),c(22,"select",16),P("ngModelChange",function(i){return S(r.searchTypeName,i)||(r.searchTypeName=i),i}),c(23,"option",17),d(24,"All Types"),s(),H(25,J7,2,2,"option",18),s(),c(26,"button",19),E("click",function(){return r.searchTransactions()}),d(27,"\u{1F50D} Filter"),s()()(),c(28,"div",20)(29,"table",21)(30,"thead")(31,"tr")(32,"th"),d(33,"Receipt No"),s(),c(34,"th"),d(35,"Type"),s(),c(36,"th"),d(37,"Date"),s(),c(38,"th"),d(39,"Beneficiary"),s(),c(40,"th"),d(41,"Currency"),s(),c(42,"th"),d(43,"Payment"),s(),c(44,"th"),d(45,"Description"),s(),c(46,"th"),d(47,"Recorded By"),s(),c(48,"th",22),d(49,"Actions"),s()()(),c(50,"tbody"),H(51,e9,25,13,"tr",23)(52,t9,3,0,"tr",24),s()()(),c(53,"div",25)(54,"span",26),d(55),s(),le(56,"app-export-buttons",27),s()(),H(57,s9,62,15,"div",28),s(),c(58,"app-modal",29),E("closed",function(){return r.closeModal()}),c(59,"div",30)(60,"div",31)(61,"div",32)(62,"label"),d(63,"Transaction Type *"),s(),c(64,"select",33),P("ngModelChange",function(i){return S(r.model.transactionTypeName,i)||(r.model.transactionTypeName=i),i}),c(65,"option",17),d(66,"-- Select --"),s(),H(67,c9,2,2,"option",18),s()(),c(68,"div",32)(69,"label"),d(70,"Receipt No *"),s(),c(71,"input",34),P("ngModelChange",function(i){return S(r.model.receiptNo,i)||(r.model.receiptNo=i),i}),s()()(),c(72,"div",31)(73,"div",32)(74,"label"),d(75,"Date *"),s(),c(76,"input",35),P("ngModelChange",function(i){return S(r.model.transactionDate,i)||(r.model.transactionDate=i),i}),s()(),c(77,"div",32)(78,"label"),d(79,"Period"),s(),c(80,"select",33),P("ngModelChange",function(i){return S(r.model.periodId,i)||(r.model.periodId=i),i}),c(81,"option",17),d(82,"-- Select --"),s(),H(83,l9,2,2,"option",18),s()()(),c(84,"div",31)(85,"div",32)(86,"label"),d(87,"Beneficiary Name"),s(),c(88,"select",33),P("ngModelChange",function(i){return S(r.model.beneficiaryNameId,i)||(r.model.beneficiaryNameId=i),i}),c(89,"option",17),d(90,"-"),s(),H(91,d9,2,2,"option",18),s()(),c(92,"div",32)(93,"label"),d(94,"Beneficiary Type"),s(),c(95,"select",33),P("ngModelChange",function(i){return S(r.model.beneficiaryTypeId,i)||(r.model.beneficiaryTypeId=i),i}),c(96,"option",17),d(97,"-"),s(),H(98,u9,2,2,"option",18),s()()(),c(99,"div",31)(100,"div",32)(101,"label"),d(102,"Currency *"),s(),c(103,"select",33),P("ngModelChange",function(i){return S(r.model.currency,i)||(r.model.currency=i),i}),H(104,f9,2,2,"option",18),s()(),c(105,"div",32)(106,"label"),d(107,"Rate"),s(),c(108,"input",36),P("ngModelChange",function(i){return S(r.model.rate,i)||(r.model.rate=i),i}),s()()(),c(109,"div",31)(110,"div",32)(111,"label"),d(112,"Payment Type *"),s(),c(113,"select",33),P("ngModelChange",function(i){return S(r.model.paymentType,i)||(r.model.paymentType=i),i}),H(114,p9,2,2,"option",18),s()(),c(115,"div",32)(116,"label"),d(117,"Default Account"),s(),c(118,"select",33),P("ngModelChange",function(i){return S(r.model.paymentDefaultAccountId,i)||(r.model.paymentDefaultAccountId=i),i}),c(119,"option",17),d(120,"-- Select --"),s(),H(121,g9,2,3,"option",18),s()()(),c(122,"div",31)(123,"div",32)(124,"label"),d(125,"Withdraw Bank"),s(),c(126,"input",37),P("ngModelChange",function(i){return S(r.model.withdrawBank,i)||(r.model.withdrawBank=i),i}),s()(),c(127,"div",32)(128,"label"),d(129,"Due Date"),s(),c(130,"input",35),P("ngModelChange",function(i){return S(r.model.dueDate,i)||(r.model.dueDate=i),i}),s()()(),c(131,"div",38)(132,"label"),d(133,"Description"),s(),c(134,"input",39),P("ngModelChange",function(i){return S(r.model.description,i)||(r.model.description=i),i}),s()(),c(135,"div",32)(136,"label"),d(137,"Recorded By"),s(),c(138,"input",40),P("ngModelChange",function(i){return S(r.model.recordBy,i)||(r.model.recordBy=i),i}),s()(),c(139,"div",41)(140,"div",42)(141,"h4"),d(142,"Transaction Lines"),s(),c(143,"button",43),E("click",function(){return r.openAddLine()}),d(144,"\uFF0B Add Line"),s()(),H(145,h9,22,1,"table",44)(146,v9,2,0,"p",45),s()(),c(147,"div",46)(148,"button",47),E("click",function(){return r.save()}),d(149),s(),c(150,"button",48),E("click",function(){return r.closeModal()}),d(151,"Cancel"),s()()(),c(152,"app-modal",49),E("closed",function(){return r.closeLineModal()}),c(153,"div",30)(154,"div",31)(155,"div",32)(156,"label"),d(157,"Account *"),s(),c(158,"select",33),P("ngModelChange",function(i){return S(r.lineModel.accountId,i)||(r.lineModel.accountId=i),i}),c(159,"option",17),d(160,"-- Select --"),s(),H(161,x9,2,3,"option",18),s()(),c(162,"div",32)(163,"label"),d(164,"File Number"),s(),c(165,"select",33),P("ngModelChange",function(i){return S(r.lineModel.fileNumberId,i)||(r.lineModel.fileNumberId=i),i}),c(166,"option",17),d(167,"-"),s(),H(168,_9,2,2,"option",18),s()()(),c(169,"div",31)(170,"div",32)(171,"label"),d(172,"Cost Center"),s(),c(173,"select",33),P("ngModelChange",function(i){return S(r.lineModel.costCenterId,i)||(r.lineModel.costCenterId=i),i}),c(174,"option",17),d(175,"-"),s(),H(176,C9,2,2,"option",18),s()(),c(177,"div",32)(178,"label"),d(179,"Period"),s(),c(180,"select",33),P("ngModelChange",function(i){return S(r.lineModel.periodId,i)||(r.lineModel.periodId=i),i}),c(181,"option",17),d(182,"-"),s(),H(183,b9,2,2,"option",18),s()()(),c(184,"div",31)(185,"div",32)(186,"label"),d(187,"Tax %"),s(),c(188,"input",36),P("ngModelChange",function(i){return S(r.lineModel.taxPercent,i)||(r.lineModel.taxPercent=i),i}),s()(),c(189,"div",32)(190,"label"),d(191,"Tax #"),s(),c(192,"input",50),P("ngModelChange",function(i){return S(r.lineModel.taxNo,i)||(r.lineModel.taxNo=i),i}),s()()(),c(193,"div",32)(194,"label"),d(195,"Description"),s(),c(196,"input",51),P("ngModelChange",function(i){return S(r.lineModel.lineDescription,i)||(r.lineModel.lineDescription=i),i}),s()(),c(197,"div",31)(198,"div",32)(199,"label"),d(200,"Debit"),s(),c(201,"input",36),P("ngModelChange",function(i){return S(r.lineModel.debit,i)||(r.lineModel.debit=i),i}),s()(),c(202,"div",32)(203,"label"),d(204,"Credit"),s(),c(205,"input",36),P("ngModelChange",function(i){return S(r.lineModel.credit,i)||(r.lineModel.credit=i),i}),s()()()(),c(206,"div",46)(207,"button",47),E("click",function(){return r.saveLine()}),d(208,"\uFF0B Add Line"),s(),c(209,"button",48),E("click",function(){return r.closeLineModal()}),d(210,"Cancel"),s()()(),c(211,"app-confirm-dialog",52),E("confirmed",function(){return r.onDeleteConfirmed()})("cancelled",function(){return r.onDeleteCancelled()}),s()()),t&2&&(f(9),ue("",r.filtered.length," records"),f(9),T("ngModel",r.searchTerm),f(2),T("ngModel",r.searchFromDate),f(),T("ngModel",r.searchToDate),f(),T("ngModel",r.searchTypeName),f(),_("ngValue",null),f(2),_("ngForOf",r.transactionTypes),f(26),_("ngForOf",r.filtered),f(),_("ngIf",r.filtered.length===0),f(3),Ue("Showing ",r.filtered.length," of ",r.transactions.length," records"),f(),_("data",r.filtered),f(),_("ngIf",r.selectedTransaction),f(),_("title",r.isEdit?"Edit Treasury Transaction":"Add New Treasury Transaction")("isOpen",r.isModalOpen),f(6),T("ngModel",r.model.transactionTypeName),f(),_("ngValue",void 0),f(2),_("ngForOf",r.transactionTypes),f(4),T("ngModel",r.model.receiptNo),f(5),T("ngModel",r.model.transactionDate),f(4),T("ngModel",r.model.periodId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.periods),f(5),T("ngModel",r.model.beneficiaryNameId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.beneficiaryNames),f(4),T("ngModel",r.model.beneficiaryTypeId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.beneficiaryTypes),f(5),T("ngModel",r.model.currency),f(),_("ngForOf",r.currencies),f(4),T("ngModel",r.model.rate),f(5),T("ngModel",r.model.paymentType),f(),_("ngForOf",r.paymentTypes),f(4),T("ngModel",r.model.paymentDefaultAccountId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.accounts),f(5),T("ngModel",r.model.withdrawBank),f(4),T("ngModel",r.model.dueDate),f(4),T("ngModel",r.model.description),f(4),T("ngModel",r.model.recordBy),f(7),_("ngIf",r.lines.length>0),f(),_("ngIf",r.lines.length===0),f(2),_("disabled",r.saving),f(),M(r.isEdit?"\u{1F4BE} Update Transaction":"\uFF0B Add Transaction"),f(3),_("title",r.isLineEdit?"Edit Transaction Line":"Add Transaction Line")("isOpen",r.isLineModalOpen),f(6),T("ngModel",r.lineModel.accountId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.accounts),f(4),T("ngModel",r.lineModel.fileNumberId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.fileNumbers),f(5),T("ngModel",r.lineModel.costCenterId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.costCenters),f(4),T("ngModel",r.lineModel.periodId),f(),_("ngValue",void 0),f(2),_("ngForOf",r.periods),f(5),T("ngModel",r.lineModel.taxPercent),f(4),T("ngModel",r.lineModel.taxNo),f(4),T("ngModel",r.lineModel.lineDescription),f(5),T("ngModel",r.lineModel.debit),f(4),T("ngModel",r.lineModel.credit),f(2),_("disabled",r.lineSaving),f(4),_("isOpen",r.showDeleteConfirm)("itemName","Transaction "+((r.deleteTarget==null?null:r.deleteTarget.receiptNo)||"")))},dependencies:[Oe,Pe,Ve,We,je,Et,Ot,De,Rn,mt,Ne,ke,fa,rn],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}.table-scroll-wrap[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}.search-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:14px;margin-bottom:14px;flex-wrap:wrap}.filter-group[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;flex-wrap:wrap}.filter-input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:13px;outline:none;background:var(--dm-surface);font-family:inherit;color:var(--dm-text);width:140px;transition:border-color .2s,box-shadow .2s}.filter-input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.filter-select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:13px;outline:none;background:var(--dm-surface);font-family:inherit;color:var(--dm-text);width:140px;transition:border-color .2s}.filter-select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent)}.btn-filter[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border:none;padding:8px 16px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:box-shadow .2s;font-family:inherit}.btn-filter[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #0f346040}.desc-cell[_ngcontent-%COMP%]{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.num-cell[_ngcontent-%COMP%]{text-align:right;font-family:Consolas,Courier New,monospace}.lines-panel[_ngcontent-%COMP%]{margin:0 20px 18px;padding:18px;background:var(--dm-hover);border-radius:var(--dm-radius-sm);border:1px solid var(--dm-border)}.lines-header[_ngcontent-%COMP%]{margin-bottom:12px}.lines-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px;color:var(--dm-primary);margin:0 0 6px}.lines-meta[_ngcontent-%COMP%]{display:flex;gap:18px;flex-wrap:wrap}.lines-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.lines-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--dm-text)}.lines-table[_ngcontent-%COMP%]{font-size:13px}.totals-row[_ngcontent-%COMP%]{background:var(--dm-hover)!important;font-weight:700}.totals-row[_ngcontent-%COMP%]   .totals-label[_ngcontent-%COMP%]{text-align:right;color:var(--dm-primary);padding-right:12px;font-weight:600}.lines-footer[_ngcontent-%COMP%]{display:flex;gap:20px;flex-wrap:wrap;margin-top:10px;padding-top:10px;border-top:1px solid var(--dm-border)}.lines-footer[_ngcontent-%COMP%]   .footer-info[_ngcontent-%COMP%]{font-size:12px;color:var(--dm-text-muted)}.lines-footer[_ngcontent-%COMP%]   .footer-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--dm-text)}.modal-lines-section[_ngcontent-%COMP%]{margin-top:18px;padding-top:14px;border-top:1px solid var(--dm-border)}.modal-lines-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.modal-lines-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:14px;color:var(--dm-text);margin:0;font-weight:600}.btn-add-line[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:6px 14px;border-radius:6px;font-size:12px;font-weight:600;cursor:pointer;transition:box-shadow .2s;font-family:inherit}.btn-add-line[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #e9456040}.modal-lines-table[_ngcontent-%COMP%]{font-size:12px}.modal-lines-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:11px}.modal-lines-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:7px 10px}.no-lines-msg[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-style:italic;font-size:13px;text-align:center;padding:14px 0}@media(max-width:768px){.search-bar[_ngcontent-%COMP%]{flex-direction:column}.filter-group[_ngcontent-%COMP%]{width:100%}.filter-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{flex:1;min-width:110px}.lines-panel[_ngcontent-%COMP%]{margin:0 12px 14px;padding:14px}.lines-meta[_ngcontent-%COMP%]{flex-direction:column;gap:6px}}@media(max-width:576px){.lines-panel[_ngcontent-%COMP%]{margin:0 8px 12px;padding:12px}}"]})};function y9(e,n){if(e&1&&(c(0,"option",46),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t),f(),M(t)}}function M9(e,n){if(e&1){let t=be();c(0,"tr",47),E("click",function(){let o=ne(t).$implicit,i=q();return re(i.selectCounter(o))}),c(1,"td"),d(2),He(3,"date"),s(),c(4,"td"),d(5),s(),c(6,"td")(7,"strong"),d(8),s()(),c(9,"td",41),d(10),He(11,"number"),s(),c(12,"td",41),d(13),He(14,"number"),s(),c(15,"td",41),d(16),He(17,"number"),s(),c(18,"td"),d(19),s(),c(20,"td"),d(21),He(22,"date"),s()()}if(e&2){let t=n.$implicit,r=q();Fn("selected",t.treasuryCounterId===(r.selectedCounter==null?null:r.selectedCounter.treasuryCounterId)),f(2),M($e(3,14,t.counterDate,"dd/MM/yyyy")),f(3),M(t.branchName||"-"),f(3),M(t.currency),f(2),M($e(11,17,t.totalCounter,"1.2-2")),f(3),M($e(14,20,t.treasuryBalance,"1.2-2")),f(2),Fn("diff-positive",(t.difference||0)>0)("diff-negative",(t.difference||0)<0),f(),ue(" ",$e(17,23,t.difference,"1.2-2")," "),f(3),M(t.recordBy||"-"),f(2),M($e(22,26,t.recordTime,"dd/MM/yyyy HH:mm"))}}function w9(e,n){e&1&&(c(0,"tr")(1,"td",48),d(2,"No counters found"),s()())}function E9(e,n){if(e&1&&(c(0,"tr")(1,"td"),d(2),s(),c(3,"td")(4,"strong"),d(5),s()(),c(6,"td",41),d(7),He(8,"number"),s(),c(9,"td",41),d(10),He(11,"number"),s()()),e&2){let t=n.$implicit,r=n.index;f(2),M(r+1),f(3),M(t.denomination),f(2),M(gh(8,4,t.count)),f(3),M($e(11,6,t.lineTotal,"1.2-2"))}}function O9(e,n){if(e&1&&(c(0,"table",58)(1,"thead")(2,"tr")(3,"th"),d(4,"#"),s(),c(5,"th"),d(6,"Denomination"),s(),c(7,"th"),d(8,"Count"),s(),c(9,"th"),d(10,"Total"),s()()(),c(11,"tbody"),H(12,E9,12,9,"tr",38),s()()),e&2){let t=q(2);f(12),_("ngForOf",t.selectedCounter.lines)}}function T9(e,n){e&1&&(c(0,"p",59),d(1,"No denomination lines"),s())}function P9(e,n){if(e&1&&(c(0,"span",56)(1,"strong"),d(2,"LU RecordBy:"),s(),d(3),s()),e&2){let t=q(2);f(3),ue(" ",t.selectedCounter.luRecordBy)}}function S9(e,n){if(e&1&&(c(0,"span",56)(1,"strong"),d(2,"LU Record Time:"),s(),d(3),He(4,"date"),s()),e&2){let t=q(2);f(3),ue(" ",$e(4,1,t.selectedCounter.luRecordTime,"dd/MM/yyyy hh:mm a"))}}function D9(e,n){if(e&1&&(c(0,"div",49)(1,"div",50)(2,"h3"),d(3),He(4,"date"),s(),c(5,"div",51)(6,"span",52)(7,"strong"),d(8,"Branch:"),s(),d(9),s(),c(10,"span",52)(11,"strong"),d(12,"Total Counter:"),s(),d(13),He(14,"number"),s(),c(15,"span",52)(16,"strong"),d(17,"Treasury Balance:"),s(),d(18),He(19,"number"),s(),c(20,"span",52)(21,"strong"),d(22,"Difference:"),s(),d(23),He(24,"number"),s()()(),H(25,O9,13,1,"table",53)(26,T9,2,0,"p",54),c(27,"div",55)(28,"span",56)(29,"strong"),d(30,"RecordBy:"),s(),d(31),s(),c(32,"span",56)(33,"strong"),d(34,"Record Time:"),s(),d(35),He(36,"date"),s(),H(37,P9,4,1,"span",57)(38,S9,5,4,"span",57),s()()),e&2){let t=q();f(3),Ue("\u{1F4CB} Counter Details \u2014 ",$e(4,12,t.selectedCounter.counterDate,"dd/MM/yyyy")," (",t.selectedCounter.currency,")"),f(6),ue(" ",t.selectedCounter.branchName||"-"),f(4),ue(" ",$e(14,15,t.selectedCounter.totalCounter,"1.2-2")),f(5),ue(" ",$e(19,18,t.selectedCounter.treasuryBalance,"1.2-2")),f(5),ue(" ",$e(24,21,t.selectedCounter.difference,"1.2-2")),f(2),_("ngIf",t.selectedCounter.lines&&t.selectedCounter.lines.length>0),f(),_("ngIf",!t.selectedCounter.lines||t.selectedCounter.lines.length===0),f(5),ue(" ",t.selectedCounter.recordBy||"-"),f(4),ue(" ",$e(36,24,t.selectedCounter.recordTime,"dd/MM/yyyy hh:mm a")),f(2),_("ngIf",t.selectedCounter.luRecordBy),f(),_("ngIf",t.selectedCounter.luRecordTime)}}function k9(e,n){if(e&1&&(c(0,"option",46),d(1),s()),e&2){let t=n.$implicit;_("ngValue",t),f(),M(t)}}function I9(e,n){if(e&1){let t=be();c(0,"tr")(1,"td",60)(2,"strong"),d(3),s()(),c(4,"td")(5,"input",61),P("ngModelChange",function(o){let i=ne(t).$implicit;return S(i.count,o)||(i.count=o),re(o)}),E("ngModelChange",function(){let o=ne(t).$implicit,i=q();return re(i.updateRowTotal(o))}),s()(),c(6,"td",62),d(7),He(8,"number"),s()()}if(e&2){let t=n.$implicit;f(3),M(t.denomination),f(2),T("ngModel",t.count),f(2),M($e(8,3,t.total,"1.2-2"))}}var o0=class e{constructor(n,t,r){this.svc=n;this.router=t;this.cdr=r}currencies=["EGP","USD","EUR","GBP"];defaultDenominations={EGP:[500,200,100,50,20,10,5,2,1,.5,.25],USD:[100,50,20,10,5,2,1,.5,.25],EUR:[500,200,100,50,20,10,5,2,1,.5,.2,.1],GBP:[50,20,10,5,2,1,.5,.2,.1]};searchCurrency="";searchBranch="";searchFromDate="";searchToDate="";counters=[];selectedCounter=null;isModalOpen=!1;saving=!1;counterDate="";branchName="";currency="EGP";recordBy="";denominationRows=[];showDeleteConfirm=!1;deleteTarget=null;ngOnInit(){this.searchCounters()}searchCounters(){this.svc.searchTreasuryCounters(this.searchCurrency||void 0,this.searchBranch||void 0,this.searchFromDate||void 0,this.searchToDate||void 0).subscribe({next:n=>{this.counters=n,this.cdr.detectChanges()},error:n=>console.error("Error searching counters:",n)})}selectCounter(n){n.treasuryCounterId&&this.svc.getTreasuryCounter(n.treasuryCounterId).subscribe({next:t=>{this.selectedCounter=t,this.cdr.detectChanges()},error:t=>console.error("Error loading counter:",t)})}openAdd(){this.counterDate=new Date().toISOString().split("T")[0],this.branchName="",this.currency="EGP",this.recordBy="",this.treasuryBalance=0,this.initDenominations("EGP"),this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.saving=!1}onCurrencyChange(){this.initDenominations(this.currency)}initDenominations(n){let t=this.defaultDenominations[n]||this.defaultDenominations.EGP;this.denominationRows=t.map(r=>({denomination:r,count:0,total:0}))}updateRowTotal(n){n.total=n.denomination*n.count}get totalCounter(){return this.denominationRows.reduce((n,t)=>n+(t.total||0),0)}treasuryBalance=0;get difference(){return this.totalCounter-(this.treasuryBalance||0)}save(){if(!this.counterDate){alert("\u26A0\uFE0F Please select a Date");return}let n=this.denominationRows.filter(r=>r.count>0);if(n.length===0){alert("\u26A0\uFE0F Please enter count for at least one denomination");return}this.saving=!0;let t={counterDate:this.counterDate,branchName:this.branchName||void 0,currency:this.currency,lines:n.map(r=>({denomination:r.denomination,count:r.count})),recordBy:this.recordBy||void 0,treasuryBalance:this.treasuryBalance};this.svc.createTreasuryCounter(t).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.cdr.detectChanges(),this.searchCounters()},error:r=>{this.saving=!1,console.error("Create error:",r),alert("Failed to create: "+(r.error?.message||r.message))}})}confirmDelete(n){this.deleteTarget=n,this.showDeleteConfirm=!0}onDeleteConfirmed(){this.deleteTarget?.treasuryCounterId&&this.svc.deleteTreasuryCounter(this.deleteTarget.treasuryCounterId).subscribe({next:()=>{this.selectedCounter?.treasuryCounterId===this.deleteTarget?.treasuryCounterId&&(this.selectedCounter=null),this.searchCounters()},error:n=>{console.error("Delete error:",n),alert("Failed to delete")}}),this.showDeleteConfirm=!1,this.deleteTarget=null}onDeleteCancelled(){this.showDeleteConfirm=!1,this.deleteTarget=null}goBack(){this.router.navigate(["/accounting/entries"])}static \u0275fac=function(t){return new(t||e)(j(Ut),j(ye),j(Se))};static \u0275cmp=se({type:e,selectors:[["app-accounting-entry-counter"]],standalone:!1,decls:116,vars:33,consts:[[1,"code-page"],[1,"code-card"],[1,"code-toolbar"],[1,"toolbar-left"],[1,"back-btn",3,"click"],[1,"record-count"],[1,"toolbar-right"],[1,"btn-add",3,"click"],[1,"code-table-wrap"],[1,"search-bar"],[1,"table-search"],[1,"search-icon"],["type","text","placeholder","Search branch...",3,"ngModelChange","ngModel"],[1,"filter-group"],[1,"filter-select",3,"ngModelChange","ngModel"],["value",""],[3,"ngValue",4,"ngFor","ngForOf"],["type","date","placeholder","From Date",1,"filter-input",3,"ngModelChange","ngModel"],["type","date","placeholder","To Date",1,"filter-input",3,"ngModelChange","ngModel"],[1,"btn-filter",3,"click"],[1,"table-scroll-wrap"],[1,"code-table"],[3,"selected","click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"table-footer"],[1,"records-info"],[3,"data"],["class","detail-panel",4,"ngIf"],["title","New Treasury Counter","size","large",3,"closed","isOpen"],[1,"modal-form"],[1,"form-row"],[1,"form-group"],["type","date",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["type","text","placeholder","Leave empty if not applicable",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g. Mohamed Hamza",3,"ngModelChange","ngModel"],[1,"denom-section"],[1,"denom-table"],[4,"ngFor","ngForOf"],[1,"totals-row"],["colspan","2",1,"totals-label"],[1,"num-cell"],["type","number","min","0","placeholder","0",1,"denom-input",2,"font-weight","bold","width","100px","padding","2px 5px","text-align","right",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-save",3,"click","disabled"],[1,"btn-cancel-modal",3,"click"],[3,"ngValue"],[3,"click"],["colspan","8",1,"empty-row"],[1,"detail-panel"],[1,"detail-header"],[1,"detail-meta"],[1,"meta-item"],["class","code-table detail-table",4,"ngIf"],["class","no-lines-msg",4,"ngIf"],[1,"detail-footer"],[1,"footer-info"],["class","footer-info",4,"ngIf"],[1,"code-table","detail-table"],[1,"no-lines-msg"],[1,"denom-cell"],["type","number","min","0","placeholder","0",1,"denom-input",3,"ngModelChange","ngModel"],[1,"num-cell","total-value"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return r.goBack()}),d(5,"\u2190"),s(),c(6,"h2"),d(7,"\u{1F3E6} Treasury Counter"),s(),c(8,"span",5),d(9),s()(),c(10,"div",6)(11,"button",7),E("click",function(){return r.openAdd()}),d(12,"\uFF0B New Counter"),s()()(),c(13,"div",8)(14,"div",9)(15,"div",10)(16,"span",11),d(17,"\u{1F50D}"),s(),c(18,"input",12),P("ngModelChange",function(i){return S(r.searchBranch,i)||(r.searchBranch=i),i}),s()(),c(19,"div",13)(20,"select",14),P("ngModelChange",function(i){return S(r.searchCurrency,i)||(r.searchCurrency=i),i}),c(21,"option",15),d(22,"All Currencies"),s(),H(23,y9,2,2,"option",16),s(),c(24,"input",17),P("ngModelChange",function(i){return S(r.searchFromDate,i)||(r.searchFromDate=i),i}),s(),c(25,"input",18),P("ngModelChange",function(i){return S(r.searchToDate,i)||(r.searchToDate=i),i}),s(),c(26,"button",19),E("click",function(){return r.searchCounters()}),d(27,"\u{1F50D} Filter"),s()()(),c(28,"div",20)(29,"table",21)(30,"thead")(31,"tr")(32,"th"),d(33,"Date"),s(),c(34,"th"),d(35,"Branch"),s(),c(36,"th"),d(37,"Currency"),s(),c(38,"th"),d(39,"Total Counter"),s(),c(40,"th"),d(41,"Treasury Balance"),s(),c(42,"th"),d(43,"Difference"),s(),c(44,"th"),d(45,"Recorded By"),s(),c(46,"th"),d(47,"Record Time"),s()()(),c(48,"tbody"),H(49,M9,23,29,"tr",22)(50,w9,3,0,"tr",23),s()()(),c(51,"div",24)(52,"span",25),d(53),s(),le(54,"app-export-buttons",26),s()(),H(55,D9,39,27,"div",27),s(),c(56,"app-modal",28),E("closed",function(){return r.closeModal()}),c(57,"div",29)(58,"div",30)(59,"div",31)(60,"label"),d(61,"Date *"),s(),c(62,"input",32),P("ngModelChange",function(i){return S(r.counterDate,i)||(r.counterDate=i),i}),s()(),c(63,"div",31)(64,"label"),d(65,"Currency *"),s(),c(66,"select",33),P("ngModelChange",function(i){return S(r.currency,i)||(r.currency=i),i}),E("ngModelChange",function(){return r.onCurrencyChange()}),H(67,k9,2,2,"option",16),s()()(),c(68,"div",30)(69,"div",31)(70,"label"),d(71,"Branch"),s(),c(72,"input",34),P("ngModelChange",function(i){return S(r.branchName,i)||(r.branchName=i),i}),s()(),c(73,"div",31)(74,"label"),d(75,"Recorded By"),s(),c(76,"input",35),P("ngModelChange",function(i){return S(r.recordBy,i)||(r.recordBy=i),i}),s()()(),c(77,"div",36)(78,"h4"),d(79,"Denomination Counts"),s(),c(80,"table",37)(81,"thead")(82,"tr")(83,"th"),d(84,"Denomination"),s(),c(85,"th"),d(86,"Count"),s(),c(87,"th"),d(88,"Total"),s()()(),c(89,"tbody"),H(90,I9,9,6,"tr",38),s(),c(91,"tfoot")(92,"tr",39)(93,"td",40),d(94,"Total Counter :"),s(),c(95,"td",41)(96,"strong"),d(97),He(98,"number"),s()()(),c(99,"tr",39)(100,"td",40),d(101,"Treasury Balance :"),s(),c(102,"td",41)(103,"input",42),P("ngModelChange",function(i){return S(r.treasuryBalance,i)||(r.treasuryBalance=i),i}),s()()(),c(104,"tr",39)(105,"td",40),d(106,"Difference :"),s(),c(107,"td",41)(108,"strong"),d(109),He(110,"number"),s()()()()()()(),c(111,"div",43)(112,"button",44),E("click",function(){return r.save()}),d(113),s(),c(114,"button",45),E("click",function(){return r.closeModal()}),d(115,"Cancel"),s()()()()),t&2&&(f(9),ue("",r.counters.length," records"),f(9),T("ngModel",r.searchBranch),f(2),T("ngModel",r.searchCurrency),f(3),_("ngForOf",r.currencies),f(),T("ngModel",r.searchFromDate),f(),T("ngModel",r.searchToDate),f(24),_("ngForOf",r.counters),f(),_("ngIf",r.counters.length===0),f(3),ue("Showing ",r.counters.length," records"),f(),_("data",r.counters),f(),_("ngIf",r.selectedCounter),f(),_("isOpen",r.isModalOpen),f(6),T("ngModel",r.counterDate),f(4),T("ngModel",r.currency),f(),_("ngForOf",r.currencies),f(5),T("ngModel",r.branchName),f(4),T("ngModel",r.recordBy),f(14),_("ngForOf",r.denominationRows),f(7),M($e(98,27,r.totalCounter,"1.2-2")),f(6),T("ngModel",r.treasuryBalance),f(4),Fn("diff-positive",r.difference>0)("diff-negative",r.difference<0),f(2),M($e(110,30,r.difference,"1.2-2")),f(3),_("disabled",r.saving),f(),ue("\u{1F4BE} ",r.saving?"Saving...":"Save Counter"))},dependencies:[Oe,Pe,Ve,je,Et,Ot,De,Rn,mt,Ne,Ml,ke,fa,rn],styles:[".code-page[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px}.code-card[_ngcontent-%COMP%]{background:var(--dm-surface);border-radius:var(--dm-radius);box-shadow:var(--dm-shadow);overflow:hidden}.code-toolbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dm-primary) 0%,var(--dm-accent) 100%);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;color:#fff;flex-wrap:wrap;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#ffffff1f;border:none;width:34px;height:34px;border-radius:var(--dm-radius-sm);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff38}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px;font-weight:600;letter-spacing:-.2px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{background:#ffffff26;padding:2px 10px;border-radius:20px;font-size:12px;font-weight:500}.code-toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-add[_ngcontent-%COMP%]{background:var(--dm-highlight);color:#fff;border:none;padding:8px 20px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;display:flex;align-items:center;gap:6px}.btn-add[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #e945604d}.code-table-wrap[_ngcontent-%COMP%]{padding:18px 22px}.code-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}@media(max-width:992px){.code-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;width:100%}}.code-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:var(--dm-hover);position:sticky;top:0;z-index:1}.code-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:11px 14px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px;-webkit-user-select:none;user-select:none;white-space:nowrap}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer}.code-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#00000008}.code-table[_ngcontent-%COMP%]   .sort-arrow[_ngcontent-%COMP%]{font-size:10px;margin-left:4px;color:var(--dm-text-muted)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--dm-border);transition:background .15s}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.code-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background:#0f34600f}.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;color:var(--dm-text)}@media(max-width:992px){.code-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}}.code-table[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{text-align:center;color:var(--dm-text-muted);padding:36px 14px;font-style:italic}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:5px}.action-btn[_ngcontent-%COMP%]{width:30px;height:30px;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:background .2s,transform .15s}.action-btn.edit-btn[_ngcontent-%COMP%]{background:#0f346014;color:var(--dm-accent)}.action-btn.edit-btn[_ngcontent-%COMP%]:hover{background:#0f346026;transform:scale(1.05)}.action-btn.delete-btn[_ngcontent-%COMP%]{background:#e9456014;color:var(--dm-highlight)}.action-btn.delete-btn[_ngcontent-%COMP%]:hover{background:#e9456026;transform:scale(1.05)}.table-search[_ngcontent-%COMP%]{position:relative;margin-bottom:14px}.table-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:14px;color:var(--dm-text-muted)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:9px 14px 9px 40px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid var(--dm-border);margin-top:8px}.table-footer[_ngcontent-%COMP%]   .records-info[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;gap:4px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid var(--dm-border);background:var(--dm-surface);border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s;font-family:inherit;color:var(--dm-text)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border-color:var(--dm-accent)}.modal-form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-size:13px;color:var(--dm-text-muted);font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:9px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;background:var(--dm-surface);font-family:inherit;color:var(--dm-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.form-group[_ngcontent-%COMP%]   .readonly-input[_ngcontent-%COMP%]{background:#f3f4f6!important;cursor:not-allowed;color:var(--dm-text-muted)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:14px}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:18px 24px;background:var(--dm-hover);border-top:1px solid var(--dm-border)}.btn-save[_ngcontent-%COMP%], .btn-cancel-modal[_ngcontent-%COMP%]{flex:1;padding:11px;border:none;border-radius:var(--dm-radius-sm);font-size:14px;font-weight:600;cursor:pointer;transition:background .2s,box-shadow .2s;font-family:inherit;letter-spacing:.1px}.btn-save[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0f346040}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.btn-cancel-modal[_ngcontent-%COMP%]{background:var(--dm-border);color:var(--dm-text)}.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d1d5db}@media(max-width:768px){.code-toolbar[_ngcontent-%COMP%]{padding:14px 16px}.code-table-wrap[_ngcontent-%COMP%]{padding:14px 12px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-form[_ngcontent-%COMP%]{padding:18px 16px}.modal-footer[_ngcontent-%COMP%]{padding:14px 16px}}@media(max-width:576px){.code-toolbar[_ngcontent-%COMP%]{padding:12px}.code-toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px}.code-toolbar[_ngcontent-%COMP%]   .record-count[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{padding:7px 14px;font-size:12px}.code-table-wrap[_ngcontent-%COMP%]{padding:10px 8px}.table-footer[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}}.status-active[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}.status-inactive[_ngcontent-%COMP%]{background:var(--dm-hover);color:var(--dm-text-muted);padding:3px 10px;border-radius:20px;font-size:12px;font-weight:500}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:var(--dm-text)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--dm-accent);cursor:pointer}.table-scroll-wrap[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}.search-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:14px;margin-bottom:14px;flex-wrap:wrap}.filter-group[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;flex-wrap:wrap}.filter-input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:13px;outline:none;background:var(--dm-surface);font-family:inherit;color:var(--dm-text);width:140px;transition:border-color .2s,box-shadow .2s}.filter-input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.filter-select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid var(--dm-border);border-radius:var(--dm-radius-sm);font-size:13px;outline:none;background:var(--dm-surface);font-family:inherit;color:var(--dm-text);width:140px;transition:border-color .2s}.filter-select[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent)}.btn-filter[_ngcontent-%COMP%]{background:var(--dm-accent);color:#fff;border:none;padding:8px 16px;border-radius:var(--dm-radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:box-shadow .2s;font-family:inherit}.btn-filter[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #0f346040}.num-cell[_ngcontent-%COMP%]{text-align:right;font-family:Consolas,Courier New,monospace}.diff-positive[_ngcontent-%COMP%]{color:var(--dm-highlight);font-weight:600}.diff-negative[_ngcontent-%COMP%]{color:var(--dm-accent);font-weight:600}.detail-panel[_ngcontent-%COMP%]{margin:0 20px 18px;padding:18px;background:var(--dm-hover);border-radius:var(--dm-radius-sm);border:1px solid var(--dm-border)}.detail-header[_ngcontent-%COMP%]{margin-bottom:12px}.detail-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px;color:var(--dm-primary);margin:0 0 6px}.detail-meta[_ngcontent-%COMP%]{display:flex;gap:18px;flex-wrap:wrap}.detail-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{font-size:13px;color:var(--dm-text-muted)}.detail-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--dm-text)}.detail-table[_ngcontent-%COMP%]{font-size:13px;max-width:500px}.detail-footer[_ngcontent-%COMP%]{display:flex;gap:20px;flex-wrap:wrap;margin-top:10px;padding-top:10px;border-top:1px solid var(--dm-border)}.detail-footer[_ngcontent-%COMP%]   .footer-info[_ngcontent-%COMP%]{font-size:12px;color:var(--dm-text-muted)}.detail-footer[_ngcontent-%COMP%]   .footer-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--dm-text)}.no-lines-msg[_ngcontent-%COMP%]{color:var(--dm-text-muted);font-style:italic;font-size:13px;text-align:center;padding:14px 0}.denom-section[_ngcontent-%COMP%]{margin-top:18px;padding-top:14px;border-top:1px solid var(--dm-border)}.denom-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:14px;color:var(--dm-text);margin:0 0 10px;font-weight:600}.denom-table[_ngcontent-%COMP%]{width:100%;max-width:400px;border-collapse:collapse;font-size:14px}.denom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:9px 12px;text-align:left;font-weight:600;color:var(--dm-text);border-bottom:2px solid var(--dm-border);font-size:12px;text-transform:uppercase;letter-spacing:.4px}.denom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{text-align:right}.denom-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:6px 12px;border-bottom:1px solid var(--dm-border);vertical-align:middle}.denom-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background .15s}.denom-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--dm-hover)}.denom-cell[_ngcontent-%COMP%]{width:100px;font-family:Consolas,Courier New,monospace;font-size:14px}.denom-input[_ngcontent-%COMP%]{width:100%;max-width:120px;padding:6px 10px;border:1px solid var(--dm-border);border-radius:6px;font-size:14px;outline:none;font-family:inherit;text-align:right;color:var(--dm-text);transition:border-color .2s,box-shadow .2s}.denom-input[_ngcontent-%COMP%]:focus{border-color:var(--dm-accent);box-shadow:0 0 0 3px #0f346014}.total-value[_ngcontent-%COMP%]{font-weight:600;color:var(--dm-text)}.totals-row[_ngcontent-%COMP%]{background:var(--dm-hover);font-weight:700}.totals-row[_ngcontent-%COMP%]   .totals-label[_ngcontent-%COMP%]{text-align:right;color:var(--dm-primary);padding-right:12px;font-size:14px}.totals-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:9px 12px;font-size:15px;color:var(--dm-primary);border-top:2px solid var(--dm-border)}@media(max-width:768px){.search-bar[_ngcontent-%COMP%]{flex-direction:column}.filter-group[_ngcontent-%COMP%]{width:100%}.filter-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{flex:1;min-width:110px}.detail-panel[_ngcontent-%COMP%]{margin:0 12px 14px;padding:14px}.detail-meta[_ngcontent-%COMP%]{flex-direction:column;gap:6px}}@media(max-width:576px){.detail-panel[_ngcontent-%COMP%]{margin:0 8px 12px;padding:12px}.denom-table[_ngcontent-%COMP%]{max-width:100%}}"]})};var i0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-accounting-follow-collection"]],standalone:!1,decls:5,vars:0,consts:[[1,"component-container"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"h2"),d(2,"Follow Collection"),s(),c(3,"p"),d(4,"Component will be implemented later."),s()())},styles:[".component-container[_ngcontent-%COMP%]{padding:2rem;background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:1rem}p[_ngcontent-%COMP%]{color:#666;font-style:italic}"],changeDetection:0})};var a0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-accounting-follow-payment"]],standalone:!1,decls:5,vars:0,consts:[[1,"component-container"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"h2"),d(2,"Follow Payment"),s(),c(3,"p"),d(4,"Component will be implemented later."),s()())},styles:[".component-container[_ngcontent-%COMP%]{padding:2rem;background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:1rem}p[_ngcontent-%COMP%]{color:#666;font-style:italic}"],changeDetection:0})};var s0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-accounting-update-transactions-rate"]],standalone:!1,decls:5,vars:0,consts:[[1,"component-container"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"h2"),d(2,"Update Transactions Rate"),s(),c(3,"p"),d(4,"Component will be implemented later."),s()())},styles:[".component-container[_ngcontent-%COMP%]{padding:2rem;background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:1rem}p[_ngcontent-%COMP%]{color:#666;font-style:italic}"],changeDetection:0})};var c0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-accounting-post-transactions"]],standalone:!1,decls:5,vars:0,consts:[[1,"component-container"]],template:function(t,r){t&1&&(c(0,"div",0)(1,"h2"),d(2,"Post Transactions"),s(),c(3,"p"),d(4,"Component will be implemented later."),s()())},styles:[".component-container[_ngcontent-%COMP%]{padding:2rem;background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:1rem}p[_ngcontent-%COMP%]{color:#666;font-style:italic}"],changeDetection:0})};var A9=[{path:"",component:Ff},{path:"operation",component:ml,children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",component:hl},{path:"entries",component:Hf},{path:"entries/transaction",component:wp},{path:"entries/traffic",component:Ep},{path:"entries/revenue",component:Op},{path:"entries/guide-allowance",component:Tp},{path:"entries/rep-commission",component:Pp},{path:"entries/boat-coast",component:Sp},{path:"codes",component:Dp},{path:"codes/agent",component:kp},{path:"codes/boat",component:Ip},{path:"codes/excursion",component:Ap},{path:"codes/excursion-supplier",component:Np},{path:"codes/guide",component:Fp},{path:"codes/hotel",component:Rp},{path:"codes/hotel-destination",component:Lp},{path:"codes/nationality",component:Bp},{path:"codes/price-list",component:Vp},{path:"codes/rate",component:jp},{path:"codes/rep",component:Up},{path:"codes/transportation-type",component:Wp},{path:"codes/transportation-supplier",component:zp},{path:"codes/transportation-cost",component:Hp},{path:"codes/voucher",component:$p},{path:"codes/excursion-cost-selling",component:Gp},{path:"reports",component:Hl}]},{path:"accounting",component:ml,children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",component:hl},{path:"codes",component:qp},{path:"codes/operationaccounts",component:Xp},{path:"codes/codeperiods",component:Yp},{path:"codes/codeagents",component:Kp},{path:"codes/codebeneficiarynames",component:Zp},{path:"codes/codebeneficiarytypes",component:Qp},{path:"codes/codecostercenters",component:Jp},{path:"codes/codefilenumbers",component:e0},{path:"codes/operationrates",component:t0},{path:"entries",component:n0},{path:"entries/entrytreasurytransaction",component:r0},{path:"entries/entrycounter",component:o0},{path:"entries/followcollection",component:i0},{path:"entries/followpayment",component:a0},{path:"entries/updatetransactionsrate",component:s0},{path:"entries/posttransactions",component:c0},{path:"reports",component:Hl}]},{path:"**",redirectTo:""}],l0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({imports:[Wr.forRoot(A9,{useHash:!0}),Wr]})};var d0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({imports:[qn,Wr]})};var No=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({imports:[qn,Fv,qn,Fv]})};var u0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({imports:[qn]})};var f0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({imports:[No,Wr]})};var p0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({imports:[No,Wr]})};var g0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({imports:[qn]})};var m0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({imports:[qn]})};var h0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=ft({type:e});static \u0275inj=dt({imports:[qn,Wr,No]})};var v0=class e{title=Rt("diving-system");static \u0275fac=function(t){return new(t||e)};static \u0275cmp=se({type:e,selectors:[["app-root"]],standalone:!1,decls:1,vars:0,template:function(t,r){t&1&&le(0,"router-outlet")},dependencies:[ya],encapsulation:2})};var x0=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=ft({type:e,bootstrap:[v0]});static \u0275inj=dt({imports:[$h,Jh,l0,d0,No,u0,f0,p0,h0,g0,m0]})};Hh().bootstrapModule(x0,{}).catch(e=>console.error(e));
